/*! For license information please see main.3dd02a24.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var a=n(853),r=n(43),i=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function u(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function c(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(s(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var E=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var F=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===F?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case S:return"Suspense";case I:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case x:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var D=Array.isArray,M=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P={pending:!1,data:null,method:null,action:null},L=[],z=-1;function B(e){return{current:e}}function W(e){0>z||(e.current=L[z],L[z]=null,z--)}function V(e,t){z++,L[z]=e.current,e.current=t}var U,j,G=B(null),H=B(null),q=B(null),K=B(null);function X(e,t){switch(V(q,t),V(H,e),V(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bd(t=yd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}W(G),V(G,e)}function Y(){W(G),W(H),W(q)}function Q(e){null!==e.memoizedState&&V(K,e);var t=G.current,n=bd(t,e.type);t!==n&&(V(H,e),V(G,n))}function J(e){H.current===e&&(W(G),W(H)),K.current===e&&(W(K),ch._currentValue=P)}function Z(e){if(void 0===U)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||"",j=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+U+e+j}var $=!1;function ee(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var a=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){a=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){a=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&a&&"string"===typeof o.stack)return[o.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=a.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var l=s.split("\n"),u=o.split("\n");for(r=a=0;a<l.length&&!l[a].includes("DetermineComponentFrameRoot");)a++;for(;r<u.length&&!u[r].includes("DetermineComponentFrameRoot");)r++;if(a===l.length||r===u.length)for(a=l.length-1,r=u.length-1;1<=a&&0<=r&&l[a]!==u[r];)r--;for(;1<=a&&0<=r;a--,r--)if(l[a]!==u[r]){if(1!==a||1!==r)do{if(a--,0>--r||l[a]!==u[r]){var c="\n"+l[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=a&&0<=r);break}}}finally{$=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Z(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Z(e.type);case 16:return Z("Lazy");case 13:return e.child!==t&&null!==t?Z("Suspense Fallback"):Z("Suspense");case 19:return Z("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Z("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(a){return"\nError generating stack: "+a.message+"\n"+a.stack}}var ae=Object.prototype.hasOwnProperty,re=a.unstable_scheduleCallback,ie=a.unstable_cancelCallback,se=a.unstable_shouldYield,oe=a.unstable_requestPaint,le=a.unstable_now,ue=a.unstable_getCurrentPriorityLevel,ce=a.unstable_ImmediatePriority,de=a.unstable_UserBlockingPriority,he=a.unstable_NormalPriority,pe=a.unstable_LowPriority,fe=a.unstable_IdlePriority,me=a.log,ge=a.unstable_setDisableYieldValue,ye=null,be=null;function ve(e){if("function"===typeof me&&ge(e),be&&"function"===typeof be.setStrictMode)try{be.setStrictMode(ye,e)}catch(t){}}var xe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/ke|0)|0},we=Math.log,ke=Math.LN2;var Se=256,Ie=262144,Ne=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,n){var a=e.pendingLanes;if(0===a)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&a;return 0!==o?0!==(a=o&~i)?r=Te(a):0!==(s&=o)?r=Te(s):n||0!==(n=o&~e)&&(r=Te(n)):0!==(o=a&~i)?r=Te(o):0!==s?r=Te(s):n||0!==(n=a&~e)&&(r=Te(n)),0===r?0:0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:r}function Ee(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function _e(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ae(){var e=Ne;return 0===(62914560&(Ne<<=1))&&(Ne=4194304),e}function Fe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Re(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-xe(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|261930&n}function Me(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-xe(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function Oe(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Pe(n))&(e.suspendedLanes|t))?0:n}function Pe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Le(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function ze(){var e=O.p;return 0!==e?e:void 0===(e=window.event)?32:Th(e.type)}function Be(e,t){var n=O.p;try{return O.p=e,t()}finally{O.p=n}}var We=Math.random().toString(36).slice(2),Ve="__reactFiber$"+We,Ue="__reactProps$"+We,je="__reactContainer$"+We,Ge="__reactEvents$"+We,He="__reactListeners$"+We,qe="__reactHandles$"+We,Ke="__reactResources$"+We,Xe="__reactMarker$"+We;function Ye(e){delete e[Ve],delete e[Ue],delete e[Ge],delete e[He],delete e[qe]}function Qe(e){var t=e[Ve];if(t)return t;for(var n=e.parentNode;n;){if(t=n[je]||n[Ve]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Pd(e);null!==e;){if(n=e[Ve])return n;e=Pd(e)}return t}n=(e=n).parentNode}return null}function Je(e){if(e=e[Ve]||e[je]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Ze(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function $e(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Xe]=!0}var tt=new Set,nt={};function at(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var it=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},ot={};function lt(e,t,n){if(r=t,ae.call(ot,r)||!ae.call(st,r)&&(it.test(r)?ot[r]=!0:(st[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function ut(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ct(e,t,n,a){if(null===a)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+a)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof a&&"function"===typeof a.get&&"function"===typeof a.set){var r=a.get,i=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=ht(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function yt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function bt(e,t,n,a,r,i,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?xt(e,s,dt(t)):null!=n?xt(e,s,dt(n)):null!=a&&e.removeAttribute("value"),null==r&&null!=i&&(e.defaultChecked=!!i),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+dt(o):e.removeAttribute("name")}function vt(e,t,n,a,r,i,s,o){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}a="function"!==typeof(a=null!=a?a:r)&&"symbol"!==typeof a&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s),pt(e)}function xt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function kt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(s(92));if(D(a)){if(1<a.length)throw Error(s(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a),pt(e)}function It(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Nt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,n){var a=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,n):"number"!==typeof n||0===n||Nt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var r in t)a=t[r],t.hasOwnProperty(r)&&n[r]!==a&&Tt(e,r,a)}else for(var i in t)t.hasOwnProperty(i)&&Tt(e,i,t[i])}function Et(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ft(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Rt(){}var Dt=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Pt=null;function Lt(e){var t=Je(e);if(t&&(e=t.stateNode)){var n=e[Ue]||null;e:switch(e=t.stateNode,t.type){case"input":if(bt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=a[Ue]||null;if(!r)throw Error(s(90));bt(a,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&ft(a)}break e;case"textarea":kt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var zt=!1;function Bt(e,t,n){if(zt)return e(t,n);zt=!0;try{return e(t)}finally{if(zt=!1,(null!==Ot||null!==Pt)&&($u(),Ot&&(t=Ot,e=Pt,Pt=Ot=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function Wt(e,t){var n=e.stateNode;if(null===n)return null;var a=n[Ue]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Vt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ut=!1;if(Vt)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch(Jh){Ut=!1}var Gt=null,Ht=null,qt=null;function Kt(){if(qt)return qt;var e,t,n=Ht,a=n.length,r="value"in Gt?Gt.value:Gt.textContent,i=r.length;for(e=0;e<a&&n[e]===r[e];e++);var s=a-e;for(t=1;t<=s&&n[a-t]===r[i-t];t++);return qt=r.slice(e,1<t?1-t:void 0)}function Xt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return!0}function Qt(){return!1}function Jt(e){function t(t,n,a,r,i){for(var s in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Yt:Qt,this.isPropagationStopped=Qt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt)},persist:function(){},isPersistent:Yt}),t}var Zt,$t,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Jt(tn),an=p({},tn,{view:0,detail:0}),rn=Jt(an),sn=p({},an,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Zt=e.screenX-en.screenX,$t=e.screenY-en.screenY):$t=Zt=0,en=e),Zt)},movementY:function(e){return"movementY"in e?e.movementY:$t}}),on=Jt(sn),ln=Jt(p({},sn,{dataTransfer:0})),un=Jt(p({},an,{relatedTarget:0})),cn=Jt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Jt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Jt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function yn(){return gn}var bn=Jt(p({},an,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Xt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return"keypress"===e.type?Xt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Xt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),vn=Jt(p({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),xn=Jt(p({},an,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),wn=Jt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),kn=Jt(p({},sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sn=Jt(p({},tn,{newState:0,oldState:0})),In=[9,13,27,32],Nn=Vt&&"CompositionEvent"in window,Tn=null;Vt&&"documentMode"in document&&(Tn=document.documentMode);var Cn=Vt&&"TextEvent"in window&&!Tn,En=Vt&&(!Nn||Tn&&8<Tn&&11>=Tn),_n=String.fromCharCode(32),An=!1;function Fn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function Pn(e,t,n,a){Ot?Pt?Pt.push(a):Pt=[a]:Ot=a,0<(t=ad(t,"onChange")).length&&(n=new nn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Ln=null,zn=null;function Bn(e){Yc(e,0)}function Wn(e){if(ft(Ze(e)))return e}function Vn(e,t){if("change"===e)return t}var Un=!1;if(Vt){var jn;if(Vt){var Gn="oninput"in document;if(!Gn){var Hn=document.createElement("div");Hn.setAttribute("oninput","return;"),Gn="function"===typeof Hn.oninput}jn=Gn}else jn=!1;Un=jn&&(!document.documentMode||9<document.documentMode)}function qn(){Ln&&(Ln.detachEvent("onpropertychange",Kn),zn=Ln=null)}function Kn(e){if("value"===e.propertyName&&Wn(zn)){var t=[];Pn(t,zn,e,Mt(e)),Bt(Bn,t)}}function Xn(e,t,n){"focusin"===e?(qn(),zn=n,(Ln=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&qn()}function Yn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Wn(zn)}function Qn(e,t){if("click"===e)return Wn(t)}function Jn(e,t){if("input"===e||"change"===e)return Wn(t)}var Zn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function $n(e,t){if(Zn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!ae.call(t,r)||!Zn(e[r],t[r]))return!1}return!0}function ea(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ta(e,t){var n,a=ea(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ea(a)}}function na(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?na(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function aa(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ra(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ia=Vt&&"documentMode"in document&&11>=document.documentMode,sa=null,oa=null,la=null,ua=!1;function ca(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ua||null==sa||sa!==mt(a)||("selectionStart"in(a=sa)&&ra(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},la&&$n(la,a)||(la=a,0<(a=ad(oa,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=sa)))}function da(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ha={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionrun:da("Transition","TransitionRun"),transitionstart:da("Transition","TransitionStart"),transitioncancel:da("Transition","TransitionCancel"),transitionend:da("Transition","TransitionEnd")},pa={},fa={};function ma(e){if(pa[e])return pa[e];if(!ha[e])return e;var t,n=ha[e];for(t in n)if(n.hasOwnProperty(t)&&t in fa)return pa[e]=n[t];return e}Vt&&(fa=document.createElement("div").style,"AnimationEvent"in window||(delete ha.animationend.animation,delete ha.animationiteration.animation,delete ha.animationstart.animation),"TransitionEvent"in window||delete ha.transitionend.transition);var ga=ma("animationend"),ya=ma("animationiteration"),ba=ma("animationstart"),va=ma("transitionrun"),xa=ma("transitionstart"),wa=ma("transitioncancel"),ka=ma("transitionend"),Sa=new Map,Ia="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Na(e,t){Sa.set(e,t),at(t,[e])}Ia.push("scrollEnd");var Ta="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ca=[],Ea=0,_a=0;function Aa(){for(var e=Ea,t=_a=Ea=0;t<e;){var n=Ca[t];Ca[t++]=null;var a=Ca[t];Ca[t++]=null;var r=Ca[t];Ca[t++]=null;var i=Ca[t];if(Ca[t++]=null,null!==a&&null!==r){var s=a.pending;null===s?r.next=r:(r.next=s.next,s.next=r),a.pending=r}0!==i&&Ma(n,r,i)}}function Fa(e,t,n,a){Ca[Ea++]=e,Ca[Ea++]=t,Ca[Ea++]=n,Ca[Ea++]=a,_a|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Ra(e,t,n,a){return Fa(e,t,n,a),Oa(e)}function Da(e,t){return Fa(e,null,null,t),Oa(e)}function Ma(e,t,n){e.lanes|=n;var a=e.alternate;null!==a&&(a.lanes|=n);for(var r=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(a=i.alternate)&&(a.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(r=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,r&&null!==t&&(r=31-xe(n),null===(a=(e=i.hiddenUpdates)[r])?e[r]=[t]:a.push(t),t.lane=536870912|n),i):null}function Oa(e){if(50<Gu)throw Gu=0,Hu=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Pa={};function La(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function za(e,t,n,a){return new La(e,t,n,a)}function Ba(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Wa(e,t){var n=e.alternate;return null===n?((n=za(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Va(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ua(e,t,n,a,r,i){var o=0;if(a=e,"function"===typeof e)Ba(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=za(31,n,t,r)).elementType=C,e.lanes=i,e;case y:return ja(n.children,r,i,t);case b:o=8,r|=24;break;case v:return(e=za(12,n,t,2|r)).elementType=v,e.lanes=i,e;case S:return(e=za(13,n,t,r)).elementType=S,e.lanes=i,e;case I:return(e=za(19,n,t,r)).elementType=I,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case x:o=9;break e;case k:o=11;break e;case N:o=14;break e;case T:o=16,a=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),a=null}return(t=za(o,n,t,r)).elementType=e,t.type=a,t.lanes=i,t}function ja(e,t,n,a){return(e=za(7,e,a,t)).lanes=n,e}function Ga(e,t,n){return(e=za(6,e,null,t)).lanes=n,e}function Ha(e){var t=za(18,null,null,0);return t.stateNode=e,t}function qa(e,t,n){return(t=za(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ka=new WeakMap;function Xa(e,t){if("object"===typeof e&&null!==e){var n=Ka.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Ka.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Ya=[],Qa=0,Ja=null,Za=0,$a=[],er=0,tr=null,nr=1,ar="";function rr(e,t){Ya[Qa++]=Za,Ya[Qa++]=Ja,Ja=e,Za=t}function ir(e,t,n){$a[er++]=nr,$a[er++]=ar,$a[er++]=tr,tr=e;var a=nr;e=ar;var r=32-xe(a)-1;a&=~(1<<r),n+=1;var i=32-xe(t)+r;if(30<i){var s=r-r%5;i=(a&(1<<s)-1).toString(32),a>>=s,r-=s,nr=1<<32-xe(t)+r|n<<r|a,ar=i+e}else nr=1<<i|n<<r|a,ar=e}function sr(e){null!==e.return&&(rr(e,1),ir(e,1,0))}function or(e){for(;e===Ja;)Ja=Ya[--Qa],Ya[Qa]=null,Za=Ya[--Qa],Ya[Qa]=null;for(;e===tr;)tr=$a[--er],$a[er]=null,ar=$a[--er],$a[er]=null,nr=$a[--er],$a[er]=null}function lr(e,t){$a[er++]=nr,$a[er++]=ar,$a[er++]=tr,nr=t.id,ar=t.overflow,tr=e}var ur=null,cr=null,dr=!1,hr=null,pr=!1,fr=Error(s(519));function mr(e){throw wr(Xa(Error(s(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fr}function gr(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[Ve]=e,t[Ue]=a,n){case"dialog":Qc("cancel",t),Qc("close",t);break;case"iframe":case"object":case"embed":Qc("load",t);break;case"video":case"audio":for(n=0;n<Kc.length;n++)Qc(Kc[n],t);break;case"source":Qc("error",t);break;case"img":case"image":case"link":Qc("error",t),Qc("load",t);break;case"details":Qc("toggle",t);break;case"input":Qc("invalid",t),vt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":Qc("invalid",t);break;case"textarea":Qc("invalid",t),St(t,a.value,a.defaultValue,a.children)}"string"!==typeof(n=a.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===a.suppressHydrationWarning||ud(t.textContent,n)?(null!=a.popover&&(Qc("beforetoggle",t),Qc("toggle",t)),null!=a.onScroll&&Qc("scroll",t),null!=a.onScrollEnd&&Qc("scrollend",t),null!=a.onClick&&(t.onclick=Rt),t=!0):t=!1,t||mr(e,!0)}function yr(e){for(ur=e.return;ur;)switch(ur.tag){case 5:case 31:case 13:return void(pr=!1);case 27:case 3:return void(pr=!0);default:ur=ur.return}}function br(e){if(e!==ur)return!1;if(!dr)return yr(e),dr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||vd(e.type,e.memoizedProps)),t=!t),t&&cr&&mr(e),yr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));cr=Od(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));cr=Od(e)}else 27===n?(n=cr,Td(e.type)?(e=Md,Md=null,cr=e):cr=n):cr=ur?Dd(e.stateNode.nextSibling):null;return!0}function vr(){cr=ur=null,dr=!1}function xr(){var e=hr;return null!==e&&(null===Au?Au=e:Au.push.apply(Au,e),hr=null),e}function wr(e){null===hr?hr=[e]:hr.push(e)}var kr=B(null),Sr=null,Ir=null;function Nr(e,t,n){V(kr,t._currentValue),t._currentValue=n}function Tr(e){e._currentValue=kr.current,W(kr)}function Cr(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Er(e,t,n,a){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var i=r.dependencies;if(null!==i){var o=r.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=r;for(var u=0;u<t.length;u++)if(l.context===t[u]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Cr(i.return,n,e),a||(o=null);break e}i=l.next}}else if(18===r.tag){if(null===(o=r.return))throw Error(s(341));o.lanes|=n,null!==(i=o.alternate)&&(i.lanes|=n),Cr(o,n,e),o=null}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}}function _r(e,t,n,a){e=null;for(var r=t,i=!1;null!==r;){if(!i)if(0!==(524288&r.flags))i=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var o=r.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=r.type;Zn(r.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(r===K.current){if(null===(o=r.alternate))throw Error(s(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(ch):e=[ch])}r=r.return}null!==e&&Er(t,e,n,a),t.flags|=262144}function Ar(e){for(e=e.firstContext;null!==e;){if(!Zn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Fr(e){Sr=e,Ir=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Rr(e){return Mr(Sr,e)}function Dr(e,t){return null===Sr&&Fr(e),Mr(e,t)}function Mr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ir){if(null===e)throw Error(s(308));Ir=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ir=Ir.next=t;return n}var Or="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Pr=a.unstable_scheduleCallback,Lr=a.unstable_NormalPriority,zr={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Br(){return{controller:new Or,data:new Map,refCount:0}}function Wr(e){e.refCount--,0===e.refCount&&Pr(Lr,function(){e.controller.abort()})}var Vr=null,Ur=0,jr=0,Gr=null;function Hr(){if(0===--Ur&&null!==Vr){null!==Gr&&(Gr.status="fulfilled");var e=Vr;Vr=null,jr=0,Gr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qr=M.S;M.S=function(e,t){Du=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Vr){var n=Vr=[];Ur=0,jr=Uc(),Gr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ur++,t.then(Hr,Hr)}(0,t),null!==qr&&qr(e,t)};var Kr=B(null);function Xr(){var e=Kr.current;return null!==e?e:fu.pooledCache}function Yr(e,t){V(Kr,null===t?Kr.current:t.pool)}function Qr(){var e=Xr();return null===e?null:{parent:zr._currentValue,pool:e}}var Jr=Error(s(460)),Zr=Error(s(474)),$r=Error(s(542)),ei={then:function(){}};function ti(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ni(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Rt,Rt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e;default:if("string"===typeof t.status)t.then(Rt,Rt);else{if(null!==(e=fu)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e}throw ri=t,Jr}}function ai(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ri=t,Jr;throw t}}var ri=null;function ii(){if(null===ri)throw Error(s(459));var e=ri;return ri=null,e}function si(e){if(e===Jr||e===$r)throw Error(s(483))}var oi=null,li=0;function ui(e){var t=li;return li+=1,null===oi&&(oi=[]),ni(oi,e,t)}function ci(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function di(e,t){if(t.$$typeof===f)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hi(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Wa(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=67108866,n):a:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Ga(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function u(e,t,n,a){var i=n.type;return i===y?d(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===T&&ai(i)===t.type)?(ci(t=r(t,n.props),n),t.return=e,t):(ci(t=Ua(n.type,n.key,n.props,null,e.mode,a),n),t.return=e,t)}function c(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qa(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,a,i){return null===t||7!==t.tag?((t=ja(n,e.mode,a,i)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ga(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return ci(n=Ua(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=qa(t,e.mode,n)).return=e,t;case T:return h(e,t=ai(t),n)}if(D(t)||A(t))return(t=ja(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,ui(t),n);if(t.$$typeof===w)return h(e,Dr(e,t),n);di(e,t)}return null}function p(e,t,n,a){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===r?u(e,t,n,a):null;case g:return n.key===r?c(e,t,n,a):null;case T:return p(e,t,n=ai(n),a)}if(D(n)||A(n))return null!==r?null:d(e,t,n,a,null);if("function"===typeof n.then)return p(e,t,ui(n),a);if(n.$$typeof===w)return p(e,t,Dr(e,n),a);di(e,n)}return null}function f(e,t,n,a,r){if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return l(t,e=e.get(n)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case m:return u(t,e=e.get(null===a.key?n:a.key)||null,a,r);case g:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case T:return f(e,t,n,a=ai(a),r)}if(D(a)||A(a))return d(t,e=e.get(n)||null,a,r,null);if("function"===typeof a.then)return f(e,t,n,ui(a),r);if(a.$$typeof===w)return f(e,t,n,Dr(t,a),r);di(t,a)}return null}function b(l,u,c,d){if("object"===typeof c&&null!==c&&c.type===y&&null===c.key&&(c=c.props.children),"object"===typeof c&&null!==c){switch(c.$$typeof){case m:e:{for(var v=c.key;null!==u;){if(u.key===v){if((v=c.type)===y){if(7===u.tag){n(l,u.sibling),(d=r(u,c.props.children)).return=l,l=d;break e}}else if(u.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===T&&ai(v)===u.type){n(l,u.sibling),ci(d=r(u,c.props),c),d.return=l,l=d;break e}n(l,u);break}t(l,u),u=u.sibling}c.type===y?((d=ja(c.props.children,l.mode,d,c.key)).return=l,l=d):(ci(d=Ua(c.type,c.key,c.props,null,l.mode,d),c),d.return=l,l=d)}return o(l);case g:e:{for(v=c.key;null!==u;){if(u.key===v){if(4===u.tag&&u.stateNode.containerInfo===c.containerInfo&&u.stateNode.implementation===c.implementation){n(l,u.sibling),(d=r(u,c.children||[])).return=l,l=d;break e}n(l,u);break}t(l,u),u=u.sibling}(d=qa(c,l.mode,d)).return=l,l=d}return o(l);case T:return b(l,u,c=ai(c),d)}if(D(c))return function(r,s,o,l){for(var u=null,c=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(r,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(r,d),s=i(y,s,m),null===c?u=y:c.sibling=y,c=y,d=g}if(m===o.length)return n(r,d),dr&&rr(r,m),u;if(null===d){for(;m<o.length;m++)null!==(d=h(r,o[m],l))&&(s=i(d,s,m),null===c?u=d:c.sibling=d,c=d);return dr&&rr(r,m),u}for(d=a(d);m<o.length;m++)null!==(g=f(d,r,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=i(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach(function(e){return t(r,e)}),dr&&rr(r,m),u}(l,u,c,d);if(A(c)){if("function"!==typeof(v=A(c)))throw Error(s(150));return function(r,o,l,u){if(null==l)throw Error(s(151));for(var c=null,d=null,m=o,g=o=0,y=null,b=l.next();null!==m&&!b.done;g++,b=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var v=p(r,m,b.value,u);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&t(r,m),o=i(v,o,g),null===d?c=v:d.sibling=v,d=v,m=y}if(b.done)return n(r,m),dr&&rr(r,g),c;if(null===m){for(;!b.done;g++,b=l.next())null!==(b=h(r,b.value,u))&&(o=i(b,o,g),null===d?c=b:d.sibling=b,d=b);return dr&&rr(r,g),c}for(m=a(m);!b.done;g++,b=l.next())null!==(b=f(m,r,g,b.value,u))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),o=i(b,o,g),null===d?c=b:d.sibling=b,d=b);return e&&m.forEach(function(e){return t(r,e)}),dr&&rr(r,g),c}(l,u,c=v.call(c),d)}if("function"===typeof c.then)return b(l,u,ui(c),d);if(c.$$typeof===w)return b(l,u,Dr(l,c),d);di(l,c)}return"string"===typeof c&&""!==c||"number"===typeof c||"bigint"===typeof c?(c=""+c,null!==u&&6===u.tag?(n(l,u.sibling),(d=r(u,c)).return=l,l=d):(n(l,u),(d=Ga(c,l.mode,d)).return=l,l=d),o(l)):n(l,u)}return function(e,t,n,a){try{li=0;var r=b(e,t,n,a);return oi=null,r}catch(s){if(s===Jr||s===$r)throw s;var i=za(29,s,null,e.mode);return i.lanes=a,i.return=e,i}}}var pi=hi(!0),fi=hi(!1),mi=!1;function gi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function vi(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&pu)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=Oa(e),Ma(e,null,n),t}return Fa(e,a,t,n),Oa(e)}function xi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Me(e,n)}}function wi(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?r=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?r=i=t:i=i.next=t}else r=i=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ki=!1;function Si(){if(ki){if(null!==Gr)throw Gr}}function Ii(e,t,n,a){ki=!1;var r=e.updateQueue;mi=!1;var i=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,u=l.next;l.next=null,null===s?i=u:s.next=u,s=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==i){var d=r.baseState;for(s=0,c=u=l=null,o=i;;){var h=-536870913&o.lane,f=h!==o.lane;if(f?(gu&h)===h:(a&h)===h){0!==h&&h===jr&&(ki=!0),null!==c&&(c=c.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;h=t;var y=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(y,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=g.payload)?m.call(y,d,h):m)||void 0===h)break e;d=p({},d,h);break e;case 2:mi=!0}}null!==(h=o.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[h]:f.push(h))}else f={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=f,l=d):c=c.next=f,s|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(f=o).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===c&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null===i&&(r.shared.lanes=0),Iu|=s,e.lanes=s,e.memoizedState=d}}function Ni(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function Ti(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ni(n[e],t)}var Ci=B(null),Ei=B(0);function _i(e,t){V(Ei,e=ku),V(Ci,t),ku=e|t.baseLanes}function Ai(){V(Ei,ku),V(Ci,Ci.current)}function Fi(){ku=Ei.current,W(Ci),W(Ei)}var Ri=B(null),Di=null;function Mi(e){var t=e.alternate;V(Bi,1&Bi.current),V(Ri,e),null===Di&&(null===t||null!==Ci.current||null!==t.memoizedState)&&(Di=e)}function Oi(e){V(Bi,Bi.current),V(Ri,e),null===Di&&(Di=e)}function Pi(e){22===e.tag?(V(Bi,Bi.current),V(Ri,e),null===Di&&(Di=e)):Li()}function Li(){V(Bi,Bi.current),V(Ri,Ri.current)}function zi(e){W(Ri),Di===e&&(Di=null),W(Bi)}var Bi=B(0);function Wi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Fd(n)||Rd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vi=0,Ui=null,ji=null,Gi=null,Hi=!1,qi=!1,Ki=!1,Xi=0,Yi=0,Qi=null,Ji=0;function Zi(){throw Error(s(321))}function $i(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function es(e,t,n,a,r,i){return Vi=i,Ui=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?go:yo,Ki=!1,i=n(a,r),Ki=!1,qi&&(i=ns(t,n,a,r)),ts(e),i}function ts(e){M.H=mo;var t=null!==ji&&null!==ji.next;if(Vi=0,Gi=ji=Ui=null,Hi=!1,Yi=0,Qi=null,t)throw Error(s(300));null===e||Do||null!==(e=e.dependencies)&&Ar(e)&&(Do=!0)}function ns(e,t,n,a){Ui=e;var r=0;do{if(qi&&(Qi=null),Yi=0,qi=!1,25<=r)throw Error(s(301));if(r+=1,Gi=ji=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}M.H=bo,i=t(n,a)}while(qi);return i}function as(){var e=M.H,t=e.useState()[0];return t="function"===typeof t.then?us(t):t,e=e.useState()[0],(null!==ji?ji.memoizedState:null)!==e&&(Ui.flags|=1024),t}function rs(){var e=0!==Xi;return Xi=0,e}function is(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ss(e){if(Hi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Hi=!1}Vi=0,Gi=ji=Ui=null,qi=!1,Yi=Xi=0,Qi=null}function os(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Gi?Ui.memoizedState=Gi=e:Gi=Gi.next=e,Gi}function ls(){if(null===ji){var e=Ui.alternate;e=null!==e?e.memoizedState:null}else e=ji.next;var t=null===Gi?Ui.memoizedState:Gi.next;if(null!==t)Gi=t,ji=e;else{if(null===e){if(null===Ui.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(ji=e).memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},null===Gi?Ui.memoizedState=Gi=e:Gi=Gi.next=e}return Gi}function us(e){var t=Yi;return Yi+=1,null===Qi&&(Qi=[]),e=ni(Qi,e,t),t=Ui,null===(null===Gi?t.memoizedState:Gi.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?go:yo),e}function cs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return us(e);if(e.$$typeof===w)return Rr(e)}throw Error(s(438,String(e)))}function ds(e){var t=null,n=Ui.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var a=Ui.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ui.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=E;return t.index++,n}function hs(e,t){return"function"===typeof t?t(e):t}function ps(e){return fs(ls(),ji,e)}function fs(e,t,n){var a=e.queue;if(null===a)throw Error(s(311));a.lastRenderedReducer=n;var r=e.baseQueue,i=a.pending;if(null!==i){if(null!==r){var o=r.next;r.next=i.next,i.next=o}t.baseQueue=r=i,a.pending=null}if(i=e.baseState,null===r)e.memoizedState=i;else{var l=o=null,u=null,c=t=r.next,d=!1;do{var h=-536870913&c.lane;if(h!==c.lane?(gu&h)===h:(Vi&h)===h){var p=c.revertLane;if(0===p)null!==u&&(u=u.next={lane:0,revertLane:0,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===jr&&(d=!0);else{if((Vi&p)===p){c=c.next,p===jr&&(d=!0);continue}h={lane:0,revertLane:c.revertLane,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=h,o=i):u=u.next=h,Ui.lanes|=p,Iu|=p}h=c.action,Ki&&n(i,h),i=c.hasEagerState?c.eagerState:n(i,h)}else p={lane:h,revertLane:c.revertLane,gesture:c.gesture,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=p,o=i):u=u.next=p,Ui.lanes|=h,Iu|=h;c=c.next}while(null!==c&&c!==t);if(null===u?o=i:u.next=l,!Zn(i,e.memoizedState)&&(Do=!0,d&&null!==(n=Gr)))throw n;e.memoizedState=i,e.baseState=o,e.baseQueue=u,a.lastRenderedState=i}return null===r&&(a.lanes=0),[e.memoizedState,a.dispatch]}function ms(e){var t=ls(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{i=e(i,o.action),o=o.next}while(o!==r);Zn(i,t.memoizedState)||(Do=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function gs(e,t,n){var a=Ui,r=ls(),i=dr;if(i){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Zn((ji||r).memoizedState,n);if(o&&(r.memoizedState=n,Do=!0),r=r.queue,Vs(vs.bind(null,a,r,e),[e]),r.getSnapshot!==t||o||null!==Gi&&1&Gi.memoizedState.tag){if(a.flags|=2048,Ps(9,{destroy:void 0},bs.bind(null,a,r,n,t),null),null===fu)throw Error(s(349));i||0!==(127&Vi)||ys(a,t,n)}return n}function ys(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ui.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ui.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function bs(e,t,n,a){t.value=n,t.getSnapshot=a,xs(t)&&ws(e)}function vs(e,t,n){return n(function(){xs(t)&&ws(e)})}function xs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch(a){return!0}}function ws(e){var t=Da(e,2);null!==t&&Xu(t,e,2)}function ks(e){var t=os();if("function"===typeof e){var n=e;if(e=n(),Ki){ve(!0);try{n()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:e},t}function Ss(e,t,n,a){return e.baseState=n,fs(e,ji,"function"===typeof a?a:hs)}function Is(e,t,n,a,r){if(ho(e))throw Error(s(485));if(null!==(e=t.action)){var i={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==M.T?n(!0):i.isTransition=!1,a(i),null===(n=t.pending)?(i.next=t.pending=i,Ns(t,i)):(i.next=n.next,t.pending=n.next=i)}}function Ns(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var i=M.T,s={};M.T=s;try{var o=n(r,a),l=M.S;null!==l&&l(s,o),Ts(e,t,o)}catch(u){Es(e,t,u)}finally{null!==i&&null!==s.types&&(i.types=s.types),M.T=i}}else try{Ts(e,t,i=n(r,a))}catch(c){Es(e,t,c)}}function Ts(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Cs(e,t,n)},function(n){return Es(e,t,n)}):Cs(e,t,n)}function Cs(e,t,n){t.status="fulfilled",t.value=n,_s(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ns(e,n)))}function Es(e,t,n){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=n,_s(t),t=t.next}while(t!==a)}e.action=null}function _s(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function As(e,t){return t}function Fs(e,t){if(dr){var n=fu.formState;if(null!==n){e:{var a=Ui;if(dr){if(cr){t:{for(var r=cr,i=pr;8!==r.nodeType;){if(!i){r=null;break t}if(null===(r=Dd(r.nextSibling))){r=null;break t}}r="F!"===(i=r.data)||"F"===i?r:null}if(r){cr=Dd(r.nextSibling),a="F!"===r.data;break e}}mr(a)}a=!1}a&&(t=n[0])}}return(n=os()).memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:As,lastRenderedState:t},n.queue=a,n=lo.bind(null,Ui,a),a.dispatch=n,a=ks(!1),i=co.bind(null,Ui,!1,a.queue),r={state:t,dispatch:null,action:e,pending:null},(a=os()).queue=r,n=Is.bind(null,Ui,r,i,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function Rs(e){return Ds(ls(),ji,e)}function Ds(e,t,n){if(t=fs(e,t,As)[0],e=ps(hs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var a=us(t)}catch(s){if(s===Jr)throw $r;throw s}else a=t;var r=(t=ls()).queue,i=r.dispatch;return n!==t.memoizedState&&(Ui.flags|=2048,Ps(9,{destroy:void 0},Ms.bind(null,r,n),null)),[a,i,e]}function Ms(e,t){e.action=t}function Os(e){var t=ls(),n=ji;if(null!==n)return Ds(t,n,e);ls(),t=t.memoizedState;var a=(n=ls()).queue.dispatch;return n.memoizedState=e,[t,a,!1]}function Ps(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},null===(t=Ui.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ui.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Ls(){return ls().memoizedState}function zs(e,t,n,a){var r=os();Ui.flags|=e,r.memoizedState=Ps(1|t,{destroy:void 0},n,void 0===a?null:a)}function Bs(e,t,n,a){var r=ls();a=void 0===a?null:a;var i=r.memoizedState.inst;null!==ji&&null!==a&&$i(a,ji.memoizedState.deps)?r.memoizedState=Ps(t,i,n,a):(Ui.flags|=e,r.memoizedState=Ps(1|t,i,n,a))}function Ws(e,t){zs(8390656,8,e,t)}function Vs(e,t){Bs(2048,8,e,t)}function Us(e){var t=ls().memoizedState;return function(e){Ui.flags|=4;var t=Ui.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ui.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pu))throw Error(s(440));return t.impl.apply(void 0,arguments)}}function js(e,t){return Bs(4,2,e,t)}function Gs(e,t){return Bs(4,4,e,t)}function Hs(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function qs(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Bs(4,4,Hs.bind(null,t,e),n)}function Ks(){}function Xs(e,t){var n=ls();t=void 0===t?null:t;var a=n.memoizedState;return null!==t&&$i(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Ys(e,t){var n=ls();t=void 0===t?null:t;var a=n.memoizedState;if(null!==t&&$i(t,a[1]))return a[0];if(a=e(),Ki){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[a,t],a}function Qs(e,t,n){return void 0===n||0!==(1073741824&Vi)&&0===(261930&gu)?e.memoizedState=t:(e.memoizedState=n,e=Ku(),Ui.lanes|=e,Iu|=e,n)}function Js(e,t,n,a){return Zn(n,t)?n:null!==Ci.current?(e=Qs(e,n,a),Zn(e,t)||(Do=!0),e):0===(42&Vi)||0!==(1073741824&Vi)&&0===(261930&gu)?(Do=!0,e.memoizedState=n):(e=Ku(),Ui.lanes|=e,Iu|=e,t)}function Zs(e,t,n,a,r){var i=O.p;O.p=0!==i&&8>i?i:8;var s=M.T,o={};M.T=o,co(e,!1,t,n);try{var l=r(),u=M.S;if(null!==u&&u(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)uo(e,t,function(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(a.status="rejected",a.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),a}(l,a),qu());else uo(e,t,a,qu())}catch(c){uo(e,t,{then:function(){},status:"rejected",reason:c},qu())}finally{O.p=i,null!==s&&null!==o.types&&(s.types=o.types),M.T=s}}function $s(){}function eo(e,t,n,a){if(5!==e.tag)throw Error(s(476));var r=to(e).queue;Zs(e,r,t,P,null===n?$s:function(){return no(e),n(a)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:P,baseState:P,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:P},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function no(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),uo(e,t.next.queue,{},qu())}function ao(){return Rr(ch)}function ro(){return ls().memoizedState}function io(){return ls().memoizedState}function so(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=qu(),a=vi(t,e=bi(n),n);return null!==a&&(Xu(a,t,n),xi(a,t,n)),t={cache:Br()},void(e.payload=t)}t=t.return}}function oo(e,t,n){var a=qu();n={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ho(e)?po(t,n):null!==(n=Ra(e,t,n,a))&&(Xu(n,e,a),fo(n,t,a))}function lo(e,t,n){uo(e,t,n,qu())}function uo(e,t,n,a){var r={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ho(e))po(t,r);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(r.hasEagerState=!0,r.eagerState=o,Zn(o,s))return Fa(e,t,r,0),null===fu&&Aa(),!1}catch(l){}if(null!==(n=Ra(e,t,r,a)))return Xu(n,e,a),fo(n,t,a),!0}return!1}function co(e,t,n,a){if(a={lane:2,revertLane:Uc(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},ho(e)){if(t)throw Error(s(479))}else null!==(t=Ra(e,n,a,2))&&Xu(t,e,2)}function ho(e){var t=e.alternate;return e===Ui||null!==t&&t===Ui}function po(e,t){qi=Hi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fo(e,t,n){if(0!==(4194048&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Me(e,n)}}var mo={readContext:Rr,use:cs,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useLayoutEffect:Zi,useInsertionEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useSyncExternalStore:Zi,useId:Zi,useHostTransitionStatus:Zi,useFormState:Zi,useActionState:Zi,useOptimistic:Zi,useMemoCache:Zi,useCacheRefresh:Zi};mo.useEffectEvent=Zi;var go={readContext:Rr,use:cs,useCallback:function(e,t){return os().memoizedState=[e,void 0===t?null:t],e},useContext:Rr,useEffect:Ws,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,Hs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){zs(4,2,e,t)},useMemo:function(e,t){var n=os();t=void 0===t?null:t;var a=e();if(Ki){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=os();if(void 0!==n){var r=n(t);if(Ki){ve(!0);try{n(t)}finally{ve(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=oo.bind(null,Ui,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},os().memoizedState=e},useState:function(e){var t=(e=ks(e)).queue,n=lo.bind(null,Ui,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ks,useDeferredValue:function(e,t){return Qs(os(),e,t)},useTransition:function(){var e=ks(!1);return e=Zs.bind(null,Ui,e.queue,!0,!1),os().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Ui,r=os();if(dr){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===fu)throw Error(s(349));0!==(127&gu)||ys(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Ws(vs.bind(null,a,i,e),[e]),a.flags|=2048,Ps(9,{destroy:void 0},bs.bind(null,a,i,n,t),null),n},useId:function(){var e=os(),t=fu.identifierPrefix;if(dr){var n=ar;t="_"+t+"R_"+(n=(nr&~(1<<32-xe(nr)-1)).toString(32)+n),0<(n=Xi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Ji++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ao,useFormState:Fs,useActionState:Fs,useOptimistic:function(e){var t=os();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=co.bind(null,Ui,!0,n),n.dispatch=t,[e,t]},useMemoCache:ds,useCacheRefresh:function(){return os().memoizedState=so.bind(null,Ui)},useEffectEvent:function(e){var t=os(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pu))throw Error(s(440));return n.impl.apply(void 0,arguments)}}},yo={readContext:Rr,use:cs,useCallback:Xs,useContext:Rr,useEffect:Vs,useImperativeHandle:qs,useInsertionEffect:js,useLayoutEffect:Gs,useMemo:Ys,useReducer:ps,useRef:Ls,useState:function(){return ps(hs)},useDebugValue:Ks,useDeferredValue:function(e,t){return Js(ls(),ji.memoizedState,e,t)},useTransition:function(){var e=ps(hs)[0],t=ls().memoizedState;return["boolean"===typeof e?e:us(e),t]},useSyncExternalStore:gs,useId:ro,useHostTransitionStatus:ao,useFormState:Rs,useActionState:Rs,useOptimistic:function(e,t){return Ss(ls(),0,e,t)},useMemoCache:ds,useCacheRefresh:io};yo.useEffectEvent=Us;var bo={readContext:Rr,use:cs,useCallback:Xs,useContext:Rr,useEffect:Vs,useImperativeHandle:qs,useInsertionEffect:js,useLayoutEffect:Gs,useMemo:Ys,useReducer:ms,useRef:Ls,useState:function(){return ms(hs)},useDebugValue:Ks,useDeferredValue:function(e,t){var n=ls();return null===ji?Qs(n,e,t):Js(n,ji.memoizedState,e,t)},useTransition:function(){var e=ms(hs)[0],t=ls().memoizedState;return["boolean"===typeof e?e:us(e),t]},useSyncExternalStore:gs,useId:ro,useHostTransitionStatus:ao,useFormState:Os,useActionState:Os,useOptimistic:function(e,t){var n=ls();return null!==ji?Ss(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ds,useCacheRefresh:io};function vo(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}bo.useEffectEvent=Us;var xo={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=qu(),r=bi(a);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=vi(e,r,a))&&(Xu(t,e,a),xi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=qu(),r=bi(a);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=vi(e,r,a))&&(Xu(t,e,a),xi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=qu(),a=bi(n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=vi(e,a,n))&&(Xu(t,e,n),xi(t,e,n))}};function wo(e,t,n,a,r,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!$n(n,a)||!$n(r,i))}function ko(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&xo.enqueueReplaceState(t,t.state,null)}function So(e,t){var n=t;if("ref"in t)for(var a in n={},t)"ref"!==a&&(n[a]=t[a]);if(e=e.defaultProps)for(var r in n===t&&(n=p({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Io(e){Ta(e)}function No(e){console.error(e)}function To(e){Ta(e)}function Co(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Eo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function _o(e,t,n){return(n=bi(n)).tag=3,n.payload={element:null},n.callback=function(){Co(e,t)},n}function Ao(e){return(e=bi(e)).tag=3,e}function Fo(e,t,n,a){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var i=a.value;e.payload=function(){return r(i)},e.callback=function(){Eo(t,n,a)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Eo(t,n,a),"function"!==typeof r&&(null===Pu?Pu=new Set([this]):Pu.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var Ro=Error(s(461)),Do=!1;function Mo(e,t,n,a){t.child=null===e?fi(t,null,n,a):pi(t,e.child,n,a)}function Oo(e,t,n,a,r){n=n.render;var i=t.ref;if("ref"in a){var s={};for(var o in a)"ref"!==o&&(s[o]=a[o])}else s=a;return Fr(t),a=es(e,t,n,s,i,r),o=rs(),null===e||Do?(dr&&o&&sr(t),t.flags|=1,Mo(e,t,a,r),t.child):(is(e,t,r),rl(e,t,r))}function Po(e,t,n,a,r){if(null===e){var i=n.type;return"function"!==typeof i||Ba(i)||void 0!==i.defaultProps||null!==n.compare?((e=Ua(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Lo(e,t,i,a,r))}if(i=e.child,!il(e,r)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:$n)(s,a)&&e.ref===t.ref)return rl(e,t,r)}return t.flags|=1,(e=Wa(i,a)).ref=t.ref,e.return=t,t.child=e}function Lo(e,t,n,a,r){if(null!==e){var i=e.memoizedProps;if($n(i,a)&&e.ref===t.ref){if(Do=!1,t.pendingProps=a=i,!il(e,r))return t.lanes=e.lanes,rl(e,t,r);0!==(131072&e.flags)&&(Do=!0)}}return Go(e,t,n,a,r)}function zo(e,t,n,a){var r=a.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===a.mode){if(0!==(128&t.flags)){if(i=null!==i?i.baseLanes|n:n,null!==e){for(a=t.child=e.child,r=0;null!==a;)r=r|a.lanes|a.childLanes,a=a.sibling;a=r&~i}else a=0,t.child=null;return Wo(e,t,i,n,a)}if(0===(536870912&n))return a=t.lanes=536870912,Wo(e,t,null!==i?i.baseLanes|n:n,n,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Yr(0,null!==i?i.cachePool:null),null!==i?_i(t,i):Ai(),Pi(t)}else null!==i?(Yr(0,i.cachePool),_i(t,i),Li(),t.memoizedState=null):(null!==e&&Yr(0,null),Ai(),Li());return Mo(e,t,r,n),t.child}function Bo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Wo(e,t,n,a,r){var i=Xr();return i=null===i?null:{parent:zr._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Yr(0,null),Ai(),Pi(t),null!==e&&_r(e,t,a,!0),t.childLanes=r,null}function Vo(e,t){return(t=$o({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Uo(e,t,n){return pi(t,e.child,null,n),(e=Vo(t,t.pendingProps)).flags|=2,zi(t),t.memoizedState=null,e}function jo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Go(e,t,n,a,r){return Fr(t),n=es(e,t,n,a,void 0,r),a=rs(),null===e||Do?(dr&&a&&sr(t),t.flags|=1,Mo(e,t,n,r),t.child):(is(e,t,r),rl(e,t,r))}function Ho(e,t,n,a,r,i){return Fr(t),t.updateQueue=null,n=ns(t,a,n,r),ts(e),a=rs(),null===e||Do?(dr&&a&&sr(t),t.flags|=1,Mo(e,t,n,i),t.child):(is(e,t,i),rl(e,t,i))}function qo(e,t,n,a,r){if(Fr(t),null===t.stateNode){var i=Pa,s=n.contextType;"object"===typeof s&&null!==s&&(i=Rr(s)),i=new n(a,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=xo,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=a,i.state=t.memoizedState,i.refs={},gi(t),s=n.contextType,i.context="object"===typeof s&&null!==s?Rr(s):Pa,i.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(vo(t,n,s,a),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(s=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&xo.enqueueReplaceState(i,i.state,null),Ii(t,a,i,r),Si(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){i=t.stateNode;var o=t.memoizedProps,l=So(n,o);i.props=l;var u=i.context,c=n.contextType;s=Pa,"object"===typeof c&&null!==c&&(s=Rr(c));var d=n.getDerivedStateFromProps;c="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate,o=t.pendingProps!==o,c||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o||u!==s)&&ko(t,i,a,s),mi=!1;var h=t.memoizedState;i.state=h,Ii(t,a,i,r),Si(),u=t.memoizedState,o||h!==u||mi?("function"===typeof d&&(vo(t,n,d,a),u=t.memoizedState),(l=mi||wo(t,n,l,a,h,u,s))?(c||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=u),i.props=a,i.state=u,i.context=s,a=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,yi(e,t),c=So(n,s=t.memoizedProps),i.props=c,d=t.pendingProps,h=i.context,u=n.contextType,l=Pa,"object"===typeof u&&null!==u&&(l=Rr(u)),(u="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||h!==l)&&ko(t,i,a,l),mi=!1,h=t.memoizedState,i.state=h,Ii(t,a,i,r),Si();var p=t.memoizedState;s!==d||h!==p||mi||null!==e&&null!==e.dependencies&&Ar(e.dependencies)?("function"===typeof o&&(vo(t,n,o,a),p=t.memoizedState),(c=mi||wo(t,n,c,a,h,p,l)||null!==e&&null!==e.dependencies&&Ar(e.dependencies))?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,p,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,p,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=p),i.props=a,i.state=p,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return i=a,jo(e,t),a=0!==(128&t.flags),i||a?(i=t.stateNode,n=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&a?(t.child=pi(t,e.child,null,r),t.child=pi(t,null,n,r)):Mo(e,t,n,r),t.memoizedState=i.state,e=t.child):e=rl(e,t,r),e}function Ko(e,t,n,a){return vr(),t.flags|=256,Mo(e,t,n,a),t.child}var Xo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yo(e){return{baseLanes:e,cachePool:Qr()}}function Qo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Cu),e}function Jo(e,t,n){var a,r=t.pendingProps,i=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&Bi.current)),a&&(i=!0,t.flags&=-129),a=0!==(32&t.flags),t.flags&=-33,null===e){if(dr){if(i?Mi(t):Li(),(e=cr)?null!==(e=null!==(e=Ad(e,pr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ar}:null,retryLane:536870912,hydrationErrors:null},(n=Ha(e)).return=t,t.child=n,ur=t,cr=null):e=null,null===e)throw mr(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var l=r.children;return r=r.fallback,i?(Li(),l=$o({mode:"hidden",children:l},i=t.mode),r=ja(r,i,n,null),l.return=t,r.return=t,l.sibling=r,t.child=l,(r=t.child).memoizedState=Yo(n),r.childLanes=Qo(e,a,n),t.memoizedState=Xo,Bo(null,r)):(Mi(t),Zo(t,l))}var u=e.memoizedState;if(null!==u&&null!==(l=u.dehydrated)){if(o)256&t.flags?(Mi(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Li(),t.child=e.child,t.flags|=128,t=null):(Li(),l=r.fallback,i=t.mode,r=$o({mode:"visible",children:r.children},i),(l=ja(l,i,n,null)).flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,pi(t,e.child,null,n),(r=t.child).memoizedState=Yo(n),r.childLanes=Qo(e,a,n),t.memoizedState=Xo,t=Bo(null,r));else if(Mi(t),Rd(l)){if(a=l.nextSibling&&l.nextSibling.dataset)var c=a.dgst;a=c,(r=Error(s(419))).stack="",r.digest=a,wr({value:r,source:null,stack:null}),t=el(e,t,n)}else if(Do||_r(e,t,n,!1),a=0!==(n&e.childLanes),Do||a){if(null!==(a=fu)&&(0!==(r=Oe(a,n))&&r!==u.retryLane))throw u.retryLane=r,Da(e,r),Xu(a,e,r),Ro;Fd(l)||sc(),t=el(e,t,n)}else Fd(l)?(t.flags|=192,t.child=e.child,t=null):(e=u.treeContext,cr=Dd(l.nextSibling),ur=t,dr=!0,hr=null,pr=!1,null!==e&&lr(t,e),(t=Zo(t,r.children)).flags|=4096);return t}return i?(Li(),l=r.fallback,i=t.mode,c=(u=e.child).sibling,(r=Wa(u,{mode:"hidden",children:r.children})).subtreeFlags=65011712&u.subtreeFlags,null!==c?l=Wa(c,l):(l=ja(l,i,n,null)).flags|=2,l.return=t,r.return=t,r.sibling=l,t.child=r,Bo(null,r),r=t.child,null===(l=e.child.memoizedState)?l=Yo(n):(null!==(i=l.cachePool)?(u=zr._currentValue,i=i.parent!==u?{parent:u,pool:u}:i):i=Qr(),l={baseLanes:l.baseLanes|n,cachePool:i}),r.memoizedState=l,r.childLanes=Qo(e,a,n),t.memoizedState=Xo,Bo(e.child,r)):(Mi(t),e=(n=e.child).sibling,(n=Wa(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function Zo(e,t){return(t=$o({mode:"visible",children:t},e.mode)).return=e,e.child=t}function $o(e,t){return(e=za(22,e,null,t)).lanes=0,e}function el(e,t,n){return pi(t,e.child,null,n),(e=Zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Cr(e.return,t,n)}function nl(e,t,n,a,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r,treeForkCount:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=n,s.tailMode=r,s.treeForkCount=i)}function al(e,t,n){var a=t.pendingProps,r=a.revealOrder,i=a.tail;a=a.children;var s=Bi.current,o=0!==(2&s);if(o?(s=1&s|2,t.flags|=128):s&=1,V(Bi,s),Mo(e,t,a,n),a=dr?Za:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Wi(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),nl(t,!1,r,n,i,a);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Wi(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}nl(t,!0,n,null,i,a);break;case"together":nl(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function rl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Iu|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(_r(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Wa(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Wa(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function il(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ar(e))}function sl(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Do=!0;else{if(!il(e,n)&&0===(128&t.flags))return Do=!1,function(e,t,n){switch(t.tag){case 3:X(t,t.stateNode.containerInfo),Nr(0,zr,e.memoizedState.cache),vr();break;case 27:case 5:Q(t);break;case 4:X(t,t.stateNode.containerInfo);break;case 10:Nr(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Oi(t),null;break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(Mi(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Jo(e,t,n):(Mi(t),null!==(e=rl(e,t,n))?e.sibling:null);Mi(t);break;case 19:var r=0!==(128&e.flags);if((a=0!==(n&t.childLanes))||(_r(e,t,n,!1),a=0!==(n&t.childLanes)),r){if(a)return al(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),V(Bi,Bi.current),a)break;return null;case 22:return t.lanes=0,zo(e,t,n,t.pendingProps);case 24:Nr(0,zr,e.memoizedState.cache)}return rl(e,t,n)}(e,t,n);Do=0!==(131072&e.flags)}else Do=!1,dr&&0!==(1048576&t.flags)&&ir(t,Za,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=ai(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var r=e.$$typeof;if(r===k){t.tag=11,t=Oo(null,t,e,a,n);break e}if(r===N){t.tag=14,t=Po(null,t,e,a,n);break e}}throw t=R(e)||e,Error(s(306,t,""))}Ba(e)?(a=So(e,a),t.tag=1,t=qo(null,t,e,a,n)):(t.tag=0,t=Go(null,t,e,a,n))}return t;case 0:return Go(e,t,t.type,t.pendingProps,n);case 1:return qo(e,t,a=t.type,r=So(a,t.pendingProps),n);case 3:e:{if(X(t,t.stateNode.containerInfo),null===e)throw Error(s(387));a=t.pendingProps;var i=t.memoizedState;r=i.element,yi(e,t),Ii(t,a,null,n);var o=t.memoizedState;if(a=o.cache,Nr(0,zr,a),a!==i.cache&&Er(t,[zr],n,!0),Si(),a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ko(e,t,a,n);break e}if(a!==r){wr(r=Xa(Error(s(424)),t)),t=Ko(e,t,a,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(cr=Dd(e.firstChild),ur=t,dr=!0,hr=null,pr=!0,n=fi(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(vr(),a===r){t=rl(e,t,n);break e}Mo(e,t,a,n)}t=t.child}return t;case 26:return jo(e,t),null===e?(n=Hd(t.type,null,t.pendingProps,null))?t.memoizedState=n:dr||(n=t.type,e=t.pendingProps,(a=gd(q.current).createElement(n))[Ve]=t,a[Ue]=e,hd(a,n,e),et(a),t.stateNode=a):t.memoizedState=Hd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&dr&&(a=t.stateNode=Ld(t.type,t.pendingProps,q.current),ur=t,pr=!0,r=cr,Td(t.type)?(Md=r,cr=Dd(a.firstChild)):cr=r),Mo(e,t,t.pendingProps.children,n),jo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&dr&&((r=a=cr)&&(null!==(a=function(e,t,n,a){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[Xe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===i)return e}if(null===(e=Dd(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,pr))?(t.stateNode=a,ur=t,cr=Dd(a.firstChild),pr=!1,r=!0):r=!1),r||mr(t)),Q(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,vd(r,i)?a=null:null!==o&&vd(r,o)&&(t.flags|=32),null!==t.memoizedState&&(r=es(e,t,as,null,null,n),ch._currentValue=r),jo(e,t),Mo(e,t,a,n),t.child;case 6:return null===e&&dr&&((e=n=cr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}(n,t.pendingProps,pr))?(t.stateNode=n,ur=t,cr=null,e=!0):e=!1),e||mr(t)),null;case 13:return Jo(e,t,n);case 4:return X(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=pi(t,null,a,n):Mo(e,t,a,n),t.child;case 11:return Oo(e,t,t.type,t.pendingProps,n);case 7:return Mo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Mo(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,Nr(0,t.type,a.value),Mo(e,t,a.children,n),t.child;case 9:return r=t.type._context,a=t.pendingProps.children,Fr(t),a=a(r=Rr(r)),t.flags|=1,Mo(e,t,a,n),t.child;case 14:return Po(e,t,t.type,t.pendingProps,n);case 15:return Lo(e,t,t.type,t.pendingProps,n);case 19:return al(e,t,n);case 31:return function(e,t,n){var a=t.pendingProps,r=0!==(128&t.flags);if(t.flags&=-129,null===e){if(dr){if("hidden"===a.mode)return e=Vo(t,a),t.lanes=536870912,Bo(null,e);if(Oi(t),(e=cr)?null!==(e=null!==(e=Ad(e,pr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ar}:null,retryLane:536870912,hydrationErrors:null},(n=Ha(e)).return=t,t.child=n,ur=t,cr=null):e=null,null===e)throw mr(t);return t.lanes=536870912,null}return Vo(t,a)}var i=e.memoizedState;if(null!==i){var o=i.dehydrated;if(Oi(t),r)if(256&t.flags)t.flags&=-257,t=Uo(e,t,n);else{if(null===t.memoizedState)throw Error(s(558));t.child=e.child,t.flags|=128,t=null}else if(Do||_r(e,t,n,!1),r=0!==(n&e.childLanes),Do||r){if(null!==(a=fu)&&0!==(o=Oe(a,n))&&o!==i.retryLane)throw i.retryLane=o,Da(e,o),Xu(a,e,o),Ro;sc(),t=Uo(e,t,n)}else e=i.treeContext,cr=Dd(o.nextSibling),ur=t,dr=!0,hr=null,pr=!1,null!==e&&lr(t,e),(t=Vo(t,a)).flags|=4096;return t}return(e=Wa(e.child,{mode:a.mode,children:a.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return zo(e,t,n,t.pendingProps);case 24:return Fr(t),a=Rr(zr),null===e?(null===(r=Xr())&&(r=fu,i=Br(),r.pooledCache=i,i.refCount++,null!==i&&(r.pooledCacheLanes|=n),r=i),t.memoizedState={parent:a,cache:r},gi(t),Nr(0,zr,r)):(0!==(e.lanes&n)&&(yi(e,t),Ii(t,null,null,n),Si()),r=e.memoizedState,i=t.memoizedState,r.parent!==a?(r={parent:a,cache:a},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Nr(0,zr,a)):(a=i.cache,Nr(0,zr,a),a!==r.cache&&Er(t,[zr],n,!0))),Mo(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,n,a,r){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!ac())throw ri=ei,Zr;e.flags|=8192}}else e.flags&=-16777217}function ul(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!rh(t)){if(!ac())throw ri=ei,Zr;e.flags|=8192}}function cl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ae():536870912,e.lanes|=t,Eu|=t)}function dl(e,t){if(!dr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=65011712&r.subtreeFlags,a|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function pl(e,t,n){var a=t.pendingProps;switch(or(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Tr(zr),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(br(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,xr())),hl(t),null;case 26:var r=t.type,i=t.memoizedState;return null===e?(ol(t),null!==i?(hl(t),ul(t,i)):(hl(t),ll(t,r,0,0,n))):i?i!==e.memoizedState?(ol(t),hl(t),ul(t,i)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==a&&ol(t),hl(t),ll(t,r,0,0,n)),null;case 27:if(J(t),n=q.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&ol(t);else{if(!a){if(null===t.stateNode)throw Error(s(166));return hl(t),null}e=G.current,br(t)?gr(t):(e=Ld(r,a,n),t.stateNode=e,ol(t))}return hl(t),null;case 5:if(J(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&ol(t);else{if(!a){if(null===t.stateNode)throw Error(s(166));return hl(t),null}if(i=G.current,br(t))gr(t);else{var o=gd(q.current);switch(i){case 1:i=o.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:i=o.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":i=o.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":i=o.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(i=o.createElement("div")).innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i="string"===typeof a.is?o.createElement("select",{is:a.is}):o.createElement("select"),a.multiple?i.multiple=!0:a.size&&(i.size=a.size);break;default:i="string"===typeof a.is?o.createElement(r,{is:a.is}):o.createElement(r)}}i[Ve]=t,i[Ue]=a;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)i.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=i;e:switch(hd(i,r,a),r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&ol(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&ol(t);else{if("string"!==typeof a&&null===t.stateNode)throw Error(s(166));if(e=q.current,br(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(r=ur))switch(r.tag){case 27:case 5:a=r.memoizedProps}e[Ve]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||ud(e.nodeValue,n)))||mr(t,!0)}else(e=gd(e).createTextNode(a))[Ve]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(a=br(t),null!==n){if(null===e){if(!a)throw Error(s(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(s(557));e[Ve]=t}else vr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=xr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(zi(t),t):(zi(t),null);if(0!==(128&t.flags))throw Error(s(558))}return hl(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=br(t),null!==a&&null!==a.dehydrated){if(null===e){if(!r)throw Error(s(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(s(317));r[Ve]=t}else vr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),r=!1}else r=xr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(zi(t),t):(zi(t),null)}return zi(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==a,e=null!==e&&null!==e.memoizedState,n&&(r=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(r=a.alternate.memoizedState.cachePool.pool),i=null,null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(i=a.memoizedState.cachePool.pool),i!==r&&(a.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),cl(t,t.updateQueue),hl(t),null);case 4:return Y(),null===e&&$c(t.stateNode.containerInfo),hl(t),null;case 10:return Tr(t.type),hl(t),null;case 19:if(W(Bi),null===(a=t.memoizedState))return hl(t),null;if(r=0!==(128&t.flags),null===(i=a.rendering))if(r)dl(a,!1);else{if(0!==Su||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=Wi(e))){for(t.flags|=128,dl(a,!1),e=i.updateQueue,t.updateQueue=e,cl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Va(n,e),n=n.sibling;return V(Bi,1&Bi.current|2),dr&&rr(t,a.treeForkCount),t.child}e=e.sibling}null!==a.tail&&le()>Mu&&(t.flags|=128,r=!0,dl(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Wi(i))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,cl(t,e),dl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!i.alternate&&!dr)return hl(t),null}else 2*le()-a.renderingStartTime>Mu&&536870912!==n&&(t.flags|=128,r=!0,dl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=a.last)?e.sibling=i:t.child=i,a.last=i)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=le(),e.sibling=null,n=Bi.current,V(Bi,r?1&n|2:1&n),dr&&rr(t,a.treeForkCount),e):(hl(t),null);case 22:case 23:return zi(t),Fi(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&cl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&W(Kr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Tr(zr),hl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function fl(e,t){switch(or(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Tr(zr),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(zi(t),null===t.alternate)throw Error(s(340));vr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(zi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));vr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return W(Bi),null;case 4:return Y(),null;case 10:return Tr(t.type),null;case 22:case 23:return zi(t),Fi(),null!==e&&W(Kr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Tr(zr),null;default:return null}}function ml(e,t){switch(or(t),t.tag){case 3:Tr(zr),Y();break;case 26:case 27:case 5:J(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&zi(t);break;case 13:zi(t);break;case 19:W(Bi);break;case 10:Tr(t.type);break;case 22:case 23:zi(t),Fi(),null!==e&&W(Kr);break;case 24:Tr(zr)}}function gl(e,t){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var i=n.create,s=n.inst;a=i(),s.destroy=a}n=n.next}while(n!==r)}}catch(o){Sc(t,t.return,o)}}function yl(e,t,n){try{var a=t.updateQueue,r=null!==a?a.lastEffect:null;if(null!==r){var i=r.next;a=i;do{if((a.tag&e)===e){var s=a.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,r=t;var l=n,u=o;try{u()}catch(c){Sc(r,l,c)}}}a=a.next}while(a!==i)}}catch(c){Sc(t,t.return,c)}}function bl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ti(t,n)}catch(a){Sc(e,e.return,a)}}}function vl(e,t,n){n.props=So(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){Sc(e,t,a)}}function xl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"===typeof n?e.refCleanup=n(a):n.current=a}}catch(r){Sc(e,t,r)}}function wl(e,t){var n=e.ref,a=e.refCleanup;if(null!==n)if("function"===typeof a)try{a()}catch(r){Sc(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){Sc(e,t,i)}else n.current=null}function kl(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){Sc(e,e.return,r)}}function Sl(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,i=null,o=null,l=null,u=null,c=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":u=h;default:a.hasOwnProperty(f)||cd(e,t,f,null,a,h)}}for(var p in a){var f=a[p];if(h=n[p],a.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":i=f;break;case"name":r=f;break;case"checked":c=f;break;case"defaultChecked":d=f;break;case"value":o=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:f!==h&&cd(e,t,p,f,a,h)}}return void bt(e,o,l,u,c,d,i,r);case"select":for(i in f=o=l=p=null,n)if(u=n[i],n.hasOwnProperty(i)&&null!=u)switch(i){case"value":break;case"multiple":f=u;default:a.hasOwnProperty(i)||cd(e,t,i,null,a,u)}for(r in a)if(i=a[r],u=n[r],a.hasOwnProperty(r)&&(null!=i||null!=u))switch(r){case"value":p=i;break;case"defaultValue":l=i;break;case"multiple":o=i;default:i!==u&&cd(e,t,r,i,a,u)}return t=l,n=o,a=f,void(null!=p?wt(e,!!n,p,!1):!!a!==!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=p=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:cd(e,t,l,null,a,r)}for(o in a)if(r=a[o],i=n[o],a.hasOwnProperty(o)&&(null!=r||null!=i))switch(o){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(s(91));break;default:r!==i&&cd(e,t,o,r,a,i)}return void kt(e,p,f);case"option":for(var m in n)if(p=n[m],n.hasOwnProperty(m)&&null!=p&&!a.hasOwnProperty(m))if("selected"===m)e.selected=!1;else cd(e,t,m,null,a,p);for(u in a)if(p=a[u],f=n[u],a.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))if("selected"===u)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else cd(e,t,u,p,a,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!a.hasOwnProperty(g)&&cd(e,t,g,null,a,p);for(c in a)if(p=a[c],f=n[c],a.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))switch(c){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:cd(e,t,c,p,a,f)}return;default:if(Et(t)){for(var y in n)p=n[y],n.hasOwnProperty(y)&&void 0!==p&&!a.hasOwnProperty(y)&&dd(e,t,y,void 0,a,p);for(d in a)p=a[d],f=n[d],!a.hasOwnProperty(d)||p===f||void 0===p&&void 0===f||dd(e,t,d,p,a,f);return}}for(var b in n)p=n[b],n.hasOwnProperty(b)&&null!=p&&!a.hasOwnProperty(b)&&cd(e,t,b,null,a,p);for(h in a)p=a[h],f=n[h],!a.hasOwnProperty(h)||p===f||null==p&&null==f||cd(e,t,h,p,a,f)}(a,e.type,n,t),a[Ue]=t}catch(r){Sc(e,e.return,r)}}function Il(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Td(e.type)||4===e.tag}function Nl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Td(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Rt));else if(4!==a&&(27===a&&Td(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,n),e=e.sibling;null!==e;)Tl(e,t,n),e=e.sibling}function Cl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&(27===a&&Td(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Cl(e,t,n),e=e.sibling;null!==e;)Cl(e,t,n),e=e.sibling}function El(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);hd(t,a,n),t[Ve]=e,t[Ue]=n}catch(i){Sc(e,e.return,i)}}var _l=!1,Al=!1,Fl=!1,Rl="function"===typeof WeakSet?WeakSet:Set,Dl=null;function Ml(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Xl(e,n),4&a&&gl(5,n);break;case 1:if(Xl(e,n),4&a)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){Sc(n,n.return,s)}else{var r=So(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Sc(n,n.return,o)}}64&a&&bl(n),512&a&&xl(n,n.return);break;case 3:if(Xl(e,n),64&a&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ti(e,t)}catch(s){Sc(n,n.return,s)}}break;case 27:null===t&&4&a&&El(n);case 26:case 5:Xl(e,n),null===t&&4&a&&kl(n),512&a&&xl(n,n.return);break;case 12:Xl(e,n);break;case 31:Xl(e,n),4&a&&Wl(e,n);break;case 13:Xl(e,n),4&a&&Vl(e,n),64&a&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,n=Cc.bind(null,n))));break;case 22:if(!(a=null!==n.memoizedState||_l)){t=null!==t&&null!==t.memoizedState||Al,r=_l;var i=Al;_l=a,(Al=t)&&!i?Ql(e,n,0!==(8772&n.subtreeFlags)):Xl(e,n),_l=r,Al=i}break;case 30:break;default:Xl(e,n)}}function Ol(e){var t=e.alternate;null!==t&&(e.alternate=null,Ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Pl=null,Ll=!1;function zl(e,t,n){for(n=n.child;null!==n;)Bl(e,t,n),n=n.sibling}function Bl(e,t,n){if(be&&"function"===typeof be.onCommitFiberUnmount)try{be.onCommitFiberUnmount(ye,n)}catch(i){}switch(n.tag){case 26:Al||wl(n,t),zl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Al||wl(n,t);var a=Pl,r=Ll;Td(n.type)&&(Pl=n.stateNode,Ll=!1),zl(e,t,n),zd(n.stateNode),Pl=a,Ll=r;break;case 5:Al||wl(n,t);case 6:if(a=Pl,r=Ll,Pl=null,zl(e,t,n),Ll=r,null!==(Pl=a))if(Ll)try{(9===Pl.nodeType?Pl.body:"HTML"===Pl.nodeName?Pl.ownerDocument.body:Pl).removeChild(n.stateNode)}catch(s){Sc(n,t,s)}else try{Pl.removeChild(n.stateNode)}catch(s){Sc(n,t,s)}break;case 18:null!==Pl&&(Ll?(Cd(9===(e=Pl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Gh(e)):Cd(Pl,n.stateNode));break;case 4:a=Pl,r=Ll,Pl=n.stateNode.containerInfo,Ll=!0,zl(e,t,n),Pl=a,Ll=r;break;case 0:case 11:case 14:case 15:yl(2,n,t),Al||yl(4,n,t),zl(e,t,n);break;case 1:Al||(wl(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount&&vl(n,t,a)),zl(e,t,n);break;case 21:zl(e,t,n);break;case 22:Al=(a=Al)||null!==n.memoizedState,zl(e,t,n),Al=a;break;default:zl(e,t,n)}}function Wl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Gh(e)}catch(n){Sc(t,t.return,n)}}}function Vl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Gh(e)}catch(n){Sc(t,t.return,n)}}function Ul(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var a=Ec.bind(null,e,t);t.then(a,a)}})}function jl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var r=n[a],i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Td(l.type)){Pl=l.stateNode,Ll=!1;break e}break;case 5:Pl=l.stateNode,Ll=!1;break e;case 3:case 4:Pl=l.stateNode.containerInfo,Ll=!0;break e}l=l.return}if(null===Pl)throw Error(s(160));Bl(i,o,r),Pl=null,Ll=!1,null!==(i=r.alternate)&&(i.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Hl(t,e),t=t.sibling}var Gl=null;function Hl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:jl(t,e),ql(e),4&a&&(yl(3,e,e.return),gl(3,e),yl(5,e,e.return));break;case 1:jl(t,e),ql(e),512&a&&(Al||null===n||wl(n,n.return)),64&a&&_l&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a))));break;case 26:var r=Gl;if(jl(t,e),ql(e),512&a&&(Al||null===n||wl(n,n.return)),4&a){var i=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(a){case"title":(!(i=r.getElementsByTagName("title")[0])||i[Xe]||i[Ve]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=r.createElement(a),r.head.insertBefore(i,r.querySelector("head > title"))),hd(i,a,n),i[Ve]=e,et(i),a=i;break e;case"link":var o=nh("link","href",r).get(a+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((i=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}hd(i=r.createElement(a),a,n),r.head.appendChild(i);break;case"meta":if(o=nh("meta","content",r).get(a+(n.content||"")))for(l=0;l<o.length;l++)if((i=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}hd(i=r.createElement(a),a,n),r.head.appendChild(i);break;default:throw Error(s(468,a))}i[Ve]=e,et(i),a=i}e.stateNode=a}else ah(r,e.type,e.stateNode);else e.stateNode=Jd(r,a,e.memoizedProps);else i!==a?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===a?ah(r,e.type,e.stateNode):Jd(r,a,e.memoizedProps)):null===a&&null!==e.stateNode&&Sl(e,e.memoizedProps,n.memoizedProps)}break;case 27:jl(t,e),ql(e),512&a&&(Al||null===n||wl(n,n.return)),null!==n&&4&a&&Sl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(jl(t,e),ql(e),512&a&&(Al||null===n||wl(n,n.return)),32&e.flags){r=e.stateNode;try{It(r,"")}catch(m){Sc(e,e.return,m)}}4&a&&null!=e.stateNode&&Sl(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&a&&(Fl=!0);break;case 6:if(jl(t,e),ql(e),4&a){if(null===e.stateNode)throw Error(s(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(m){Sc(e,e.return,m)}}break;case 3:if(th=null,r=Gl,Gl=Vd(t.containerInfo),jl(t,e),Gl=r,ql(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Gh(t.containerInfo)}catch(m){Sc(e,e.return,m)}Fl&&(Fl=!1,Kl(e));break;case 4:a=Gl,Gl=Vd(e.stateNode.containerInfo),jl(t,e),ql(e),Gl=a;break;case 12:default:jl(t,e),ql(e);break;case 31:case 19:jl(t,e),ql(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ul(e,a)));break;case 13:jl(t,e),ql(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Ru=le()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ul(e,a)));break;case 22:r=null!==e.memoizedState;var u=null!==n&&null!==n.memoizedState,c=_l,d=Al;if(_l=c||r,Al=d||u,jl(t,e),Al=d,_l=c,ql(e),8192&a)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||u||_l||Al||Yl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){u=n=t;try{if(i=u.stateNode,r)"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=u.stateNode;var h=u.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(m){Sc(u,u.return,m)}}}else if(6===t.tag){if(null===n){u=t;try{u.stateNode.nodeValue=r?"":u.memoizedProps}catch(m){Sc(u,u.return,m)}}}else if(18===t.tag){if(null===n){u=t;try{var f=u.stateNode;r?Ed(f,!0):Ed(u.stateNode,!1)}catch(m){Sc(u,u.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(n=a.retryQueue)&&(a.retryQueue=null,Ul(e,n))));case 30:case 21:}}function ql(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(Il(a)){n=a;break}a=a.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var r=n.stateNode;Cl(e,Nl(e),r);break;case 5:var i=n.stateNode;32&n.flags&&(It(i,""),n.flags&=-33),Cl(e,Nl(e),i);break;case 3:case 4:var o=n.stateNode.containerInfo;Tl(e,Nl(e),o);break;default:throw Error(s(161))}}catch(l){Sc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Xl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ml(e,t.alternate,t),t=t.sibling}function Yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Yl(t);break;case 1:wl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&vl(t,t.return,n),Yl(t);break;case 27:zd(t.stateNode);case 26:case 5:wl(t,t.return),Yl(t);break;case 22:null===t.memoizedState&&Yl(t);break;default:Yl(t)}e=e.sibling}}function Ql(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,r=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Ql(r,i,n),gl(4,i);break;case 1:if(Ql(r,i,n),"function"===typeof(r=(a=i).stateNode).componentDidMount)try{r.componentDidMount()}catch(u){Sc(a,a.return,u)}if(null!==(r=(a=i).updateQueue)){var o=a.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)Ni(l[r],o)}catch(u){Sc(a,a.return,u)}}n&&64&s&&bl(i),xl(i,i.return);break;case 27:El(i);case 26:case 5:Ql(r,i,n),n&&null===a&&4&s&&kl(i),xl(i,i.return);break;case 12:Ql(r,i,n);break;case 31:Ql(r,i,n),n&&4&s&&Wl(r,i);break;case 13:Ql(r,i,n),n&&4&s&&Vl(r,i);break;case 22:null===i.memoizedState&&Ql(r,i,n),xl(i,i.return);break;case 30:break;default:Ql(r,i,n)}t=t.sibling}}function Jl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Wr(n))}function Zl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Wr(e))}function $l(e,t,n,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)eu(e,t,n,a),t=t.sibling}function eu(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:$l(e,t,n,a),2048&r&&gl(9,t);break;case 1:case 31:case 13:default:$l(e,t,n,a);break;case 3:$l(e,t,n,a),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Wr(e)));break;case 12:if(2048&r){$l(e,t,n,a),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Sc(t,t.return,l)}}else $l(e,t,n,a);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?$l(e,t,n,a):nu(e,t):2&i._visibility?$l(e,t,n,a):(i._visibility|=2,tu(e,t,n,a,0!==(10256&t.subtreeFlags)||!1)),2048&r&&Jl(s,t);break;case 24:$l(e,t,n,a),2048&r&&Zl(t.alternate,t)}}function tu(e,t,n,a,r){for(r=r&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,s=t,o=n,l=a,u=s.flags;switch(s.tag){case 0:case 11:case 15:tu(i,s,o,l,r),gl(8,s);break;case 23:break;case 22:var c=s.stateNode;null!==s.memoizedState?2&c._visibility?tu(i,s,o,l,r):nu(i,s):(c._visibility|=2,tu(i,s,o,l,r)),r&&2048&u&&Jl(s.alternate,s);break;case 24:tu(i,s,o,l,r),r&&2048&u&&Zl(s.alternate,s);break;default:tu(i,s,o,l,r)}t=t.sibling}}function nu(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:nu(n,a),2048&r&&Jl(a.alternate,a);break;case 24:nu(n,a),2048&r&&Zl(a.alternate,a);break;default:nu(n,a)}t=t.sibling}}var au=8192;function ru(e,t,n){if(e.subtreeFlags&au)for(e=e.child;null!==e;)iu(e,t,n),e=e.sibling}function iu(e,t,n){switch(e.tag){case 26:ru(e,t,n),e.flags&au&&null!==e.memoizedState&&function(e,t,n,a){if("stylesheet"===n.type&&("string"!==typeof a.media||!1!==matchMedia(a.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var r=qd(a.href),i=t.querySelector(Kd(r));if(i)return null!==(t=i._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=sh.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void et(i);i=t.ownerDocument||t,a=Xd(a),(r=Bd.get(r))&&$d(a,r),et(i=i.createElement("link"));var s=i;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(i,"link",a),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=sh.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Gl,e.memoizedState,e.memoizedProps);break;case 5:default:ru(e,t,n);break;case 3:case 4:var a=Gl;Gl=Vd(e.stateNode.containerInfo),ru(e,t,n),Gl=a;break;case 22:null===e.memoizedState&&(null!==(a=e.alternate)&&null!==a.memoizedState?(a=au,au=16777216,ru(e,t,n),au=a):ru(e,t,n))}}function su(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function ou(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Dl=a,cu(a,e)}su(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lu(e),e=e.sibling}function lu(e){switch(e.tag){case 0:case 11:case 15:ou(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:ou(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,uu(e)):ou(e)}}function uu(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Dl=a,cu(a,e)}su(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),uu(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,uu(t));break;default:uu(t)}e=e.sibling}}function cu(e,t){for(;null!==Dl;){var n=Dl;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var a=n.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Wr(n.memoizedState.cache)}if(null!==(a=n.child))a.return=n,Dl=a;else e:for(n=e;null!==Dl;){var r=(a=Dl).sibling,i=a.return;if(Ol(a),a===n){Dl=null;break e}if(null!==r){r.return=i,Dl=r;break e}Dl=i}}}var du={getCacheForType:function(e){var t=Rr(zr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Rr(zr).controller.signal}},hu="function"===typeof WeakMap?WeakMap:Map,pu=0,fu=null,mu=null,gu=0,yu=0,bu=null,vu=!1,xu=!1,wu=!1,ku=0,Su=0,Iu=0,Nu=0,Tu=0,Cu=0,Eu=0,_u=null,Au=null,Fu=!1,Ru=0,Du=0,Mu=1/0,Ou=null,Pu=null,Lu=0,zu=null,Bu=null,Wu=0,Vu=0,Uu=null,ju=null,Gu=0,Hu=null;function qu(){return 0!==(2&pu)&&0!==gu?gu&-gu:null!==M.T?Uc():ze()}function Ku(){if(0===Cu)if(0===(536870912&gu)||dr){var e=Ie;0===(3932160&(Ie<<=1))&&(Ie=262144),Cu=e}else Cu=536870912;return null!==(e=Ri.current)&&(e.flags|=32),Cu}function Xu(e,t,n){(e!==fu||2!==yu&&9!==yu)&&null===e.cancelPendingCommit||(tc(e,0),Zu(e,gu,Cu,!1)),Re(e,n),0!==(2&pu)&&e===fu||(e===fu&&(0===(2&pu)&&(Nu|=n),4===Su&&Zu(e,gu,Cu,!1)),Oc(e))}function Yu(e,t,n){if(0!==(6&pu))throw Error(s(327));for(var a=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ee(e,t),r=a?function(e,t){var n=pu;pu|=2;var a=rc(),r=ic();fu!==e||gu!==t?(Ou=null,Mu=le()+500,tc(e,t)):xu=Ee(e,t);e:for(;;)try{if(0!==yu&&null!==mu){t=mu;var i=bu;t:switch(yu){case 1:yu=0,bu=null,hc(e,t,i,1);break;case 2:case 9:if(ti(i)){yu=0,bu=null,dc(t);break}t=function(){2!==yu&&9!==yu||fu!==e||(yu=7),Oc(e)},i.then(t,t);break e;case 3:yu=7;break e;case 4:yu=5;break e;case 7:ti(i)?(yu=0,bu=null,dc(t)):(yu=0,bu=null,hc(e,t,i,7));break;case 5:var o=null;switch(mu.tag){case 26:o=mu.memoizedState;case 5:case 27:var l=mu;if(o?rh(o):l.stateNode.complete){yu=0,bu=null;var u=l.sibling;if(null!==u)mu=u;else{var c=l.return;null!==c?(mu=c,pc(c)):mu=null}break t}}yu=0,bu=null,hc(e,t,i,5);break;case 6:yu=0,bu=null,hc(e,t,i,6);break;case 8:ec(),Su=6;break e;default:throw Error(s(462))}}uc();break}catch(d){nc(e,d)}return Ir=Sr=null,M.H=a,M.A=r,pu=n,null!==mu?0:(fu=null,gu=0,Aa(),Su)}(e,t):oc(e,t,!0),i=a;;){if(0===r){xu&&!a&&Zu(e,t,0,!1);break}if(n=e.current.alternate,!i||Ju(n)){if(2===r){if(i=t,e.errorRecoveryDisabledLanes&i)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;r=_u;var u=l.current.memoizedState.isDehydrated;if(u&&(tc(l,o).flags|=256),2!==(o=oc(l,o,!1))){if(wu&&!u){l.errorRecoveryDisabledLanes|=i,Nu|=i,r=4;break e}i=Au,Au=r,null!==i&&(null===Au?Au=i:Au.push.apply(Au,i))}r=o}if(i=!1,2!==r)continue}}if(1===r){tc(e,0),Zu(e,t,0,!0);break}e:{switch(a=e,i=r){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Zu(a,t,Cu,!vu);break e;case 2:Au=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(r=Ru+300-le())){if(Zu(a,t,Cu,!vu),0!==Ce(a,0,!0))break e;Wu=t,a.timeoutHandle=wd(Qu.bind(null,a,n,Au,Ou,Fu,t,Cu,Nu,Eu,vu,i,"Throttled",-0,0),r)}else Qu(a,n,Au,Ou,Fu,t,Cu,Nu,Eu,vu,i,null,-0,0)}break}r=oc(e,t,!1),i=!1}Oc(e)}function Qu(e,t,n,a,r,i,s,o,l,u,c,d,h,p){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){iu(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rt});var f=(62914560&i)===i?Ru-le():(4194048&i)===i?Du-le():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var a=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ih&&(ih=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),a=0;a<n.length;a++){var r=n[a],i=r.transferSize,s=r.initiatorType,o=r.duration;if(i&&o&&pd(s)){for(s=0,o=r.responseEnd,a+=1;a<n.length;a++){var l=n[a],u=l.startTime;if(u>o)break;var c=l.transferSize,d=l.initiatorType;c&&pd(d)&&(s+=c*((l=l.responseEnd)<o?1:(o-u)/(l-u)))}if(--a,t+=8*(i+s)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ih?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(r)}}:null}(d,f)))return Wu=i,e.cancelPendingCommit=f(mc.bind(null,e,t,i,n,a,r,s,o,l,c,d,null,h,p)),void Zu(e,i,s,!u)}mc(e,t,i,n,a,r,s,o,l)}function Ju(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var a=0;a<n.length;a++){var r=n[a],i=r.getSnapshot;r=r.value;try{if(!Zn(i(),r))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zu(e,t,n,a){t&=~Tu,t&=~Nu,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var i=31-xe(r),s=1<<i;a[i]=-1,r&=~s}0!==n&&De(e,n,t)}function $u(){return 0!==(6&pu)||(Pc(0,!1),!1)}function ec(){if(null!==mu){if(0===yu)var e=mu.return;else Ir=Sr=null,ss(e=mu),oi=null,li=0,e=mu;for(;null!==e;)ml(e.alternate,e),e=e.return;mu=null}}function tc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,kd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Wu=0,ec(),fu=e,mu=n=Wa(e.current,null),gu=t,yu=0,bu=null,vu=!1,xu=Ee(e,t),wu=!1,Eu=Cu=Tu=Nu=Iu=Su=0,Au=_u=null,Fu=!1,0!==(8&t)&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var r=31-xe(a),i=1<<r;t|=e[r],a&=~i}return ku=t,Aa(),n}function nc(e,t){Ui=null,M.H=mo,t===Jr||t===$r?(t=ii(),yu=3):t===Zr?(t=ii(),yu=4):yu=t===Ro?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,bu=t,null===mu&&(Su=1,Co(e,Xa(t,e.current)))}function ac(){var e=Ri.current;return null===e||((4194048&gu)===gu?null===Di:((62914560&gu)===gu||0!==(536870912&gu))&&e===Di)}function rc(){var e=M.H;return M.H=mo,null===e?mo:e}function ic(){var e=M.A;return M.A=du,e}function sc(){Su=4,vu||(4194048&gu)!==gu&&null!==Ri.current||(xu=!0),0===(134217727&Iu)&&0===(134217727&Nu)||null===fu||Zu(fu,gu,Cu,!1)}function oc(e,t,n){var a=pu;pu|=2;var r=rc(),i=ic();fu===e&&gu===t||(Ou=null,tc(e,t)),t=!1;var s=Su;e:for(;;)try{if(0!==yu&&null!==mu){var o=mu,l=bu;switch(yu){case 8:ec(),s=6;break e;case 3:case 2:case 9:case 6:null===Ri.current&&(t=!0);var u=yu;if(yu=0,bu=null,hc(e,o,l,u),n&&xu){s=0;break e}break;default:u=yu,yu=0,bu=null,hc(e,o,l,u)}}lc(),s=Su;break}catch(c){nc(e,c)}return t&&e.shellSuspendCounter++,Ir=Sr=null,pu=a,M.H=r,M.A=i,null===mu&&(fu=null,gu=0,Aa()),s}function lc(){for(;null!==mu;)cc(mu)}function uc(){for(;null!==mu&&!se();)cc(mu)}function cc(e){var t=sl(e.alternate,e,ku);e.memoizedProps=e.pendingProps,null===t?pc(e):mu=t}function dc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ho(n,t,t.pendingProps,t.type,void 0,gu);break;case 11:t=Ho(n,t,t.pendingProps,t.type.render,t.ref,gu);break;case 5:ss(t);default:ml(n,t),t=sl(n,t=mu=Va(t,ku),ku)}e.memoizedProps=e.pendingProps,null===t?pc(e):mu=t}function hc(e,t,n,a){Ir=Sr=null,ss(t),oi=null,li=0;var r=t.return;try{if(function(e,t,n,a,r){if(n.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){if(null!==(t=n.alternate)&&_r(t,n,r,!0),null!==(n=Ri.current)){switch(n.tag){case 31:case 13:return null===Di?sc():null===n.alternate&&0===Su&&(Su=3),n.flags&=-257,n.flags|=65536,n.lanes=r,a===ei?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),Ic(e,a,r)),!1;case 22:return n.flags|=65536,a===ei?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),Ic(e,a,r)),!1}throw Error(s(435,n.tag))}return Ic(e,a,r),sc(),!1}if(dr)return null!==(t=Ri.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,a!==fr&&wr(Xa(e=Error(s(422),{cause:a}),n))):(a!==fr&&wr(Xa(t=Error(s(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,a=Xa(a,n),wi(e,r=_o(e.stateNode,a,r)),4!==Su&&(Su=2)),!1;var i=Error(s(520),{cause:a});if(i=Xa(i,n),null===_u?_u=[i]:_u.push(i),4!==Su&&(Su=2),null===t)return!0;a=Xa(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,wi(n,e=_o(n.stateNode,a,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Pu||!Pu.has(i))))return n.flags|=65536,r&=-r,n.lanes|=r,Fo(r=Ao(r),e,n,a),wi(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,gu))return Su=1,Co(e,Xa(n,e.current)),void(mu=null)}catch(i){if(null!==r)throw mu=r,i;return Su=1,Co(e,Xa(n,e.current)),void(mu=null)}32768&t.flags?(dr||1===a?e=!0:xu||0!==(536870912&gu)?e=!1:(vu=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=Ri.current)&&13===a.tag&&(a.flags|=16384))),fc(t,e)):pc(t)}function pc(e){var t=e;do{if(0!==(32768&t.flags))return void fc(t,vu);e=t.return;var n=pl(t.alternate,t,ku);if(null!==n)return void(mu=n);if(null!==(t=t.sibling))return void(mu=t);mu=t=e}while(null!==t);0===Su&&(Su=5)}function fc(e,t){do{var n=fl(e.alternate,e);if(null!==n)return n.flags&=32767,void(mu=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(mu=e);mu=e=n}while(null!==e);Su=6,mu=null}function mc(e,t,n,a,r,i,o,l,u){e.cancelPendingCommit=null;do{xc()}while(0!==Lu);if(0!==(6&pu))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(i=t.lanes|t.childLanes,function(e,t,n,a,r,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,u=e.hiddenUpdates;for(n=s&~n;0<n;){var c=31-xe(n),d=1<<c;o[c]=0,l[c]=-1;var h=u[c];if(null!==h)for(u[c]=null,c=0;c<h.length;c++){var p=h[c];null!==p&&(p.lane&=-536870913)}n&=~d}0!==a&&De(e,a,0),0!==i&&0===r&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,i|=_a,o,l,u),e===fu&&(mu=fu=null,gu=0),Bu=t,zu=e,Wu=n,Vu=i,Uu=r,ju=a,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,re(he,function(){return wc(),null})):(e.callbackNode=null,e.callbackPriority=0),a=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||a){a=M.T,M.T=null,r=O.p,O.p=2,o=pu,pu|=4;try{!function(e,t){if(e=e.containerInfo,fd=vh,ra(e=aa(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==i||0!==a&&3!==h.nodeType||(u=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===r&&(l=o),p===i&&++d===a&&(u=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(md={focusedElem:e,selectionRange:n},vh=!1,Dl=t;null!==Dl;)if(e=(t=Dl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Dl=e;else for(;null!==Dl;){switch(i=(t=Dl).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(r=e[n]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,r=i.memoizedProps,i=i.memoizedState,a=n.stateNode;try{var m=So(n.type,r);e=a.getSnapshotBeforeUpdate(m,i),a.__reactInternalSnapshotBeforeUpdate=e}catch(y){Sc(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))_d(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":_d(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,Dl=e;break}Dl=t.return}}(e,t)}finally{pu=o,O.p=r,M.T=a}}Lu=1,gc(),yc(),bc()}}function gc(){if(1===Lu){Lu=0;var e=zu,t=Bu,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=M.T,M.T=null;var a=O.p;O.p=2;var r=pu;pu|=4;try{Hl(t,e);var i=md,s=aa(e.containerInfo),o=i.focusedElem,l=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&na(o.ownerDocument.documentElement,o)){if(null!==l&&ra(o)){var u=l.start,c=l.end;if(void 0===c&&(c=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(c,o.value.length);else{var d=o.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=o.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!p.extend&&m>g&&(s=g,g=m,m=s);var y=ta(o,m),b=ta(o,g);if(y&&b&&(1!==p.rangeCount||p.anchorNode!==y.node||p.anchorOffset!==y.offset||p.focusNode!==b.node||p.focusOffset!==b.offset)){var v=d.createRange();v.setStart(y.node,y.offset),p.removeAllRanges(),m>g?(p.addRange(v),p.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),p.addRange(v))}}}}for(d=[],p=o;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var x=d[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}vh=!!fd,md=fd=null}finally{pu=r,O.p=a,M.T=n}}e.current=t,Lu=2}}function yc(){if(2===Lu){Lu=0;var e=zu,t=Bu,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=M.T,M.T=null;var a=O.p;O.p=2;var r=pu;pu|=4;try{Ml(e,t.alternate,t)}finally{pu=r,O.p=a,M.T=n}}Lu=3}}function bc(){if(4===Lu||3===Lu){Lu=0,oe();var e=zu,t=Bu,n=Wu,a=ju;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Lu=5:(Lu=0,Bu=zu=null,vc(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Pu=null),Le(n),t=t.stateNode,be&&"function"===typeof be.onCommitFiberRoot)try{be.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==a){t=M.T,r=O.p,O.p=2,M.T=null;try{for(var i=e.onRecoverableError,s=0;s<a.length;s++){var o=a[s];i(o.value,{componentStack:o.stack})}}finally{M.T=t,O.p=r}}0!==(3&Wu)&&xc(),Oc(e),r=e.pendingLanes,0!==(261930&n)&&0!==(42&r)?e===Hu?Gu++:(Gu=0,Hu=e):Gu=0,Pc(0,!1)}}function vc(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Wr(t)))}function xc(){return gc(),yc(),bc(),wc()}function wc(){if(5!==Lu)return!1;var e=zu,t=Vu;Vu=0;var n=Le(Wu),a=M.T,r=O.p;try{O.p=32>n?32:n,M.T=null,n=Uu,Uu=null;var i=zu,o=Wu;if(Lu=0,Bu=zu=null,Wu=0,0!==(6&pu))throw Error(s(331));var l=pu;if(pu|=4,lu(i.current),eu(i,i.current,o,n),pu=l,Pc(0,!1),be&&"function"===typeof be.onPostCommitFiberRoot)try{be.onPostCommitFiberRoot(ye,i)}catch(u){}return!0}finally{O.p=r,M.T=a,vc(e,t)}}function kc(e,t,n){t=Xa(n,t),null!==(e=vi(e,t=_o(e.stateNode,t,2),2))&&(Re(e,2),Oc(e))}function Sc(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Pu||!Pu.has(a))){e=Xa(n,e),null!==(a=vi(t,n=Ao(2),2))&&(Fo(n,a,t,e),Re(a,2),Oc(a));break}}t=t.return}}function Ic(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new hu;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(wu=!0,r.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function Nc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fu===e&&(gu&n)===n&&(4===Su||3===Su&&(62914560&gu)===gu&&300>le()-Ru?0===(2&pu)&&tc(e,0):Tu|=n,Eu===gu&&(Eu=0)),Oc(e)}function Tc(e,t){0===t&&(t=Ae()),null!==(e=Da(e,t))&&(Re(e,t),Oc(e))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 31:case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==a&&a.delete(t),Tc(e,n)}var _c=null,Ac=null,Fc=!1,Rc=!1,Dc=!1,Mc=0;function Oc(e){e!==Ac&&null===e.next&&(null===Ac?_c=Ac=e:Ac=Ac.next=e),Rc=!0,Fc||(Fc=!0,Id(function(){0!==(6&pu)?re(ce,Lc):zc()}))}function Pc(e,t){if(!Dc&&Rc){Dc=!0;do{for(var n=!1,a=_c;null!==a;){if(!t)if(0!==e){var r=a.pendingLanes;if(0===r)var i=0;else{var s=a.suspendedLanes,o=a.pingedLanes;i=(1<<31-xe(42|e)+1)-1,i=201326741&(i&=r&~(s&~o))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Vc(a,i))}else i=gu,0===(3&(i=Ce(a,a===fu?i:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||Ee(a,i)||(n=!0,Vc(a,i));a=a.next}}while(n);Dc=!1}}function Lc(){zc()}function zc(){Rc=Fc=!1;var e=0;0!==Mc&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==xd&&(xd=e,!0);return xd=null,!1}()&&(e=Mc);for(var t=le(),n=null,a=_c;null!==a;){var r=a.next,i=Bc(a,t);0===i?(a.next=null,null===n?_c=r:n.next=r,null===r&&(Ac=n)):(n=a,(0!==e||0!==(3&i))&&(Rc=!0)),a=r}0!==Lu&&5!==Lu||Pc(e,!1),0!==Mc&&(Mc=0)}function Bc(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-xe(i),o=1<<s,l=r[s];-1===l?0!==(o&n)&&0===(o&a)||(r[s]=_e(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}if(n=gu,n=Ce(e,e===(t=fu)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===n||e===t&&(2===yu||9===yu)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&ie(a),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ee(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==a&&ie(a),Le(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=fe}return a=Wc.bind(null,e),n=re(n,a),e.callbackPriority=t,e.callbackNode=n,t}return null!==a&&null!==a&&ie(a),e.callbackPriority=2,e.callbackNode=null,2}function Wc(e,t){if(0!==Lu&&5!==Lu)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var a=gu;return 0===(a=Ce(e,e===fu?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Yu(e,a,t),Bc(e,le()),null!=e.callbackNode&&e.callbackNode===n?Wc.bind(null,e):null)}function Vc(e,t){if(xc())return null;Yu(e,t,!0)}function Uc(){if(0===Mc){var e=jr;0===e&&(e=Se,0===(261888&(Se<<=1))&&(Se=256)),Mc=e}return Mc}function jc(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Ft(""+e)}function Gc(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Hc=0;Hc<Ia.length;Hc++){var qc=Ia[Hc];Na(qc.toLowerCase(),"on"+(qc[0].toUpperCase()+qc.slice(1)))}Na(ga,"onAnimationEnd"),Na(ya,"onAnimationIteration"),Na(ba,"onAnimationStart"),Na("dblclick","onDoubleClick"),Na("focusin","onFocus"),Na("focusout","onBlur"),Na(va,"onTransitionRun"),Na(xa,"onTransitionStart"),Na(wa,"onTransitionCancel"),Na(ka,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xc=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kc));function Yc(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var s=a.length-1;0<=s;s--){var o=a[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=u;try{i(r)}catch(c){Ta(c)}r.currentTarget=null,i=l}else for(s=0;s<a.length;s++){if(l=(o=a[s]).instance,u=o.currentTarget,o=o.listener,l!==i&&r.isPropagationStopped())break e;i=o,r.currentTarget=u;try{i(r)}catch(c){Ta(c)}r.currentTarget=null,i=l}}}}function Qc(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var a=e+"__bubble";n.has(a)||(ed(t,e,2,!1),n.add(a))}function Jc(e,t,n){var a=0;t&&(a|=4),ed(n,e,a,t)}var Zc="_reactListening"+Math.random().toString(36).slice(2);function $c(e){if(!e[Zc]){e[Zc]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Xc.has(t)||Jc(t,!1,e),Jc(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Zc]||(t[Zc]=!0,Jc("selectionchange",!1,t))}}function ed(e,t,n,a){switch(Th(t)){case 2:var r=xh;break;case 8:r=wh;break;default:r=kh}n=r.bind(null,t,n,e),r=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function td(e,t,n,a,r){var i=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var s=a.tag;if(3===s||4===s){var o=a.stateNode.containerInfo;if(o===r)break;if(4===s)for(s=a.return;null!==s;){var u=s.tag;if((3===u||4===u)&&s.stateNode.containerInfo===r)return;s=s.return}for(;null!==o;){if(null===(s=Qe(o)))return;if(5===(u=s.tag)||6===u||26===u||27===u){a=i=s;continue e}o=o.parentNode}}a=a.return}Bt(function(){var a=i,r=Mt(n),s=[];e:{var o=Sa.get(e);if(void 0!==o){var u=nn,c=e;switch(e){case"keypress":if(0===Xt(n))break e;case"keydown":case"keyup":u=bn;break;case"focusin":c="focus",u=un;break;case"focusout":c="blur",u=un;break;case"beforeblur":case"afterblur":u=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=on;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=xn;break;case ga:case ya:case ba:u=cn;break;case ka:u=wn;break;case"scroll":case"scrollend":u=rn;break;case"wheel":u=kn;break;case"copy":case"cut":case"paste":u=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=vn;break;case"toggle":case"beforetoggle":u=Sn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==o?o+"Capture":null:o;d=[];for(var f,m=a;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Wt(m,p))&&d.push(nd(m,g,f)),h)break;m=m.return}0<d.length&&(o=new u(o,c,null,n,r),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Dt||!(c=n.relatedTarget||n.fromElement)||!Qe(c)&&!c[je])&&(u||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,u?(u=a,null!==(c=(c=n.relatedTarget||n.toElement)?Qe(c):null)&&(h=l(c),d=c.tag,c!==h||5!==d&&27!==d&&6!==d)&&(c=null)):(u=null,c=a),u!==c)){if(d=on,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=vn,g="onPointerLeave",p="onPointerEnter",m="pointer"),h=null==u?o:Ze(u),f=null==c?o:Ze(c),(o=new d(g,m+"leave",u,n,r)).target=h,o.relatedTarget=f,g=null,Qe(r)===a&&((d=new d(p,m+"enter",c,n,r)).target=f,d.relatedTarget=h,g=d),h=g,u&&c)e:{for(d=rd,m=c,f=0,g=p=u;g;g=d(g))f++;g=0;for(var y=m;y;y=d(y))g++;for(;0<f-g;)p=d(p),f--;for(;0<g-f;)m=d(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){d=p;break e}p=d(p),m=d(m)}d=null}else d=null;null!==u&&id(s,o,u,d,!1),null!==c&&null!==h&&id(s,h,c,d,!0)}if("select"===(u=(o=a?Ze(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===u&&"file"===o.type)var b=Vn;else if(On(o))if(Un)b=Jn;else{b=Yn;var v=Xn}else!(u=o.nodeName)||"input"!==u.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?a&&Et(a.elementType)&&(b=Vn):b=Qn;switch(b&&(b=b(e,a))?Pn(s,b,n,r):(v&&v(e,o,a),"focusout"===e&&a&&"number"===o.type&&null!=a.memoizedProps.value&&xt(o,"number",o.value)),v=a?Ze(a):window,e){case"focusin":(On(v)||"true"===v.contentEditable)&&(sa=v,oa=a,la=null);break;case"focusout":la=oa=sa=null;break;case"mousedown":ua=!0;break;case"contextmenu":case"mouseup":case"dragend":ua=!1,ca(s,n,r);break;case"selectionchange":if(ia)break;case"keydown":case"keyup":ca(s,n,r)}var x;if(Nn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Dn?Fn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(En&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Dn&&(x=Kt()):(Ht="value"in(Gt=r)?Gt.value:Gt.textContent,Dn=!0)),0<(v=ad(a,w)).length&&(w=new hn(w,e,null,n,r),s.push({event:w,listeners:v}),x?w.data=x:null!==(x=Rn(n))&&(w.data=x))),(x=Cn?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(An=!0,_n);case"textInput":return(e=t.data)===_n&&An?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!Nn&&Fn(e,t)?(e=Kt(),qt=Ht=Gt=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=ad(a,"onBeforeInput")).length&&(v=new hn("onBeforeInput","beforeinput",null,n,r),s.push({event:v,listeners:w}),v.data=x)),function(e,t,n,a,r){if("submit"===t&&n&&n.stateNode===r){var i=jc((r[Ue]||null).action),s=a.submitter;s&&null!==(t=(t=s[Ue]||null)?jc(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var o=new nn("action","action",null,a,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==Mc){var e=s?Gc(r,s):new FormData(r);eo(n,{pending:!0,data:e,method:r.method,action:i},null,e)}}else"function"===typeof i&&(o.preventDefault(),e=s?Gc(r,s):new FormData(r),eo(n,{pending:!0,data:e,method:r.method,action:i},i,e))},currentTarget:r}]})}}(s,e,a,n,r)}Yc(s,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ad(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,i=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===i||(null!=(r=Wt(e,n))&&a.unshift(nd(e,r,i)),null!=(r=Wt(e,t))&&a.push(nd(e,r,i))),3===e.tag)return a;e=e.return}return[]}function rd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function id(e,t,n,a,r){for(var i=t._reactName,s=[];null!==n&&n!==a;){var o=n,l=o.alternate,u=o.stateNode;if(o=o.tag,null!==l&&l===a)break;5!==o&&26!==o&&27!==o||null===u||(l=u,r?null!=(u=Wt(n,i))&&s.unshift(nd(n,u,l)):r||null!=(u=Wt(n,i))&&s.push(nd(n,u,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var sd=/\r\n?/g,od=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(sd,"\n").replace(od,"")}function ud(e,t){return t=ld(t),ld(e)===t}function cd(e,t,n,a,r,i){switch(n){case"children":"string"===typeof a?"body"===t||"textarea"===t&&""===a||It(e,a):("number"===typeof a||"bigint"===typeof a)&&"body"!==t&&It(e,""+a);break;case"className":ut(e,"class",a);break;case"tabIndex":ut(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":ut(e,n,a);break;case"style":Ct(e,a,i);break;case"data":if("object"!==t){ut(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"===typeof a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=Ft(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"===typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&cd(e,t,"name",r.name,r,null),cd(e,t,"formEncType",r.formEncType,r,null),cd(e,t,"formMethod",r.formMethod,r,null),cd(e,t,"formTarget",r.formTarget,r,null)):(cd(e,t,"encType",r.encType,r,null),cd(e,t,"method",r.method,r,null),cd(e,t,"target",r.target,r,null))),null==a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=Ft(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=Rt);break;case"onScroll":null!=a&&Qc("scroll",e);break;case"onScrollEnd":null!=a&&Qc("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(s(61));if(null!=(n=a.__html)){if(null!=r.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"muted":e.muted=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"===typeof a||"boolean"===typeof a||"symbol"===typeof a){e.removeAttribute("xlink:href");break}n=Ft(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":null==a||"function"===typeof a||"symbol"===typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Qc("beforetoggle",e),Qc("toggle",e),lt(e,"popover",a);break;case"xlinkActuate":ct(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":ct(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":ct(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":ct(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":ct(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":ct(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":ct(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":ct(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":ct(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":lt(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=_t.get(n)||n,a)}}function dd(e,t,n,a,r,i){switch(n){case"style":Ct(e,a,i);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(s(61));if(null!=(n=a.__html)){if(null!=r.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof a?It(e,a):("number"===typeof a||"bigint"===typeof a)&&It(e,""+a);break;case"onScroll":null!=a&&Qc("scroll",e);break;case"onScrollEnd":null!=a&&Qc("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(i=null!=(i=e[Ue]||null)?i[n]:null)&&e.removeEventListener(t,i,r),"function"!==typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):lt(e,n,a):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,r)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qc("error",e),Qc("load",e);var a,r=!1,i=!1;for(a in n)if(n.hasOwnProperty(a)){var o=n[a];if(null!=o)switch(a){case"src":r=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:cd(e,t,a,o,n,null)}}return i&&cd(e,t,"srcSet",n.srcSet,n,null),void(r&&cd(e,t,"src",n.src,n,null));case"input":Qc("invalid",e);var l=a=o=i=null,u=null,c=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":i=d;break;case"type":o=d;break;case"checked":u=d;break;case"defaultChecked":c=d;break;case"value":a=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:cd(e,t,r,d,n,null)}}return void vt(e,a,l,u,c,o,i,!1);case"select":for(i in Qc("invalid",e),r=o=a=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":a=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:cd(e,t,i,l,n,null)}return t=a,n=o,e.multiple=!!r,void(null!=t?wt(e,!!r,t,!1):null!=n&&wt(e,!!r,n,!0));case"textarea":for(o in Qc("invalid",e),a=i=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":i=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:cd(e,t,o,l,n,null)}return void St(e,r,i,a);case"option":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))if("selected"===u)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else cd(e,t,u,r,n,null);return;case"dialog":Qc("beforetoggle",e),Qc("toggle",e),Qc("cancel",e),Qc("close",e);break;case"iframe":case"object":Qc("load",e);break;case"video":case"audio":for(r=0;r<Kc.length;r++)Qc(Kc[r],e);break;case"image":Qc("error",e),Qc("load",e);break;case"details":Qc("toggle",e);break;case"embed":case"source":case"link":Qc("error",e),Qc("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:cd(e,t,c,r,n,null)}return;default:if(Et(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(r=n[d])&&dd(e,t,d,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&cd(e,t,l,r,n,null))}function pd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fd=null,md=null;function gd(e){return 9===e.nodeType?e:e.ownerDocument}function yd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function vd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xd=null;var wd="function"===typeof setTimeout?setTimeout:void 0,kd="function"===typeof clearTimeout?clearTimeout:void 0,Sd="function"===typeof Promise?Promise:void 0,Id="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Sd?function(e){return Sd.resolve(null).then(e).catch(Nd)}:wd;function Nd(e){setTimeout(function(){throw e})}function Td(e){return"head"===e}function Cd(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===a)return e.removeChild(r),void Gh(t);a--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)a++;else if("html"===n)zd(e.ownerDocument.documentElement);else if("head"===n){zd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var s=i.nextSibling,o=i.nodeName;i[Xe]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=s}}else"body"===n&&zd(e.ownerDocument.body);n=r}while(n);Gh(t)}function Ed(e,t){var n=e;e=0;do{var a=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=a}while(n)}function _d(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":_d(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Ad(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}function Fd(e){return"$?"===e.data||"$~"===e.data}function Rd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Dd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Md=null;function Od(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Dd(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Pd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Ld(e,t,n){switch(t=gd(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function zd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var Bd=new Map,Wd=new Set;function Vd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Ud=O.d;O.d={f:function(){var e=Ud.f(),t=$u();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?no(t):Ud.r(e)},D:function(e){Ud.D(e),Gd("dns-prefetch",e,null)},C:function(e,t){Ud.C(e,t),Gd("preconnect",e,t)},L:function(e,t,n){Ud.L(e,t,n);var a=jd;if(a&&e&&t){var r='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+yt(n.imageSizes)+'"]')):r+='[href="'+yt(e)+'"]';var i=r;switch(t){case"style":i=qd(e);break;case"script":i=Yd(e)}Bd.has(i)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Bd.set(i,e),null!==a.querySelector(r)||"style"===t&&a.querySelector(Kd(i))||"script"===t&&a.querySelector(Qd(i))||(hd(t=a.createElement("link"),"link",e),et(t),a.head.appendChild(t)))}},m:function(e,t){Ud.m(e,t);var n=jd;if(n&&e){var a=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+yt(a)+'"][href="'+yt(e)+'"]',i=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Yd(e)}if(!Bd.has(i)&&(e=p({rel:"modulepreload",href:e},t),Bd.set(i,e),null===n.querySelector(r))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Qd(i)))return}hd(a=n.createElement("link"),"link",e),et(a),n.head.appendChild(a)}}},X:function(e,t){Ud.X(e,t);var n=jd;if(n&&e){var a=$e(n).hoistableScripts,r=Yd(e),i=a.get(r);i||((i=n.querySelector(Qd(r)))||(e=p({src:e,async:!0},t),(t=Bd.get(r))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}},S:function(e,t,n){Ud.S(e,t,n);var a=jd;if(a&&e){var r=$e(a).hoistableStyles,i=qd(e);t=t||"default";var s=r.get(i);if(!s){var o={loading:0,preload:null};if(s=a.querySelector(Kd(i)))o.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Bd.get(i))&&$d(e,n);var l=s=a.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Zd(s,t,a)}s={type:"stylesheet",instance:s,count:1,state:o},r.set(i,s)}}},M:function(e,t){Ud.M(e,t);var n=jd;if(n&&e){var a=$e(n).hoistableScripts,r=Yd(e),i=a.get(r);i||((i=n.querySelector(Qd(r)))||(e=p({src:e,async:!0,type:"module"},t),(t=Bd.get(r))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(r,i))}}};var jd="undefined"===typeof document?null:document;function Gd(e,t,n){var a=jd;if(a&&"string"===typeof t&&t){var r=yt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),Wd.has(r)||(Wd.add(r),e={rel:e,crossOrigin:n,href:t},null===a.querySelector(r)&&(hd(t=a.createElement("link"),"link",e),et(t),a.head.appendChild(t)))}}function Hd(e,t,n,a){var r,i,o,l,u=(u=q.current)?Vd(u):null;if(!u)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=qd(n.href),(a=(n=$e(u).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=qd(n.href);var c=$e(u).hoistableStyles,d=c.get(e);if(d||(u=u.ownerDocument||u,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=u.querySelector(Kd(e)))&&!c._p&&(d.instance=c,d.state.loading=5),Bd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Bd.set(e,n),c||(r=u,i=e,o=n,l=d.state,r.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=r.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),hd(i,"link",o),et(i),r.head.appendChild(i))))),t&&null===a)throw Error(s(528,""));return d}if(t&&null!==a)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Yd(n),(a=(n=$e(u).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function qd(e){return'href="'+yt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function Xd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Yd(e){return'[src="'+yt(e)+'"]'}function Qd(e){return"script[async]"+e}function Jd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(a)return t.instance=a,et(a),a;var r=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(a=(e.ownerDocument||e).createElement("style")),hd(a,"style",r),Zd(a,n.precedence,e),t.instance=a;case"stylesheet":r=qd(n.href);var i=e.querySelector(Kd(r));if(i)return t.state.loading|=4,t.instance=i,et(i),i;a=Xd(n),(r=Bd.get(r))&&$d(a,r),et(i=(e.ownerDocument||e).createElement("link"));var o=i;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hd(i,"link",a),t.state.loading|=4,Zd(i,n.precedence,e),t.instance=i;case"script":return i=Yd(n.src),(r=e.querySelector(Qd(i)))?(t.instance=r,et(r),r):(a=n,(r=Bd.get(i))&&eh(a=p({},n),r),et(r=(e=e.ownerDocument||e).createElement("script")),hd(r,"link",a),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Zd(a,n.precedence,e));return t.instance}function Zd(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,i=r,s=0;s<a.length;s++){var o=a[s];if(o.dataset.precedence===t)i=o;else if(i!==r)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function $d(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var a=new Map,r=th=new Map;r.set(n,a)}else(a=(r=th).get(n))||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var i=n[r];if(!(i[Xe]||i[Ve]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var o=a.get(s);o?o.push(i):a.set(s,[i])}}return a}function ah(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function rh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ih=0;function sh(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var oh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,oh=new Map,t.forEach(uh,e),oh=null,sh.call(e))}function uh(e,t){if(!(4&t.state.loading)){var n=oh.get(e);if(n)var a=n.get(null);else{n=new Map,oh.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<r.length;i++){var s=r[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),a=s)}a&&n.set(null,a)}s=(r=t.instance).getAttribute("data-precedence"),(i=n.get(s)||a)===a&&n.set(null,r),n.set(s,r),this.count++,a=sh.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),i?i.parentNode.insertBefore(r,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var ch={$$typeof:w,Provider:null,Consumer:null,_currentValue:P,_currentValue2:P,_threadCount:0};function dh(e,t,n,a,r,i,s,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fe(0),this.hiddenUpdates=Fe(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,a,r,i,s,o,l,u,c,d){return e=new dh(e,t,n,s,l,u,c,d,o),t=1,!0===i&&(t|=24),i=za(3,null,null,t),e.current=i,i.stateNode=e,(t=Br()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:a,isDehydrated:n,cache:t},gi(i),e}function ph(e){return e?e=Pa:Pa}function fh(e,t,n,a,r,i){r=ph(r),null===a.context?a.context=r:a.pendingContext=r,(a=bi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(a.callback=i),null!==(n=vi(e,a,t))&&(Xu(n,0,t),xi(n,e,t))}function mh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gh(e,t){mh(e,t),(e=e.alternate)&&mh(e,t)}function yh(e){if(13===e.tag||31===e.tag){var t=Da(e,67108864);null!==t&&Xu(t,0,67108864),gh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=qu(),n=Da(e,t=Pe(t));null!==n&&Xu(n,0,t),gh(e,t)}}var vh=!0;function xh(e,t,n,a){var r=M.T;M.T=null;var i=O.p;try{O.p=2,kh(e,t,n,a)}finally{O.p=i,M.T=r}}function wh(e,t,n,a){var r=M.T;M.T=null;var i=O.p;try{O.p=8,kh(e,t,n,a)}finally{O.p=i,M.T=r}}function kh(e,t,n,a){if(vh){var r=Sh(a);if(null===r)td(e,t,a,Ih,n),Oh(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return Eh=Ph(Eh,e,t,n,a,r),!0;case"dragenter":return _h=Ph(_h,e,t,n,a,r),!0;case"mouseover":return Ah=Ph(Ah,e,t,n,a,r),!0;case"pointerover":var i=r.pointerId;return Fh.set(i,Ph(Fh.get(i)||null,e,t,n,a,r)),!0;case"gotpointercapture":return i=r.pointerId,Rh.set(i,Ph(Rh.get(i)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(Oh(e,a),4&t&&-1<Mh.indexOf(e)){for(;null!==r;){var i=Je(r);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=Te(i.pendingLanes);if(0!==s){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-xe(s);o.entanglements[1]|=l,s&=~l}Oc(i),0===(6&pu)&&(Mu=le()+500,Pc(0,!1))}}break;case 31:case 13:null!==(o=Da(i,2))&&Xu(o,0,2),$u(),gh(i,2)}if(null===(i=Sh(a))&&td(e,t,a,Ih,n),i===r)break;r=i}null!==r&&a.stopPropagation()}else td(e,t,a,null,n)}}function Sh(e){return Nh(e=Mt(e))}var Ih=null;function Nh(e){if(Ih=null,null!==(e=Qe(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=u(t)))return e;e=null}else if(31===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ih=e,null}function Th(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case ce:return 2;case de:return 8;case he:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Ch=!1,Eh=null,_h=null,Ah=null,Fh=new Map,Rh=new Map,Dh=[],Mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Oh(e,t){switch(e){case"focusin":case"focusout":Eh=null;break;case"dragenter":case"dragleave":_h=null;break;case"mouseover":case"mouseout":Ah=null;break;case"pointerover":case"pointerout":Fh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rh.delete(t.pointerId)}}function Ph(e,t,n,a,r,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:i,targetContainers:[r]},null!==t&&(null!==(t=Je(t))&&yh(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lh(e){var t=Qe(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=u(n)))return e.blockedOn=t,void Be(e.priority,function(){bh(n)})}else if(31===t){if(null!==(t=c(n)))return e.blockedOn=t,void Be(e.priority,function(){bh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Sh(e.nativeEvent);if(null!==n)return null!==(t=Je(n))&&yh(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);Dt=a,n.target.dispatchEvent(a),Dt=null,t.shift()}return!0}function Bh(e,t,n){zh(e)&&n.delete(t)}function Wh(){Ch=!1,null!==Eh&&zh(Eh)&&(Eh=null),null!==_h&&zh(_h)&&(_h=null),null!==Ah&&zh(Ah)&&(Ah=null),Fh.forEach(Bh),Rh.forEach(Bh)}function Vh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ch||(Ch=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Wh)))}var Uh=null;function jh(e){Uh!==e&&(Uh=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Uh===e&&(Uh=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],r=e[t+2];if("function"!==typeof a){if(null===Nh(a||n))continue;break}var i=Je(n);null!==i&&(e.splice(t,3),t-=3,eo(i,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function Gh(e){function t(t){return Vh(t,e)}null!==Eh&&Vh(Eh,e),null!==_h&&Vh(_h,e),null!==Ah&&Vh(Ah,e),Fh.forEach(t),Rh.forEach(t);for(var n=0;n<Dh.length;n++){var a=Dh[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Dh.length&&null===(n=Dh[0]).blockedOn;)Lh(n),null===n.blockedOn&&Dh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<n.length;a+=3){var r=n[a],i=n[a+1],s=r[Ue]||null;if("function"===typeof i)s||jh(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(r=i,s=i[Ue]||null)o=s.formAction;else if(null!==Nh(r))continue}else o=s.action;"function"===typeof o?n[a+1]=o:(n.splice(a,3),a-=3),jh(n)}}}function Hh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),a||setTimeout(n,20)}function n(){if(!a&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var a=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function qh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=qh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));fh(t.current,qu(),e,t,null,null)},Kh.prototype.unmount=qh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fh(e.current,2,null,e,null,null),$u(),t[je]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=ze();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dh.length&&0!==t&&t<Dh[n].priority;n++);Dh.splice(n,0,e),0===n&&Lh(e)}};var Xh=r.version;if("19.2.0"!==Xh)throw Error(s(527,Xh,"19.2.0"));O.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(a=r.return)){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return d(r),e;if(i===a)return d(r),t;i=i.sibling}throw Error(s(188))}if(n.return!==a.return)n=r,a=i;else{for(var o=!1,u=r.child;u;){if(u===n){o=!0,n=r,a=i;break}if(u===a){o=!0,a=r,n=i;break}u=u.sibling}if(!o){for(u=i.child;u;){if(u===n){o=!0,n=i,a=r;break}if(u===a){o=!0,a=i,n=r;break}u=u.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==a)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Yh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qh.isDisabled&&Qh.supportsFiber)try{ye=Qh.inject(Yh),be=Qh}catch(Zh){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,a="",r=Io,i=No,l=To;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,a,null,r,i,l,Hh),e[je]=t.current,$c(e),new qh(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var a=!1,r="",i=Io,l=No,u=To,c=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(u=n.onRecoverableError),void 0!==n.formState&&(c=n.formState)),(t=hh(e,1,!0,t,0,a,r,c,i,l,u,Hh)).context=ph(null),n=t.current,(r=bi(a=Pe(a=qu()))).callback=null,vi(n,r,a),n=a,t.current.lanes=n,Re(t,n),Oc(t),e[je]=t.current,$c(e),new Kh(t)},t.version="19.2.0"},43:(e,t,n)=>{"use strict";e.exports=n(288)},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function b(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function v(){}function x(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=b.prototype;var w=x.prototype=new v;w.constructor=x,g(w,b.prototype),w.isPureReactComponent=!0;var k=Array.isArray;function S(){}var I={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function T(e,t,a){var r=a.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:a}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,r,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,u,c=!1;if(null===e)c=!0;else switch(o){case"bigint":case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case a:c=!0;break;case h:return A((c=e._init)(e._payload),t,r,i,s)}}if(c)return s=s(e),c=""===i?"."+_(e,0):i,k(s)?(r="",null!=c&&(r=c.replace(E,"$&/")+"/"),A(s,t,r,"",function(e){return e})):null!=s&&(C(s)&&(l=s,u=r+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+c,s=T(l.type,u,l.props)),t.push(s)),1;c=0;var d,p=""===i?".":i+":";if(k(e))for(var m=0;m<e.length;m++)c+=A(i=e[m],t,r,o=p+_(i,m),s);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(i=e.next()).done;)c+=A(i=i.value,t,r,o=p+_(i,m++),s);else if("object"===o){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return c}function F(e,t,n){if(null==e)return e;var a=[],r=0;return A(e,a,"","",function(e){return t.call(n,e,r++)}),a}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},M={map:F,forEach:function(e,t,n){F(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return F(e,function(){t++}),t},toArray:function(e){return F(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=M,t.Component=b,t.Fragment=r,t.Profiler=s,t.PureComponent=x,t.StrictMode=i,t.Suspense=c,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return I.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var a=g({},e.props),r=e.key;if(null!=t)for(i in void 0!==t.key&&(r=""+t.key),t)!N.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(a[i]=t[i]);var i=arguments.length-2;if(1===i)a.children=n;else if(1<i){for(var s=Array(i),o=0;o<i;o++)s[o]=arguments[o+2];a.children=s}return T(e.type,r,a)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var a,r={},i=null;if(null!=t)for(a in void 0!==t.key&&(i=""+t.key),t)N.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(r[a]=t[a]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];r.children=o}if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===r[a]&&(r[a]=s[a]);return T(e,i,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.T,n={};I.T=n;try{var a=e(),r=I.S;null!==r&&r(n,a),"object"===typeof a&&null!==a&&"function"===typeof a.then&&a.then(S,D)}catch(i){D(i)}finally{null!==t&&null!==n.types&&(t.types=n.types),I.T=t}},t.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},t.use=function(e){return I.H.use(e)},t.useActionState=function(e,t,n){return I.H.useActionState(e,t,n)},t.useCallback=function(e,t){return I.H.useCallback(e,t)},t.useContext=function(e){return I.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return I.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return I.H.useEffect(e,t)},t.useEffectEvent=function(e){return I.H.useEffectEvent(e)},t.useId=function(){return I.H.useId()},t.useImperativeHandle=function(e,t,n){return I.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.H.useMemo(e,t)},t.useOptimistic=function(e,t){return I.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return I.H.useReducer(e,t,n)},t.useRef=function(e){return I.H.useRef(e)},t.useState=function(e){return I.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.H.useTransition()},t.version="19.2.0"},291:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=291,e.exports=t},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{"use strict";e.exports=n(799)},672:(e,t,n)=>{"use strict";var a=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(r(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,a=u(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:a,integrity:r,fetchPriority:i}):"script"===n&&s.d.X(e,{crossOrigin:a,integrity:r,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=u(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,a=u(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=u(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(e,t,a){var r=null;if(void 0!==a&&(r=""+a),void 0!==t.key&&(r=""+t.key),"key"in t)for(var i in a={},t)"key"!==i&&(a[i]=t[i]);else a=t;return t=a.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:a}}t.Fragment=a,t.jsx=r,t.jsxs=r},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<i(r,t)))break e;e[a]=t,e[n]=r,n=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,s=r>>>1;a<s;){var o=2*(a+1)-1,l=e[o],u=o+1,c=e[u];if(0>i(l,n))u<r&&0>i(c,l)?(e[a]=c,e[u]=n,a=u):(e[a]=l,e[o]=n,a=o);else{if(!(u<r&&0>i(c,n)))break e;e[a]=c,e[u]=n,a=u}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=a(c);null!==t;){if(null===t.callback)r(c);else{if(!(t.startTime<=e))break;r(c),t.sortIndex=t.expirationTime,n(u,t)}t=a(c)}}function k(e){if(g=!1,w(e),!m)if(null!==a(u))m=!0,I||(I=!0,S());else{var t=a(c);null!==t&&R(k,t.startTime-e)}}var S,I=!1,N=-1,T=5,C=-1;function E(){return!!y||!(t.unstable_now()-C<T)}function _(){if(y=!1,I){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,v(N),N=-1),f=!0;var i=p;try{t:{for(w(e),h=a(u);null!==h&&!(h.expirationTime>e&&E());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),n=!0;break t}h===a(u)&&r(u),w(e)}else r(u);h=a(u)}if(null!==h)n=!0;else{var l=a(c);null!==l&&R(k,l.startTime-e),n=!1}}break e}finally{h=null,p=i,f=!1}n=void 0}}finally{n?S():I=!1}}}if("function"===typeof x)S=function(){x(_)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,F=A.port2;A.port1.onmessage=_,S=function(){F.postMessage(null)}}else S=function(){b(_,0)};function R(e,n){N=b(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(c,e),null===a(u)&&e===a(c)&&(g?(v(N),N=-1):g=!0,R(k,i-s))):(e.sortIndex=o,n(u,e),m||f||(m=!0,I||(I=!0,S()))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,n.amdO={},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"static/js/"+e+".65454859.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="learnlens:";n.l=(a,r,i,s)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==i)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=a),e[a]=[r];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.p="/LearnLens/",(()=>{var e={792:0};n.f.j=(t,a)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var i=new Promise((n,a)=>r=e[t]=[n,a]);a.push(r[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,a=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,r[1](o)}},"chunk-"+t,t)}};var t=(t,a)=>{var r,i,[s,o,l]=a,u=0;if(s.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(a);u<s.length;u++)i=s[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},a=self.webpackChunklearnlens=self.webpackChunklearnlens||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),(()=>{"use strict";var e=n(43),t=n(391);function a(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const u=["sri"],c=["page"],d=["page","matches"],h=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],p=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],f=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var m="popstate";function g(){return S(function(e,t){let{pathname:n="/",search:a="",hash:r=""}=k(e.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),x("",{pathname:n,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let n=e.document.querySelector("base"),a="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");a=-1===n?t:t.slice(0,n)}return a+"#"+("string"===typeof t?t:w(t))},function(e,t){b("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push(".concat(JSON.stringify(t),")"))},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function y(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function b(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Xm){}}}function v(e,t){return{usr:e.state,key:e.key,idx:t}}function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return l(l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?k(t):t),{},{state:n,key:t&&t.key||a||Math.random().toString(36).substring(2,10)})}function w(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function k(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function S(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:i=!1}=a,s=r.history,o="POP",u=null,c=d();function d(){return(s.state||{idx:null}).idx}function h(){o="POP";let e=d(),t=null==e?null:e-c;c=e,u&&u({action:o,location:f.location,delta:t})}function p(e){return I(e)}null==c&&(c=0,s.replaceState(l(l({},s.state),{},{idx:c}),""));let f={get action(){return o},get location(){return e(r,s)},listen(e){if(u)throw new Error("A history only accepts one active listener");return r.addEventListener(m,h),u=e,()=>{r.removeEventListener(m,h),u=null}},createHref:e=>t(r,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let a=x(f.location,e,t);n&&n(a,e),c=d()+1;let l=v(a,c),h=f.createHref(a);try{s.pushState(l,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(h)}i&&u&&u({action:o,location:f.location,delta:1})},replace:function(e,t){o="REPLACE";let a=x(f.location,e,t);n&&n(a,e),c=d();let r=v(a,c),l=f.createHref(a);s.replaceState(r,"",l),i&&u&&u({action:o,location:f.location,delta:0})},go:e=>s.go(e)};return f}function I(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),y(n,"No window.location.(origin|href) available to create URL");let a="string"===typeof e?e:w(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}new WeakMap;function N(e,t){return T(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function T(e,t,n,a){let r=V(("string"===typeof t?k(t):t).pathname||"/",n);if(null==r)return null;let i=C(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=W(r);s=L(i[o],e,a)}return s}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=function(e,i){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(a)&&s)return;y(l.relativePath.startsWith(a),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(a,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(a.length)}let u=q([a,l.relativePath]),c=n.concat(l);e.children&&e.children.length>0&&(y(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(u,'".')),C(e.children,t,c,u,s)),(null!=e.path||e.index)&&t.push({path:u,score:P(u,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let a of E(e.path))i(e,t,!0,a);else i(e,t)}),t}function E(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===a.length)return r?[i,""]:[i];let s=E(a.join("/")),o=[];return o.push(...s.map(e=>""===e?i:[i,e].join("/"))),r&&o.push(...s),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var _=/^:[\w-]+$/,A=3,F=2,R=1,D=10,M=-2,O=e=>"*"===e;function P(e,t){let n=e.split("/"),a=n.length;return n.some(O)&&(a+=M),t&&(a+=F),n.filter(e=>!O(e)).reduce((e,t)=>e+(_.test(t)?A:""===t?R:D),a)}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,r={},i="/",s=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,u="/"===i?t:t.slice(i.length)||"/",c=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),d=e.route;if(!c&&l&&n&&!a[a.length-1].route.index&&(c=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(r,c.params),s.push({params:r,pathname:q([i,c.pathname]),pathnameBase:K(q([i,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(i=q([i,c.pathnameBase]))}return s}function z(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=B(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],s=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:a.reduce((e,t,n)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[a]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:s,pattern:e}}function B(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];b("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function W(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return b(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function U(e,t,n,a){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(a),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function j(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function G(e){let t=j(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function H(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=k(e):(a=l({},e),y(!a.pathname||!a.pathname.includes("?"),U("?","pathname","search",a)),y(!a.pathname||!a.pathname.includes("#"),U("#","pathname","hash",a)),y(!a.search||!a.search.includes("#"),U("#","search","hash",a)));let i,s=""===e||""===a.pathname,o=s?"/":a.pathname;if(null==o)i=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:a="",hash:r=""}="string"===typeof e?k(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:X(a),hash:Y(r)}}(a,i),c=o&&"/"!==o&&o.endsWith("/"),d=(s||"."===o)&&n.endsWith("/");return u.pathname.endsWith("/")||!c&&!d||(u.pathname+="/"),u}var q=e=>e.join("/").replace(/\/\/+/g,"/"),K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),X=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var J=["POST","PUT","PATCH","DELETE"],Z=(new Set(J),["GET",...J]);new Set(Z),Symbol("ResetLoaderData");var $=e.createContext(null);$.displayName="DataRouter";var ee=e.createContext(null);ee.displayName="DataRouterState";var te=e.createContext(!1);var ne=e.createContext({isTransitioning:!1});ne.displayName="ViewTransition";var ae=e.createContext(new Map);ae.displayName="Fetchers";var re=e.createContext(null);re.displayName="Await";var ie=e.createContext(null);ie.displayName="Navigation";var se=e.createContext(null);se.displayName="Location";var oe=e.createContext({outlet:null,matches:[],isDataRoute:!1});oe.displayName="Route";var le=e.createContext(null);le.displayName="RouteError";function ue(){return null!=e.useContext(se)}function ce(){return y(ue(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(se).location}var de="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function he(t){e.useContext(ie).static||e.useLayoutEffect(t)}function pe(){let{isDataRoute:t}=e.useContext(oe);return t?function(){let{router:t}=ke("useNavigate"),n=Ie("useNavigate"),a=e.useRef(!1);he(()=>{a.current=!0});let r=e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(a.current,de),a.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,l({fromRouteId:n},r)))},[t,n]);return r}():function(){y(ue(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext($),{basename:n,navigator:a}=e.useContext(ie),{matches:r}=e.useContext(oe),{pathname:i}=ce(),s=JSON.stringify(G(r)),o=e.useRef(!1);he(()=>{o.current=!0});let l=e.useCallback(function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b(o.current,de),!o.current)return;if("number"===typeof e)return void a.go(e);let l=H(e,JSON.parse(s),i,"path"===r.relative);null==t&&"/"!==n&&(l.pathname="/"===l.pathname?n:q([n,l.pathname])),(r.replace?a.replace:a.push)(l,r.state,r)},[n,a,s,i,t]);return l}()}e.createContext(null);function fe(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:a}=e.useContext(oe),{pathname:r}=ce(),i=JSON.stringify(G(a));return e.useMemo(()=>H(t,JSON.parse(i),r,"path"===n),[t,i,r,n])}function me(t,n,a,r,i){y(ue(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=e.useContext(ie),{matches:o}=e.useContext(oe),u=o[o.length-1],c=u?u.params:{},d=u?u.pathname:"/",h=u?u.pathnameBase:"/",p=u&&u.route;{let e=p&&p.path||"";Ce(d,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=ce();if(n){var g;let e="string"===typeof n?k(n):n;y("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",x=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=N(t,{pathname:x});b(p||null!=w,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),b(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let S=xe(w&&w.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:q([h,s.encodeLocation?s.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:q([h,s.encodeLocation?s.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,a,r,i);return n&&S?e.createElement(se.Provider,{value:{location:l({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},S):S}function ge(){let t=Ne(),n=Q(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:s},"ErrorBoundary")," or"," ",e.createElement("code",{style:s},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),a?e.createElement("pre",{style:i},a):null,o)}var ye=e.createElement(ge,null),be=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?e.createElement(oe.Provider,{value:this.props.routeContext},e.createElement(le.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ve(t){let{routeContext:n,match:a,children:r}=t,i=e.useContext($);return i&&i.static&&i.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=a.route.id),e.createElement(oe.Provider,{value:n},r)}function xe(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!a)return null;if(a.errors)t=a.matches;else{if(0!==n.length||a.initialized||!(a.matches.length>0))return null;t=a.matches}}let i=t,s=null===a||void 0===a?void 0:a.errors;if(null!=s){let e=i.findIndex(e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id]));y(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let o=!1,l=-1;if(a)for(let e=0;e<i.length;e++){let t=i[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=a,r=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){o=!0,i=l>=0?i.slice(0,l+1):[i[0]];break}}}return i.reduceRight((t,u,c)=>{let d,h=!1,p=null,f=null;a&&(d=s&&u.route.id?s[u.route.id]:void 0,p=u.route.errorElement||ye,o&&(l<0&&0===c?(Ce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):l===c&&(h=!0,f=u.route.hydrateFallbackElement||null)));let m=n.concat(i.slice(0,c+1)),g=()=>{let n;return n=d?p:h?f:u.route.Component?e.createElement(u.route.Component,null):u.route.element?u.route.element:t,e.createElement(ve,{match:u,routeContext:{outlet:t,matches:m,isDataRoute:null!=a},children:n})};return a&&(u.route.ErrorBoundary||u.route.errorElement||0===c)?e.createElement(be,{location:a.location,revalidation:a.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function we(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function ke(t){let n=e.useContext($);return y(n,we(t)),n}function Se(t){let n=e.useContext(ee);return y(n,we(t)),n}function Ie(t){let n=function(t){let n=e.useContext(oe);return y(n,we(t)),n}(t),a=n.matches[n.matches.length-1];return y(a.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),a.route.id}function Ne(){var t;let n=e.useContext(le),a=Se("useRouteError"),r=Ie("useRouteError");return void 0!==n?n:null===(t=a.errors)||void 0===t?void 0:t[r]}var Te={};function Ce(e,t,n){t||Te[e]||(Te[e]=!0,b(!1,n))}var Ee={};function _e(e,t){e||Ee[t]||(Ee[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:n,state:a,unstable_onError:r}=e;return me(t,void 0,a,r,n)});function Ae(t){let{to:n,replace:a,state:r,relative:i}=t;y(ue(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=e.useContext(ie);b(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=e.useContext(oe),{pathname:l}=ce(),u=pe(),c=H(n,G(o),l,"path"===i),d=JSON.stringify(c);return e.useEffect(()=>{u(JSON.parse(d),{replace:a,state:r,relative:i})},[u,d,i,a,r]),null}function Fe(e){y(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Re(t){let{basename:n="/",children:a=null,location:r,navigationType:i="POP",navigator:s,static:o=!1}=t;y(!ue(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=e.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);"string"===typeof r&&(r=k(r));let{pathname:c="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=e.useMemo(()=>{let e=V(c,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:i}},[l,c,d,h,p,f,i]);return b(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(c).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:e.createElement(ie.Provider,{value:u},e.createElement(se.Provider,{children:a,value:m}))}function De(e){let{children:t,location:n}=e;return me(Me(t),n)}e.Component;function Me(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[];return e.Children.forEach(t,(t,r)=>{if(!e.isValidElement(t))return;let i=[...n,r];if(t.type===e.Fragment)return void a.push.apply(a,Me(t.props.children,i));y(t.type===Fe,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),y(!t.props.index||!t.props.children,"An index route cannot have child routes.");let s={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,middleware:t.props.middleware,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(s.children=Me(t.props.children,i)),a.push(s)}),a}var Oe="get",Pe="application/x-www-form-urlencoded";function Le(e){return null!=e&&"string"===typeof e.tagName}var ze=null;var Be=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function We(e){return null==e||Be.has(e)?e:(b(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Pe,'"')),null)}function Ve(e,t){let n,a,r,i,s;if(Le(o=e)&&"form"===o.tagName.toLowerCase()){let s=e.getAttribute("action");a=s?V(s,t):null,n=e.getAttribute("method")||Oe,r=We(e.getAttribute("enctype"))||Pe,i=new FormData(e)}else if(function(e){return Le(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Le(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||s.getAttribute("action");if(a=o?V(o,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Oe,r=We(e.getAttribute("formenctype"))||We(s.getAttribute("enctype"))||Pe,i=new FormData(s,e),!function(){if(null===ze)try{new FormData(document.createElement("form"),0),ze=!1}catch(Xm){ze=!0}return ze}()){let{name:t,type:n,value:a}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,a)}}else{if(Le(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Oe,a=null,r=Pe,s=e}var o;return i&&"text/plain"===r&&(s=i,i=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:i,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function Ue(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function je(e,t,n){let a="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname="_root.".concat(n):t&&"/"===V(a.pathname,t)?a.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):a.pathname="".concat(a.pathname.replace(/\/$/,""),".").concat(n),a}async function Ge(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function He(e){return null!=e&&"string"===typeof e.page}function qe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ke(e,t,n,a,r,i){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var a;return n[t].pathname!==e.pathname||(null===(a=n[t].route.path)||void 0===a?void 0:a.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>s(e,t)||o(e,t)):"data"===i?t.filter((t,i)=>{let l=a.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,i)||o(t,i))return!0;if(t.route.shouldRevalidate){var u;let a=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(u=n[0])||void 0===u?void 0:u.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0}):[]}function Xe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let r=[a.module];return a.clientActionModule&&(r=r.concat(a.clientActionModule)),a.clientLoaderModule&&(r=r.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(r=r.concat(a.hydrateFallbackModule)),a.imports&&(r=r.concat(a.imports)),r}).flat(1),[...new Set(a)];var a}function Ye(e,t){let n=new Set,a=new Set(t);return e.reduce((e,r)=>{if(t&&!He(r)&&"script"===r.as&&r.href&&a.has(r.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}(r));return n.has(i)||(n.add(i),e.push({key:i,link:r})),e},[])}function Qe(e,t){return"lazy"===e.mode&&!0===t}function Je(){let t=e.useContext($);return Ue(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Ze(){let t=e.useContext(ee);return Ue(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var $e=e.createContext(void 0);function et(){let t=e.useContext($e);return Ue(t,"You must render this element inside a <HydratedRouter> element"),t}function tt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function nt(e,t,n){if(n&&!st)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}$e.displayName="FrameworkContext";function at(t){let{page:n}=t,r=a(t,c),{router:i}=Je(),s=e.useMemo(()=>N(i.routes,n,i.basename),[i.routes,n,i.basename]);return s?e.createElement(it,l({page:n,matches:s},r)):null}function rt(t){let{manifest:n,routeModules:a}=et(),[r,i]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,n){return Ye((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await Ge(a,n);return e.links?e.links():[]}return[]}))).flat(1).filter(qe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?l(l({},e),{},{rel:"prefetch",as:"style"}):l(l({},e),{},{rel:"prefetch"})))}(t,n,a).then(t=>{e||i(t)}),()=>{e=!0}},[t,n,a]),r}function it(t){let{page:n,matches:r}=t,i=a(t,d),s=ce(),{manifest:o,routeModules:u}=et(),{basename:c}=Je(),{loaderData:h,matches:p}=Ze(),f=e.useMemo(()=>Ke(n,r,p,o,s,"data"),[n,r,p,o,s]),m=e.useMemo(()=>Ke(n,r,p,o,s,"assets"),[n,r,p,o,s]),g=e.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let e=new Set,t=!1;if(r.forEach(n=>{var a;let r=o.routes[n.route.id];r&&r.hasLoader&&(!f.some(e=>e.route.id===n.route.id)&&n.route.id in h&&null!==(a=u[n.route.id])&&void 0!==a&&a.shouldRevalidate||r.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let a=je(n,c,"data");return t&&e.size>0&&a.searchParams.set("_routes",r.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[a.pathname+a.search]},[c,h,s,o,f,r,n,u]),y=e.useMemo(()=>Xe(m,o),[m,o]),b=rt(m);return e.createElement(e.Fragment,null,g.map(t=>e.createElement("link",l({key:t,rel:"prefetch",as:"fetch",href:t},i))),y.map(t=>e.createElement("link",l({key:t,rel:"modulepreload",href:t},i))),b.map(t=>{let{key:n,link:a}=t;return e.createElement("link",l({key:n,nonce:i.nonce},a))}))}var st=!1;function ot(t){let{manifest:n,serverHandoffString:r,isSpaMode:i,renderMeta:s,routeDiscovery:o,ssr:c}=et(),{router:d,static:h,staticContext:p}=Je(),{matches:f}=Ze(),m=e.useContext(te),g=Qe(o,c);s&&(s.didRenderScripts=!0);let y=nt(f,null,i);e.useEffect(()=>{0},[]);let b=e.useMemo(()=>{var i;if(m)return null;let s=p?"window.__reactRouterContext = ".concat(r,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=h?"".concat(null!==n.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(y.map((e,t)=>{let a="route".concat(t),r=n.routes[e.route.id];Ue(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:s,clientMiddlewareModule:o,hydrateFallbackModule:l,module:u}=r,c=[...i?[{module:i,varName:"".concat(a,"_clientAction")}]:[],...s?[{module:s,varName:"".concat(a,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(a,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(a,"_HydrateFallback")}]:[],{module:u,varName:"".concat(a,"_main")}];return 1===c.length?"import * as ".concat(a," from ").concat(JSON.stringify(u),";"):[c.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(a," = {").concat(c.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=a(e,u),i=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(s.pop();s.length>0;)o.push("/".concat(s.join("/"))),s.pop();o.forEach(e=>{let n=N(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let c=[...i].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return l(l({},r),{},{routes:c,sri:!!n||void 0})}(n,d),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(y.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",l(l({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:void 0})),e.createElement("script",l(l({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),v=st||m?[]:(n.entry.imports.concat(Xe(y,n,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let w="object"===typeof n.sri?n.sri:{};return _e(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||m?null:e.createElement(e.Fragment,null,"object"===typeof n.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:e.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:t.crossOrigin,integrity:w[n.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:t.crossOrigin,integrity:w[n.entry.module],suppressHydrationWarning:!0}),v.map(n=>e.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:t.crossOrigin,integrity:w[n],suppressHydrationWarning:!0})),b)}function lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function ut(t){let{error:n,isOutsideRemixApp:a}=t;console.error(n);let r,i=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Q(n))return e.createElement(ct,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),i);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return e.createElement(ct,{title:"Application Error!",isOutsideRemixApp:a},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),i)}function ct(t){var n;let{title:a,renderScripts:r,isOutsideRemixApp:i,children:s}=t,{routeModules:o}=et();return null!==o.root&&void 0!==n&&n.Layout&&!i?s:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,a)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,r?e.createElement(ot,null):null)))}var dt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{dt&&(window.__reactRouterVersion="7.9.5")}catch(Xm){}function ht(t){let{basename:n,children:a,window:r}=t,i=e.useRef();null==i.current&&(i.current=g({window:r,v5Compat:!0}));let s=i.current,[o,l]=e.useState({action:s.action,location:s.location}),u=e.useCallback(t=>{e.startTransition(()=>l(t))},[l]);return e.useLayoutEffect(()=>s.listen(u),[s,u]),e.createElement(Re,{basename:n,children:a,location:o.location,navigationType:o.action,navigator:s})}var pt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ft=e.forwardRef(function(t,n){let r,{onClick:i,discover:s="render",prefetch:o="none",relative:u,reloadDocument:c,replace:d,state:p,target:f,to:m,preventScrollReset:g,viewTransition:v}=t,x=a(t,h),{basename:k}=e.useContext(ie),S="string"===typeof m&&pt.test(m),I=!1;if("string"===typeof m&&S&&(r=m,dt))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=V(t.pathname,k);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:I=!0}catch(Xm){b(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let N=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(ue(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=e.useContext(ie),{hash:i,pathname:s,search:o}=fe(t,{relative:n}),l=s;return"/"!==a&&(l="/"===s?a:q([a,s])),r.createHref({pathname:l,search:o,hash:i})}(m,{relative:u}),[T,C,E]=function(t,n){let a=e.useContext($e),[r,i]=e.useState(!1),[s,o]=e.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:c,onMouseLeave:d,onTouchStart:h}=n,p=e.useRef(null);e.useEffect(()=>{if("render"===t&&o(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{i(!0)},m=()=>{i(!1),o(!1)};return a?"intent"!==t?[s,p,{}]:[s,p,{onFocus:tt(l,f),onBlur:tt(u,m),onMouseEnter:tt(c,f),onMouseLeave:tt(d,m),onTouchStart:tt(h,f)}]:[!1,p,{}]}(o,x),_=function(t){let{target:n,replace:a,state:r,preventScrollReset:i,relative:s,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=pe(),u=ce(),c=fe(t,{relative:s});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,n)){e.preventDefault();let n=void 0!==a?a:w(u)===w(c);l(t,{replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[u,l,c,a,r,n,t,i,s,o])}(m,{replace:d,state:p,target:f,preventScrollReset:g,relative:u,viewTransition:v});let A=e.createElement("a",l(l(l({},x),E),{},{href:r||N,onClick:I||c?i:function(e){i&&i(e),e.defaultPrevented||_(e)},ref:lt(n,C),target:f,"data-discover":S||"render"!==s?void 0:"true"}));return T&&!S?e.createElement(e.Fragment,null,A,e.createElement(at,{page:N})):A});ft.displayName="Link";var mt=e.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:u,to:c,viewTransition:d,children:h}=t,f=a(t,p),m=fe(c,{relative:f.relative}),g=ce(),b=e.useContext(ee),{navigator:v,basename:x}=e.useContext(ie),w=null!=b&&function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.useContext(ne);y(null!=a,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bt("useViewTransitionState"),i=fe(t,{relative:n});if(!a.isTransitioning)return!1;let s=V(a.currentLocation.pathname,r)||a.currentLocation.pathname,o=V(a.nextLocation.pathname,r)||a.nextLocation.pathname;return null!=z(i.pathname,o)||null!=z(i.pathname,s)}(m)&&!0===d,k=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,S=g.pathname,I=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;i||(S=S.toLowerCase(),I=I?I.toLowerCase():null,k=k.toLowerCase()),I&&x&&(I=V(I,x)||I);const N="/"!==k&&k.endsWith("/")?k.length-1:k.length;let T,C=S===k||!o&&S.startsWith(k)&&"/"===S.charAt(N),E=null!=I&&(I===k||!o&&I.startsWith(k)&&"/"===I.charAt(k.length)),_={isActive:C,isPending:E,isTransitioning:w},A=C?r:void 0;T="function"===typeof s?s(_):[s,C?"active":null,E?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let F="function"===typeof u?u(_):u;return e.createElement(ft,l(l({},f),{},{"aria-current":A,className:T,ref:n,style:F,to:c,viewTransition:d}),"function"===typeof h?h(_):h)});mt.displayName="NavLink";var gt=e.forwardRef((t,n)=>{let{discover:r="render",fetcherKey:i,navigate:s,reloadDocument:o,replace:u,state:c,method:d=Oe,action:h,onSubmit:p,relative:m,preventScrollReset:g,viewTransition:b}=t,v=a(t,f),x=wt(),k=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:a}=e.useContext(ie),r=e.useContext(oe);y(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s=l({},fe(t||".",{relative:n})),o=ce();if(null==t){s.search=o.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}t&&"."!==t||!i.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==a&&(s.pathname="/"===s.pathname?a:q([a,s.pathname]));return w(s)}(h,{relative:m}),S="get"===d.toLowerCase()?"get":"post",I="string"===typeof h&&pt.test(h);return e.createElement("form",l(l({ref:n,method:S,action:k,onSubmit:o?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;x(t||e.currentTarget,{fetcherKey:i,method:n,navigate:s,replace:u,state:c,relative:m,preventScrollReset:g,viewTransition:b})}},v),{},{"data-discover":I||"render"!==r?void 0:"true"}))});function yt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function bt(t){let n=e.useContext($);return y(n,yt(t)),n}gt.displayName="Form";var vt=0,xt=()=>"__".concat(String(++vt),"__");function wt(){let{router:t}=bt("useSubmit"),{basename:n}=e.useContext(ie),a=Ie("useRouteId");return e.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:s,encType:o,formData:l,body:u}=Ve(e,n);if(!1===r.navigate){let e=r.fetcherKey||xt();await t.fetch(e,a,r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||s,formEncType:r.encType||o,flushSync:r.flushSync})}else await t.navigate(r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||s,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:a,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,n,a])}const kt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],St=(()=>new Set(kt))(),It=e=>180*e/Math.PI,Nt=e=>{const t=It(Math.atan2(e[1],e[0]));return Ct(t)},Tt={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Nt,rotateZ:Nt,skewX:e=>It(Math.atan(e[1])),skewY:e=>It(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Ct=e=>((e%=360)<0&&(e+=360),e),Et=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),_t=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),At={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Et,scaleY:_t,scale:e=>(Et(e)+_t(e))/2,rotateX:e=>Ct(It(Math.atan2(e[6],e[5]))),rotateY:e=>Ct(It(Math.atan2(-e[2],e[0]))),rotateZ:Nt,rotate:Nt,skewX:e=>It(Math.atan(e[4])),skewY:e=>It(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Ft(e){return e.includes("scale")?1:0}function Rt(e,t){if(!e||"none"===e)return Ft(t);const n=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let a,r;if(n)a=At,r=n;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);a=Tt,r=t}if(!r)return Ft(t);const i=a[t],s=r[1].split(",").map(Dt);return"function"===typeof i?i(s):s[i]}function Dt(e){return parseFloat(e.trim())}const Mt=e=>t=>"string"===typeof t&&t.startsWith(e),Ot=Mt("--"),Pt=Mt("var(--"),Lt=e=>!!Pt(e)&&zt.test(e.split("/*")[0].trim()),zt=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i;function Bt(e){let{top:t,left:n,right:a,bottom:r}=e;return{x:{min:n,max:a},y:{min:t,max:r}}}const Wt=(e,t,n)=>e+(t-e)*n;function Vt(e){return void 0===e||1===e}function Ut(e){let{scale:t,scaleX:n,scaleY:a}=e;return!Vt(t)||!Vt(n)||!Vt(a)}function jt(e){return Ut(e)||Gt(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Gt(e){return Ht(e.x)||Ht(e.y)}function Ht(e){return e&&"0%"!==e}function qt(e,t,n){return n+t*(e-n)}function Kt(e,t,n,a,r){return void 0!==r&&(e=qt(e,r,a)),qt(e,n,a)+t}function Xt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=Kt(e.min,t,n,a,r),e.max=Kt(e.max,t,n,a,r)}function Yt(e,t){let{x:n,y:a}=t;Xt(e.x,n.translate,n.scale,n.originPoint),Xt(e.y,a.translate,a.scale,a.originPoint)}const Qt=.999999999999,Jt=1.0000000000001;function Zt(e,t){e.min=e.min+t,e.max=e.max+t}function $t(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;Xt(e,t,n,Wt(e.min,e.max,r),a)}function en(e,t){$t(e.x,t.x,t.scaleX,t.scale,t.originX),$t(e.y,t.y,t.scaleY,t.scale,t.originY)}function tn(e,t){return Bt(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:a.y,right:a.x}}(e.getBoundingClientRect(),t))}const nn=new Set(["width","height","top","left","right","bottom",...kt]),an=(e,t,n)=>n>t?t:n<e?e:n,rn={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},sn=l(l({},rn),{},{transform:e=>an(0,1,e)}),on=l(l({},rn),{},{default:1}),ln=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),un=ln("deg"),cn=ln("%"),dn=ln("px"),hn=ln("vh"),pn=ln("vw"),fn=(()=>l(l({},cn),{},{parse:e=>cn.parse(e)/100,transform:e=>cn.transform(100*e)}))(),mn=e=>t=>t.test(e),gn=[rn,dn,cn,un,pn,hn,{test:e=>"auto"===e,parse:e=>e}],yn=e=>gn.find(mn(e));const bn=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),vn=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function xn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[a,r]=function(e){const t=vn.exec(e);if(!t)return[,];const[,n,a,r]=t;return["--".concat(null!==n&&void 0!==n?n:a),r]}(e);if(!a)return;const i=window.getComputedStyle(t).getPropertyValue(a);if(i){const e=i.trim();return bn(e)?parseFloat(e):e}return Lt(r)?xn(r,t,n+1):r}const wn=e=>e===rn||e===dn,kn=new Set(["x","y","z"]),Sn=kt.filter(e=>!kn.has(e));const In={width:(e,t)=>{let{x:n}=e,{paddingLeft:a="0",paddingRight:r="0"}=t;return n.max-n.min-parseFloat(a)-parseFloat(r)},height:(e,t)=>{let{y:n}=e,{paddingTop:a="0",paddingBottom:r="0"}=t;return n.max-n.min-parseFloat(a)-parseFloat(r)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:a}=t;return parseFloat(a)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:a}=t;return parseFloat(a)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return Rt(n,"x")},y:(e,t)=>{let{transform:n}=t;return Rt(n,"y")}};In.translateX=In.x,In.translateY=In.y;const Nn=e=>e,Tn={},Cn=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],En={value:null,addProjectionMetrics:null};function _n(e,t){let n=!1,a=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,s=Cn.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,a=new Set,r=!1,i=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function u(t){s.has(t)&&(c.schedule(t),e()),l++,t(o)}const c={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&r?n:a;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&s.add(e),t.has(e)||t.add(e),e},cancel:e=>{a.delete(e),s.delete(e)},process:e=>{o=e,r?i=!0:(r=!0,[n,a]=[a,n],n.forEach(u),t&&En.value&&En.value.frameloop[t].push(l),l=0,n.clear(),r=!1,i&&(i=!1,c.process(e)))}};return c}(i,t?n:void 0),e),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:c,update:d,preRender:h,render:p,postRender:f}=s,m=()=>{const i=Tn.useManualTiming?r.timestamp:performance.now();n=!1,Tn.useManualTiming||(r.delta=a?1e3/60:Math.max(Math.min(i-r.timestamp,40),1)),r.timestamp=i,r.isProcessing=!0,o.process(r),l.process(r),u.process(r),c.process(r),d.process(r),h.process(r),p.process(r),f.process(r),r.isProcessing=!1,n&&t&&(a=!1,e(m))},g=Cn.reduce((t,i)=>{const o=s[i];return t[i]=function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,a=!0,r.isProcessing||e(m)),o.schedule(t,i,s)},t},{});return{schedule:g,cancel:e=>{for(let t=0;t<Cn.length;t++)s[Cn[t]].cancel(e)},state:r,steps:s}}const{schedule:An,cancel:Fn,state:Rn,steps:Dn}=_n("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:Nn,!0),Mn=new Set;let On=!1,Pn=!1,Ln=!1;function zn(){if(Pn){const e=Array.from(Mn).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return Sn.forEach(n=>{const a=e.getValue(n);void 0!==a&&(t.push([n,a.get()]),a.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(t=>{var n;let[a,r]=t;null===(n=e.getValue(a))||void 0===n||n.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}Pn=!1,On=!1,Mn.forEach(e=>e.complete(Ln)),Mn.clear()}function Bn(){Mn.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Pn=!0)})}class Wn{constructor(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=a,this.element=r,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Mn.add(this),On||(On=!0,An.read(Bn),An.resolveKeyframes(zn))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:a}=this;if(null===e[0]){const r=null===a||void 0===a?void 0:a.get(),i=e[e.length-1];if(void 0!==r)e[0]=r;else if(n&&t){const a=n.readValue(t,i);void 0!==a&&null!==a&&(e[0]=a)}void 0===e[0]&&(e[0]=i),a&&void 0===r&&a.set(e[0])}!function(e){for(let n=1;n<e.length;n++){var t;null!==(t=e[n])&&void 0!==t||(e[n]=e[n-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Mn.delete(this)}cancel(){"scheduled"===this.state&&(Mn.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const Vn=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function Un(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||Vn(e))}const jn=e=>Math.round(1e5*e)/1e5,Gn=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const Hn=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,qn=(e,t)=>n=>Boolean("string"===typeof n&&Hn.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),Kn=(e,t,n)=>a=>{if("string"!==typeof a)return a;const[r,i,s,o]=a.match(Gn);return{[e]:parseFloat(r),[t]:parseFloat(i),[n]:parseFloat(s),alpha:void 0!==o?parseFloat(o):1}},Xn=l(l({},rn),{},{transform:e=>Math.round((e=>an(0,255,e))(e))}),Yn={test:qn("rgb","red"),parse:Kn("red","green","blue"),transform:e=>{let{red:t,green:n,blue:a,alpha:r=1}=e;return"rgba("+Xn.transform(t)+", "+Xn.transform(n)+", "+Xn.transform(a)+", "+jn(sn.transform(r))+")"}};const Qn={test:qn("#"),parse:function(e){let t="",n="",a="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),a=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),a=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,a+=a,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(a,16),alpha:r?parseInt(r,16)/255:1}},transform:Yn.transform},Jn={test:qn("hsl","hue"),parse:Kn("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:a,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+cn.transform(jn(n))+", "+cn.transform(jn(a))+", "+jn(sn.transform(r))+")"}},Zn={test:e=>Yn.test(e)||Qn.test(e)||Jn.test(e),parse:e=>Yn.test(e)?Yn.parse(e):Jn.test(e)?Jn.parse(e):Qn.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?Yn.transform(e):Jn.transform(e),getAnimatableNone:e=>{const t=Zn.parse(e);return t.alpha=0,Zn.transform(t)}},$n=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const ea="number",ta="color",na=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function aa(e){const t=e.toString(),n=[],a={color:[],number:[],var:[]},r=[];let i=0;const s=t.replace(na,e=>(Zn.test(e)?(a.color.push(i),r.push(ta),n.push(Zn.parse(e))):e.startsWith("var(")?(a.var.push(i),r.push("var"),n.push(e)):(a.number.push(i),r.push(ea),n.push(parseFloat(e))),++i,"${}")).split("${}");return{values:n,split:s,indexes:a,types:r}}function ra(e){return aa(e).values}function ia(e){const{split:t,types:n}=aa(e),a=t.length;return e=>{let r="";for(let i=0;i<a;i++)if(r+=t[i],void 0!==e[i]){const t=n[i];r+=t===ea?jn(e[i]):t===ta?Zn.transform(e[i]):e[i]}return r}}const sa=e=>"number"===typeof e?0:Zn.test(e)?Zn.getAnimatableNone(e):e;const oa={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(Gn))||void 0===t?void 0:t.length)||0)+((null===(n=e.match($n))||void 0===n?void 0:n.length)||0)>0},parse:ra,createTransformer:ia,getAnimatableNone:function(e){const t=ra(e);return ia(e)(t.map(sa))}},la=new Set(["brightness","contrast","saturate","opacity"]);function ua(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[a]=n.match(Gn)||[];if(!a)return e;const r=n.replace(a,"");let i=la.has(t)?1:0;return a!==n&&(i*=100),t+"("+i+r+")"}const ca=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,da=l(l({},oa),{},{getAnimatableNone:e=>{const t=e.match(ca);return t?t.map(ua).join(" "):e}}),ha=l(l({},rn),{},{transform:Math.round}),pa=l(l({borderWidth:dn,borderTopWidth:dn,borderRightWidth:dn,borderBottomWidth:dn,borderLeftWidth:dn,borderRadius:dn,radius:dn,borderTopLeftRadius:dn,borderTopRightRadius:dn,borderBottomRightRadius:dn,borderBottomLeftRadius:dn,width:dn,maxWidth:dn,height:dn,maxHeight:dn,top:dn,right:dn,bottom:dn,left:dn,padding:dn,paddingTop:dn,paddingRight:dn,paddingBottom:dn,paddingLeft:dn,margin:dn,marginTop:dn,marginRight:dn,marginBottom:dn,marginLeft:dn,backgroundPositionX:dn,backgroundPositionY:dn},{rotate:un,rotateX:un,rotateY:un,rotateZ:un,scale:on,scaleX:on,scaleY:on,scaleZ:on,skew:un,skewX:un,skewY:un,distance:dn,translateX:dn,translateY:dn,translateZ:dn,x:dn,y:dn,z:dn,perspective:dn,transformPerspective:dn,opacity:sn,originX:fn,originY:fn,originZ:dn}),{},{zIndex:ha,fillOpacity:sn,strokeOpacity:sn,numOctaves:ha}),fa=l(l({},pa),{},{color:Zn,backgroundColor:Zn,outlineColor:Zn,fill:Zn,stroke:Zn,borderColor:Zn,borderTopColor:Zn,borderRightColor:Zn,borderBottomColor:Zn,borderLeftColor:Zn,filter:da,WebkitFilter:da}),ma=e=>fa[e];function ga(e,t){let n=ma(e);return n!==da&&(n=oa),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const ya=new Set(["auto","none","0"]);class ba extends Wn{constructor(e,t,n,a,r){super(e,t,n,a,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let n=e[o];if("string"===typeof n&&(n=n.trim(),Lt(n))){const a=xn(n,t.current);void 0!==a&&(e[o]=a),o===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!nn.has(n)||2!==e.length)return;const[a,r]=e,i=yn(a),s=yn(r);if(i!==s)if(wn(i)&&wn(s))for(let o=0;o<e.length;o++){const t=e[o];"string"===typeof t&&(e[o]=parseFloat(t))}else In[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let a=0;a<e.length;a++)(null===e[a]||Un(e[a]))&&n.push(a);n.length&&function(e,t,n){let a,r=0;for(;r<e.length&&!a;){const t=e[r];"string"===typeof t&&!ya.has(t)&&aa(t).values.length&&(a=e[r]),r++}if(a&&n)for(const i of t)e[i]=ga(n,a)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=In[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const a=t[t.length-1];void 0!==a&&e.getValue(n,a).jump(a,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const i=a.length-1,s=a[i];a[i]=In[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[n,a]=e;t.getValue(n).set(a)}),this.resolveNoneKeyframes()}}const va=e=>Boolean(e&&e.getVelocity);let xa;function wa(){xa=void 0}const ka={now:()=>(void 0===xa&&ka.set(Rn.isProcessing||Tn.useManualTiming?Rn.timestamp:performance.now()),xa),set:e=>{xa=e,queueMicrotask(wa)}};function Sa(e,t){-1===e.indexOf(t)&&e.push(t)}function Ia(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Na{constructor(){this.subscriptions=[]}add(e){return Sa(this.subscriptions,e),()=>Ia(this.subscriptions,e)}notify(e,t,n){const a=this.subscriptions.length;if(a)if(1===a)this.subscriptions[0](e,t,n);else for(let r=0;r<a;r++){const a=this.subscriptions[r];a&&a(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Ta(e,t){return t?e*(1e3/t):0}const Ca={current:void 0};class Ea{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=ka.now();var n;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(n=this.events.change)||void 0===n||n.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=ka.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Na);const n=this.events[e].add(t);return"change"===e?()=>{n(),An.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return Ca.current&&Ca.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=ka.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Ta(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function _a(e,t){return new Ea(e,t)}const Aa=[...gn,Zn,oa],{schedule:Fa,cancel:Ra}=_n(queueMicrotask,!1),Da={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ma={};for(const n in Da)Ma[n]={isEnabled:e=>Da[n].some(t=>!!e[t])};const Oa=()=>({x:{min:0,max:0},y:{min:0,max:0}}),Pa="undefined"!==typeof window,La={current:null},za={current:!1};const Ba=new WeakMap;function Wa(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function Va(e){return"string"===typeof e||Array.isArray(e)}const Ua=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ja=["initial",...Ua];function Ga(e){return Wa(e.animate)||ja.some(t=>Va(e[t]))}function Ha(e){return Boolean(Ga(e)||e.variants)}function qa(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function Ka(e,t,n,a){if("function"===typeof t){const[r,i]=qa(a);t=t(void 0!==n?n:e.custom,r,i)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[r,i]=qa(a);t=t(void 0!==n?n:e.custom,r,i)}return t}const Xa=["willChange"],Ya=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Qa{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o}=e,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Wn,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=ka.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,An.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget=l({},c),this.initialValues=n.initial?l({},c):{},this.renderState=d,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=u,this.blockInitialAnimation=Boolean(s),this.isControllingVariants=Ga(n),this.isVariantNode=Ha(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const h=this.scrapeMotionValuesFromProps(n,{},this),{willChange:p}=h,f=a(h,Xa);for(const a in f){const e=f[a];void 0!==c[a]&&va(e)&&e.set(c[a])}}mount(e){var t;this.current=e,Ba.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),za.current||function(){if(za.current=!0,Pa)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>La.current=e.matches;e.addEventListener("change",t),t()}else La.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||La.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Fn(this.notifyUpdate),Fn(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=St.has(e);n&&this.onBindTransform&&this.onBindTransform();const a=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&An.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let r;window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{a(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Ma){const t=Ma[e];if(!t)continue;const{isEnabled:n,Feature:a}=t;if(!this.features[e]&&a&&n(this.props)&&(this.features[e]=new a(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Ya.length;n++){const t=Ya[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const a=e["on"+t];a&&(this.propEventSubscriptions[t]=this.on(t,a))}this.prevMotionValues=function(e,t,n){for(const a in t){const r=t[a],i=n[a];if(va(r))e.addValue(a,r);else if(va(i))e.addValue(a,_a(r,{owner:e}));else if(i!==r)if(e.hasValue(a)){const t=e.getValue(a);!0===t.liveStyle?t.jump(r):t.hasAnimated||t.set(r)}else{const t=e.getStaticValue(a);e.addValue(a,_a(void 0!==t?t:r,{owner:e}))}}for(const a in n)void 0===t[a]&&e.removeValue(a);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=_a(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let a=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var r;return void 0!==a&&null!==a&&("string"===typeof a&&(bn(a)||Vn(a))?a=parseFloat(a):(r=a,!Aa.find(mn(r))&&oa.test(t)&&(a=ga(e,t))),this.setBaseTarget(e,va(a)?a.get():a)),va(a)?a.get():a}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"===typeof t||"object"===typeof t){var a;const r=Ka(this.props,t,null===(a=this.presenceContext)||void 0===a?void 0:a.custom);r&&(n=r[e])}if(t&&void 0!==n)return n;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||va(r)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new Na),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.events[e].notify(...n)}}scheduleRenderMicrotask(){Fa.render(this.render)}}class Ja extends Qa{constructor(){super(...arguments),this.KeyframeResolver=ba}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:a}=t;delete n[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;va(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const Za=(e,t)=>t&&"number"===typeof e?t.transform(e):e,$a={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},er=kt.length;function tr(e,t,n){const{style:a,vars:r,transformOrigin:i}=e;let s=!1,o=!1;for(const l in t){const e=t[l];if(St.has(l))s=!0;else if(Ot(l))r[l]=e;else{const t=Za(e,pa[l]);l.startsWith("origin")?(o=!0,i[l]=t):a[l]=t}}if(t.transform||(s||n?a.transform=function(e,t,n){let a="",r=!0;for(let i=0;i<er;i++){const s=kt[i],o=e[s];if(void 0===o)continue;let l=!0;if(l="number"===typeof o?o===(s.startsWith("scale")?1:0):0===parseFloat(o),!l||n){const e=Za(o,pa[s]);l||(r=!1,a+="".concat($a[s]||s,"(").concat(e,") ")),n&&(t[s]=e)}}return a=a.trim(),n?a=n(t,r?"":a):r&&(a="none"),a}(t,e.transform,n):a.transform&&(a.transform="none")),o){const{originX:e="50%",originY:t="50%",originZ:n=0}=i;a.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function nr(e,t,n,a){let{style:r,vars:i}=t;const s=e.style;let o;for(o in r)s[o]=r[o];for(o in null===a||void 0===a||a.applyProjectionStyles(s,n),i)s.setProperty(o,i[o])}const ar={};function rr(e,t){let{layout:n,layoutId:a}=t;return St.has(e)||e.startsWith("origin")||(n||void 0!==a)&&(!!ar[e]||"opacity"===e)}function ir(e,t,n){const{style:a}=e,r={};for(const s in a){var i;(va(a[s])||t.style&&va(t.style[s])||rr(s,e)||void 0!==(null===n||void 0===n||null===(i=n.getValue(s))||void 0===i?void 0:i.liveStyle))&&(r[s]=a[s])}return r}class sr extends Ja{constructor(){super(...arguments),this.type="html",this.renderInstance=nr}readValueFromInstance(e,t){var n,a;if(St.has(t))return null!==(n=this.projection)&&void 0!==n&&n.isProjecting?Ft(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return Rt(n,t)})(e,t);{const n=(a=e,window.getComputedStyle(a)),r=(Ot(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof r?r.trim():r}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return tn(e,n)}build(e,t,n){tr(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return ir(e,t,n)}}const or=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),lr={offset:"stroke-dashoffset",array:"stroke-dasharray"},ur={offset:"strokeDashoffset",array:"strokeDasharray"};const cr=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function dr(e,t,n,r,i){let{attrX:s,attrY:o,attrScale:l,pathLength:u,pathSpacing:c=1,pathOffset:d=0}=t;if(tr(e,a(t,cr),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:h,style:p}=e;var f,m;(h.transform&&(p.transform=h.transform,delete h.transform),p.transform||h.transformOrigin)&&(p.transformOrigin=null!==(f=h.transformOrigin)&&void 0!==f?f:"50% 50%",delete h.transformOrigin);p.transform&&(p.transformBox=null!==(m=null===i||void 0===i?void 0:i.transformBox)&&void 0!==m?m:"fill-box",delete h.transformBox);void 0!==s&&(h.x=s),void 0!==o&&(h.y=o),void 0!==l&&(h.scale=l),void 0!==u&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const i=r?lr:ur;e[i.offset]=dn.transform(-a);const s=dn.transform(t),o=dn.transform(n);e[i.array]="".concat(s," ").concat(o)}(h,u,c,d,!1)}const hr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),pr=e=>"string"===typeof e&&"svg"===e.toLowerCase();function fr(e,t,n){const a=ir(e,t,n);for(const r in e)if(va(e[r])||va(t[r])){a[-1!==kt.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]}return a}class mr extends Ja{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Oa}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(St.has(t)){const e=ma(t);return e&&e.default||0}return t=hr.has(t)?t:or(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return fr(e,t,n)}build(e,t,n){dr(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,a){!function(e,t,n,a){nr(e,t,void 0,a);for(const r in t.attrs)e.setAttribute(hr.has(r)?r:or(r),t.attrs[r])}(e,t,0,a)}mount(e){this.isSVGTag=pr(e.tagName),super.mount(e)}}const gr=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yr(e){return"string"===typeof e&&!e.includes("-")&&!!(gr.indexOf(e)>-1||/[A-Z]/.test(e))}const br=(t,n)=>yr(t)?new mr(n):new sr(n,{allowProjection:t!==e.Fragment});var vr=n(579);const xr=(0,e.createContext)({}),wr=(0,e.createContext)({strict:!1}),kr=(0,e.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Sr=(0,e.createContext)({});function Ir(t){const{initial:n,animate:a}=function(e,t){if(Ga(e)){const{initial:t,animate:n}=e;return{initial:!1===t||Va(t)?t:void 0,animate:Va(n)?n:void 0}}return!1!==e.inherit?t:{}}(t,(0,e.useContext)(Sr));return(0,e.useMemo)(()=>({initial:n,animate:a}),[Nr(n),Nr(a)])}function Nr(e){return Array.isArray(e)?e.join(" "):e}const Tr=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Cr(e,t,n){for(const a in t)va(t[a])||rr(a,n)||(e[a]=t[a])}function Er(t,n){const a={};return Cr(a,t.style||{},t),Object.assign(a,function(t,n){let{transformTemplate:a}=t;return(0,e.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return tr(e,n,a),Object.assign({},e.vars,e.style)},[n])}(t,n)),a}function _r(e,t){const n={},a=Er(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=a,n}const Ar=()=>l(l({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}});function Fr(t,n,a,r){const i=(0,e.useMemo)(()=>{const e=Ar();return dr(e,n,pr(r),t.transformTemplate,t.style),l(l({},e.attrs),{},{style:l({},e.style)})},[n]);if(t.style){const e={};Cr(e,t.style,t),i.style=l(l({},e),i.style)}return i}const Rr=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Dr(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Rr.has(e)}let Mr=e=>!Dr(e);try{"function"===typeof(Or=require("@emotion/is-prop-valid").default)&&(Mr=e=>e.startsWith("on")?!Dr(e):Or(e))}catch(hne){}var Or;function Pr(t,n,a,r,i){let{latestValues:s}=r,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const u=(yr(t)?Fr:_r)(n,s,i,t),c=function(e,t,n){const a={};for(const r in e)"values"===r&&"object"===typeof e.values||(Mr(r)||!0===n&&Dr(r)||!t&&!Dr(r)||e.draggable&&r.startsWith("onDrag"))&&(a[r]=e[r]);return a}(n,"string"===typeof t,o),d=t!==e.Fragment?l(l(l({},c),u),{},{ref:a}):{},{children:h}=n,p=(0,e.useMemo)(()=>va(h)?h.get():h,[h]);return(0,e.createElement)(t,l(l({},d),{},{children:p}))}const Lr=(0,e.createContext)(null);function zr(t){const n=(0,e.useRef)(null);return null===n.current&&(n.current=t()),n.current}function Br(e){return va(e)?e.get():e}const Wr=["transitionEnd","transition"];function Vr(e,t,n,r){const i={},s=r(e,{});for(const a in s)i[a]=Br(s[a]);let{initial:o,animate:l}=e;const u=Ga(e),c=Ha(e);t&&c&&!u&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===l&&(l=t.animate));let d=!!n&&!1===n.initial;d=d||!1===o;const h=d?l:o;if(h&&"boolean"!==typeof h&&!Wa(h)){const t=Array.isArray(h)?h:[h];for(let n=0;n<t.length;n++){const r=Ka(e,t[n]);if(r){const{transitionEnd:e,transition:t}=r,n=a(r,Wr);for(const a in n){let e=n[a];if(Array.isArray(e)){e=e[d?e.length-1:0]}null!==e&&(i[a]=e)}for(const a in e)i[a]=e[a]}}}return i}const Ur=t=>(n,a)=>{const r=(0,e.useContext)(Sr),i=(0,e.useContext)(Lr),s=()=>function(e,t,n,a){let{scrapeMotionValuesFromProps:r,createRenderState:i}=e;return{latestValues:Vr(t,n,a,r),renderState:i()}}(t,n,r,i);return a?s():zr(s)},jr=Ur({scrapeMotionValuesFromProps:ir,createRenderState:Tr}),Gr=Ur({scrapeMotionValuesFromProps:fr,createRenderState:Ar});const Hr=Symbol.for("motionComponentSymbol");function qr(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Kr(t,n,a){return(0,e.useCallback)(e=>{e&&t.onMount&&t.onMount(e),n&&(e?n.mount(e):n.unmount()),a&&("function"===typeof a?a(e):qr(a)&&(a.current=e))},[n])}const Xr="data-"+or("framerAppearId"),Yr=(0,e.createContext)({}),Qr=Pa?e.useLayoutEffect:e.useEffect;function Jr(t,n,a,r,i){var s,o,l,u;const{visualElement:c}=(0,e.useContext)(Sr),d=(0,e.useContext)(wr),h=(0,e.useContext)(Lr),p=(0,e.useContext)(kr).reducedMotion,f=(0,e.useRef)(null);r=r||d.renderer,!f.current&&r&&(f.current=r(t,{visualState:n,parent:c,props:a,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:p}));const m=f.current,g=(0,e.useContext)(Yr);!m||m.projection||!i||"html"!==m.type&&"svg"!==m.type||function(e,t,n,a){const{layoutId:r,layout:i,drag:s,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Zr(e.parent)),e.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:Boolean(s)||o&&qr(o),visualElement:e,animationType:"string"===typeof i?i:"both",initialPromotionConfig:a,crossfade:c,layoutScroll:l,layoutRoot:u})}(f.current,a,i,g);const y=(0,e.useRef)(!1);(0,e.useInsertionEffect)(()=>{m&&y.current&&m.update(a,h)});const b=a[Xr],v=(0,e.useRef)(Boolean(b)&&!(null!==(s=(o=window).MotionHandoffIsComplete)&&void 0!==s&&s.call(o,b))&&(null===(l=(u=window).MotionHasOptimisedAnimation)||void 0===l?void 0:l.call(u,b)));return Qr(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),v.current&&m.animationState&&m.animationState.animateChanges())}),(0,e.useEffect)(()=>{m&&(!v.current&&m.animationState&&m.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var e,t;null===(e=(t=window).MotionHandoffMarkAsComplete)||void 0===e||e.call(t,b)}),v.current=!1),m.enteringChildren=void 0)}),m}function Zr(e){if(e)return!1!==e.options.allowProjection?e.projection:Zr(e.parent)}function $r(t){var n,a;let{forwardMotionProps:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;i&&function(e){for(const t in e)Ma[t]=l(l({},Ma[t]),e[t])}(i);const o=yr(t)?Gr:jr;function u(n,a){let i;const u=l(l(l({},(0,e.useContext)(kr)),n),{},{layoutId:ei(n)}),{isStatic:c}=u,d=Ir(n),h=o(n,c);if(!c&&Pa){!function(){(0,e.useContext)(wr).strict;0}();const n=function(e){const{drag:t,layout:n}=Ma;if(!t&&!n)return{};const a=l(l({},t),n);return{MeasureLayout:null!==t&&void 0!==t&&t.isEnabled(e)||null!==n&&void 0!==n&&n.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}(u);i=n.MeasureLayout,d.visualElement=Jr(t,h,u,s,n.ProjectionNode)}return(0,vr.jsxs)(Sr.Provider,{value:d,children:[i&&d.visualElement?(0,vr.jsx)(i,l({visualElement:d.visualElement},u)):null,Pr(t,n,Kr(h,d.visualElement,a),h,c,r)]})}u.displayName="motion.".concat("string"===typeof t?t:"create(".concat(null!==(n=null!==(a=t.displayName)&&void 0!==a?a:t.name)&&void 0!==n?n:"",")"));const c=(0,e.forwardRef)(u);return c[Hr]=t,c}function ei(t){let{layoutId:n}=t;const a=(0,e.useContext)(xr).id;return a&&void 0!==n?a+"-"+n:n}function ti(e,t){if("undefined"===typeof Proxy)return $r;const n=new Map,a=(n,a)=>$r(n,a,e,t);return new Proxy((e,t)=>a(e,t),{get:(r,i)=>"create"===i?a:(n.has(i)||n.set(i,$r(i,void 0,e,t)),n.get(i))})}function ni(e,t,n){const a=e.getProps();return Ka(a,t,void 0!==n?n:a.custom,e)}function ai(e,t){var n,a;return null!==(n=null!==(a=null===e||void 0===e?void 0:e[t])&&void 0!==a?a:null===e||void 0===e?void 0:e.default)&&void 0!==n?n:e}const ri=e=>Array.isArray(e),ii=["transitionEnd","transition"];function si(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,_a(n))}function oi(e){return ri(e)?e[e.length-1]||0:e}function li(e,t){const n=e.getValue("willChange");if(a=n,Boolean(va(a)&&a.add))return n.add(t);if(!n&&Tn.WillChange){const n=new Tn.WillChange("auto");e.addValue("willChange",n),n.add(t)}var a}function ui(e){return e.props[Xr]}function ci(e){e.duration=0,e.type="keyframes"}const di=(e,t)=>n=>t(e(n)),hi=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(di)},pi=e=>1e3*e,fi=e=>e/1e3,mi={layout:0,mainThread:0,waapi:0};function gi(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function yi(e,t){return n=>n>0?t:e}const bi=(e,t,n)=>{const a=e*e,r=n*(t*t-a)+a;return r<0?0:Math.sqrt(r)},vi=[Qn,Yn,Jn];function xi(e){const t=(n=e,vi.find(e=>e.test(n)));var n;if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let a=t.parse(e);return t===Jn&&(a=function(e){let{hue:t,saturation:n,lightness:a,alpha:r}=e;t/=360,n/=100,a/=100;let i=0,s=0,o=0;if(n){const e=a<.5?a*(1+n):a+n-a*n,r=2*a-e;i=gi(r,e,t+1/3),s=gi(r,e,t),o=gi(r,e,t-1/3)}else i=s=o=a;return{red:Math.round(255*i),green:Math.round(255*s),blue:Math.round(255*o),alpha:r}}(a)),a}const wi=(e,t)=>{const n=xi(e),a=xi(t);if(!n||!a)return yi(e,t);const r=l({},n);return e=>(r.red=bi(n.red,a.red,e),r.green=bi(n.green,a.green,e),r.blue=bi(n.blue,a.blue,e),r.alpha=Wt(n.alpha,a.alpha,e),Yn.transform(r))},ki=new Set(["none","hidden"]);function Si(e,t){return n=>Wt(e,t,n)}function Ii(e){return"number"===typeof e?Si:"string"===typeof e?Lt(e)?yi:Zn.test(e)?wi:Ci:Array.isArray(e)?Ni:"object"===typeof e?Zn.test(e)?wi:Ti:yi}function Ni(e,t){const n=[...e],a=n.length,r=e.map((e,n)=>Ii(e)(e,t[n]));return e=>{for(let t=0;t<a;t++)n[t]=r[t](e);return n}}function Ti(e,t){const n=l(l({},e),t),a={};for(const r in n)void 0!==e[r]&&void 0!==t[r]&&(a[r]=Ii(e[r])(e[r],t[r]));return e=>{for(const t in a)n[t]=a[t](e);return n}}const Ci=(e,t)=>{const n=oa.createTransformer(t),a=aa(e),r=aa(t);return a.indexes.var.length===r.indexes.var.length&&a.indexes.color.length===r.indexes.color.length&&a.indexes.number.length>=r.indexes.number.length?ki.has(e)&&!r.values.length||ki.has(t)&&!a.values.length?function(e,t){return ki.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):hi(Ni(function(e,t){const n=[],a={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){var r;const s=t.types[i],o=e.indexes[s][a[s]],l=null!==(r=e.values[o])&&void 0!==r?r:0;n[i]=l,a[s]++}return n}(a,r),r.values),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),yi(e,t))};function Ei(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return Wt(e,t,n);return Ii(e)(e,t)}const _i=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return An.update(t,e)},stop:()=>Fn(t),now:()=>Rn.isProcessing?Rn.timestamp:ka.now()}},Ai=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a="";const r=Math.max(Math.round(t/n),2);for(let i=0;i<r;i++)a+=Math.round(1e4*e(i/(r-1)))/1e4+", ";return"linear(".concat(a.substring(0,a.length-2),")")},Fi=2e4;function Ri(e){let t=0;let n=e.next(t);for(;!n.done&&t<Fi;)t+=50,n=e.next(t);return t>=Fi?1/0:t}function Di(e,t,n){const a=Math.max(t-5,0);return Ta(n-e(a),t-a)}const Mi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Oi=.001;function Pi(e){let t,n,{duration:a=Mi.duration,bounce:r=Mi.bounce,velocity:i=Mi.velocity,mass:s=Mi.mass}=e;pi(Mi.maxDuration);let o=1-r;o=an(Mi.minDamping,Mi.maxDamping,o),a=an(Mi.minDuration,Mi.maxDuration,fi(a)),o<1?(t=e=>{const t=e*o,n=t*a,r=t-i,s=zi(e,o),l=Math.exp(-n);return Oi-r/s*l},n=e=>{const n=e*o*a,r=n*i+i,s=Math.pow(o,2)*Math.pow(e,2)*a,l=Math.exp(-n),u=zi(Math.pow(e,2),o);return(-t(e)+Oi>0?-1:1)*((r-s)*l)/u}):(t=e=>Math.exp(-e*a)*((e-i)*a+1)-.001,n=e=>Math.exp(-e*a)*(a*a*(i-e)));const l=function(e,t,n){let a=n;for(let r=1;r<Li;r++)a-=e(a)/t(a);return a}(t,n,5/a);if(a=pi(a),isNaN(l))return{stiffness:Mi.stiffness,damping:Mi.damping,duration:a};{const e=Math.pow(l,2)*s;return{stiffness:e,damping:2*o*Math.sqrt(s*e),duration:a}}}const Li=12;function zi(e,t){return e*Math.sqrt(1-t*t)}const Bi=["duration","bounce"],Wi=["stiffness","damping","mass"];function Vi(e,t){return t.some(t=>void 0!==e[t])}function Ui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mi.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mi.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:r}=n;const i=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:u,damping:c,mass:d,duration:h,velocity:p,isResolvedFromDuration:f}=function(e){let t=l({velocity:Mi.velocity,stiffness:Mi.stiffness,damping:Mi.damping,mass:Mi.mass,isResolvedFromDuration:!1},e);if(!Vi(e,Wi)&&Vi(e,Bi))if(e.visualDuration){const n=e.visualDuration,a=2*Math.PI/(1.2*n),r=a*a,i=2*an(.05,1,1-(e.bounce||0))*Math.sqrt(r);t=l(l({},t),{},{mass:Mi.mass,stiffness:r,damping:i})}else{const n=Pi(e);t=l(l(l({},t),n),{},{mass:Mi.mass}),t.isResolvedFromDuration=!0}return t}(l(l({},n),{},{velocity:-fi(n.velocity||0)})),m=p||0,g=c/(2*Math.sqrt(u*d)),y=s-i,b=fi(Math.sqrt(u/d)),v=Math.abs(y)<5;let x;if(a||(a=v?Mi.restSpeed.granular:Mi.restSpeed.default),r||(r=v?Mi.restDelta.granular:Mi.restDelta.default),g<1){const e=zi(b,g);x=t=>{const n=Math.exp(-g*b*t);return s-n*((m+g*b*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}}else if(1===g)x=e=>s-Math.exp(-b*e)*(y+(m+b*y)*e);else{const e=b*Math.sqrt(g*g-1);x=t=>{const n=Math.exp(-g*b*t),a=Math.min(e*t,300);return s-n*((m+g*b*y)*Math.sinh(a)+e*y*Math.cosh(a))/e}}const w={calculatedDuration:f&&h||null,next:e=>{const t=x(e);if(f)o.done=e>=h;else{let n=0===e?m:0;g<1&&(n=0===e?pi(m):Di(x,e,t));const i=Math.abs(n)<=a,l=Math.abs(s-t)<=r;o.done=i&&l}return o.value=o.done?s:t,o},toString:()=>{const e=Math.min(Ri(w),Fi),t=Ai(t=>w.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return w}function ji(e){let{keyframes:t,velocity:n=0,power:a=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:c=.5,restSpeed:d}=e;const h=t[0],p={done:!1,value:h},f=e=>void 0===l?u:void 0===u||Math.abs(l-e)<Math.abs(u-e)?l:u;let m=a*n;const g=h+m,y=void 0===o?g:o(g);y!==g&&(m=y-h);const b=e=>-m*Math.exp(-e/r),v=e=>y+b(e),x=e=>{const t=b(e),n=v(e);p.done=Math.abs(t)<=c,p.value=p.done?y:n};let w,k;const S=e=>{var t;(t=p.value,void 0!==l&&t<l||void 0!==u&&t>u)&&(w=e,k=Ui({keyframes:[p.value,f(p.value)],velocity:Di(v,e,p.value),damping:i,stiffness:s,restDelta:c,restSpeed:d}))};return S(0),{calculatedDuration:null,next:e=>{let t=!1;return k||void 0!==w||(t=!0,x(e),S(e)),void 0!==w&&e>=w?k.next(e-w):(!t&&x(e),p)}}}Ui.applyToOptions=e=>{const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=(arguments.length>2?arguments[2]:void 0)(l(l({},e),{},{keyframes:[0,t]})),a=Math.min(Ri(n),Fi);return{type:"keyframes",ease:e=>n.next(a*e).value/t,duration:fi(a)}}(e,100,Ui);return e.ease=t.ease,e.duration=pi(t.duration),e.type="keyframes",e};const Gi=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Hi(e,t,n,a){if(e===t&&n===a)return Nn;const r=t=>function(e,t,n,a,r){let i,s,o=0;do{s=t+(n-t)/2,i=Gi(s,a,r)-e,i>0?n=s:t=s}while(Math.abs(i)>1e-7&&++o<12);return s}(t,0,1,e,n);return e=>0===e||1===e?e:Gi(r(e),t,a)}const qi=Hi(.42,0,1,1),Ki=Hi(0,0,.58,1),Xi=Hi(.42,0,.58,1),Yi=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Qi=e=>t=>1-e(1-t),Ji=Hi(.33,1.53,.69,.99),Zi=Qi(Ji),$i=Yi(Zi),es=e=>(e*=2)<1?.5*Zi(e):.5*(2-Math.pow(2,-10*(e-1))),ts=e=>1-Math.sin(Math.acos(e)),ns=Qi(ts),as=Yi(ts),rs=e=>Array.isArray(e)&&"number"===typeof e[0],is={linear:Nn,easeIn:qi,easeInOut:Xi,easeOut:Ki,circIn:ts,circInOut:as,circOut:ns,backIn:Zi,backInOut:$i,backOut:Ji,anticipate:es},ss=e=>{if(rs(e)){e.length;const[t,n,a,r]=e;return Hi(t,n,a,r)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),is[e]):e},os=(e,t,n)=>{const a=t-e;return 0===a?1:(n-e)/a};function ls(e,t){let{clamp:n=!0,ease:a,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.length;if(t.length,1===i)return()=>t[0];if(2===i&&t[0]===t[1])return()=>t[1];const s=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,n){const a=[],r=n||Tn.mix||Ei,i=e.length-1;for(let s=0;s<i;s++){let n=r(e[s],e[s+1]);if(t){const e=Array.isArray(t)?t[s]||Nn:t;n=hi(e,n)}a.push(n)}return a}(t,a,r),l=o.length,u=n=>{if(s&&n<e[0])return t[0];let a=0;if(l>1)for(;a<e.length-2&&!(n<e[a+1]);a++);const r=os(e[a],e[a+1],n);return o[a](r)};return n?t=>u(an(e[0],e[i-1],t)):u}function us(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let a=1;a<=t;a++){const r=os(0,t,a);e.push(Wt(n,1,r))}}(t,e.length-1),t}function cs(e){let{duration:t=300,keyframes:n,times:a,ease:r="easeInOut"}=e;const i=(e=>Array.isArray(e)&&"number"!==typeof e[0])(r)?r.map(ss):ss(r),s={done:!1,value:n[0]},o=function(e,t){return e.map(e=>e*t)}(a&&a.length===n.length?a:us(n),t),l=ls(o,n,{ease:Array.isArray(i)?i:(u=n,c=i,u.map(()=>c||Xi).splice(0,u.length-1))});var u,c;return{calculatedDuration:t,next:e=>(s.value=l(e),s.done=e>=t,s)}}const ds=e=>null!==e;function hs(e,t,n){let{repeat:a,repeatType:r="loop"}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const s=e.filter(ds),o=i<0||a&&"loop"!==r&&a%2===1?0:s.length-1;return o&&void 0!==n?n:s[o]}const ps={decay:ji,inertia:ji,tween:cs,keyframes:cs,spring:Ui};function fs(e){"string"===typeof e.type&&(e.type=ps[e.type])}class ms{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const gs=e=>e/100;class ys extends ms{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==ka.now()&&this.tick(ka.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},mi.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;fs(e);const{type:t=cs,repeat:n=0,repeatDelay:a=0,repeatType:r,velocity:i=0}=e;let{keyframes:s}=e;const o=t||cs;o!==cs&&"number"!==typeof s[0]&&(this.mixKeyframes=hi(gs,Ei(s[0],s[1])),s=[0,100]);const u=o(l(l({},e),{},{keyframes:s}));"mirror"===r&&(this.mirroredGenerator=o(l(l({},e),{},{keyframes:[...s].reverse(),velocity:-i}))),null===u.calculatedDuration&&(u.calculatedDuration=Ri(u));const{calculatedDuration:c}=u;this.calculatedDuration=c,this.resolvedDuration=c+a,this.totalDuration=this.resolvedDuration*(n+1)-a,this.generator=u}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:n,totalDuration:a,mixKeyframes:r,mirroredGenerator:i,resolvedDuration:s,calculatedDuration:o}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:u,repeat:c,repeatType:d,repeatDelay:h,type:p,onUpdate:f,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?g<0:g>a;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=a);let b=this.currentTime,v=n;if(c){const e=Math.min(this.currentTime,a)/s;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,c+1);Boolean(t%2)&&("reverse"===d?(n=1-n,h&&(n-=h/s)):"mirror"===d&&(v=i)),b=an(0,1,n)*s}const x=y?{done:!1,value:u[0]}:v.next(b);r&&(x.value=r(x.value));let{done:w}=x;y||null===o||(w=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&p!==ji&&(x.value=hs(u,this.options,m,this.speed)),f&&f(x.value),k&&this.finish(),x}then(e,t){return this.finished.then(e,t)}get duration(){return fi(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+fi(e)}get time(){return fi(this.currentTime)}set time(e){var t;e=pi(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ka.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=fi(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=_i,startTime:a}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const r=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=r):null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime||(this.startTime=null!==a&&void 0!==a?a:r),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ka.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,mi.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}function bs(e){let t;return()=>(void 0===t&&(t=e()),t)}const vs=bs(()=>void 0!==window.ScrollTimeline),xs={};function ws(e,t){const n=bs(e);return()=>{var e;return null!==(e=xs[t])&&void 0!==e?e:n()}}const ks=ws(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(Xm){return!1}return!0},"linearEasing"),Ss=e=>{let[t,n,a,r]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(a,", ").concat(r,")")},Is={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ss([0,.65,.55,1]),circOut:Ss([.55,0,1,.45]),backIn:Ss([.31,.01,.66,-.59]),backOut:Ss([.33,1.53,.69,.99])};function Ns(e,t){return e?"function"===typeof e?ks()?Ai(e,t):"ease-out":rs(e)?Ss(e):Array.isArray(e)?e.map(e=>Ns(e,t)||Is.easeOut):Is[e]:void 0}function Ts(e,t,n){let{delay:a=0,duration:r=300,repeat:i=0,repeatType:s="loop",ease:o="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const c={[t]:n};l&&(c.offset=l);const d=Ns(o,r);Array.isArray(d)&&(c.easing=d),En.value&&mi.waapi++;const h={delay:a,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:"reverse"===s?"alternate":"normal"};u&&(h.pseudoElement=u);const p=e.animate(c,h);return En.value&&p.finished.finally(()=>{mi.waapi--}),p}function Cs(e){return"function"===typeof e&&"applyToOptions"in e}const Es=["type"];class _s extends ms{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:i,allowFlatten:s=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=Boolean(i),this.allowFlatten=s,this.options=e,e.type;const u=function(e){let{type:t}=e,n=a(e,Es);return Cs(t)&&ks()?t.applyToOptions(n):(null!==(r=n.duration)&&void 0!==r||(n.duration=300),null!==(i=n.ease)&&void 0!==i||(n.ease="easeOut"),n);var r,i}(e);this.animation=Ts(t,n,r,u,i),!1===u.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const e=hs(r,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null===l||void 0===l||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch(Xm){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const n=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return fi(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+fi(e)}get time(){return fi(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=pi(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;var a;this.allowFlatten&&(null===(a=this.animation.effect)||void 0===a||a.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&vs()?(this.animation.timeline=t,Nn):n(this)}}const As={anticipate:es,backInOut:$i,circInOut:as};function Fs(e){"string"===typeof e.ease&&e.ease in As&&(e.ease=As[e.ease])}const Rs=["motionValue","onUpdate","onComplete","element"];class Ds extends _s{constructor(e){Fs(e),fs(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:i,onComplete:s,element:o}=n,u=a(n,Rs);if(!r)return;if(void 0!==e)return void r.set(e);const c=new ys(l(l({},u),{},{autoplay:!1})),d=pi(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);r.setWithVelocity(c.sample(d-10).value,c.sample(d).value,10),c.stop()}}const Ms=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!oa.test(e)&&"0"!==e||e.startsWith("url(")));const Os=new Set(["opacity","clipPath","filter","transform"]),Ps=bs(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const Ls=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class zs extends ms{constructor(e){var t;let{autoplay:n=!0,delay:r=0,type:i="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:u="loop",keyframes:c,name:d,motionValue:h,element:p}=e,f=a(e,Ls);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=ka.now();const m=l({autoplay:n,delay:r,type:i,repeat:s,repeatDelay:o,repeatType:u,name:d,motionValue:h,element:p},f),g=(null===p||void 0===p?void 0:p.KeyframeResolver)||Wn;this.keyframeResolver=new g(c,(e,t,n)=>this.onKeyframesResolved(e,t,m,!n),d,h,p),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,n,a){this.keyframeResolver=void 0;const{name:r,type:i,velocity:s,delay:o,isHandoff:u,onUpdate:c}=n;this.resolvedAt=ka.now(),function(e,t,n,a){const r=e[0];if(null===r)return!1;if("display"===t||"visibility"===t)return!0;const i=e[e.length-1],s=Ms(r,t),o=Ms(i,t);return"You are trying to animate ".concat(t,' from "').concat(r,'" to "').concat(i,'". "').concat(s?i:r,'" is not an animatable value.'),!(!s||!o)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||Cs(n))&&a)}(e,r,i,s)||(!Tn.instantAnimations&&o||null===c||void 0===c||c(hs(e,n,t)),e[0]=e[e.length-1],ci(n),n.repeat=0);const d=l(l({startTime:a?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t},n),{},{keyframes:e}),h=!u&&function(e){var t;const{motionValue:n,name:a,repeatDelay:r,repeatType:i,damping:s,type:o}=e;if(!((null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return Ps()&&a&&Os.has(a)&&("transform"!==a||!u)&&!l&&!r&&"mirror"!==i&&0!==s&&"inertia"!==o}(d)?new Ds(l(l({},d),{},{element:d.motionValue.owner.current})):new ys(d);h.finished.then(()=>this.notifyFinished()).catch(Nn),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),Ln=!0,Bn(),zn(),Ln=!1);return this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const Bs=e=>null!==e;const Ws={type:"spring",stiffness:500,damping:25,restSpeed:10},Vs={type:"keyframes",duration:.8},Us={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},js=(e,t)=>{let{keyframes:n}=t;return n.length>2?Vs:St.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:Ws:Us},Gs=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const Hs=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return o=>{const u=ai(r,e)||{},c=u.delay||r.delay||0;let{elapsed:d=0}=r;d-=pi(c);const h=l(l({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},u),{},{delay:-d,onUpdate:e=>{t.set(e),u.onUpdate&&u.onUpdate(e)},onComplete:()=>{o(),u.onComplete&&u.onComplete()},name:e,motionValue:t,element:s?void 0:i});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:i,staggerDirection:s,repeat:o,repeatType:l,repeatDelay:u,from:c,elapsed:d}=e,h=a(e,Gs);return!!Object.keys(h).length})(u)||Object.assign(h,js(e,h)),h.duration&&(h.duration=pi(h.duration)),h.repeatDelay&&(h.repeatDelay=pi(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let p=!1;if((!1===h.type||0===h.duration&&!h.repeatDelay)&&(ci(h),0===h.delay&&(p=!0)),(Tn.instantAnimations||Tn.skipAnimations)&&(p=!0,ci(h),h.delay=0),h.allowFlatten=!u.type&&!u.ease,p&&!s&&void 0!==t.get()){const e=function(e,t,n){let{repeat:a,repeatType:r="loop"}=t;const i=e.filter(Bs),s=a&&"loop"!==r&&a%2===1?0:i.length-1;return s&&void 0!==n?n:i[s]}(h.keyframes,u);if(void 0!==e)return void An.update(()=>{h.onUpdate(e),h.onComplete()})}return u.isSync?new ys(h):new zs(h)}},qs=["transition","transitionEnd"];function Ks(e,t){let{protectedKeys:n,needsAnimating:a}=e;const r=n.hasOwnProperty(t)&&!0!==a[t];return a[t]=!1,r}function Xs(e,t){let{delay:n=0,transitionOverride:r,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:s=e.getDefaultTransition(),transitionEnd:o}=t,u=a(t,qs);r&&(s=r);const c=[],d=i&&e.animationState&&e.animationState.getState()[i];for(const a in u){var h;const t=e.getValue(a,null!==(h=e.latestValues[a])&&void 0!==h?h:null),r=u[a];if(void 0===r||d&&Ks(d,a))continue;const i=l({delay:n},ai(s||{},a)),o=t.get();if(void 0!==o&&!t.isAnimating&&!Array.isArray(r)&&r===o&&!i.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const t=ui(e);if(t){const e=window.MotionHandoffAnimation(t,a,An);null!==e&&(i.startTime=e,p=!0)}}li(e,a),t.start(Hs(a,t,r,e.shouldReduceMotion&&nn.has(a)?{type:!1}:i,e,p));const f=t.animation;f&&c.push(f)}return o&&Promise.all(c).then(()=>{An.update(()=>{o&&function(e,t){let n=ni(e,t)||{},{transitionEnd:r={},transition:i={}}=n,s=a(n,ii);s=l(l({},s),r);for(const a in s)si(e,a,oi(s[a]))}(e,o)})}),c}function Ys(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),s=e.size,o=(s-1)*a;return"function"===typeof n?n(i,s):1===r?i*a:o-i*a}function Qs(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=ni(e,t,"exit"===a.type?null===(n=e.presenceContext)||void 0===n?void 0:n.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(i=a.transitionOverride);const s=r?()=>Promise.all(Xs(e,r,a)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:r=0,staggerChildren:s,staggerDirection:o}=i;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6?arguments[6]:void 0;const o=[];for(const u of e.variantChildren)u.notify("AnimationStart",t),o.push(Qs(u,t,l(l({},s),{},{delay:n+("function"===typeof a?0:a)+Ys(e.variantChildren,u,a,r,i)})).then(()=>u.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,n,r,s,o,a)}:()=>Promise.resolve(),{when:u}=i;if(u){const[e,t]="beforeChildren"===u?[s,o]:[o,s];return e().then(()=>t())}return Promise.all([s(),o(a.delay)])}function Js(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let a=0;a<n;a++)if(t[a]!==e[a])return!1;return!0}const Zs=ja.length;function $s(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&$s(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<Zs;n++){const a=ja[n],r=e.props[a];(Va(r)||!1===r)&&(t[a]=r)}return t}const eo=["transition","transitionEnd"],to=[...Ua].reverse(),no=Ua.length;function ao(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:a}=t;return function(e,t){let n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const r=t.map(t=>Qs(e,t,a));n=Promise.all(r)}else if("string"===typeof t)n=Qs(e,t,a);else{const r="function"===typeof t?ni(e,t,a.custom):t;n=Promise.all(Xs(e,r,a))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,n,a)}))}function ro(e){let t=ao(e),n=oo(),r=!0;const i=t=>(n,r)=>{var i;const s=ni(e,r,"exit"===t?null===(i=e.presenceContext)||void 0===i?void 0:i.custom:void 0);if(s){const{transition:e,transitionEnd:t}=s,r=a(s,eo);n=l(l(l({},n),r),t)}return n};function s(a){const{props:s}=e,o=$s(e.parent)||{},u=[],c=new Set;let d={},h=1/0;for(let t=0;t<no;t++){const p=to[t],f=n[p],m=void 0!==s[p]?s[p]:o[p],g=Va(m),y=p===a?f.isActive:null;!1===y&&(h=t);let b=m===o[p]&&m!==s[p]&&g;if(b&&r&&e.manuallyAnimateOnMount&&(b=!1),f.protectedKeys=l({},d),!f.isActive&&null===y||!m&&!f.prevProp||Wa(m)||"boolean"===typeof m)continue;const v=io(f.prevProp,m);let x=v||p===a&&f.isActive&&!b&&g||t>h&&g,w=!1;const k=Array.isArray(m)?m:[m];let S=k.reduce(i(p),{});!1===y&&(S={});const{prevResolvedValues:I={}}=f,N=l(l({},I),S),T=t=>{x=!0,c.has(t)&&(w=!0,c.delete(t)),f.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in N){const t=S[e],n=I[e];if(d.hasOwnProperty(e))continue;let a=!1;a=ri(t)&&ri(n)?!Js(t,n):t!==n,a?void 0!==t&&null!==t?T(e):c.add(e):void 0!==t&&c.has(e)?T(e):f.protectedKeys[e]=!0}f.prevProp=m,f.prevResolvedValues=S,f.isActive&&(d=l(l({},d),S)),r&&e.blockInitialAnimation&&(x=!1);const C=b&&v;x&&(!C||w)&&u.push(...k.map(t=>{const n={type:p};if("string"===typeof t&&r&&!C&&e.manuallyAnimateOnMount&&e.parent){const{parent:a}=e,r=ni(a,t);if(a.enteringChildren&&r){const{delayChildren:t}=r.transition||{};n.delay=Ys(a.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(c.size){const t={};if("boolean"!==typeof s.initial){const n=ni(e,Array.isArray(s.initial)?s.initial[0]:s.initial);n&&n.transition&&(t.transition=n.transition)}c.forEach(n=>{const a=e.getBaseTarget(n),r=e.getValue(n);r&&(r.liveStyle=!0),t[n]=null!==a&&void 0!==a?a:null}),u.push({animation:t})}let p=Boolean(u.length);return!r||!1!==s.initial&&s.initial!==s.animate||e.manuallyAnimateOnMount||(p=!1),r=!1,p?t(u):Promise.resolve()}return{animateChanges:s,setActive:function(t,a){var r;if(n[t].isActive===a)return Promise.resolve();null===(r=e.variantChildren)||void 0===r||r.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,a)}),n[t].isActive=a;const i=s(t);for(const e in n)n[e].protectedKeys={};return i},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=oo()}}}function io(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!Js(t,e)}function so(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function oo(){return{animate:so(!0),whileInView:so(),whileHover:so(),whileTap:so(),whileDrag:so(),whileFocus:so(),exit:so()}}class lo{constructor(e){this.isMounted=!1,this.node=e}update(){}}let uo=0;const co={animation:{Feature:class extends lo{constructor(e){super(e),e.animationState||(e.animationState=ro(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Wa(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends lo{constructor(){super(...arguments),this.id=uo++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},ho={x:!1,y:!1};function po(){return ho.x||ho.y}function fo(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n)}const mo=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function go(e){return{point:{x:e.pageX,y:e.pageY}}}function yo(e,t,n,a){return fo(e,t,(e=>t=>mo(t)&&e(t,go(t)))(n),a)}function bo(e){return e.max-e.min}function vo(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=a,e.originPoint=Wt(t.min,t.max,e.origin),e.scale=bo(n)/bo(t),e.translate=Wt(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function xo(e,t,n,a){vo(e.x,t.x,n.x,a?a.originX:void 0),vo(e.y,t.y,n.y,a?a.originY:void 0)}function wo(e,t,n){e.min=n.min+t.min,e.max=e.min+bo(t)}function ko(e,t,n){e.min=t.min-n.min,e.max=e.min+bo(t)}function So(e,t,n){ko(e.x,t.x,n.x),ko(e.y,t.y,n.y)}function Io(e){return[e("x"),e("y")]}const No=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},To=(e,t)=>Math.abs(e-t);class Co{constructor(e,t){let{transformPagePoint:n,contextWindow:a=window,dragSnapToOrigin:r=!1,distanceThreshold:i=3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=Ao(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=To(e.x,t.x),a=To(e.y,t.y);return Math.sqrt(n**2+a**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;const{point:a}=e,{timestamp:r}=Rn;this.history.push(l(l({},a),{},{timestamp:r}));const{onStart:i,onMove:s}=this.handlers;t||(i&&i(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),s&&s(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=Eo(t,this.transformPagePoint),An.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:a,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const i=Ao("pointercancel"===e.type?this.lastMoveEventInfo:Eo(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,i),a&&a(e,i)},!mo(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=a||window;const s=Eo(go(e),this.transformPagePoint),{point:o}=s,{timestamp:u}=Rn;this.history=[l(l({},o),{},{timestamp:u})];const{onSessionStart:c}=t;c&&c(e,Ao(s,this.history)),this.removeListeners=hi(yo(this.contextWindow,"pointermove",this.handlePointerMove),yo(this.contextWindow,"pointerup",this.handlePointerUp),yo(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Fn(this.updatePoint)}}function Eo(e,t){return t?{point:t(e.point)}:e}function _o(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ao(e,t){let{point:n}=e;return{point:n,delta:_o(n,Ro(t)),offset:_o(n,Fo(t)),velocity:Do(t,.1)}}function Fo(e){return e[0]}function Ro(e){return e[e.length-1]}function Do(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,a=null;const r=Ro(e);for(;n>=0&&(a=e[n],!(r.timestamp-a.timestamp>pi(t)));)n--;if(!a)return{x:0,y:0};const i=fi(r.timestamp-a.timestamp);if(0===i)return{x:0,y:0};const s={x:(r.x-a.x)/i,y:(r.y-a.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Mo(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function Oo(e,t){let n=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,a]=[a,n]),{min:n,max:a}}const Po=.35;function Lo(e,t,n){return{min:zo(e,t),max:zo(e,n)}}function zo(e,t){return"number"===typeof e?e:e[t]||0}const Bo=new WeakMap;class Wo{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e){let{snapToCursor:t=!1,distanceThreshold:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:a}=this.visualElement;if(a&&!1===a.isPresent)return;const{dragSnapToOrigin:r}=this.getProps();this.panSession=new Co(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(go(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:a,onDragStart:r}=this.getProps();if(n&&!a&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(i=n)||"y"===i?ho[i]?null:(ho[i]=!0,()=>{ho[i]=!1}):ho.x||ho.y?null:(ho.x=ho.y=!0,()=>{ho.x=ho.y=!1}),!this.openDragLock))return;var i;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Io(e=>{let t=this.getAxisMotionValue(e).get()||0;if(cn.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const a=n.layout.layoutBox[e];if(a){t=bo(a)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),r&&An.postRender(()=>r(e,t)),li(this.visualElement,"transform");const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:n,dragDirectionLock:a,onDirectionLock:r,onDrag:i}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:s}=t;if(a&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(s),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",t.point,s),this.updateAxis("y",t.point,s),this.visualElement.render(),i&&i(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>Io(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,distanceThreshold:n,contextWindow:No(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,a=t||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!a||!n)return;const{velocity:i}=a;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&An.postRender(()=>s(n,a))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:a}=this.getProps();if(!n||!Vo(e,a,this.currentDirection))return;const r=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=function(e,t,n){let{min:a,max:r}=t;return void 0!==a&&e<a?e=n?Wt(a,e,n.min):Math.max(e,a):void 0!==r&&e>r&&(e=n?Wt(r,e,n.max):Math.min(e,r)),e}(i,this.constraints[e],this.elastic[e])),r.set(i)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,r=this.constraints;t&&qr(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!a)&&function(e,t){let{top:n,left:a,bottom:r,right:i}=t;return{x:Mo(e.x,a,i),y:Mo(e.y,n,r)}}(a.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Po;return!1===e?e=0:!0===e&&(e=Po),{x:Lo(e,"left","right"),y:Lo(e,"top","bottom")}}(n),r!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Io(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(a.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!qr(e))return!1;const n=e.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const r=function(e,t,n){const a=tn(e,n),{scroll:r}=t;return r&&(Zt(a.x,r.offset.x),Zt(a.y,r.offset.y)),a}(n,a.root,this.visualElement.getTransformPagePoint());let i=function(e,t){return{x:Oo(e.x,t.x),y:Oo(e.y,t.y)}}(a.layout.layoutBox,r);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(i));this.hasMutatedConstraints=!!e,e&&(i=Bt(e))}return i}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:a,dragTransition:r,dragSnapToOrigin:i,onDragTransitionEnd:s}=this.getProps(),o=this.constraints||{},u=Io(s=>{if(!Vo(s,t,this.currentDirection))return;let u=o&&o[s]||{};i&&(u={min:0,max:0});const c=a?200:1e6,d=a?40:1e7,h=l(l({type:"inertia",velocity:n?e[s]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10},r),u);return this.startAxisValueAnimation(s,h)});return Promise.all(u).then(s)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return li(this.visualElement,e),n.start(Hs(e,n,0,t,this.visualElement,!1))}stopAnimation(){Io(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Io(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),a=n[t];return a||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Io(t=>{const{drag:n}=this.getProps();if(!Vo(t,n,this.currentDirection))return;const{projection:a}=this.visualElement,r=this.getAxisMotionValue(t);if(a&&a.layout){const{min:n,max:i}=a.layout.layoutBox[t];r.set(e[t]-Wt(n,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!qr(t)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Io(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();a[e]=function(e,t){let n=.5;const a=bo(e),r=bo(t);return r>a?n=os(t.min,t.max-a,e.min):a>r&&(n=os(e.min,e.max-r,t.min)),an(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Io(t=>{if(!Vo(t,e,null))return;const n=this.getAxisMotionValue(t),{min:r,max:i}=this.constraints[t];n.set(Wt(r,i,a[t]))})}addListeners(){if(!this.visualElement.current)return;Bo.set(this.visualElement,this);const e=yo(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();qr(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),An.read(t);const r=fo(window,"resize",()=>this.scalePositionWithinConstraints()),i=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(Io(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{r(),e(),a(),i&&i()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:r=!1,dragElastic:i=Po,dragMomentum:s=!0}=e;return l(l({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:a,dragConstraints:r,dragElastic:i,dragMomentum:s})}}function Vo(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const Uo=e=>(t,n)=>{e&&An.postRender(()=>e(t,n))};function jo(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=(0,e.useContext)(Lr);if(null===n)return[!0,null];const{isPresent:a,onExitComplete:r,register:i}=n,s=(0,e.useId)();(0,e.useEffect)(()=>{if(t)return i(s)},[t]);const o=(0,e.useCallback)(()=>t&&r&&r(s),[s,r,t]);return!a&&r?[!1,o]:[!0]}const Go={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ho(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const qo={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!dn.test(e))return e;e=parseFloat(e)}const n=Ho(e,t.target.x),a=Ho(e,t.target.y);return"".concat(n,"% ").concat(a,"%")}},Ko={correct:(e,t)=>{let{treeScale:n,projectionDelta:a}=t;const r=e,i=oa.parse(e);if(i.length>5)return r;const s=oa.createTransformer(e),o="number"!==typeof i[0]?1:0,l=a.x.scale*n.x,u=a.y.scale*n.y;i[0+o]/=l,i[1+o]/=u;const c=Wt(l,u,.5);return"number"===typeof i[2+o]&&(i[2+o]/=c),"number"===typeof i[3+o]&&(i[3+o]/=c),s(i)}};let Xo=!1;class Yo extends e.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:a}=this.props,{projection:r}=e;!function(e){for(const t in e)ar[t]=e[t],Ot(t)&&(ar[t].isCSSVariable=!0)}(Jo),r&&(t.group&&t.group.add(r),n&&n.register&&a&&n.register(r),Xo&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions(l(l({},r.options),{},{onExitComplete:()=>this.safeToRemove()}))),Go.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:a,isPresent:r}=this.props,{projection:i}=n;return i?(i.isPresent=r,Xo=!0,a||e.layoutDependency!==t||void 0===t||e.isPresent!==r?i.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?i.promote():i.relegate()||An.postRender(()=>{const e=i.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Fa.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:a}=e;Xo=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Qo(t){const[n,a]=jo(),r=(0,e.useContext)(xr);return(0,vr.jsx)(Yo,l(l({},t),{},{layoutGroup:r,switchLayoutGroup:(0,e.useContext)(Yr),isPresent:n,safeToRemove:a}))}const Jo={borderRadius:l(l({},qo),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:qo,borderTopRightRadius:qo,borderBottomLeftRadius:qo,borderBottomRightRadius:qo,boxShadow:Ko};function Zo(e){return"object"===typeof e&&null!==e}function $o(e){return Zo(e)&&"ownerSVGElement"in e}const el=(e,t)=>e.depth-t.depth;class tl{constructor(){this.children=[],this.isDirty=!1}add(e){Sa(this.children,e),this.isDirty=!0}remove(e){Ia(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(el),this.isDirty=!1,this.children.forEach(e)}}function nl(e,t){const n=ka.now(),a=r=>{let{timestamp:i}=r;const s=i-n;s>=t&&(Fn(a),e(s-t))};return An.setup(a,!0),()=>Fn(a)}const al=["TopLeft","TopRight","BottomLeft","BottomRight"],rl=al.length,il=e=>"string"===typeof e?parseFloat(e):e,sl=e=>"number"===typeof e||dn.test(e);function ol(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const ll=cl(0,.5,ns),ul=cl(.5,.95,Nn);function cl(e,t,n){return a=>a<e?0:a>t?1:n(os(e,t,a))}function dl(e,t){e.min=t.min,e.max=t.max}function hl(e,t){dl(e.x,t.x),dl(e.y,t.y)}function pl(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function fl(e,t,n,a,r){return e=qt(e-=t,1/n,a),void 0!==r&&(e=qt(e,1/r,a)),e}function ml(e,t,n,a,r){let[i,s,o]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;cn.test(t)&&(t=parseFloat(t),t=Wt(s.min,s.max,t/100)-s.min);if("number"!==typeof t)return;let o=Wt(i.min,i.max,a);e===i&&(o-=t),e.min=fl(e.min,t,n,o,r),e.max=fl(e.max,t,n,o,r)}(e,t[i],t[s],t[o],t.scale,a,r)}const gl=["x","scaleX","originX"],yl=["y","scaleY","originY"];function bl(e,t,n,a){ml(e.x,t,gl,n?n.x:void 0,a?a.x:void 0),ml(e.y,t,yl,n?n.y:void 0,a?a.y:void 0)}function vl(e){return 0===e.translate&&1===e.scale}function xl(e){return vl(e.x)&&vl(e.y)}function wl(e,t){return e.min===t.min&&e.max===t.max}function kl(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Sl(e,t){return kl(e.x,t.x)&&kl(e.y,t.y)}function Il(e){return bo(e.x)/bo(e.y)}function Nl(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Tl{constructor(){this.members=[]}add(e){Sa(this.members,e),e.scheduleRender()}remove(e){if(Ia(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let a=t;a>=0;a--){const e=this.members[a];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:a}=e.options;!1===a&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Cl={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},El=["","X","Y","Z"];let _l=0;function Al(e,t,n,a){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),a&&(a[e]=0))}function Fl(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=ui(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",An,!(t||a))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&Fl(a)}function Rl(e){let{attachResizeListener:t,defaultParent:n,measureScroll:a,checkIsScrollRoot:r,resetTransform:i}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=_l++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,En.value&&(Cl.nodes=Cl.calculatedTargetDeltas=Cl.calculatedProjections=0),this.nodes.forEach(Ol),this.nodes.forEach(Ul),this.nodes.forEach(jl),this.nodes.forEach(Pl),En.addProjectionMetrics&&En.addProjectionMetrics(Cl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new tl)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Na),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];t&&t.notify(...a)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;var n;this.isSVG=$o(e)&&!($o(n=e)&&"svg"===n.tagName),this.instance=e;const{layoutId:a,layout:r,visualElement:i}=this.options;if(i&&!i.current&&i.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(r||a)&&(this.isLayoutDirty=!0),t){let n,a=0;const r=()=>this.root.updateBlockedByResize=!1;An.read(()=>{a=window.innerWidth}),t(e,()=>{const e=window.innerWidth;e!==a&&(a=e,this.root.updateBlockedByResize=!0,n&&n(),n=nl(r,250),Go.hasAnimatedSinceResize&&(Go.hasAnimatedSinceResize=!1,this.nodes.forEach(Vl)))})}a&&this.root.registerSharedNode(a,this),!1!==this.options.animate&&i&&(a||r)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:a,layout:r}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const s=this.options.transition||i.getDefaultTransition()||Yl,{onLayoutAnimationStart:o,onLayoutAnimationComplete:u}=i.getProps(),c=!this.targetLayout||!Sl(this.targetLayout,r),d=!n&&a;if(this.options.layoutRoot||this.resumeFrom||d||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const e=l(l({},ai(s,"layout")),{},{onPlay:o,onComplete:u});(i.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,d)}else n||Vl(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Fn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Gl),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Fl(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let r=0;r<this.path.length;r++){const e=this.path[r];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const a=this.getTransformTemplate();this.prevTransformTemplateValue=a?a(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(zl);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(Bl);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Wl),this.nodes.forEach(Dl),this.nodes.forEach(Ml)):this.nodes.forEach(Bl),this.clearAllSnapshots();const e=ka.now();Rn.delta=an(0,1e3/60,e-Rn.timestamp),Rn.timestamp=e,Rn.isProcessing=!0,Dn.update.process(Rn),Dn.preRender.process(Rn),Dn.render.process(Rn),Rn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Fa.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Ll),this.sharedNodes.forEach(Hl)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,An.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){An.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||bo(this.snapshot.measuredBox.x)||bo(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!xl(this.projectionDelta),n=this.getTransformTemplate(),a=n?n(this.latestValues,""):void 0,r=a!==this.prevTransformTemplateValue;e&&this.instance&&(t||jt(this.latestValues)||r)&&(i(this.instance,a),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var a;return e&&(n=this.removeTransform(n)),Zl((a=n).x),Zl(a.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(eu))){const{scroll:e}=this.root;e&&(Zt(n.x,e.offset.x),Zt(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(hl(n,e),null!==(t=this.scroll)&&void 0!==t&&t.wasRoot)return n;for(let a=0;a<this.path.length;a++){const t=this.path[a],{scroll:r,options:i}=t;t!==this.root&&r&&i.layoutScroll&&(r.wasRoot&&hl(n,e),Zt(n.x,r.offset.x),Zt(n.y,r.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};hl(n,e);for(let a=0;a<this.path.length;a++){const e=this.path[a];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&en(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),jt(e.latestValues)&&en(n,e.latestValues)}return jt(this.latestValues)&&en(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};hl(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!jt(e.latestValues))continue;Ut(e.latestValues)&&e.updateSnapshot();const a=Oa();hl(a,e.measurePageBox()),bl(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,a)}return jt(this.latestValues)&&bl(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=l(l(l({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Rn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const a=Boolean(this.resumingFrom)||this!==n;if(!(t||a&&this.isSharedProjectionDirty||this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:r,layoutId:i}=this.options;if(this.layout&&(r||i)){if(this.resolvedRelativeTargetAt=Rn.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},So(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),hl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var s,o,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),s=this.target,o=this.relativeTarget,l=this.relativeParent.target,wo(s.x,o.x,l.x),wo(s.y,o.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):hl(this.target,this.layout.layoutBox),Yt(this.target,this.targetDelta)):hl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},So(this.relativeTargetOrigin,this.target,e.target),hl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}En.value&&Cl.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!Ut(this.parent.latestValues)&&!Gt(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let a=!0;if((this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty)&&(a=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(a=!1),this.resolvedRelativeTargetAt===Rn.timestamp&&(a=!1),a)return;const{layout:r,layoutId:i}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!i)return;hl(this.layoutCorrected,this.layout.layoutBox);const s=this.treeScale.x,o=this.treeScale.y;!function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=n.length;if(!r)return;let i,s;t.x=t.y=1;for(let o=0;o<r;o++){i=n[o],s=i.projectionDelta;const{visualElement:r}=i.options;r&&r.props.style&&"contents"===r.props.style.display||(a&&i.options.layoutScroll&&i.scroll&&i!==i.root&&en(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,Yt(e,s)),a&&jt(i.latestValues)&&en(e,i.latestValues))}t.x<Jt&&t.x>Qt&&(t.x=1),t.y<Jt&&t.y>Qt&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(pl(this.prevProjectionDelta.x,this.projectionDelta.x),pl(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),xo(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===s&&this.treeScale.y===o&&Nl(this.projectionDelta.x,this.prevProjectionDelta.x)&&Nl(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),En.value&&Cl.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,a=n?n.latestValues:{},r=l({},this.latestValues),i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const s={x:{min:0,max:0},y:{min:0,max:0}},o=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),u=this.getStack(),c=!u||u.members.length<=1,d=Boolean(o&&!c&&!0===this.options.crossfade&&!this.path.some(Xl));let h;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,u;ql(i.x,e.x,n),ql(i.y,e.y,n),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(So(s,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,n,a){Kl(e.x,t.x,n.x,a),Kl(e.y,t.y,n.y,a)}(this.relativeTarget,this.relativeTargetOrigin,s,n),h&&(l=this.relativeTarget,u=h,wl(l.x,u.x)&&wl(l.y,u.y))&&(this.isProjectionDirty=!1),h||(h={x:{min:0,max:0},y:{min:0,max:0}}),hl(h,this.relativeTarget)),o&&(this.animationValues=r,function(e,t,n,a,r,i){var s,o;if(r)e.opacity=Wt(0,null!==(s=n.opacity)&&void 0!==s?s:1,ll(a)),e.opacityExit=Wt(null!==(o=t.opacity)&&void 0!==o?o:1,0,ul(a));else if(i){var l,u;e.opacity=Wt(null!==(l=t.opacity)&&void 0!==l?l:1,null!==(u=n.opacity)&&void 0!==u?u:1,a)}for(let c=0;c<rl;c++){const r="border".concat(al[c],"Radius");let i=ol(t,r),s=ol(n,r);void 0===i&&void 0===s||(i||(i=0),s||(s=0),0===i||0===s||sl(i)===sl(s)?(e[r]=Math.max(Wt(il(i),il(s),a),0),(cn.test(s)||cn.test(i))&&(e[r]+="%")):e[r]=s)}(t.rotate||n.rotate)&&(e.rotate=Wt(t.rotate||0,n.rotate||0,a))}(r,a,this.latestValues,n,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,n;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),null===(n=this.resumingFrom)||void 0===n||null===(n=n.currentAnimation)||void 0===n||n.stop(),this.pendingAnimation&&(Fn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=An.update(()=>{Go.hasAnimatedSinceResize=!0,mi.layout++,this.motionValue||(this.motionValue=_a(0)),this.currentAnimation=function(e,t,n){const a=va(e)?e:_a(e);return a.start(Hs("",a,t,n)),a.animation}(this.motionValue,[0,1e3],l(l({},e),{},{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{mi.layout--},onComplete:()=>{mi.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:a,latestValues:r}=e;if(t&&n&&a){if(this!==e&&this.layout&&a&&$l(this.options.animationType,this.layout.layoutBox,a.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=bo(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const a=bo(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+a}hl(t,n),en(t,r),xo(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Tl);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=this.getStack();a&&a.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const a={};n.z&&Al("z",e,a,this.animationValues);for(let r=0;r<El.length;r++)Al("rotate".concat(El[r]),e,a,this.animationValues),Al("skew".concat(El[r]),e,a,this.animationValues);e.render();for(const r in a)e.setStaticValue(r,a[r]),this.animationValues&&(this.animationValues[r]=a[r]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=Br(null===t||void 0===t?void 0:t.pointerEvents)||"",void(e.transform=n?n(this.latestValues,""):"none");const a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Br(null===t||void 0===t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!jt(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1));e.visibility="";const r=a.animationValues||a.latestValues;this.applyTransformsToTarget();let i=function(e,t,n){let a="";const r=e.x.translate/t.x,i=e.y.translate/t.y,s=(null===n||void 0===n?void 0:n.z)||0;if((r||i||s)&&(a="translate3d(".concat(r,"px, ").concat(i,"px, ").concat(s,"px) ")),1===t.x&&1===t.y||(a+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:r,rotateY:i,skewX:s,skewY:o}=n;e&&(a="perspective(".concat(e,"px) ").concat(a)),t&&(a+="rotate(".concat(t,"deg) ")),r&&(a+="rotateX(".concat(r,"deg) ")),i&&(a+="rotateY(".concat(i,"deg) ")),s&&(a+="skewX(".concat(s,"deg) ")),o&&(a+="skewY(".concat(o,"deg) "))}const o=e.x.scale*t.x,l=e.y.scale*t.y;return 1===o&&1===l||(a+="scale(".concat(o,", ").concat(l,")")),a||"none"}(this.projectionDeltaWithTransform,this.treeScale,r);n&&(i=n(r,i)),e.transform=i;const{x:s,y:o}=this.projectionDelta;var l,u;(e.transformOrigin="".concat(100*s.origin,"% ").concat(100*o.origin,"% 0"),a.animationValues)?e.opacity=a===this?null!==(l=null!==(u=r.opacity)&&void 0!==u?u:this.latestValues.opacity)&&void 0!==l?l:1:this.preserveOpacity?this.latestValues.opacity:r.opacityExit:e.opacity=a===this?void 0!==r.opacity?r.opacity:"":void 0!==r.opacityExit?r.opacityExit:0;for(const c in ar){if(void 0===r[c])continue;const{correct:t,applyTo:n,isCSSVariable:s}=ar[c],o="none"===i?r[c]:t(r[c],a);if(n){const t=n.length;for(let a=0;a<t;a++)e[n[a]]=o}else s?this.options.visualElement.renderState.vars[c]=o:e[c]=o}this.options.layoutId&&(e.pointerEvents=a===this?Br(null===t||void 0===t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(zl),this.root.sharedNodes.clear()}}}function Dl(e){e.updateLayout()}function Ml(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:a}=e.layout,{animationType:r}=e.options,i=n.source!==e.layout.source;"size"===r?Io(e=>{const a=i?n.measuredBox[e]:n.layoutBox[e],r=bo(a);a.min=t[e].min,a.max=a.min+r}):$l(r,n.layoutBox,t)&&Io(a=>{const r=i?n.measuredBox[a]:n.layoutBox[a],s=bo(t[a]);r.max=r.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[a].max=e.relativeTarget[a].min+s)});const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};xo(s,t,n.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};i?xo(o,e.applyTransform(a,!0),n.measuredBox):xo(o,t,n.layoutBox);const l=!xl(s);let u=!1;if(!e.resumeFrom){const a=e.getClosestProjectingParent();if(a&&!a.resumeFrom){const{snapshot:r,layout:i}=a;if(r&&i){const s={x:{min:0,max:0},y:{min:0,max:0}};So(s,n.layoutBox,r.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};So(o,t,i.layoutBox),Sl(s,o)||(u=!0),a.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=s,e.relativeParent=a)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:o,layoutDelta:s,hasLayoutChanged:l,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Ol(e){En.value&&Cl.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Pl(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Ll(e){e.clearSnapshot()}function zl(e){e.clearMeasurements()}function Bl(e){e.isLayoutDirty=!1}function Wl(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Vl(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ul(e){e.resolveTargetDelta()}function jl(e){e.calcProjection()}function Gl(e){e.resetSkewAndRotation()}function Hl(e){e.removeLeadSnapshot()}function ql(e,t,n){e.translate=Wt(t.translate,0,n),e.scale=Wt(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Kl(e,t,n,a){e.min=Wt(t.min,n.min,a),e.max=Wt(t.max,n.max,a)}function Xl(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const Yl={duration:.45,ease:[.4,0,.1,1]},Ql=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Jl=Ql("applewebkit/")&&!Ql("chrome/")?Math.round:Nn;function Zl(e){e.min=Jl(e.min),e.max=Jl(e.max)}function $l(e,t,n){return"position"===e||"preserve-aspect"===e&&(a=Il(t),r=Il(n),i=.2,!(Math.abs(a-r)<=i));var a,r,i}function eu(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const tu=Rl({attachResizeListener:(e,t)=>fo(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),nu={current:void 0},au=Rl({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!nu.current){const e=new tu({});e.mount(window),e.setOptions({layoutScroll:!0}),nu.current=e}return nu.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),ru={pan:{Feature:class extends lo{constructor(){super(...arguments),this.removePointerDownListener=Nn}onPointerDown(e){this.session=new Co(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:No(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:Uo(e),onStart:Uo(t),onMove:n,onEnd:(e,t)=>{delete this.session,a&&An.postRender(()=>a(e,t))}}}mount(){this.removePointerDownListener=yo(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends lo{constructor(e){super(e),this.removeGroupControls=Nn,this.removeListeners=Nn,this.controls=new Wo(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Nn}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:au,MeasureLayout:Qo}};function iu(e,t){const n=function(e,t,n){if(e instanceof EventTarget)return[e];if("string"===typeof e){var a;let r=document;t&&(r=t.current);const i=null!==(a=null===n||void 0===n?void 0:n[e])&&void 0!==a?a:r.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}(e),a=new AbortController;return[n,l(l({passive:!0},t),{},{signal:a.signal}),()=>a.abort()]}function su(e){return!("touch"===e.pointerType||po())}function ou(e,t,n){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover","Start"===n);const r=a["onHover"+n];r&&An.postRender(()=>r(t,go(t)))}function lu(e){return Zo(e)&&"offsetHeight"in e}const uu=(e,t)=>!!t&&(e===t||uu(e,t.parentElement)),cu=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const du=new WeakSet;function hu(e){return t=>{"Enter"===t.key&&e(t)}}function pu(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function fu(e){return mo(e)&&!po()}function mu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[a,r,i]=iu(e,n),s=e=>{const a=e.currentTarget;if(!fu(e))return;du.add(a);const i=t(a,e),s=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),du.has(a)&&du.delete(a),fu(e)&&"function"===typeof i&&i(e,{success:t})},o=e=>{s(e,a===window||a===document||n.useGlobalTarget||uu(a,e.target))},l=e=>{s(e,!1)};window.addEventListener("pointerup",o,r),window.addEventListener("pointercancel",l,r)};return a.forEach(e=>{var t;(n.useGlobalTarget?window:e).addEventListener("pointerdown",s,r),lu(e)&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const a=hu(()=>{if(du.has(n))return;pu(n,"down");const e=hu(()=>{pu(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>pu(n,"cancel"),t)});n.addEventListener("keydown",a,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",a),t)})(e,r)),t=e,cu.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),i}function gu(e,t,n){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap","Start"===n);const r=a["onTap"+("End"===n?"":n)];r&&An.postRender(()=>r(t,go(t)))}const yu=["root"],bu=new WeakMap,vu=new WeakMap,xu=e=>{const t=bu.get(e.target);t&&t(e)},wu=e=>{e.forEach(xu)};function ku(e,t,n){const r=function(e){let{root:t}=e,n=a(e,yu);const r=t||document;vu.has(r)||vu.set(r,{});const i=vu.get(r),s=JSON.stringify(n);return i[s]||(i[s]=new IntersectionObserver(wu,l({root:t},n))),i[s]}(t);return bu.set(e,n),r.observe(e),()=>{bu.delete(e),r.unobserve(e)}}const Su={some:0,all:1};const Iu={inView:{Feature:class extends lo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:a="some",once:r}=e,i={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof a?a:Su[a]};return ku(this.node.current,i,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,r&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:a}=this.node.getProps(),i=t?n:a;i&&i(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends lo{mount(){const{current:e}=this.node;e&&(this.unmount=mu(e,(e,t)=>(gu(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return gu(this.node,e,n?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends lo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(Xm){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hi(fo(this.node.current,"focus",()=>this.onFocus()),fo(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends lo{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[a,r,i]=iu(e,n),s=e=>{if(!su(e))return;const{target:n}=e,a=t(n,e);if("function"!==typeof a||!n)return;const i=e=>{su(e)&&(a(e),n.removeEventListener("pointerleave",i))};n.addEventListener("pointerleave",i,r)};return a.forEach(e=>{e.addEventListener("pointerenter",s,r)}),i}(e,(e,t)=>(ou(this.node,t,"Start"),e=>ou(this.node,e,"End"))))}unmount(){}}}},Nu={layout:{ProjectionNode:au,MeasureLayout:Qo}},Tu=ti(l(l(l(l({},co),Iu),ru),Nu),br),Cu=e=>{let{children:t,className:n}=e;return(0,vr.jsxs)("div",{className:"relative overflow-hidden ".concat(n||""),children:[(0,vr.jsx)(_u,{}),(0,vr.jsx)("div",{className:"relative z-10",children:t})]})},Eu=e=>{let{children:t,className:n}=e;return(0,vr.jsx)(Tu.span,{initial:{backgroundSize:"0% 100%"},animate:{backgroundSize:"100% 100%"},transition:{duration:2,ease:"linear",delay:.5},style:{backgroundRepeat:"no-repeat",backgroundPosition:"left center",display:"inline"},className:"relative inline-block bg-gradient-to-r from-primary-500 to-accent-500 bg-clip-text text-transparent ".concat(n||""),children:t})},_u=()=>(0,vr.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,vr.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900 via-blue-900 to-purple-900"}),(0,vr.jsx)(Tu.div,{animate:{x:[0,100,0],y:[0,-100,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-0 left-0 w-96 h-96 bg-primary-500/30 rounded-full blur-3xl"}),(0,vr.jsx)(Tu.div,{animate:{x:[0,-100,0],y:[0,100,0]},transition:{duration:15,repeat:1/0,ease:"linear"},className:"absolute bottom-0 right-0 w-96 h-96 bg-accent-500/30 rounded-full blur-3xl"}),(0,vr.jsx)(Tu.div,{animate:{x:[0,50,0],y:[0,50,0]},transition:{duration:25,repeat:1/0,ease:"linear"},className:"absolute top-1/2 left-1/2 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl"})]}),Au=t=>{let{words:n,className:a,cursorClassName:r}=t;const[i,s]=(0,e.useState)(0),[o,l]=(0,e.useState)(""),[u,c]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{const e=n[i],t=setTimeout(()=>{u?(l(e.substring(0,o.length-1)),""===o&&(c(!1),s(e=>(e+1)%n.length))):(l(e.substring(0,o.length+1)),o===e&&setTimeout(()=>c(!0),1500))},u?50:150);return()=>clearTimeout(t)},[o,u,i,n]),(0,vr.jsxs)("div",{className:"flex items-center space-x-1 ".concat(a||""),children:[(0,vr.jsx)(Tu.span,{initial:{opacity:0},animate:{opacity:1},className:"text-xl md:text-2xl lg:text-3xl font-medium",children:o}),(0,vr.jsx)(Tu.span,{animate:{opacity:[1,0,1]},transition:{duration:.8,repeat:1/0},className:"inline-block w-[3px] h-6 md:h-8 bg-primary-500 ".concat(r||"")})]})},Fu=e=>{let{onLearnMore:t}=e;return(0,vr.jsx)(Cu,{className:"min-h-screen flex items-center justify-center px-4 py-20",children:(0,vr.jsxs)("div",{className:"max-w-7xl mx-auto text-center",children:[(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary-500/10 border border-primary-500/20 backdrop-blur-sm mb-8",children:[(0,vr.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,vr.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-400 opacity-75"}),(0,vr.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-primary-500"})]}),(0,vr.jsx)("span",{className:"text-sm text-gray-300",children:"AI-Powered \u2022 Real-Time \u2022 Privacy-First"})]}),(0,vr.jsxs)(Tu.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"text-4xl md:text-6xl lg:text-7xl font-bold text-white mb-6",children:["Transform Your Webcam",(0,vr.jsx)("br",{}),"Experience with ",(0,vr.jsx)(Eu,{children:"LearnLens"})]}),(0,vr.jsx)(Tu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},className:"mb-8 text-gray-300",children:(0,vr.jsx)(Au,{words:["20+ Real-Time Filters","AI-Powered Recommendations","Face Detection & Emotion Recognition","100% Private & Browser-Based"],className:"justify-center"})}),(0,vr.jsx)(Tu.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"text-lg md:text-xl text-gray-400 mb-12 max-w-3xl mx-auto",children:"Apply stunning real-time filters, get AI-powered recommendations, and explore advanced face detection - all in your browser with zero installation required."}),(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.7},className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,vr.jsxs)(ft,{to:"/demo",className:"group relative inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-accent-600 rounded-lg overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-primary-500/50",children:[(0,vr.jsxs)("span",{className:"relative z-10 flex items-center gap-2",children:["\ud83d\ude80 Launch LearnLens",(0,vr.jsx)(Tu.span,{animate:{x:[0,5,0]},transition:{duration:1.5,repeat:1/0},children:"\u2192"})]}),(0,vr.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-500 to-accent-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,vr.jsx)("button",{onClick:t,className:"inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-gray-300 bg-white/5 backdrop-blur-sm border border-white/10 rounded-lg hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:"\ud83d\udcda Learn to Build This"})]}),(0,vr.jsx)(Tu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.9},className:"mt-16 flex flex-wrap justify-center gap-4",children:[{icon:"\ud83c\udfa8",text:"20+ Filters"},{icon:"\ud83e\udd16",text:"AI Powered"},{icon:"\ud83e\udde0",text:"Face Detection"},{icon:"\ud83d\ude0a",text:"Emotion Recognition"},{icon:"\ud83d\udd12",text:"100% Private"},{icon:"\u26a1",text:"Real-Time"}].map((e,t)=>(0,vr.jsxs)(Tu.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.9+.1*t},className:"px-4 py-2 bg-white/5 backdrop-blur-sm border border-white/10 rounded-full text-sm text-gray-300 hover:bg-white/10 hover:border-white/20 transition-all duration-300 cursor-default",children:[(0,vr.jsx)("span",{className:"mr-2",children:e.icon}),e.text]},t))}),(0,vr.jsx)(Tu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:1.2},className:"mt-20",children:(0,vr.jsxs)(Tu.div,{animate:{y:[0,10,0]},transition:{duration:2,repeat:1/0},className:"inline-flex flex-col items-center gap-2 text-gray-500 cursor-pointer hover:text-gray-300 transition-colors",children:[(0,vr.jsx)("span",{className:"text-sm",children:"Explore Features"}),(0,vr.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]})})]})})},Ru=()=>{const e=["col-span-2 row-span-2","col-span-1 row-span-1","col-span-1 row-span-1","col-span-1 row-span-2","col-span-2 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1","col-span-2 row-span-1","col-span-1 row-span-1","col-span-1 row-span-2","col-span-1 row-span-1","col-span-2 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1","col-span-1 row-span-1"],t={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,vr.jsx)("section",{className:"py-20 px-4 bg-gradient-to-b from-transparent to-black/20",children:(0,vr.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},className:"text-center mb-16",children:[(0,vr.jsxs)("h2",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:["Explore ",(0,vr.jsx)("span",{className:"bg-gradient-to-r from-primary-400 to-accent-400 bg-clip-text text-transparent",children:"20+ Stunning Filters"})]}),(0,vr.jsx)("p",{className:"text-lg text-gray-400 max-w-2xl mx-auto",children:"From vintage classics to futuristic cyberpunk - find the perfect filter for every moment"})]}),(0,vr.jsx)(Tu.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",whileInView:"show",viewport:{once:!0},className:"grid grid-cols-2 md:grid-cols-4 gap-4 auto-rows-[160px]",children:[{id:"none",name:"Original",icon:"\u2728",description:"Pure, unfiltered you"},{id:"grayscale",name:"Grayscale",icon:"\u26ab",description:"Classic black & white"},{id:"sepia",name:"Sepia",icon:"\ud83d\udfe4",description:"Timeless vintage tone"},{id:"vintage",name:"Vintage",icon:"\ud83d\udcf7",description:"Classic film look"},{id:"cyberpunk",name:"Cyberpunk",icon:"\ud83e\udd16",description:"Futuristic neon vibes"},{id:"moonlight",name:"Moonlight",icon:"\ud83c\udf19",description:"Ethereal blue tones"},{id:"sunset",name:"Sunset",icon:"\ud83c\udf05",description:"Golden hour magic"},{id:"warm",name:"Warm",icon:"\ud83d\udd25",description:"Cozy, inviting tones"},{id:"cool",name:"Cool",icon:"\u2744\ufe0f",description:"Fresh, professional look"},{id:"saturate",name:"Vibrant",icon:"\ud83c\udf08",description:"Saturated, punchy colors"},{id:"dramatic",name:"Dramatic",icon:"\ud83c\udfad",description:"High contrast intensity"},{id:"noir",name:"Noir",icon:"\ud83c\udfac",description:"Black & white with grain"},{id:"ocean",name:"Ocean",icon:"\ud83c\udf0a",description:"Deep blue serenity"},{id:"rose",name:"Rose",icon:"\ud83c\udf39",description:"Romantic pink glow"},{id:"pastel",name:"Pastel",icon:"\ud83c\udfa8",description:"Soft, dreamy colors"},{id:"brightness",name:"Bright",icon:"\u2600\ufe0f",description:"Enhanced luminosity"},{id:"contrast",name:"Contrast",icon:"\u26a1",description:"Bold definition"},{id:"blur",name:"Blur",icon:"\ud83d\udcab",description:"Soft focus effect"}].map((n,a)=>(0,vr.jsx)(ft,{to:"/demo",children:(0,vr.jsxs)(Tu.div,{variants:t,whileHover:{scale:1.05,zIndex:10},className:"".concat(e[a%e.length]," group relative overflow-hidden rounded-2xl bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 backdrop-blur-sm cursor-pointer transition-all duration-300 hover:border-primary-500/50 hover:shadow-2xl hover:shadow-primary-500/20"),children:[(0,vr.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,vr.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500/20 to-accent-500/20"})}),(0,vr.jsxs)("div",{className:"relative h-full p-6 flex flex-col justify-between",children:[(0,vr.jsx)("div",{className:"text-4xl md:text-5xl mb-2",children:n.icon}),(0,vr.jsxs)("div",{children:[(0,vr.jsx)("h3",{className:"text-lg md:text-xl font-semibold text-white mb-1",children:n.name}),(0,vr.jsx)("p",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors",children:n.description})]}),(0,vr.jsx)(Tu.div,{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 text-white",initial:{x:-10},whileHover:{x:0},children:(0,vr.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})})]})]})},n.id))}),(0,vr.jsx)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.3},className:"mt-12 text-center",children:(0,vr.jsxs)(ft,{to:"/demo",className:"inline-flex items-center gap-2 px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-accent-600 rounded-lg hover:scale-105 hover:shadow-2xl hover:shadow-primary-500/50 transition-all duration-300",children:[(0,vr.jsx)("span",{children:"Try All Filters Now"}),(0,vr.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})})},Du=()=>(0,vr.jsx)("section",{className:"py-20 px-4 bg-gradient-to-b from-black/20 to-transparent",children:(0,vr.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},className:"text-center mb-16",children:[(0,vr.jsxs)("h2",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:["Want to ",(0,vr.jsx)("span",{className:"bg-gradient-to-r from-primary-400 to-accent-400 bg-clip-text text-transparent",children:"Build This Yourself?"})]}),(0,vr.jsx)("p",{className:"text-lg text-gray-400 max-w-2xl mx-auto",children:"Follow our comprehensive 8-level tutorial to build LearnLens from scratch. Learn React, WebRTC, Canvas, AI, and Machine Learning."}),(0,vr.jsxs)("div",{className:"mt-4 inline-flex items-center gap-2 text-sm text-gray-500",children:[(0,vr.jsx)("span",{children:"Total Learning Time: 15-20 hours"}),(0,vr.jsx)("span",{children:"\u2022"}),(0,vr.jsx)("span",{children:"8 Progressive Levels"}),(0,vr.jsx)("span",{children:"\u2022"}),(0,vr.jsx)("span",{children:"Hands-On Building"})]})]}),(0,vr.jsxs)("div",{className:"relative",children:[(0,vr.jsx)("div",{className:"absolute left-8 md:left-1/2 top-0 bottom-0 w-[2px] bg-gradient-to-b from-primary-500/50 via-accent-500/50 to-primary-500/50"}),(0,vr.jsx)("div",{className:"space-y-12",children:[{level:1,title:"React Basics",description:"Component structure, JSX syntax, useState, and event handlers",tech:["React","JSX","Hooks"],difficulty:"\ud83d\udfe2 Beginner",time:"1-2 hours",color:"from-green-500 to-emerald-500"},{level:2,title:"Webcam & Canvas",description:"useRef, WebRTC getUserMedia, Canvas 2D rendering, requestAnimationFrame",tech:["WebRTC","Canvas API","useRef"],difficulty:"\ud83d\udfe2 Beginner",time:"2-3 hours",color:"from-blue-500 to-cyan-500"},{level:3,title:"Filters & Effects",description:"CSS filters, canvas transformations, dynamic filter switching",tech:["CSS Filters","Transformations"],difficulty:"\ud83d\udfe1 Intermediate",time:"1-2 hours",color:"from-yellow-500 to-orange-500"},{level:4,title:"Photo Capture",description:"Canvas toDataURL(), Blob API, file downloads, modal components",tech:["Canvas API","Blob","Download"],difficulty:"\ud83d\udfe1 Intermediate",time:"1-2 hours",color:"from-orange-500 to-red-500"},{level:5,title:"Stickers & Drag",description:"Drag & Drop API, mouse events, coordinate transformations",tech:["Drag & Drop","Events"],difficulty:"\ud83d\udfe1 Intermediate",time:"2-3 hours",color:"from-pink-500 to-rose-500"},{level:6,title:"AI Integration",description:"Environment variables, API security, async/await, Gemini AI API",tech:["Gemini API","Async/Await"],difficulty:"\ud83d\udd34 Advanced",time:"2-3 hours",color:"from-purple-500 to-violet-500"},{level:7,title:"AI Vision",description:"Base64 encoding, multimodal AI (text + image), vision API prompting",tech:["Multimodal AI","Vision API"],difficulty:"\ud83d\udd34 Advanced",time:"2-3 hours",color:"from-indigo-500 to-blue-500"},{level:8,title:"Face Detection",description:"TensorFlow.js, ML models, facial landmarks, expression recognition",tech:["TensorFlow.js","Face-API","ML"],difficulty:"\ud83d\udd34 Advanced",time:"3-4 hours",color:"from-red-500 to-pink-500"}].map((e,t)=>(0,vr.jsxs)(Tu.div,{initial:{opacity:0,x:t%2===0?-50:50},whileInView:{opacity:1,x:0},viewport:{once:!0,margin:"-100px"},transition:{duration:.5,delay:.1*t},className:"relative flex items-center ".concat(t%2===0?"md:flex-row":"md:flex-row-reverse"),children:[(0,vr.jsx)("div",{className:"absolute left-8 md:left-1/2 transform md:-translate-x-1/2 w-16 h-16 rounded-full bg-gradient-to-br from-primary-600 to-accent-600 flex items-center justify-center text-white font-bold text-xl shadow-2xl shadow-primary-500/50 z-10 border-4 border-gray-900",children:e.level}),(0,vr.jsx)(Tu.div,{whileHover:{scale:1.02},className:"ml-28 md:ml-0 md:w-[calc(50%-4rem)] ".concat(t%2===0?"md:mr-auto md:pr-16":"md:ml-auto md:pl-16"),children:(0,vr.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 backdrop-blur-sm p-6 hover:border-primary-500/50 hover:shadow-2xl hover:shadow-primary-500/20 transition-all duration-300",children:[(0,vr.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 bg-gradient-to-br ".concat(e.color," transition-opacity duration-300")}),(0,vr.jsxs)("div",{className:"relative z-10",children:[(0,vr.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,vr.jsxs)("h3",{className:"text-2xl font-bold text-white",children:["Level ",e.level,": ",e.title]}),(0,vr.jsx)("span",{className:"text-sm whitespace-nowrap ml-2",children:e.difficulty})]}),(0,vr.jsx)("p",{className:"text-gray-400 mb-4",children:e.description}),(0,vr.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tech.map(t=>(0,vr.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-gradient-to-r ".concat(e.color," bg-opacity-10 text-white border border-white/20"),children:t},t))}),(0,vr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,vr.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,vr.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,vr.jsx)("span",{children:e.time})]}),(0,vr.jsxs)("a",{href:"https://github.com/devgunnu/LearnLens/blob/main/docs/README-LEVEL-".concat(e.level,".md"),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-400 hover:text-primary-300 font-medium flex items-center gap-1 group",children:[(0,vr.jsx)("span",{children:"View Tutorial"}),(0,vr.jsx)(Tu.svg,{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",whileHover:{x:3},children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})]})]})})]},e.level))})]}),(0,vr.jsx)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},className:"mt-16 text-center",children:(0,vr.jsxs)("a",{href:"https://github.com/devgunnu/LearnLens/tree/main/docs",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-accent-600 rounded-lg hover:scale-105 hover:shadow-2xl hover:shadow-primary-500/50 transition-all duration-300",children:[(0,vr.jsx)("span",{children:"Start Learning Journey"}),(0,vr.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})});function Mu(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function Ou(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e.useCallback(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const a=t.map(t=>{const a=Mu(t,e);return n||"function"!==typeof a||(n=!0),a});if(n)return()=>{for(let e=0;e<a.length;e++){const n=a[e];"function"===typeof n?n():Mu(t[e],null)}}}}(...n),n)}class Pu extends e.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=lu(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Lu(t){let{children:n,isPresent:a,anchorX:r,root:i}=t;const s=(0,e.useId)(),o=(0,e.useRef)(null),l=(0,e.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=(0,e.useContext)(kr),c=Ou(o,null===n||void 0===n?void 0:n.ref);return(0,e.useInsertionEffect)(()=>{const{width:e,height:t,top:n,left:c,right:d}=l.current;if(a||!o.current||!e||!t)return;const h="left"===r?"left: ".concat(c):"right: ".concat(d);o.current.dataset.motionPopId=s;const p=document.createElement("style");u&&(p.nonce=u);const f=null!==i&&void 0!==i?i:document.head;return f.appendChild(p),p.sheet&&p.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat(h,"px !important;\n            top: ").concat(n,"px !important;\n          }\n        ")),()=>{f.contains(p)&&f.removeChild(p)}},[a]),(0,vr.jsx)(Pu,{isPresent:a,childRef:o,sizeRef:l,children:e.cloneElement(n,{ref:c})})}const zu=t=>{let{children:n,initial:a,isPresent:r,onExitComplete:i,custom:s,presenceAffectsLayout:o,mode:u,anchorX:c,root:d}=t;const h=zr(Bu),p=(0,e.useId)();let f=!0,m=(0,e.useMemo)(()=>(f=!1,{id:p,initial:a,isPresent:r,custom:s,onExitComplete:e=>{h.set(e,!0);for(const t of h.values())if(!t)return;i&&i()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[r,h,i]);return o&&f&&(m=l({},m)),(0,e.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),e.useEffect(()=>{!r&&!h.size&&i&&i()},[r]),"popLayout"===u&&(n=(0,vr.jsx)(Lu,{isPresent:r,anchorX:c,root:d,children:n})),(0,vr.jsx)(Lr.Provider,{value:m,children:n})};function Bu(){return new Map}const Wu=e=>e.key||"";function Vu(t){const n=[];return e.Children.forEach(t,t=>{(0,e.isValidElement)(t)&&n.push(t)}),n}const Uu=t=>{let{children:n,custom:a,initial:r=!0,onExitComplete:i,presenceAffectsLayout:s=!0,mode:o="sync",propagate:l=!1,anchorX:u="left",root:c}=t;const[d,h]=jo(l),p=(0,e.useMemo)(()=>Vu(n),[n]),f=l&&!d?[]:p.map(Wu),m=(0,e.useRef)(!0),g=(0,e.useRef)(p),y=zr(()=>new Map),[b,v]=(0,e.useState)(p),[x,w]=(0,e.useState)(p);Qr(()=>{m.current=!1,g.current=p;for(let e=0;e<x.length;e++){const t=Wu(x[e]);f.includes(t)?y.delete(t):!0!==y.get(t)&&y.set(t,!1)}},[x,f.length,f.join("-")]);const k=[];if(p!==b){let e=[...p];for(let t=0;t<x.length;t++){const n=x[t],a=Wu(n);f.includes(a)||(e.splice(t,0,n),k.push(n))}return"wait"===o&&k.length&&(e=k),w(Vu(e)),v(p),null}const{forceRender:S}=(0,e.useContext)(xr);return(0,vr.jsx)(vr.Fragment,{children:x.map(e=>{const t=Wu(e),n=!(l&&!d)&&(p===x||f.includes(t));return(0,vr.jsx)(zu,{isPresent:n,initial:!(m.current&&!r)&&void 0,custom:a,presenceAffectsLayout:s,mode:o,root:c,onExitComplete:n?void 0:()=>{if(!y.has(t))return;y.set(t,!0);let e=!0;y.forEach(t=>{t||(e=!1)}),e&&(null===S||void 0===S||S(),w(g.current),l&&(null===h||void 0===h||h()),i&&i())},anchorX:u,children:e},t)})})},ju=()=>{const[t,n]=(0,e.useState)(null);return(0,vr.jsx)("section",{className:"py-20 px-4 bg-gradient-to-b from-transparent to-black/20",children:(0,vr.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},className:"text-center mb-16",children:[(0,vr.jsxs)("h2",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:["Frequently Asked ",(0,vr.jsx)("span",{className:"bg-gradient-to-r from-primary-400 to-accent-400 bg-clip-text text-transparent",children:"Questions"})]}),(0,vr.jsx)("p",{className:"text-lg text-gray-400",children:"Everything you need to know about LearnLens"})]}),(0,vr.jsx)("div",{className:"space-y-4",children:[{question:"Is LearnLens free?",answer:"Yes! LearnLens is completely free and open-source. The only optional cost is if you want to use AI features (Levels 6-7), which require a Google Gemini API key. Google offers a generous free tier for the Gemini API."},{question:"Is my data private?",answer:"Absolutely! All processing happens locally in your browser. Your photos and webcam feed never leave your device. We don't collect any data, use cookies, or track your activity. You have complete control over your privacy."},{question:"Do I need to install anything?",answer:"No installation required! Just open the website and start using it. For developers who want to run it locally or follow the learning path, you'll need Node.js installed on your computer."},{question:"Can I use this offline?",answer:"Core filters work offline once the page is loaded. However, AI features (recommendations, vision analysis) require an internet connection to communicate with the Gemini API."},{question:"What browsers are supported?",answer:"LearnLens works on all modern browsers: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+, and Opera 76+. You need webcam access and WebRTC support for the full experience."},{question:"How does face detection work?",answer:"We use TensorFlow.js and face-api.js to run machine learning models directly in your browser. The models detect 68 facial landmark points and can recognize 7 different emotions - all processed locally for your privacy."},{question:"Can I use this for commercial projects?",answer:"Yes! LearnLens is licensed under the MIT License, which allows you to use, modify, and distribute it freely - even for commercial purposes. Just keep the license notice in your code."},{question:"How long does the learning tutorial take?",answer:"The complete 8-level tutorial takes approximately 15-20 hours to complete, but you can go at your own pace. Each level is self-contained, so you can learn over a few days or weeks."}].map((e,a)=>(0,vr.jsx)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.3,delay:.05*a},children:(0,vr.jsxs)("button",{onClick:()=>n(t===a?null:a),className:"w-full text-left bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 hover:border-primary-500/50 hover:bg-white/10 transition-all duration-300",children:[(0,vr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,vr.jsx)("h3",{className:"text-lg md:text-xl font-semibold text-white pr-8",children:e.question}),(0,vr.jsx)(Tu.svg,{className:"w-6 h-6 text-primary-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:t===a?180:0},transition:{duration:.3},children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,vr.jsx)(Uu,{children:t===a&&(0,vr.jsx)(Tu.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,vr.jsx)("p",{className:"text-gray-400 mt-4 leading-relaxed",children:e.answer})})})]})},a))}),(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},className:"mt-12 text-center p-8 bg-gradient-to-br from-primary-500/10 to-accent-500/10 border border-primary-500/20 rounded-2xl backdrop-blur-sm",children:[(0,vr.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Still have questions?"}),(0,vr.jsx)("p",{className:"text-gray-400 mb-4",children:"Feel free to reach out on GitHub Discussions or open an issue"}),(0,vr.jsxs)("div",{className:"flex flex-wrap justify-center gap-4",children:[(0,vr.jsxs)("a",{href:"https://github.com/devgunnu/LearnLens/discussions",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-white/5 border border-white/10 rounded-lg text-white hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:[(0,vr.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),(0,vr.jsx)("span",{children:"Discussions"})]}),(0,vr.jsxs)("a",{href:"https://github.com/devgunnu/LearnLens/issues",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-primary-600 hover:bg-primary-700 rounded-lg text-white transition-all duration-300",children:[(0,vr.jsx)("span",{children:"Open an Issue"}),(0,vr.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})})},Gu=()=>(0,vr.jsx)("section",{className:"py-20 px-4",children:(0,vr.jsx)("div",{className:"max-w-5xl mx-auto",children:(0,vr.jsxs)(Tu.div,{initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},viewport:{once:!0},transition:{duration:.5},className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-primary-600 via-accent-600 to-primary-600 p-12 md:p-16",children:[(0,vr.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,vr.jsx)("div",{className:"absolute top-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl animate-float"}),(0,vr.jsx)("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}})]}),(0,vr.jsxs)("div",{className:"relative z-10 text-center",children:[(0,vr.jsx)(Tu.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.2},className:"text-3xl md:text-5xl font-bold text-white mb-6",children:"Ready to Transform Your Webcam Experience?"}),(0,vr.jsx)(Tu.p,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.3},className:"text-lg md:text-xl text-white/90 mb-8 max-w-2xl mx-auto",children:"Join thousands of users enjoying AI-powered filters, face detection, and real-time effects. No installation, no sign-up, no tracking."}),(0,vr.jsxs)(Tu.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.4},className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,vr.jsx)(ft,{to:"/demo",className:"group inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-primary-600 bg-white rounded-lg hover:scale-105 transition-all duration-300 shadow-xl",children:(0,vr.jsxs)("span",{className:"flex items-center gap-2",children:["\ud83d\ude80 Launch LearnLens Now",(0,vr.jsx)(Tu.span,{animate:{x:[0,5,0]},transition:{duration:1.5,repeat:1/0},children:"\u2192"})]})}),(0,vr.jsxs)("a",{href:"https://github.com/devgunnu/LearnLens",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-white bg-white/10 backdrop-blur-sm border-2 border-white/30 rounded-lg hover:bg-white/20 hover:border-white/50 transition-all duration-300",children:[(0,vr.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),"Star on GitHub"]})]}),(0,vr.jsx)(Tu.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{duration:.5,delay:.6},className:"mt-12 grid grid-cols-2 md:grid-cols-4 gap-6",children:[{value:"20+",label:"Filters"},{value:"100%",label:"Private"},{value:"0",label:"Installation"},{value:"Free",label:"Open Source"}].map((e,t)=>(0,vr.jsxs)("div",{className:"text-center",children:[(0,vr.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-white mb-1",children:e.value}),(0,vr.jsx)("div",{className:"text-sm text-white/70",children:e.label})]},t))})]})]})})}),Hu=()=>(0,vr.jsxs)("div",{className:"landing-page bg-gradient-to-b from-gray-900 via-purple-900 to-gray-900 min-h-screen",children:[(0,vr.jsx)(Fu,{onLearnMore:()=>{var e;null===(e=document.querySelector("#timeline-section"))||void 0===e||e.scrollIntoView({behavior:"smooth"})}}),(0,vr.jsx)(Ru,{}),(0,vr.jsx)(Gu,{}),(0,vr.jsx)("div",{id:"timeline-section",children:(0,vr.jsx)(Du,{})}),(0,vr.jsx)(ju,{}),(0,vr.jsx)("footer",{className:"py-12 px-4 border-t border-white/10 bg-black/20",children:(0,vr.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,vr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8",children:[(0,vr.jsxs)("div",{className:"md:col-span-2",children:[(0,vr.jsx)("h3",{className:"text-2xl font-bold text-white mb-3",children:(0,vr.jsx)("span",{className:"bg-gradient-to-r from-primary-400 to-accent-400 bg-clip-text text-transparent",children:"LearnLens"})}),(0,vr.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:"AI-powered webcam filters with face detection and emotion recognition. Transform your webcam experience or learn to build it yourself."}),(0,vr.jsxs)("div",{className:"flex gap-4",children:[(0,vr.jsx)("a",{href:"https://github.com/devgunnu/LearnLens",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors","aria-label":"GitHub",children:(0,vr.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})}),(0,vr.jsx)("a",{href:"https://twitter.com/devgunnu7",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors","aria-label":"Twitter",children:(0,vr.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,vr.jsx)("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})})})]})]}),(0,vr.jsxs)("div",{children:[(0,vr.jsx)("h4",{className:"text-white font-semibold mb-4",children:"Quick Links"}),(0,vr.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,vr.jsx)("li",{children:(0,vr.jsx)(ft,{to:"/demo",className:"text-gray-400 hover:text-white transition-colors",children:"Launch App"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://github.com/devgunnu/LearnLens/tree/main/docs",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"Documentation"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://github.com/devgunnu/LearnLens/issues",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"Report Issue"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://github.com/devgunnu/LearnLens/discussions",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"Community"})})]})]}),(0,vr.jsxs)("div",{children:[(0,vr.jsx)("h4",{className:"text-white font-semibold mb-4",children:"Resources"}),(0,vr.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://react.dev/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"React Docs"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://www.tensorflow.org/js",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"TensorFlow.js"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://ai.google.dev/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"Gemini API"})}),(0,vr.jsx)("li",{children:(0,vr.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors",children:"Web APIs"})})]})]})]}),(0,vr.jsxs)("div",{className:"pt-8 border-t border-white/10 text-center",children:[(0,vr.jsx)("p",{className:"text-gray-500 text-sm",children:"\xa9 2025 LearnLens. Released under the MIT License."}),(0,vr.jsx)("p",{className:"text-gray-600 text-xs mt-2",children:"Built with \u2764\ufe0f for creators, learners, and developers"})]})]})})]});var qu="/index.js",Ku=Object.defineProperty,Xu=n(291),Yu=(e,t)=>{for(var n in t)Ku(e,n,{get:t[n],enumerable:!0})};Yu({},{Abs:()=>Fd,Acos:()=>Rd,Acosh:()=>Dd,AdadeltaOptimizer:()=>vI,AdagradOptimizer:()=>xI,AdamOptimizer:()=>wI,AdamaxOptimizer:()=>kI,Add:()=>Md,AddN:()=>Od,All:()=>Pd,Any:()=>Ld,ArgMax:()=>zd,ArgMin:()=>Bd,Asin:()=>Wd,Asinh:()=>Vd,Atan:()=>Ud,Atan2:()=>Gd,Atanh:()=>jd,AvgPool:()=>Hd,AvgPool3D:()=>Kd,AvgPool3DGrad:()=>Xd,AvgPoolGrad:()=>qd,BackendWasm:()=>t7,BatchMatMul:()=>Yd,BatchToSpaceND:()=>Qd,Bincount:()=>Jd,BitwiseAnd:()=>Zd,BroadcastArgs:()=>eh,BroadcastTo:()=>$d,Callback:()=>ZP,CallbackList:()=>DF,Cast:()=>th,Ceil:()=>nh,ClipByValue:()=>ah,Complex:()=>rh,ComplexAbs:()=>ih,Concat:()=>sh,Conv2D:()=>oh,Conv2DBackpropFilter:()=>lh,Conv2DBackpropInput:()=>uh,Conv3D:()=>ch,Conv3DBackpropFilterV2:()=>dh,Conv3DBackpropInputV2:()=>hh,Cos:()=>ph,Cosh:()=>fh,CropAndResize:()=>yh,Cumprod:()=>mh,Cumsum:()=>gh,CustomCallback:()=>PF,DataStorage:()=>Tc,DenseBincount:()=>bh,DepthToSpace:()=>vh,DepthwiseConv2dNative:()=>xh,DepthwiseConv2dNativeBackpropFilter:()=>wh,DepthwiseConv2dNativeBackpropInput:()=>kh,Diag:()=>Sh,Dilation2D:()=>Ih,Dilation2DBackpropFilter:()=>Th,Dilation2DBackpropInput:()=>Nh,Draw:()=>Ch,ENV:()=>Ed,EarlyStopping:()=>tL,Einsum:()=>_h,Elu:()=>Ah,EluGrad:()=>Fh,Environment:()=>Id,Equal:()=>Dh,Erf:()=>Rh,Exp:()=>Mh,ExpandDims:()=>Oh,Expm1:()=>Ph,FFT:()=>Lh,Fill:()=>zh,FlipLeftRight:()=>Bh,Floor:()=>Wh,FloorDiv:()=>Vh,FromPixels:()=>Hf,FusedBatchNorm:()=>Uh,FusedConv2D:()=>Xf,FusedDepthwiseConv2D:()=>Yf,GPGPUContext:()=>$X,GatherNd:()=>Gh,GatherV2:()=>jh,GraphModel:()=>jz,Greater:()=>Hh,GreaterEqual:()=>qh,History:()=>OF,IFFT:()=>Xh,Identity:()=>Kh,Imag:()=>Yh,InputSpec:()=>OA,IsFinite:()=>Qh,IsInf:()=>Jh,IsNan:()=>Zh,KernelBackend:()=>Cc,LRN:()=>dp,LRNGrad:()=>hp,LayerVariable:()=>RA,LayersModel:()=>LR,LeakyRelu:()=>$h,Less:()=>ep,LessEqual:()=>tp,LinSpace:()=>np,Log:()=>ap,Log1p:()=>rp,LogSoftmax:()=>up,LogicalAnd:()=>ip,LogicalNot:()=>sp,LogicalOr:()=>op,LogicalXor:()=>lp,LowerBound:()=>cp,MathBackendCPU:()=>lW,MathBackendWebGL:()=>fQ,MatrixBandPart:()=>pp,Max:()=>fp,MaxPool:()=>gp,MaxPool3D:()=>bp,MaxPool3DGrad:()=>vp,MaxPoolGrad:()=>yp,MaxPoolWithArgmax:()=>xp,Maximum:()=>mp,Mean:()=>wp,Min:()=>kp,Minimum:()=>Sp,MirrorPad:()=>Ip,Mod:()=>Np,MomentumOptimizer:()=>II,Multinomial:()=>Tp,Multiply:()=>Cp,Neg:()=>Ep,NonMaxSuppressionV3:()=>Ap,NonMaxSuppressionV4:()=>Fp,NonMaxSuppressionV5:()=>Rp,NotEqual:()=>_p,OP_SCOPE_SUFFIX:()=>Cg,OneHot:()=>Mp,OnesLike:()=>Dp,Optimizer:()=>bI,OptimizerConstructors:()=>_N,Pack:()=>Op,PadV2:()=>Pp,Pool:()=>Lp,Pow:()=>zp,Prelu:()=>Bp,Prod:()=>Wp,RMSPropOptimizer:()=>NI,RNN:()=>HD,RaggedGather:()=>Vp,RaggedRange:()=>Up,RaggedTensorToTensor:()=>jp,Range:()=>Gp,Rank:()=>Km,Real:()=>Hp,RealDiv:()=>Eh,Reciprocal:()=>qp,Reduction:()=>BS,Relu:()=>Kp,Relu6:()=>$p,Reshape:()=>Xp,ResizeBilinear:()=>Jp,ResizeBilinearGrad:()=>Zp,ResizeNearestNeighbor:()=>Yp,ResizeNearestNeighborGrad:()=>Qp,Reverse:()=>ef,RotateWithOffset:()=>qf,Round:()=>tf,Rsqrt:()=>nf,SGDOptimizer:()=>SI,ScatterNd:()=>af,SearchSorted:()=>sf,Select:()=>of,Selu:()=>lf,Sequential:()=>VR,Sigmoid:()=>pf,Sign:()=>hf,Sin:()=>cf,Sinh:()=>df,Slice:()=>uf,Softmax:()=>vf,Softplus:()=>ff,SpaceToBatchND:()=>yf,SparseFillEmptyRows:()=>xf,SparseReshape:()=>wf,SparseSegmentMean:()=>kf,SparseSegmentSum:()=>Sf,SparseToDense:()=>If,SplitV:()=>bf,Sqrt:()=>mf,Square:()=>Tf,SquaredDifference:()=>Nf,StaticRegexReplace:()=>Cf,Step:()=>Gf,StridedSlice:()=>Ef,StringNGrams:()=>_f,StringSplit:()=>Af,StringToHashBucketFast:()=>Ff,Sub:()=>Rf,Sum:()=>gf,SymbolicTensor:()=>PA,Tan:()=>Df,Tanh:()=>Mf,Tensor:()=>Gm,TensorBuffer:()=>Vm,TensorScatterUpdate:()=>rf,Tile:()=>Of,TopK:()=>Pf,Transform:()=>Lf,Transpose:()=>zf,Unique:()=>Bf,Unpack:()=>Wf,UnsortedSegmentSum:()=>Vf,UpperBound:()=>Uf,Variable:()=>qm,ZerosLike:()=>jf,_FusedMatMul:()=>Kf,abs:()=>sb,acos:()=>ob,acosh:()=>lb,add:()=>nb,addN:()=>ub,all:()=>cb,any:()=>db,argMax:()=>hb,argMin:()=>pb,asin:()=>fb,asinh:()=>mb,atan:()=>gb,atan2:()=>yb,atanh:()=>bb,avgPool:()=>Ob,avgPool3d:()=>Pb,backend:()=>$g,backend_util:()=>MN,basicLSTMCell:()=>Ub,batchNorm:()=>Hb,batchNorm2d:()=>qb,batchNorm3d:()=>Kb,batchNorm4d:()=>Xb,batchToSpaceND:()=>jb,bincount:()=>Yb,bitwiseAnd:()=>Qb,booleanMaskAsync:()=>Wk,broadcastArgs:()=>Jb,broadcastTo:()=>Zb,broadcast_util:()=>kv,browser:()=>QI,buffer:()=>Zy,callbacks:()=>rL,cast:()=>$y,ceil:()=>$b,clipByValue:()=>tv,clone:()=>eb,complex:()=>_g,concat:()=>Lb,concat1d:()=>nv,concat2d:()=>av,concat3d:()=>rv,concat4d:()=>iv,constraints:()=>JA,conv1d:()=>ov,conv2d:()=>sv,conv2dTranspose:()=>uv,conv3d:()=>cv,conv3dTranspose:()=>hv,copyRegisteredKernels:()=>om,cos:()=>pv,cosh:()=>fv,cosineWindow:()=>Xk,cumprod:()=>mv,cumsum:()=>gv,customGrad:()=>Ix,data:()=>Kz,denseBincount:()=>yv,deprecationWarn:()=>Lg,depthToSpace:()=>bv,depthwiseConv2d:()=>vv,deregisterOp:()=>lL,device_util:()=>yg,diag:()=>xv,dilation2d:()=>wv,disableDeprecationWarnings:()=>Pg,dispose:()=>jg,disposeVariables:()=>zg,div:()=>rb,divNoNan:()=>_v,dot:()=>Av,dropout:()=>qk,einsum:()=>Fv,elu:()=>Rv,enableDebugMode:()=>Og,enableProdMode:()=>Mg,enclosingPowerOfTwo:()=>Kk,engine:()=>Bg,ensureShape:()=>Dv,env:()=>Td,equal:()=>Tv,erf:()=>Mv,euclideanNorm:()=>Zv,exp:()=>$v,expandDims:()=>ex,expm1:()=>tx,eye:()=>ax,fft:()=>uk,fill:()=>ev,findBackend:()=>Qg,findBackendFactory:()=>Jg,floor:()=>rx,floorDiv:()=>ab,forceHalfFloat:()=>gQ,fused:()=>Qk,gather:()=>ix,gatherND:()=>Hk,gather_util:()=>sN,getBackend:()=>Xg,getGradient:()=>tm,getKernel:()=>em,getKernelsForBackend:()=>nm,getThreadsCount:()=>m7,gpgpu_util:()=>AX,grad:()=>vx,grads:()=>xx,greater:()=>sx,greaterEqual:()=>ox,ifft:()=>ck,imag:()=>lx,image:()=>sI,inTopKAsync:()=>Yk,initializers:()=>hF,input:()=>GR,io:()=>CI,irfft:()=>dk,isFinite:()=>ux,isInf:()=>cx,isNaN:()=>dx,keep:()=>Gg,kernel_impls:()=>WT,layers:()=>_F,leakyRelu:()=>hx,less:()=>px,lessEqual:()=>fx,linalg:()=>oI,linspace:()=>mx,loadGraphModel:()=>Gz,loadGraphModelSync:()=>Hz,loadLayersModel:()=>WR,localResponseNormalization:()=>gx,log:()=>yx,log1p:()=>bx,logSigmoid:()=>Ex,logSoftmax:()=>Ax,logSumExp:()=>Fx,logicalAnd:()=>Rx,logicalNot:()=>Dx,logicalOr:()=>Mx,logicalXor:()=>Ox,losses:()=>lI,lowerBound:()=>zx,matMul:()=>zb,math:()=>XI,max:()=>jv,maxPool:()=>Bx,maxPool3d:()=>Wx,maxPoolWithArgmax:()=>Vx,maximum:()=>Ux,mean:()=>jx,memory:()=>Wg,meshgrid:()=>qx,metrics:()=>AP,min:()=>Gv,minimum:()=>Kx,mirrorPad:()=>Xx,mod:()=>Yx,model:()=>UR,models:()=>KP,moments:()=>Qx,movingAverage:()=>Uk,mul:()=>ib,multiRNNCell:()=>Jx,multinomial:()=>Zx,neg:()=>Tx,nextFrame:()=>RN,norm:()=>Jv,notEqual:()=>$x,oneHot:()=>ew,ones:()=>Hx,onesLike:()=>tw,op:()=>Eg,outerProduct:()=>nw,pad:()=>aw,pad1d:()=>rw,pad2d:()=>iw,pad3d:()=>sw,pad4d:()=>ow,pool:()=>uw,pow:()=>Hv,prelu:()=>cw,print:()=>tb,prod:()=>dw,profile:()=>Vg,raggedGather:()=>hw,raggedRange:()=>pw,raggedTensorToTensor:()=>fw,rand:()=>mw,randomGamma:()=>Ow,randomNormal:()=>Pw,randomStandardNormal:()=>Lw,randomUniform:()=>zw,randomUniformInt:()=>Bw,range:()=>Ww,ready:()=>Kg,real:()=>Vw,reciprocal:()=>Uw,registerBackend:()=>Zg,registerCallbackConstructor:()=>HR,registerGradient:()=>rm,registerKernel:()=>am,registerOp:()=>sL,regularizers:()=>XP,relu:()=>jw,relu6:()=>Gw,removeBackend:()=>Yg,reshape:()=>Mb,reverse:()=>Hw,reverse1d:()=>qw,reverse2d:()=>Kw,reverse3d:()=>Xw,reverse4d:()=>Yw,rfft:()=>pk,round:()=>Qw,rsqrt:()=>Jw,scalar:()=>qv,scatterND:()=>jk,scatter_util:()=>Tk,searchSorted:()=>Lx,selu:()=>Zw,separableConv2d:()=>$w,sequential:()=>jR,serialization:()=>dI,setBackend:()=>qg,setPlatform:()=>ey,setThreadsCount:()=>f7,setWasmPath:()=>c7,setWasmPaths:()=>d7,setWebGLContext:()=>Yq,setdiff1dAsync:()=>ek,shared:()=>uW,sigmoid:()=>Bb,sign:()=>tk,signal:()=>iI,sin:()=>nk,sinh:()=>ak,slice:()=>Wb,slice1d:()=>rk,slice2d:()=>ik,slice3d:()=>sk,slice4d:()=>ok,slice_util:()=>lN,softmax:()=>lk,softplus:()=>Cx,spaceToBatchND:()=>lw,sparse:()=>uI,sparseToDense:()=>Gk,spectral:()=>rI,split:()=>hk,sqrt:()=>Kv,square:()=>Xv,squaredDifference:()=>fk,squeeze:()=>mk,stack:()=>gk,step:()=>yk,stridedSlice:()=>bk,string:()=>cI,sub:()=>_x,sum:()=>Yv,sumOutType:()=>ng,tan:()=>vk,tanh:()=>Vb,tensor:()=>Fg,tensor1d:()=>xk,tensor2d:()=>wk,tensor3d:()=>kk,tensor4d:()=>Sk,tensor5d:()=>Ik,tensor6d:()=>Nk,tensorScatterUpdate:()=>Ak,tensor_util:()=>$m,test_util:()=>yw,tidy:()=>Ug,tile:()=>nx,time:()=>Hg,topk:()=>Fk,train:()=>AN,transpose:()=>Vk,truncatedNormal:()=>Rk,unique:()=>Dk,unregisterGradient:()=>sm,unregisterKernel:()=>im,unsortedSegmentSum:()=>Mk,unstack:()=>Ok,upcastType:()=>tg,upperBound:()=>Pk,util:()=>um,valueAndGrad:()=>wx,valueAndGrads:()=>kx,variable:()=>Lk,variableGrads:()=>Sx,version:()=>b7,version_converter:()=>qz,version_core:()=>EN,version_cpu:()=>PU,version_layers:()=>bR,version_wasm:()=>g7,version_webgl:()=>mQ,webgl:()=>yQ,webgl_util:()=>jq,where:()=>Cv,whereAsync:()=>Bk,zeros:()=>Gx,zerosLike:()=>Ev});var Qu=Object.create,Ju=Object.defineProperty,Zu=Object.getOwnPropertyDescriptor,$u=Object.getOwnPropertyNames,ec=Object.getPrototypeOf,tc=Object.prototype.hasOwnProperty,nc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ac=(e,t)=>{for(var n in t)Ju(e,n,{get:t[n],enumerable:!0})},rc=(e,t,n)=>(n=null!=e?Qu(ec(e)):{},((e,t,n,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of $u(t))!tc.call(e,r)&&r!==n&&Ju(e,r,{get:()=>t[r],enumerable:!(a=Zu(t,r))||a.enumerable});return e})(!t&&e&&e.__esModule?n:Ju(n,"default",{value:e,enumerable:!0}),e)),ic=nc((e,t)=>{t.exports=a;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(T){}function a(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}a.prototype.__isLong__,Object.defineProperty(a.prototype,"__isLong__",{value:!0}),a.isLong=r;var i={},s={};function o(e,t){var n,a,r;return t?(r=0<=(e>>>=0)&&e<256)&&(a=s[e])?a:(n=u(e,(0|e)<0?-1:0,!0),r&&(s[e]=n),n):(r=-128<=(e|=0)&&e<128)&&(a=i[e])?a:(n=u(e,e<0?-1:0,!1),r&&(i[e]=n),n)}function l(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=f)return S}else{if(e<=-m)return I;if(e+1>=m)return k}return e<0?l(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,n){return new a(e,t,n)}a.fromInt=o,a.fromNumber=l,a.fromBits=u;var c=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var a;if((a=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===a)return d(e.substring(1),t,n).neg();for(var r=l(c(n,8)),i=y,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+o),n);if(o<8){var h=l(c(n,o));i=i.mul(h).add(l(u))}else i=(i=i.mul(r)).add(l(u))}return i.unsigned=t,i}function h(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}a.fromString=d,a.fromValue=h;var p=4294967296,f=p*p,m=f/2,g=o(1<<24),y=o(0);a.ZERO=y;var b=o(0,!0);a.UZERO=b;var v=o(1);a.ONE=v;var x=o(1,!0);a.UONE=x;var w=o(-1);a.NEG_ONE=w;var k=u(-1,2147483647,!1);a.MAX_VALUE=k;var S=u(-1,-1,!0);a.MAX_UNSIGNED_VALUE=S;var I=u(0,-2147483648,!1);a.MIN_VALUE=I;var N=a.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},N.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=l(e),n=this.div(t),a=n.mul(t).sub(this);return n.toString(e)+a.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=l(c(e,6),this.unsigned),i=this,s="";;){var o=i.div(r),u=(i.sub(o.mul(r)).toInt()>>>0).toString(e);if((i=o).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},N.isZero=function(){return 0===this.high&&0===this.low},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return 1===(1&this.low)},N.isEven=function(){return 0===(1&this.low)},N.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},N.eq=N.equals,N.notEquals=function(e){return!this.eq(e)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(e){return this.comp(e)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(e){return this.comp(e)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(e){return this.comp(e)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(e){return this.comp(e)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(v)},N.neg=N.negate,N.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,s=e.high>>>16,o=65535&e.high,l=e.low>>>16,c=0,d=0,p=0,f=0;return p+=(f+=i+(65535&e.low))>>>16,d+=(p+=a+l)>>>16,c+=(d+=n+o)>>>16,c+=t+s,u((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},N.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},N.sub=N.subtract,N.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=h(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(I))return e.isOdd()?I:y;if(e.eq(I))return this.isOdd()?I:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,a=65535&this.high,i=this.low>>>16,s=65535&this.low,o=e.high>>>16,c=65535&e.high,d=e.low>>>16,p=65535&e.low,f=0,m=0,b=0,v=0;return b+=(v+=s*p)>>>16,m+=(b+=i*p)>>>16,b&=65535,m+=(b+=s*d)>>>16,f+=(m+=a*p)>>>16,m&=65535,f+=(m+=i*d)>>>16,m&=65535,f+=(m+=s*c)>>>16,f+=t*p+a*d+i*c+s*o,u((b&=65535)<<16|(v&=65535),(f&=65535)<<16|(m&=65535),this.unsigned)},N.mul=N.multiply,N.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,a,i;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return x;i=b}else{if(this.eq(I))return e.eq(v)||e.eq(w)?I:e.eq(I)?v:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?v:w:(a=this.sub(e.mul(t)),i=t.add(a.div(e)));if(e.eq(I))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=y}for(a=this;a.gte(e);){t=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),o=s<=48?1:c(2,s-48),d=l(t),p=d.mul(e);p.isNegative()||p.gt(a);)p=(d=l(t-=o,this.unsigned)).mul(e);d.isZero()&&(d=v),i=i.add(d),a=a.sub(p)}return i},N.div=N.divide,N.modulo=function(e){return r(e)||(e=h(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return u(~this.low,~this.high,this.unsigned)},N.and=function(e){return r(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},N.or=function(e){return r(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},N.xor=function(e){return r(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},N.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},N.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},N.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},a.fromBytes=function(e,t,n){return n?a.fromBytesLE(e,t):a.fromBytesBE(e,t)},a.fromBytesLE=function(e,t){return new a(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},a.fromBytesBE=function(e,t){return new a(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}}),sc=nc(()=>{}),oc=nc(()=>{}),lc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var a=.02519603282416938*(e+=t.charCodeAt(n));a-=e=a>>>0,e=(a*=e)>>>0,e+=4294967296*(a-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new a(e),i=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,i&&("object"==typeof i&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.alea=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),uc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new a(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor128=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),cc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),a==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new a(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorwow=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),dc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this;t.next=function(){var e,n,a=t.x,r=t.i;return e=a[r],n=(e^=e>>>7)^e<<24,n^=(e=a[r+1&7])^e>>>10,n^=(e=a[r+3&7])^e>>>3,n^=(e=a[r+4&7])^e<<7,e=a[r+7&7],n^=(e^=e<<13)^e<<9,a[r]=n,t.i=r+1&7,n},function(e,t){var n,a=[];if(t===(0|t))a[0]=t;else for(t=""+t,n=0;n<t.length;++n)a[7&n]=a[7&n]<<15^t.charCodeAt(n)+a[n+1&7]<<13;for(;a.length<8;)a.push(0);for(n=0;n<8&&0===a[n];++n);for(8==n?a[7]=-1:a[n],e.x=a,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new a(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&(i.x&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xorshift7=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),hc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this;t.next=function(){var e,n,a=t.w,r=t.X,i=t.i;return t.w=a=a+1640531527|0,n=r[i+34&127],e=r[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[i]=n^e,t.i=i,n+(a^a>>>16)|0},function(e,t){var n,a,r,i,s,o=[],l=128;for(t===(0|t)?(a=t,t=null):(t+="\0",a=0,l=Math.max(l,t.length)),r=0,i=-32;i<l;++i)t&&(a^=t.charCodeAt((i+32)%t.length)),0===i&&(s=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,i>=0&&(s=s+1640531527|0,r=0==(n=o[127&i]^=a+s)?r+1:0);for(r>=128&&(o[127&(t&&t.length||0)]=-1),r=127,i=512;i>0;--i)a=o[r+34&127],n=o[r=r+1&127],a^=a<<13,n^=n<<17,a^=a>>>15,n^=n>>>12,o[r]=a^n;e.w=s,e.X=o,e.i=r}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new a(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&(i.X&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.xor4096=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),pc=nc((e,t)=>{!function(e,t,n){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,a=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-a|0,a=a<<24^a>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-a|0,t.d=a<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var a=0;a<n.length+20;a++)t.b^=0|n.charCodeAt(a),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new a(e),i=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,i&&("object"==typeof i&&r(i,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=i:n&&n.amd?n(function(){return i}):this.tychei=i}(0,"object"==typeof t&&t,"function"==typeof define&&define)}),fc=nc(()=>{}),mc=nc((e,t)=>{!function(e,a,r){var i,s=256,o="random",l=r.pow(s,6),u=r.pow(2,52),c=2*u,d=255;function h(t,n,d){var h=[],b=g(m((n=1==n?{entropy:!0}:n||{}).entropy?[t,y(a)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(t)),y(t)}catch(h){var n=e.navigator,r=n&&n.plugins;return[+new Date,e,r,e.screen,y(a)]}}():t,3),h),v=new p(h),x=function(){for(var e=v.g(6),t=l,n=0;e<u;)e=(e+n)*s,t*=s,n=v.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|v.g(4)},x.quick=function(){return v.g(4)/4294967296},x.double=x,g(y(v.S),a),(n.pass||d||function(e,t,n,a){return a&&(a.S&&f(a,v),e.state=function(){return f(v,{})}),n?(r[o]=e,t):e})(x,b,"global"in n?n.global:this==r,n.state)}function p(e){var t,n=e.length,a=this,r=0,i=a.i=a.j=0,o=a.S=[];for(n||(e=[n++]);r<s;)o[r]=r++;for(r=0;r<s;r++)o[r]=o[i=d&i+e[r%n]+(t=o[r])],o[i]=t;(a.g=function(e){for(var t,n=0,r=a.i,i=a.j,o=a.S;e--;)t=o[r=d&r+1],n=n*s+o[d&(o[r]=o[i=d&i+t])+(o[i]=t)];return a.i=r,a.j=i,n})(s)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,a=[],r=typeof e;if(t&&"object"==r)for(n in e)try{a.push(m(e[n],t-1))}catch(i){}return a.length?a:"string"==r?e:e+"\0"}function g(e,t){for(var n,a=e+"",r=0;r<a.length;)t[d&r]=d&(n^=19*t[d&r])+a.charCodeAt(r++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(g(r.random(),a),"object"==typeof t&&t.exports){t.exports=h;try{i=fc()}catch(b){}}else"function"==typeof define&&n.amdO?define(function(){return h}):r["seed"+o]=h}("undefined"!=typeof self?self:e,[],Math)}),gc=nc((e,t)=>{var n=lc(),a=uc(),r=cc(),i=dc(),s=hc(),o=pc(),l=mc();l.alea=n,l.xor128=a,l.xorwow=r,l.xorshift7=i,l.xor4096=s,l.tychei=o,t.exports=l}),yc=nc(()=>{}),bc=nc(()=>{}),vc=nc(()=>{}),xc=nc(()=>{}),wc=nc(()=>{}),kc=nc(()=>{}),Sc=nc((e,t)=>{var a=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return e=e||qu,function(t){function a(){return F.buffer!=O&&G(F.buffer),L}function r(){return F.buffer!=O&&G(F.buffer),z}function i(){return F.buffer!=O&&G(F.buffer),B}function s(){return F.buffer!=O&&G(F.buffer),W}var o,l,u,c="undefined"!=typeof(t=t||{})?t:{};c.ready=new Promise(function(e,t){o=e,l=t}),"undefined"!=typeof process&&process.listeners&&(u={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var d,h,p,f=Object.assign({},c),m=[],g=(e,t)=>{throw t},y="object"==typeof window,b="function"==typeof importScripts,v="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,x=c.ENVIRONMENT_IS_PTHREAD||!1,w="";function k(e){return c.locateFile?c.locateFile(e,w):w+e}if(v){var S=bc(),I=vc();let e;w=b?I.dirname(w)+"/":"//",d=(e,t)=>(e=se(e)?new URL(e):I.normalize(e),S.readFileSync(e,t?void 0:"utf8")),p=e=>{var t=d(e,!0);return t.buffer||(t=new Uint8Array(t)),t},h=(e,t,n)=>{e=se(e)?new URL(e):I.normalize(e),S.readFile(e,function(e,a){e?n(e):t(a.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),m=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof ue))throw e}),process.on("unhandledRejection",function(e){throw e}),g=(e,t)=>{if(Q())throw process.exitCode=e,t;(function(e){e instanceof ue||E("exiting due to exception: "+e)})(t),process.exit(e)},c.inspect=function(){return"[Emscripten Module object]"};try{e=xc()}catch(Je){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),Je}n.g.Worker=e.Worker}else(y||b)&&(b?w=self.location.href:"undefined"!=typeof document&&document.currentScript&&(w=document.currentScript.src),"undefined"!=typeof e&&e&&(w=e),w=0!==w.indexOf("blob:")?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},b&&(p=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),h=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)}),e=>document.title=e);v&&"undefined"==typeof performance&&(n.g.performance=wc().performance);var N=console.log.bind(console),T=console.warn.bind(console);v&&(N=e=>S.writeSync(1,e+"\n"),T=e=>S.writeSync(2,e+"\n"));var C=c.print||N,E=c.printErr||T;Object.assign(c,f),f=null,c.arguments&&(m=c.arguments),c.thisProgram&&c.thisProgram,c.quit&&(g=c.quit);var _;Atomics.load,Atomics.store,Atomics.compareExchange;c.wasmBinary&&(_=c.wasmBinary);var A=c.noExitRuntime||!0;"object"!=typeof WebAssembly&&ae("no native wasm support detected");var F,R,D,M=!1;var O,P,L,z,B,W,V="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function U(e,t,n){for(var a=(t>>>=0)+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.buffer&&V)return V.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(var i="";t<r;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|l:(7&s)<<18|o<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(s);else{var u=s-65536;i+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else i+=String.fromCharCode((31&s)<<6|o)}else i+=String.fromCharCode(s)}return i}function j(e,t){return(e>>>=0)?U(a(),e,t):""}function G(e){O=e,c.HEAP8=P=new Int8Array(e),c.HEAP16=new Int16Array(e),c.HEAP32=z=new Int32Array(e),c.HEAPU8=L=new Uint8Array(e),c.HEAPU16=new Uint16Array(e),c.HEAPU32=B=new Uint32Array(e),c.HEAPF32=new Float32Array(e),c.HEAPF64=W=new Float64Array(e)}x&&(O=c.buffer);var H=c.INITIAL_MEMORY||16777216;if(x)F=c.wasmMemory,O=c.buffer;else if(c.wasmMemory)F=c.wasmMemory;else if(!((F=new WebAssembly.Memory({initial:H/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw E("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&E("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");F&&(O=F.buffer),H=O.byteLength,G(O);var q,K=[],X=[],Y=[];function Q(){return A}function J(){!x&&me(X)}function Z(e){K.unshift(e)}function $(e){Y.unshift(e)}var ee=0,te=null,ne=null;function ae(e){c.onAbort&&c.onAbort(e),E(e="Aborted("+e+")"),M=!0,D=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw l(t),t}var re;function ie(e){return e.startsWith("data:application/octet-stream;base64,")}function se(e){return e.startsWith("file://")}function oe(e){try{if(e==re&&_)return new Uint8Array(_);if(p)return p(e);throw"both async and sync fetching of the wasm failed"}catch(Je){ae(Je)}}ie(re="tfjs-backend-wasm-threaded-simd.wasm")||(re=k(re));var le={};function ue(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ce(e){var t=fe.pthreads[e];(function(e,t){e||ae(t)})(t),fe.returnWorkerToPool(t)}function de(e){var t=fe.getNewWorker();if(!t)return 6;fe.runningWorkers.push(t),fe.pthreads[e.pthread_ptr]=t,t.pthread_ptr=e.pthread_ptr;var n={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return t.runPthread=()=>{v&&t.ref(),t.postMessage(n,e.transferList),delete t.runPthread},t.loaded&&t.runPthread(),0}function he(e){if(x)return Se(1,1,e);D=e,Q()||(fe.terminateAllThreads(),c.onExit&&c.onExit(e),M=!0),g(e,new ue(e))}var pe=function(e,t){if(D=e,!t&&x)throw ge(e),"unwind";he(e)};var fe={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){x?fe.initWorker():fe.initMainThread()},initMainThread:function(){for(var e=8;e--;)fe.allocateUnusedWorker()},initWorker:function(){A=!1},setExitStatus:function(e){D=e},terminateAllThreads:function(){for(var e of Object.values(fe.pthreads))fe.returnWorkerToPool(e);for(var e of fe.unusedWorkers)e.terminate();fe.unusedWorkers=[]},returnWorkerToPool:function(e){var t=e.pthread_ptr;delete fe.pthreads[t],fe.unusedWorkers.push(e),fe.runningWorkers.splice(fe.runningWorkers.indexOf(e),1),e.pthread_ptr=0,v&&e.unref(),je(t)},receiveObjectTransfer:function(e){},threadInitTLS:function(){fe.tlsInitFunctions.forEach(e=>e())},loadWasmModuleToWorker:function(t,n){t.onmessage=e=>{var a=e.data,r=a.cmd;if(t.pthread_ptr&&(fe.currentProxiedOperationCallerThread=t.pthread_ptr),a.targetThread&&a.targetThread!=Be()){var i=fe.pthreads[a.targetThread];return i?i.postMessage(a,a.transferList):E('Internal error! Worker sent a message "'+r+'" to target pthread '+a.targetThread+", but that thread no longer exists!"),void(fe.currentProxiedOperationCallerThread=void 0)}"processProxyingQueue"===r?we(a.queue):"spawnThread"===r?de(a):"cleanupThread"===r?ce(a.thread):"killThread"===r?function(e){var t=fe.pthreads[e];delete fe.pthreads[e],t.terminate(),je(e),fe.runningWorkers.splice(fe.runningWorkers.indexOf(t),1),t.pthread_ptr=0}(a.thread):"cancelThread"===r?function(e){fe.pthreads[e].postMessage({cmd:"cancel"})}(a.thread):"loaded"===r?(t.loaded=!0,v&&t.unref(),n&&n(t),t.runPthread&&t.runPthread()):"print"===r?C("Thread "+a.threadId+": "+a.text):"printErr"===r?E("Thread "+a.threadId+": "+a.text):"alert"===r?alert("Thread "+a.threadId+": "+a.text):"setimmediate"===a.target?t.postMessage(a):"callHandler"===r?c[a.handler](...a.args):r&&E("worker sent an unknown command "+r),fe.currentProxiedOperationCallerThread=void 0},t.onerror=e=>{throw E("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},v&&(t.on("message",function(e){t.onmessage({data:e})}),t.on("error",function(e){t.onerror(e)}),t.on("detachedExit",function(){}));var a=[];for(var r of["onExit","onAbort","print","printErr"])c.hasOwnProperty(r)&&a.push(r);t.postMessage({cmd:"load",handlers:a,urlOrBlob:c.mainScriptUrlOrBlob||e,wasmMemory:F,wasmModule:R})},allocateUnusedWorker:function(){var e,t=k("tfjs-backend-wasm-threaded-simd.worker.js");e=new Worker(t),fe.unusedWorkers.push(e)},getNewWorker:function(){return 0==fe.unusedWorkers.length&&(fe.allocateUnusedWorker(),fe.loadWasmModuleToWorker(fe.unusedWorkers[0])),fe.unusedWorkers.pop()}};function me(e){for(;e.length>0;)e.shift()(c)}function ge(e){if(x)return Se(2,0,e);try{pe(e)}catch(Je){!function(e){if(e instanceof ue||"unwind"==e)return D;g(1,e)}(Je)}}c.PThread=fe,c.establishStackSpace=function(){var e=Be(),t=r()[e+52>>>2],n=r()[e+56>>>2];He(t,t-n),Ke(t)};var ye=[];function be(e,t,n,a){return x?Se(3,1,e,t,n,a):ve(e,t,n,a)}function ve(e,t,n,a){if("undefined"==typeof SharedArrayBuffer)return E("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var r=[];if(x&&0===r.length)return be(e,t,n,a);var i={startRoutine:n,pthread_ptr:e,arg:a,transferList:r};return x?(i.cmd="spawnThread",postMessage(i,r),0):de(i)}c.invokeEntryPoint=function(e,t){var n=function(e){var t=ye[e];return t||(e>=ye.length&&(ye.length=e+1),ye[e]=t=q.get(e)),t}(e)(t);Q()?fe.setExitStatus(n):Ge(n)};var xe;function we(e){Atomics.store(r(),e>>2,1),Be()&&Ue(e),Atomics.compareExchange(r(),e>>2,1,0)}function ke(e){ke.shown||(ke.shown={}),ke.shown[e]||(ke.shown[e]=1,v&&(e="warning: "+e),E(e))}function Se(e,t){var n=arguments.length-2,a=arguments;return function(e){var t=qe(),n=e();return Ke(t),n}(()=>{for(var r=n,i=Xe(8*r),o=i>>3,l=0;l<n;l++){var u=a[2+l];s()[o+l>>>0]=u}return Ve(e,r,i,t)})}c.executeNotifiedProxyingQueue=we,xe=v?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.timeOrigin+performance.now();var Ie=[];function Ne(e){try{return F.grow(e-O.byteLength+65535>>>16),G(F.buffer),1}catch(Je){}}function Te(e){return x?Se(4,1,e):52}function Ce(e,t,n,a,r){return x?Se(5,1,e,t,n,a,r):70}var Ee=[null,[],[]];function _e(e,t){var n=Ee[e];0===t||10===t?((1===e?C:E)(U(n,0)),n.length=0):n.push(t)}function Ae(e,t,n,r){if(x)return Se(6,1,e,t,n,r);for(var s=0,o=0;o<n;o++){var l=i()[t>>>2],u=i()[t+4>>>2];t+=8;for(var c=0;c<u;c++)_e(e,a()[l+c>>>0]);s+=u}return i()[r>>>2]=s,0}function Fe(e){return c["_"+e]}function Re(e,t){(F.buffer!=O&&G(F.buffer),P).set(e,t>>>0)}function De(e,t,n,r,i){var s={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,a){if(!(a>0))return 0;for(var r=n>>>=0,i=n+a-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),o<=127){if(n>=i)break;t[n++>>>0]=o}else if(o<=2047){if(n+1>=i)break;t[n++>>>0]=192|o>>6,t[n++>>>0]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++>>>0]=224|o>>12,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}else{if(n+3>=i)break;t[n++>>>0]=240|o>>18,t[n++>>>0]=128|o>>12&63,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}}t[n>>>0]=0})(e,a(),t,n)})(e,t=Xe(n),n)}return t},array:e=>{var t=Xe(e.length);return Re(e,t),t}};var o=Fe(e),l=[],u=0;if(r)for(var c=0;c<r.length;c++){var d=s[n[c]];d?(0===u&&(u=qe()),l[c]=d(r[c])):l[c]=r[c]}var h,p=o.apply(null,l);return h=p,0!==u&&Ke(u),p=function(e){return"string"===t?j(e):"boolean"===t?!!e:e}(h),p}fe.init();var Me,Oe,Pe,Le=[null,he,ge,be,Te,Ce,Ae],ze={__emscripten_init_main_thread_js:function(e){We(e,!b,1,!y),fe.threadInitTLS()},__emscripten_thread_cleanup:function(e){x?postMessage({cmd:"cleanupThread",thread:e}):ce(e)},__pthread_create_js:ve,_emscripten_default_pthread_stack_size:function(){return 65536},_emscripten_get_now_is_monotonic:function(){return true},_emscripten_notify_task_queue:function(e,t,n,a){if(e==t)setTimeout(()=>we(a));else if(x)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:a});else{var r=fe.pthreads[e];if(!r)return;r.postMessage({cmd:"processProxyingQueue",queue:a})}return 1},_emscripten_set_offscreencanvas_size:function(e,t,n){return-1},abort:function(){ae("")},emscripten_check_blocking_allowed:function(){v||b||ke("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return 4294901760},emscripten_get_now:xe,emscripten_memcpy_big:function(e,t,n){a().copyWithin(e>>>0,t>>>0,t+n>>>0)},emscripten_num_logical_cores:function(){return v?kc().cpus().length:navigator.hardwareConcurrency},emscripten_receive_on_main_thread_js:function(e,t,n){Ie.length=t;for(var a=n>>3,r=0;r<t;r++)Ie[r]=s()[a+r>>>0];return(e<0?le[-e-1]:Le[e]).apply(null,Ie)},emscripten_resize_heap:function(e){var t=a().length;if((e>>>=0)<=t)return!1;var n=4294901760;if(e>n)return!1;let r=(e,t)=>e+(t-e%t)%t;for(var i=1;i<=4;i*=2){var s=t*(1+.2/i);if(s=Math.min(s,e+100663296),Ne(Math.min(n,r(Math.max(e,s),65536))))return!0}return!1},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},exit:pe,fd_close:Te,fd_seek:Ce,fd_write:Ae,memory:F||c.wasmMemory},Be=(function(){var e={env:ze,wasi_snapshot_preview1:ze};function t(e,t){var n=e.exports;if(c.asm=n,function(e){fe.tlsInitFunctions.push(e)}(c.asm._emscripten_tls_init),q=c.asm.__indirect_function_table,function(e){X.unshift(e)}(c.asm.__wasm_call_ctors),R=t,!x){var a=fe.unusedWorkers.length;fe.unusedWorkers.forEach(function(e){fe.loadWasmModuleToWorker(e,function(){--a||function(){if(ee--,c.monitorRunDependencies&&c.monitorRunDependencies(ee),0==ee&&(null!==te&&(clearInterval(te),te=null),ne)){var e=ne;ne=null,e()}}()})})}}function n(e){t(e.instance,e.module)}function a(t){return function(){if(!_&&(y||b)){if("function"==typeof fetch&&!se(re))return fetch(re,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+re+"'";return e.arrayBuffer()}).catch(function(){return oe(re)});if(h)return new Promise(function(e,t){h(re,function(t){e(new Uint8Array(t))},t)})}return Promise.resolve().then(function(){return oe(re)})}().then(function(t){return WebAssembly.instantiate(t,e)}).then(function(e){return e}).then(t,function(e){E("failed to asynchronously prepare wasm: "+e),ae(e)})}if(x||(ee++,c.monitorRunDependencies&&c.monitorRunDependencies(ee)),c.instantiateWasm)try{return c.instantiateWasm(e,t)}catch(r){E("Module.instantiateWasm callback failed with error: "+r),l(r)}(_||"function"!=typeof WebAssembly.instantiateStreaming||ie(re)||se(re)||v||"function"!=typeof fetch?a(n):fetch(re,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(n,function(e){return E("wasm streaming compile failed: "+e),E("falling back to ArrayBuffer instantiation"),a(n)})})).catch(l)}(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.__wasm_call_ctors).apply(null,arguments)},c._init=function(){return(c._init=c.asm.init).apply(null,arguments)},c._init_with_threads_count=function(){return(c._init_with_threads_count=c.asm.init_with_threads_count).apply(null,arguments)},c._get_threads_count=function(){return(c._get_threads_count=c.asm.get_threads_count).apply(null,arguments)},c._register_tensor=function(){return(c._register_tensor=c.asm.register_tensor).apply(null,arguments)},c._dispose_data=function(){return(c._dispose_data=c.asm.dispose_data).apply(null,arguments)},c._dispose=function(){return(c._dispose=c.asm.dispose).apply(null,arguments)},c._Abs=function(){return(c._Abs=c.asm.Abs).apply(null,arguments)},c._Acos=function(){return(c._Acos=c.asm.Acos).apply(null,arguments)},c._Acosh=function(){return(c._Acosh=c.asm.Acosh).apply(null,arguments)},c._Add=function(){return(c._Add=c.asm.Add).apply(null,arguments)},c._AddN=function(){return(c._AddN=c.asm.AddN).apply(null,arguments)},c._All=function(){return(c._All=c.asm.All).apply(null,arguments)},c._Any=function(){return(c._Any=c.asm.Any).apply(null,arguments)},c._ArgMax=function(){return(c._ArgMax=c.asm.ArgMax).apply(null,arguments)},c._ArgMin=function(){return(c._ArgMin=c.asm.ArgMin).apply(null,arguments)},c._Asin=function(){return(c._Asin=c.asm.Asin).apply(null,arguments)},c._Asinh=function(){return(c._Asinh=c.asm.Asinh).apply(null,arguments)},c._Atan=function(){return(c._Atan=c.asm.Atan).apply(null,arguments)},c._Atan2=function(){return(c._Atan2=c.asm.Atan2).apply(null,arguments)},c._Atanh=function(){return(c._Atanh=c.asm.Atanh).apply(null,arguments)},c._AvgPool=function(){return(c._AvgPool=c.asm.AvgPool).apply(null,arguments)},c._AvgPool3D=function(){return(c._AvgPool3D=c.asm.AvgPool3D).apply(null,arguments)},c._AvgPool3DGrad=function(){return(c._AvgPool3DGrad=c.asm.AvgPool3DGrad).apply(null,arguments)},c._AvgPoolGrad=function(){return(c._AvgPoolGrad=c.asm.AvgPoolGrad).apply(null,arguments)},c._BatchMatMul=function(){return(c._BatchMatMul=c.asm.BatchMatMul).apply(null,arguments)},c._Bincount=function(){return(c._Bincount=c.asm.Bincount).apply(null,arguments)},c._BitwiseAnd=function(){return(c._BitwiseAnd=c.asm.BitwiseAnd).apply(null,arguments)},c._Ceil=function(){return(c._Ceil=c.asm.Ceil).apply(null,arguments)},c._ClipByValue=function(){return(c._ClipByValue=c.asm.ClipByValue).apply(null,arguments)},c._Conv2D=function(){return(c._Conv2D=c.asm.Conv2D).apply(null,arguments)},c._Conv2DBackpropInput=function(){return(c._Conv2DBackpropInput=c.asm.Conv2DBackpropInput).apply(null,arguments)},c._Conv3D=function(){return(c._Conv3D=c.asm.Conv3D).apply(null,arguments)},c._Conv3DBackpropFilterV2=function(){return(c._Conv3DBackpropFilterV2=c.asm.Conv3DBackpropFilterV2).apply(null,arguments)},c._Conv3DBackpropInputV2=function(){return(c._Conv3DBackpropInputV2=c.asm.Conv3DBackpropInputV2).apply(null,arguments)},c._Cos=function(){return(c._Cos=c.asm.Cos).apply(null,arguments)},c._Cosh=function(){return(c._Cosh=c.asm.Cosh).apply(null,arguments)},c._CropAndResize=function(){return(c._CropAndResize=c.asm.CropAndResize).apply(null,arguments)},c._Cumprod=function(){return(c._Cumprod=c.asm.Cumprod).apply(null,arguments)},c._Cumsum=function(){return(c._Cumsum=c.asm.Cumsum).apply(null,arguments)},c._DenseBincount=function(){return(c._DenseBincount=c.asm.DenseBincount).apply(null,arguments)},c._DepthToSpace=function(){return(c._DepthToSpace=c.asm.DepthToSpace).apply(null,arguments)},c._DepthwiseConv2dNative=function(){return(c._DepthwiseConv2dNative=c.asm.DepthwiseConv2dNative).apply(null,arguments)},c._Diag=function(){return(c._Diag=c.asm.Diag).apply(null,arguments)},c._Dilation2D=function(){return(c._Dilation2D=c.asm.Dilation2D).apply(null,arguments)},c._Dilation2DBackpropFilter=function(){return(c._Dilation2DBackpropFilter=c.asm.Dilation2DBackpropFilter).apply(null,arguments)},c._Dilation2DBackpropInput=function(){return(c._Dilation2DBackpropInput=c.asm.Dilation2DBackpropInput).apply(null,arguments)},c._Elu=function(){return(c._Elu=c.asm.Elu).apply(null,arguments)},c._EluGrad=function(){return(c._EluGrad=c.asm.EluGrad).apply(null,arguments)},c._Equal=function(){return(c._Equal=c.asm.Equal).apply(null,arguments)},c._Erf=function(){return(c._Erf=c.asm.Erf).apply(null,arguments)},c._Exp=function(){return(c._Exp=c.asm.Exp).apply(null,arguments)},c._Expm1=function(){return(c._Expm1=c.asm.Expm1).apply(null,arguments)},c._FlipLeftRight=function(){return(c._FlipLeftRight=c.asm.FlipLeftRight).apply(null,arguments)},c._Floor=function(){return(c._Floor=c.asm.Floor).apply(null,arguments)},c._FloorDiv=function(){return(c._FloorDiv=c.asm.FloorDiv).apply(null,arguments)},c._FusedBatchNorm=function(){return(c._FusedBatchNorm=c.asm.FusedBatchNorm).apply(null,arguments)},c._FusedConv2D=function(){return(c._FusedConv2D=c.asm.FusedConv2D).apply(null,arguments)},c._FusedDepthwiseConv2D=function(){return(c._FusedDepthwiseConv2D=c.asm.FusedDepthwiseConv2D).apply(null,arguments)},c._Gather=function(){return(c._Gather=c.asm.Gather).apply(null,arguments)},c._GatherNd=function(){return(c._GatherNd=c.asm.GatherNd).apply(null,arguments)},c._Greater=function(){return(c._Greater=c.asm.Greater).apply(null,arguments)},c._GreaterEqual=function(){return(c._GreaterEqual=c.asm.GreaterEqual).apply(null,arguments)},c._IsFinite=function(){return(c._IsFinite=c.asm.IsFinite).apply(null,arguments)},c._IsInf=function(){return(c._IsInf=c.asm.IsInf).apply(null,arguments)},c._IsNan=function(){return(c._IsNan=c.asm.IsNan).apply(null,arguments)},c._LRN=function(){return(c._LRN=c.asm.LRN).apply(null,arguments)},c._LRNGrad=function(){return(c._LRNGrad=c.asm.LRNGrad).apply(null,arguments)},c._LeakyRelu=function(){return(c._LeakyRelu=c.asm.LeakyRelu).apply(null,arguments)},c._Less=function(){return(c._Less=c.asm.Less).apply(null,arguments)},c._LessEqual=function(){return(c._LessEqual=c.asm.LessEqual).apply(null,arguments)},c._LinSpace=function(){return(c._LinSpace=c.asm.LinSpace).apply(null,arguments)},c._Log=function(){return(c._Log=c.asm.Log).apply(null,arguments)},c._Log1p=function(){return(c._Log1p=c.asm.Log1p).apply(null,arguments)},c._LogicalAnd=function(){return(c._LogicalAnd=c.asm.LogicalAnd).apply(null,arguments)},c._LogicalNot=function(){return(c._LogicalNot=c.asm.LogicalNot).apply(null,arguments)},c._LogicalOr=function(){return(c._LogicalOr=c.asm.LogicalOr).apply(null,arguments)},c._LogicalXor=function(){return(c._LogicalXor=c.asm.LogicalXor).apply(null,arguments)},c._Max=function(){return(c._Max=c.asm.Max).apply(null,arguments)},c._MaxPool=function(){return(c._MaxPool=c.asm.MaxPool).apply(null,arguments)},c._MaxPool3D=function(){return(c._MaxPool3D=c.asm.MaxPool3D).apply(null,arguments)},c._MaxPool3DGrad=function(){return(c._MaxPool3DGrad=c.asm.MaxPool3DGrad).apply(null,arguments)},c._MaxPoolGrad=function(){return(c._MaxPoolGrad=c.asm.MaxPoolGrad).apply(null,arguments)},c._MaxPoolWithArgmax=function(){return(c._MaxPoolWithArgmax=c.asm.MaxPoolWithArgmax).apply(null,arguments)},c._Maximum=function(){return(c._Maximum=c.asm.Maximum).apply(null,arguments)},c._Mean=function(){return(c._Mean=c.asm.Mean).apply(null,arguments)},c._Min=function(){return(c._Min=c.asm.Min).apply(null,arguments)},c._Minimum=function(){return(c._Minimum=c.asm.Minimum).apply(null,arguments)},c._MirrorPad=function(){return(c._MirrorPad=c.asm.MirrorPad).apply(null,arguments)},c._Mod=function(){return(c._Mod=c.asm.Mod).apply(null,arguments)},c._Multinomial=function(){return(c._Multinomial=c.asm.Multinomial).apply(null,arguments)},c._Multiply=function(){return(c._Multiply=c.asm.Multiply).apply(null,arguments)},c._Neg=function(){return(c._Neg=c.asm.Neg).apply(null,arguments)},c._NonMaxSuppressionV3=function(){return(c._NonMaxSuppressionV3=c.asm.NonMaxSuppressionV3).apply(null,arguments)},c._NonMaxSuppressionV4=function(){return(c._NonMaxSuppressionV4=c.asm.NonMaxSuppressionV4).apply(null,arguments)},c._NonMaxSuppressionV5=function(){return(c._NonMaxSuppressionV5=c.asm.NonMaxSuppressionV5).apply(null,arguments)},c._NotEqual=function(){return(c._NotEqual=c.asm.NotEqual).apply(null,arguments)},c._OneHot=function(){return(c._OneHot=c.asm.OneHot).apply(null,arguments)},c._PadV2=function(){return(c._PadV2=c.asm.PadV2).apply(null,arguments)},c._Pow=function(){return(c._Pow=c.asm.Pow).apply(null,arguments)},c._Prelu=function(){return(c._Prelu=c.asm.Prelu).apply(null,arguments)},c._Prod=function(){return(c._Prod=c.asm.Prod).apply(null,arguments)},c._RealDiv=function(){return(c._RealDiv=c.asm.RealDiv).apply(null,arguments)},c._Reciprocal=function(){return(c._Reciprocal=c.asm.Reciprocal).apply(null,arguments)},c._Relu=function(){return(c._Relu=c.asm.Relu).apply(null,arguments)},c._Relu6=function(){return(c._Relu6=c.asm.Relu6).apply(null,arguments)},c._ResizeBilinear=function(){return(c._ResizeBilinear=c.asm.ResizeBilinear).apply(null,arguments)},c._ResizeBilinearGrad=function(){return(c._ResizeBilinearGrad=c.asm.ResizeBilinearGrad).apply(null,arguments)},c._ResizeNearestNeighbor=function(){return(c._ResizeNearestNeighbor=c.asm.ResizeNearestNeighbor).apply(null,arguments)},c._ResizeNearestNeighborGrad=function(){return(c._ResizeNearestNeighborGrad=c.asm.ResizeNearestNeighborGrad).apply(null,arguments)},c._Reverse=function(){return(c._Reverse=c.asm.Reverse).apply(null,arguments)},c._RotateWithOffset=function(){return(c._RotateWithOffset=c.asm.RotateWithOffset).apply(null,arguments)},c._Round=function(){return(c._Round=c.asm.Round).apply(null,arguments)},c._Rsqrt=function(){return(c._Rsqrt=c.asm.Rsqrt).apply(null,arguments)},c._ScatterNd=function(){return(c._ScatterNd=c.asm.ScatterNd).apply(null,arguments)},c._SearchSorted=function(){return(c._SearchSorted=c.asm.SearchSorted).apply(null,arguments)},c._SelectV2=function(){return(c._SelectV2=c.asm.SelectV2).apply(null,arguments)},c._Selu=function(){return(c._Selu=c.asm.Selu).apply(null,arguments)},c._Sigmoid=function(){return(c._Sigmoid=c.asm.Sigmoid).apply(null,arguments)},c._Sign=function(){return(c._Sign=c.asm.Sign).apply(null,arguments)},c._Sin=function(){return(c._Sin=c.asm.Sin).apply(null,arguments)},c._Sinh=function(){return(c._Sinh=c.asm.Sinh).apply(null,arguments)},c._Softmax=function(){return(c._Softmax=c.asm.Softmax).apply(null,arguments)},c._Softplus=function(){return(c._Softplus=c.asm.Softplus).apply(null,arguments)},c._SparseFillEmptyRows=function(){return(c._SparseFillEmptyRows=c.asm.SparseFillEmptyRows).apply(null,arguments)},c._SparseReshape=function(){return(c._SparseReshape=c.asm.SparseReshape).apply(null,arguments)},c._SparseSegmentReduction=function(){return(c._SparseSegmentReduction=c.asm.SparseSegmentReduction).apply(null,arguments)},c._SparseToDense=function(){return(c._SparseToDense=c.asm.SparseToDense).apply(null,arguments)},c._Sqrt=function(){return(c._Sqrt=c.asm.Sqrt).apply(null,arguments)},c._Square=function(){return(c._Square=c.asm.Square).apply(null,arguments)},c._SquaredDifference=function(){return(c._SquaredDifference=c.asm.SquaredDifference).apply(null,arguments)},c._Step=function(){return(c._Step=c.asm.Step).apply(null,arguments)},c._StridedSlice=function(){return(c._StridedSlice=c.asm.StridedSlice).apply(null,arguments)},c._Sub=function(){return(c._Sub=c.asm.Sub).apply(null,arguments)},c._Sum=function(){return(c._Sum=c.asm.Sum).apply(null,arguments)},c._Tan=function(){return(c._Tan=c.asm.Tan).apply(null,arguments)},c._Tanh=function(){return(c._Tanh=c.asm.Tanh).apply(null,arguments)},c._TensorScatterUpdate=function(){return(c._TensorScatterUpdate=c.asm.TensorScatterUpdate).apply(null,arguments)},c._Tile=function(){return(c._Tile=c.asm.Tile).apply(null,arguments)},c._TopK=function(){return(c._TopK=c.asm.TopK).apply(null,arguments)},c._Transform=function(){return(c._Transform=c.asm.Transform).apply(null,arguments)},c._Transpose=function(){return(c._Transpose=c.asm.Transpose).apply(null,arguments)},c.__FusedMatMul=function(){return(c.__FusedMatMul=c.asm._FusedMatMul).apply(null,arguments)},c._malloc=function(){return(c._malloc=c.asm.malloc).apply(null,arguments)},c._free=function(){return(c._free=c.asm.free).apply(null,arguments)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=c.asm._emscripten_tls_init).apply(null,arguments)},c._pthread_self=function(){return(Be=c._pthread_self=c.asm.pthread_self).apply(null,arguments)}),We=(c.___errno_location=function(){return(c.___errno_location=c.asm.__errno_location).apply(null,arguments)},c.__emscripten_thread_init=function(){return(We=c.__emscripten_thread_init=c.asm._emscripten_thread_init).apply(null,arguments)}),Ve=(c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=c.asm._emscripten_thread_crashed).apply(null,arguments)},c._emscripten_main_thread_process_queued_calls=function(){return(c._emscripten_main_thread_process_queued_calls=c.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},c._emscripten_main_browser_thread_id=function(){return(c._emscripten_main_browser_thread_id=c.asm.emscripten_main_browser_thread_id).apply(null,arguments)},c._emscripten_run_in_main_runtime_thread_js=function(){return(Ve=c._emscripten_run_in_main_runtime_thread_js=c.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)}),Ue=(c._emscripten_dispatch_to_thread_=function(){return(c._emscripten_dispatch_to_thread_=c.asm.emscripten_dispatch_to_thread_).apply(null,arguments)},c.__emscripten_proxy_execute_task_queue=function(){return(Ue=c.__emscripten_proxy_execute_task_queue=c.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)}),je=c.__emscripten_thread_free_data=function(){return(je=c.__emscripten_thread_free_data=c.asm._emscripten_thread_free_data).apply(null,arguments)},Ge=c.__emscripten_thread_exit=function(){return(Ge=c.__emscripten_thread_exit=c.asm._emscripten_thread_exit).apply(null,arguments)},He=c._emscripten_stack_set_limits=function(){return(He=c._emscripten_stack_set_limits=c.asm.emscripten_stack_set_limits).apply(null,arguments)},qe=c.stackSave=function(){return(qe=c.stackSave=c.asm.stackSave).apply(null,arguments)},Ke=c.stackRestore=function(){return(Ke=c.stackRestore=c.asm.stackRestore).apply(null,arguments)},Xe=c.stackAlloc=function(){return(Xe=c.stackAlloc=c.asm.stackAlloc).apply(null,arguments)};c.dynCall_iijjiiii=function(){return(c.dynCall_iijjiiii=c.asm.dynCall_iijjiiii).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.dynCall_jiji).apply(null,arguments)};function Ye(e){if(e=e||m,!(ee>0)){if(x)return o(c),J(),void startWorker(c);(function(){if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)Z(c.preRun.shift());me(K)})(),ee>0||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),t()},1)):t())}function t(){Me||(Me=!0,c.calledRun=!0,!M&&(J(),o(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),function(){if(!x){if(c.postRun)for("function"==typeof c.postRun&&(c.postRun=[c.postRun]);c.postRun.length;)$(c.postRun.shift());me(Y)}}()))}}if(c.keepRuntimeAlive=Q,c.wasmMemory=F,c.cwrap=function(e,t,n,a){var r=(n=n||[]).every(e=>"number"===e||"boolean"===e);return"string"!==t&&r&&!a?Fe(e):function(){return De(e,t,n,arguments)}},c.ExitStatus=ue,c.PThread=fe,ne=function e(){Me||Ye(),Me||(ne=e)},c.preInit)for("function"==typeof c.preInit&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();if(Ye(),u&&(Oe={uncaughtException:process.listeners("uncaughtException").filter(function(e){return!u.uncaughtException.indexOf(e)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(e){return!u.unhandledRejection.indexOf(e)>-1})}),"undefined"!=typeof WasmBackendModule)Pe=WasmBackendModule;else{if("undefined"==typeof t)throw new Error("Could not find wasm module in post.js");Pe=t}if(Oe){var Qe=Pe._dispose;Pe._dispose=function(){Qe(),Oe.uncaughtException.forEach(function(e){process.removeListener("uncaughtException",e)}),Oe.unhandledRejection.forEach(function(e){process.removeListener("unhandledRejection",e)})}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=a:"function"==typeof define&&n.amdO?define([],function(){return a}):"object"==typeof e&&(e.WasmBackendModuleThreadedSimd=a)}),Ic=nc((e,t)=>{t.exports.wasmWorkerContents='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};'}),Nc=nc((e,t)=>{var a=(()=>{var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return e=e||qu,function(t){var n,a,r,i="undefined"!=typeof(t=t||{})?t:{};i.ready=new Promise(function(e,t){n=e,a=t}),"undefined"!=typeof process&&process.listeners&&(r={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var s,o,l,u=Object.assign({},i),c=[],d="object"==typeof window,h="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,f="";if(p){var m=bc(),g=vc();f=h?g.dirname(f)+"/":"//",s=(e,t)=>(e=j(e)?new URL(e):g.normalize(e),m.readFileSync(e,t?void 0:"utf8")),l=e=>{var t=s(e,!0);return t.buffer||(t=new Uint8Array(t)),t},o=(e,t,n)=>{e=j(e)?new URL(e):g.normalize(e),m.readFile(e,function(e,a){e?n(e):t(a.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),c=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof H))throw e}),process.on("unhandledRejection",function(e){throw e}),i.inspect=function(){return"[Emscripten Module object]"}}else(d||h)&&(h?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),e&&(f=e),f=0!==f.indexOf("blob:")?f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)},e=>document.title=e);var y=i.print||console.log.bind(console),b=i.printErr||console.warn.bind(console);Object.assign(i,u),u=null,i.arguments&&(c=i.arguments),i.thisProgram&&i.thisProgram,i.quit&&i.quit;var v;i.wasmBinary&&(v=i.wasmBinary);var x=i.noExitRuntime||!0;"object"!=typeof WebAssembly&&B("no native wasm support detected");var w,k=!1;var S,I,N,T,C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,n){for(var a=(t>>>=0)+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.buffer&&C)return C.decode(e.subarray(t,r));for(var i="";t<r;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|l:(7&s)<<18|o<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(s);else{var u=s-65536;i+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else i+=String.fromCharCode((31&s)<<6|o)}else i+=String.fromCharCode(s)}return i}function _(e,t){return(e>>>=0)?E(N,e,t):""}function A(e){S=e,i.HEAP8=I=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=new Int32Array(e),i.HEAPU8=N=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=T=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=new Float64Array(e)}i.INITIAL_MEMORY;var F=[],R=[],D=[];function M(e){F.unshift(e)}function O(e){D.unshift(e)}var P=0,L=null,z=null;function B(e){i.onAbort&&i.onAbort(e),b(e="Aborted("+e+")"),k=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}var W,V;function U(e){return e.startsWith("data:application/octet-stream;base64,")}function j(e){return e.startsWith("file://")}function G(e){try{if(e==W&&v)return new Uint8Array(v);if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(t){B(t)}}function H(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function q(e){for(;e.length>0;)e.shift()(i)}function K(e){try{return w.grow(e-S.byteLength+65535>>>16),A(w.buffer),1}catch(t){}}U(W="tfjs-backend-wasm.wasm")||(V=W,W=i.locateFile?i.locateFile(V,f):f+V);var X=[null,[],[]];function Y(e,t){var n=X[e];0===t||10===t?((1===e?y:b)(E(n,0)),n.length=0):n.push(t)}function Q(e){return i["_"+e]}function J(e,t,n,a,r){var i={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,a){if(!(a>0))return 0;for(var r=n>>>=0,i=n+a-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),o<=127){if(n>=i)break;t[n++>>>0]=o}else if(o<=2047){if(n+1>=i)break;t[n++>>>0]=192|o>>6,t[n++>>>0]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++>>>0]=224|o>>12,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}else{if(n+3>=i)break;t[n++>>>0]=240|o>>18,t[n++>>>0]=128|o>>12&63,t[n++>>>0]=128|o>>6&63,t[n++>>>0]=128|63&o}}t[n>>>0]=0})(e,N,t,n)})(e,t=re(n),n)}return t},array:e=>{var t=re(e.length);return function(e,t){I.set(e,t>>>0)}(e,t),t}};var s=Q(e),o=[],l=0;if(a)for(var u=0;u<a.length;u++){var c=i[n[u]];c?(0===l&&(l=ne()),o[u]=c(a[u])):o[u]=a[u]}var d,h=s.apply(null,o);return d=h,0!==l&&ae(l),h=function(e){return"string"===t?_(e):"boolean"===t?!!e:e}(d),h}var Z,$,ee,te={abort:function(){B("")},emscripten_get_heap_max:function(){return 4294901760},emscripten_memcpy_big:function(e,t,n){N.copyWithin(e>>>0,t>>>0,t+n>>>0)},emscripten_resize_heap:function(e){var t=N.length,n=4294901760;if((e>>>=0)>n)return!1;let a=(e,t)=>e+(t-e%t)%t;for(var r=1;r<=4;r*=2){var i=t*(1+.2/r);if(i=Math.min(i,e+100663296),K(Math.min(n,a(Math.max(e,i),65536))))return!0}return!1},fd_close:function(e){return 52},fd_seek:function(e,t,n,a,r){return 70},fd_write:function(e,t,n,a){for(var r=0,i=0;i<n;i++){var s=T[t>>>2],o=T[t+4>>>2];t+=8;for(var l=0;l<o;l++)Y(e,N[s+l>>>0]);r+=o}return T[a>>>2]=r,0}},ne=(function(){var e={env:te,wasi_snapshot_preview1:te};function t(e,t){var n=e.exports;i.asm=n,A((w=i.asm.memory).buffer),i.asm.__indirect_function_table,function(e){R.unshift(e)}(i.asm.__wasm_call_ctors),function(){if(P--,i.monitorRunDependencies&&i.monitorRunDependencies(P),0==P&&(null!==L&&(clearInterval(L),L=null),z)){var e=z;z=null,e()}}()}function n(e){t(e.instance)}function r(t){return function(){if(!v&&(d||h)){if("function"==typeof fetch&&!j(W))return fetch(W,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+W+"'";return e.arrayBuffer()}).catch(function(){return G(W)});if(o)return new Promise(function(e,t){o(W,function(t){e(new Uint8Array(t))},t)})}return Promise.resolve().then(function(){return G(W)})}().then(function(t){return WebAssembly.instantiate(t,e)}).then(function(e){return e}).then(t,function(e){b("failed to asynchronously prepare wasm: "+e),B(e)})}if(P++,i.monitorRunDependencies&&i.monitorRunDependencies(P),i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(s){b("Module.instantiateWasm callback failed with error: "+s),a(s)}(v||"function"!=typeof WebAssembly.instantiateStreaming||U(W)||j(W)||p||"function"!=typeof fetch?r(n):fetch(W,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(n,function(e){return b("wasm streaming compile failed: "+e),b("falling back to ArrayBuffer instantiation"),r(n)})})).catch(a)}(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.__wasm_call_ctors).apply(null,arguments)},i._init=function(){return(i._init=i.asm.init).apply(null,arguments)},i._init_with_threads_count=function(){return(i._init_with_threads_count=i.asm.init_with_threads_count).apply(null,arguments)},i._get_threads_count=function(){return(i._get_threads_count=i.asm.get_threads_count).apply(null,arguments)},i._register_tensor=function(){return(i._register_tensor=i.asm.register_tensor).apply(null,arguments)},i._dispose_data=function(){return(i._dispose_data=i.asm.dispose_data).apply(null,arguments)},i._dispose=function(){return(i._dispose=i.asm.dispose).apply(null,arguments)},i._Abs=function(){return(i._Abs=i.asm.Abs).apply(null,arguments)},i._Acos=function(){return(i._Acos=i.asm.Acos).apply(null,arguments)},i._Acosh=function(){return(i._Acosh=i.asm.Acosh).apply(null,arguments)},i._Add=function(){return(i._Add=i.asm.Add).apply(null,arguments)},i._AddN=function(){return(i._AddN=i.asm.AddN).apply(null,arguments)},i._All=function(){return(i._All=i.asm.All).apply(null,arguments)},i._Any=function(){return(i._Any=i.asm.Any).apply(null,arguments)},i._ArgMax=function(){return(i._ArgMax=i.asm.ArgMax).apply(null,arguments)},i._ArgMin=function(){return(i._ArgMin=i.asm.ArgMin).apply(null,arguments)},i._Asin=function(){return(i._Asin=i.asm.Asin).apply(null,arguments)},i._Asinh=function(){return(i._Asinh=i.asm.Asinh).apply(null,arguments)},i._Atan=function(){return(i._Atan=i.asm.Atan).apply(null,arguments)},i._Atan2=function(){return(i._Atan2=i.asm.Atan2).apply(null,arguments)},i._Atanh=function(){return(i._Atanh=i.asm.Atanh).apply(null,arguments)},i._AvgPool=function(){return(i._AvgPool=i.asm.AvgPool).apply(null,arguments)},i._AvgPool3D=function(){return(i._AvgPool3D=i.asm.AvgPool3D).apply(null,arguments)},i._AvgPool3DGrad=function(){return(i._AvgPool3DGrad=i.asm.AvgPool3DGrad).apply(null,arguments)},i._AvgPoolGrad=function(){return(i._AvgPoolGrad=i.asm.AvgPoolGrad).apply(null,arguments)},i._BatchMatMul=function(){return(i._BatchMatMul=i.asm.BatchMatMul).apply(null,arguments)},i._Bincount=function(){return(i._Bincount=i.asm.Bincount).apply(null,arguments)},i._BitwiseAnd=function(){return(i._BitwiseAnd=i.asm.BitwiseAnd).apply(null,arguments)},i._Ceil=function(){return(i._Ceil=i.asm.Ceil).apply(null,arguments)},i._ClipByValue=function(){return(i._ClipByValue=i.asm.ClipByValue).apply(null,arguments)},i._Conv2D=function(){return(i._Conv2D=i.asm.Conv2D).apply(null,arguments)},i._Conv2DBackpropInput=function(){return(i._Conv2DBackpropInput=i.asm.Conv2DBackpropInput).apply(null,arguments)},i._Conv3D=function(){return(i._Conv3D=i.asm.Conv3D).apply(null,arguments)},i._Conv3DBackpropFilterV2=function(){return(i._Conv3DBackpropFilterV2=i.asm.Conv3DBackpropFilterV2).apply(null,arguments)},i._Conv3DBackpropInputV2=function(){return(i._Conv3DBackpropInputV2=i.asm.Conv3DBackpropInputV2).apply(null,arguments)},i._Cos=function(){return(i._Cos=i.asm.Cos).apply(null,arguments)},i._Cosh=function(){return(i._Cosh=i.asm.Cosh).apply(null,arguments)},i._CropAndResize=function(){return(i._CropAndResize=i.asm.CropAndResize).apply(null,arguments)},i._Cumprod=function(){return(i._Cumprod=i.asm.Cumprod).apply(null,arguments)},i._Cumsum=function(){return(i._Cumsum=i.asm.Cumsum).apply(null,arguments)},i._DenseBincount=function(){return(i._DenseBincount=i.asm.DenseBincount).apply(null,arguments)},i._DepthToSpace=function(){return(i._DepthToSpace=i.asm.DepthToSpace).apply(null,arguments)},i._DepthwiseConv2dNative=function(){return(i._DepthwiseConv2dNative=i.asm.DepthwiseConv2dNative).apply(null,arguments)},i._Diag=function(){return(i._Diag=i.asm.Diag).apply(null,arguments)},i._Dilation2D=function(){return(i._Dilation2D=i.asm.Dilation2D).apply(null,arguments)},i._Dilation2DBackpropFilter=function(){return(i._Dilation2DBackpropFilter=i.asm.Dilation2DBackpropFilter).apply(null,arguments)},i._Dilation2DBackpropInput=function(){return(i._Dilation2DBackpropInput=i.asm.Dilation2DBackpropInput).apply(null,arguments)},i._Elu=function(){return(i._Elu=i.asm.Elu).apply(null,arguments)},i._EluGrad=function(){return(i._EluGrad=i.asm.EluGrad).apply(null,arguments)},i._Equal=function(){return(i._Equal=i.asm.Equal).apply(null,arguments)},i._Erf=function(){return(i._Erf=i.asm.Erf).apply(null,arguments)},i._Exp=function(){return(i._Exp=i.asm.Exp).apply(null,arguments)},i._Expm1=function(){return(i._Expm1=i.asm.Expm1).apply(null,arguments)},i._FlipLeftRight=function(){return(i._FlipLeftRight=i.asm.FlipLeftRight).apply(null,arguments)},i._Floor=function(){return(i._Floor=i.asm.Floor).apply(null,arguments)},i._FloorDiv=function(){return(i._FloorDiv=i.asm.FloorDiv).apply(null,arguments)},i._FusedBatchNorm=function(){return(i._FusedBatchNorm=i.asm.FusedBatchNorm).apply(null,arguments)},i._FusedConv2D=function(){return(i._FusedConv2D=i.asm.FusedConv2D).apply(null,arguments)},i._FusedDepthwiseConv2D=function(){return(i._FusedDepthwiseConv2D=i.asm.FusedDepthwiseConv2D).apply(null,arguments)},i._Gather=function(){return(i._Gather=i.asm.Gather).apply(null,arguments)},i._GatherNd=function(){return(i._GatherNd=i.asm.GatherNd).apply(null,arguments)},i._Greater=function(){return(i._Greater=i.asm.Greater).apply(null,arguments)},i._GreaterEqual=function(){return(i._GreaterEqual=i.asm.GreaterEqual).apply(null,arguments)},i._IsFinite=function(){return(i._IsFinite=i.asm.IsFinite).apply(null,arguments)},i._IsInf=function(){return(i._IsInf=i.asm.IsInf).apply(null,arguments)},i._IsNan=function(){return(i._IsNan=i.asm.IsNan).apply(null,arguments)},i._LRN=function(){return(i._LRN=i.asm.LRN).apply(null,arguments)},i._LRNGrad=function(){return(i._LRNGrad=i.asm.LRNGrad).apply(null,arguments)},i._LeakyRelu=function(){return(i._LeakyRelu=i.asm.LeakyRelu).apply(null,arguments)},i._Less=function(){return(i._Less=i.asm.Less).apply(null,arguments)},i._LessEqual=function(){return(i._LessEqual=i.asm.LessEqual).apply(null,arguments)},i._LinSpace=function(){return(i._LinSpace=i.asm.LinSpace).apply(null,arguments)},i._Log=function(){return(i._Log=i.asm.Log).apply(null,arguments)},i._Log1p=function(){return(i._Log1p=i.asm.Log1p).apply(null,arguments)},i._LogicalAnd=function(){return(i._LogicalAnd=i.asm.LogicalAnd).apply(null,arguments)},i._LogicalNot=function(){return(i._LogicalNot=i.asm.LogicalNot).apply(null,arguments)},i._LogicalOr=function(){return(i._LogicalOr=i.asm.LogicalOr).apply(null,arguments)},i._LogicalXor=function(){return(i._LogicalXor=i.asm.LogicalXor).apply(null,arguments)},i._Max=function(){return(i._Max=i.asm.Max).apply(null,arguments)},i._MaxPool=function(){return(i._MaxPool=i.asm.MaxPool).apply(null,arguments)},i._MaxPool3D=function(){return(i._MaxPool3D=i.asm.MaxPool3D).apply(null,arguments)},i._MaxPool3DGrad=function(){return(i._MaxPool3DGrad=i.asm.MaxPool3DGrad).apply(null,arguments)},i._MaxPoolGrad=function(){return(i._MaxPoolGrad=i.asm.MaxPoolGrad).apply(null,arguments)},i._MaxPoolWithArgmax=function(){return(i._MaxPoolWithArgmax=i.asm.MaxPoolWithArgmax).apply(null,arguments)},i._Maximum=function(){return(i._Maximum=i.asm.Maximum).apply(null,arguments)},i._Mean=function(){return(i._Mean=i.asm.Mean).apply(null,arguments)},i._Min=function(){return(i._Min=i.asm.Min).apply(null,arguments)},i._Minimum=function(){return(i._Minimum=i.asm.Minimum).apply(null,arguments)},i._MirrorPad=function(){return(i._MirrorPad=i.asm.MirrorPad).apply(null,arguments)},i._Mod=function(){return(i._Mod=i.asm.Mod).apply(null,arguments)},i._Multinomial=function(){return(i._Multinomial=i.asm.Multinomial).apply(null,arguments)},i._Multiply=function(){return(i._Multiply=i.asm.Multiply).apply(null,arguments)},i._Neg=function(){return(i._Neg=i.asm.Neg).apply(null,arguments)},i._NonMaxSuppressionV3=function(){return(i._NonMaxSuppressionV3=i.asm.NonMaxSuppressionV3).apply(null,arguments)},i._NonMaxSuppressionV4=function(){return(i._NonMaxSuppressionV4=i.asm.NonMaxSuppressionV4).apply(null,arguments)},i._NonMaxSuppressionV5=function(){return(i._NonMaxSuppressionV5=i.asm.NonMaxSuppressionV5).apply(null,arguments)},i._NotEqual=function(){return(i._NotEqual=i.asm.NotEqual).apply(null,arguments)},i._OneHot=function(){return(i._OneHot=i.asm.OneHot).apply(null,arguments)},i._PadV2=function(){return(i._PadV2=i.asm.PadV2).apply(null,arguments)},i._Pow=function(){return(i._Pow=i.asm.Pow).apply(null,arguments)},i._Prelu=function(){return(i._Prelu=i.asm.Prelu).apply(null,arguments)},i._Prod=function(){return(i._Prod=i.asm.Prod).apply(null,arguments)},i._RealDiv=function(){return(i._RealDiv=i.asm.RealDiv).apply(null,arguments)},i._Reciprocal=function(){return(i._Reciprocal=i.asm.Reciprocal).apply(null,arguments)},i._Relu=function(){return(i._Relu=i.asm.Relu).apply(null,arguments)},i._Relu6=function(){return(i._Relu6=i.asm.Relu6).apply(null,arguments)},i._ResizeBilinear=function(){return(i._ResizeBilinear=i.asm.ResizeBilinear).apply(null,arguments)},i._ResizeBilinearGrad=function(){return(i._ResizeBilinearGrad=i.asm.ResizeBilinearGrad).apply(null,arguments)},i._ResizeNearestNeighbor=function(){return(i._ResizeNearestNeighbor=i.asm.ResizeNearestNeighbor).apply(null,arguments)},i._ResizeNearestNeighborGrad=function(){return(i._ResizeNearestNeighborGrad=i.asm.ResizeNearestNeighborGrad).apply(null,arguments)},i._Reverse=function(){return(i._Reverse=i.asm.Reverse).apply(null,arguments)},i._RotateWithOffset=function(){return(i._RotateWithOffset=i.asm.RotateWithOffset).apply(null,arguments)},i._Round=function(){return(i._Round=i.asm.Round).apply(null,arguments)},i._Rsqrt=function(){return(i._Rsqrt=i.asm.Rsqrt).apply(null,arguments)},i._ScatterNd=function(){return(i._ScatterNd=i.asm.ScatterNd).apply(null,arguments)},i._SearchSorted=function(){return(i._SearchSorted=i.asm.SearchSorted).apply(null,arguments)},i._SelectV2=function(){return(i._SelectV2=i.asm.SelectV2).apply(null,arguments)},i._Selu=function(){return(i._Selu=i.asm.Selu).apply(null,arguments)},i._Sigmoid=function(){return(i._Sigmoid=i.asm.Sigmoid).apply(null,arguments)},i._Sign=function(){return(i._Sign=i.asm.Sign).apply(null,arguments)},i._Sin=function(){return(i._Sin=i.asm.Sin).apply(null,arguments)},i._Sinh=function(){return(i._Sinh=i.asm.Sinh).apply(null,arguments)},i._Softmax=function(){return(i._Softmax=i.asm.Softmax).apply(null,arguments)},i._Softplus=function(){return(i._Softplus=i.asm.Softplus).apply(null,arguments)},i._SparseFillEmptyRows=function(){return(i._SparseFillEmptyRows=i.asm.SparseFillEmptyRows).apply(null,arguments)},i._SparseReshape=function(){return(i._SparseReshape=i.asm.SparseReshape).apply(null,arguments)},i._SparseSegmentReduction=function(){return(i._SparseSegmentReduction=i.asm.SparseSegmentReduction).apply(null,arguments)},i._SparseToDense=function(){return(i._SparseToDense=i.asm.SparseToDense).apply(null,arguments)},i._Sqrt=function(){return(i._Sqrt=i.asm.Sqrt).apply(null,arguments)},i._Square=function(){return(i._Square=i.asm.Square).apply(null,arguments)},i._SquaredDifference=function(){return(i._SquaredDifference=i.asm.SquaredDifference).apply(null,arguments)},i._Step=function(){return(i._Step=i.asm.Step).apply(null,arguments)},i._StridedSlice=function(){return(i._StridedSlice=i.asm.StridedSlice).apply(null,arguments)},i._Sub=function(){return(i._Sub=i.asm.Sub).apply(null,arguments)},i._Sum=function(){return(i._Sum=i.asm.Sum).apply(null,arguments)},i._Tan=function(){return(i._Tan=i.asm.Tan).apply(null,arguments)},i._Tanh=function(){return(i._Tanh=i.asm.Tanh).apply(null,arguments)},i._TensorScatterUpdate=function(){return(i._TensorScatterUpdate=i.asm.TensorScatterUpdate).apply(null,arguments)},i._Tile=function(){return(i._Tile=i.asm.Tile).apply(null,arguments)},i._TopK=function(){return(i._TopK=i.asm.TopK).apply(null,arguments)},i._Transform=function(){return(i._Transform=i.asm.Transform).apply(null,arguments)},i._Transpose=function(){return(i._Transpose=i.asm.Transpose).apply(null,arguments)},i.__FusedMatMul=function(){return(i.__FusedMatMul=i.asm._FusedMatMul).apply(null,arguments)},i._malloc=function(){return(i._malloc=i.asm.malloc).apply(null,arguments)},i._free=function(){return(i._free=i.asm.free).apply(null,arguments)},i.___errno_location=function(){return(i.___errno_location=i.asm.__errno_location).apply(null,arguments)},i.stackSave=function(){return(ne=i.stackSave=i.asm.stackSave).apply(null,arguments)}),ae=i.stackRestore=function(){return(ae=i.stackRestore=i.asm.stackRestore).apply(null,arguments)},re=i.stackAlloc=function(){return(re=i.stackAlloc=i.asm.stackAlloc).apply(null,arguments)};i.dynCall_iijjiiii=function(){return(i.dynCall_iijjiiii=i.asm.dynCall_iijjiiii).apply(null,arguments)},i.dynCall_jiji=function(){return(i.dynCall_jiji=i.asm.dynCall_jiji).apply(null,arguments)};function ie(e){function t(){Z||(Z=!0,i.calledRun=!0,!k&&(q(R),n(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)O(i.postRun.shift());q(D)}()))}e=e||c,P>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)M(i.preRun.shift());q(F)}(),P>0)||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),t()},1)):t())}if(i.cwrap=function(e,t,n,a){var r=(n=n||[]).every(e=>"number"===e||"boolean"===e);return"string"!==t&&r&&!a?Q(e):function(){return J(e,t,n,arguments)}},z=function e(){Z||ie(),Z||(z=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();if(ie(),r&&($={uncaughtException:process.listeners("uncaughtException").filter(function(e){return!r.uncaughtException.indexOf(e)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(e){return!r.unhandledRejection.indexOf(e)>-1})}),"undefined"!=typeof t)ee=t;else{if("undefined"==typeof WasmBackendModuleThreadedSimd)throw new Error("Could not find wasm module in post.js");ee=WasmBackendModuleThreadedSimd}if($){var se=ee._dispose;ee._dispose=function(){se(),$.uncaughtException.forEach(function(e){process.removeListener("uncaughtException",e)}),$.unhandledRejection.forEach(function(e){process.removeListener("unhandledRejection",e)})}}return t.ready}})();"object"==typeof e&&"object"==typeof t?t.exports=a:"function"==typeof define&&n.amdO?define([],function(){return a}):"object"==typeof e&&(e.WasmBackendModule=a)}),Tc=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},Cc=class{refCount(e){return Ec("refCount")}incRef(e){return Ec("incRef")}timerAvailable(){return!0}time(e){return Ec("time")}read(e){return Ec("read")}readSync(e){return Ec("readSync")}readToGPU(e,t){return Ec("readToGPU")}numDataIds(){return Ec("numDataIds")}disposeData(e,t){return Ec("disposeData")}write(e,t,n){return Ec("write")}move(e,t,n,a,r){return Ec("move")}createTensorFromGPUData(e,t,n){return Ec("createTensorFromGPUData")}memory(){return Ec("memory")}floatPrecision(){return Ec("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Ec("dispose")}};function Ec(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen"))}function _c(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Dc(e,t,n)}function Ac(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together First array length was ".concat(e.length,"Second array length was ").concat(t.length));let n=e.length,a=0;for(;n>0;)a=Math.random()*n|0,n--,Dc(e,n,a),Dc(t,n,a)}function Fc(e,t,n){return Math.max(e,Math.min(t,n))}function Rc(e){return e%2===0?e:e+1}function Dc(e,t,n){let a=e[t];e[t]=e[n],e[n]=a}function Mc(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function Oc(e,t){let n=Math.random();return t*n+(1-n)*e}function Pc(e,t){let n=0;for(let a=0;a<e.length;a++){let r=Number(e[a])-Number(t[a]);n+=r*r}return n}function Lc(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function zc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Lc(jc(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function Bc(e){Lc(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function Wc(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Vc(e){return 0===e.length}function Uc(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function jc(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Gc(e){return e%1===0}function Hc(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function qc(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Kc(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return _c(t),t}function Xc(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Yc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return new Promise((r,i)=>{let s=0,o=()=>{if(e())return void r();s++;let l=t(s);null!=n&&s>=n?i():null!=a?a(o,l):setTimeout(o,l)};o()})}function Qc(e,t){let n=1,a=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. Found -1 at dim ".concat(a," and dim ").concat(i));a=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found ".concat(e[i]," at dim ").concat(i));if(-1===a){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when there are 0 elements"));if(t%n!==0)throw Error("The implicit shape can't be a fractional number. Got ".concat(t," / ").concat(n));let r=e.slice();return r[a]=t/n,r}function Jc(e,t){let n=t.length;return Lc((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ").concat(e)),Lc(e.every(e=>Gc(e)),()=>"All values in axis param must be integers but got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function Zc(e,t){let n=[],a=[],r=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||r?null:Jc(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(null!=i){if(i[s]===o&&1!==e[o])throw new Error("Can't squeeze axis ".concat(o," since its dim '").concat(e[o],"' is not 1"));(null==i[s]||i[s]>o)&&1===e[o]&&(n.push(e[o]),a.push(o)),i[s]<=o&&s++}1!==e[o]&&(n.push(e[o]),a.push(o))}return{newShape:n,keptDims:a}}function $c(e,t){return ed(e,t)}function ed(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function td(e,t){for(let n=0;n<e.length;n++){let a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(a,"."))}}function nd(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function ad(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function rd(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function id(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function sd(e){return"string"==typeof e||e instanceof String}function od(e){return"boolean"==typeof e}function ld(e){return"number"==typeof e}function ud(e){return Array.isArray(e)?ud(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":ld(e)?"float32":sd(e)?"string":od(e)?"bool":"float32"}function cd(e){return!!(e&&e.constructor&&e.call&&e.apply)}function dd(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function hd(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function pd(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Array;if(1===t.length){let i=t[0]*(a?2:1);for(let t=0;t<i;t++)r[t]=n[e+t]}else{let i=t[0],s=t.slice(1),o=s.reduce((e,t)=>e*t)*(a?2:1);for(let t=0;t<i;t++)r[t]=pd(e+t*o,s,n,a)}return r}function fd(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];let a=e.reduce((e,t)=>e*t)*(n?2:1);if(0===a)return[];if(a!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return pd(0,e,t,n)}function md(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function gd(e,t){let n=yd(e,t);for(let a=0;a<n.length;a++)n[a]=1;return n}function yd(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function bd(e,t){let n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return fd(e,new Float32Array(n));if("int32"===t)return fd(e,new Int32Array(n));if("bool"===t)return fd(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function vd(e){e.forEach(t=>{Lc(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got shape [".concat(e,"]."))})}function xd(e,t,n){if(0===t)return 0;if(1===t)return e[0];let a=e[e.length-1];for(let r=0;r<e.length-1;++r)a+=n[r]*e[r];return a}function wd(e,t,n){if(0===t)return[];if(1===t)return[e];let a=new Array(t);for(let r=0;r<a.length-1;++r)a[r]=Math.floor(e/n[r]),e-=a[r]*n[r];return a[a.length-1]=e,a}function kd(e){return e&&e.then&&"function"==typeof e.then}var Sd="tfjsflags",Id=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Nd,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(Td().getBool("IS_TEST")||Td().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. Overwriting the platform with ").concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let t=this.urlFlags[e];Td().getBool("IS_TEST")||Td().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(kd(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. Please use getAsync() instead."));return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"==typeof this.global||"undefined"==typeof this.global.location||"undefined"==typeof this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);Sd in e&&e[Sd].split(",").forEach(e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){let n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}};function Nd(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,a[0],a[1]),a.join("=")}),t}function Td(){return Ed}var Cd,Ed=null;function _d(){if(null==Cd){let e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Cd=e}return Cd}function Ad(e,t){let n=function(){let e=_d();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let a=t();return n.set(e,a),n.get(e)}}var Fd="Abs",Rd="Acos",Dd="Acosh",Md="Add",Od="AddN",Pd="All",Ld="Any",zd="ArgMax",Bd="ArgMin",Wd="Asin",Vd="Asinh",Ud="Atan",jd="Atanh",Gd="Atan2",Hd="AvgPool",qd="AvgPoolGrad",Kd="AvgPool3D",Xd="AvgPool3DGrad",Yd="BatchMatMul",Qd="BatchToSpaceND",Jd="Bincount",Zd="BitwiseAnd",$d="BroadcastTo",eh="BroadcastArgs",th="Cast",nh="Ceil",ah="ClipByValue",rh="Complex",ih="ComplexAbs",sh="Concat",oh="Conv2D",lh="Conv2DBackpropFilter",uh="Conv2DBackpropInput",ch="Conv3D",dh="Conv3DBackpropFilterV2",hh="Conv3DBackpropInputV2",ph="Cos",fh="Cosh",mh="Cumprod",gh="Cumsum",yh="CropAndResize",bh="DenseBincount",vh="DepthToSpace",xh="DepthwiseConv2dNative",wh="DepthwiseConv2dNativeBackpropFilter",kh="DepthwiseConv2dNativeBackpropInput",Sh="Diag",Ih="Dilation2D",Nh="Dilation2DBackpropInput",Th="Dilation2DBackpropFilter",Ch="Draw",Eh="RealDiv",_h="Einsum",Ah="Elu",Fh="EluGrad",Rh="Erf",Dh="Equal",Mh="Exp",Oh="ExpandDims",Ph="Expm1",Lh="FFT",zh="Fill",Bh="FlipLeftRight",Wh="Floor",Vh="FloorDiv",Uh="FusedBatchNorm",jh="GatherV2",Gh="GatherNd",Hh="Greater",qh="GreaterEqual",Kh="Identity",Xh="IFFT",Yh="Imag",Qh="IsFinite",Jh="IsInf",Zh="IsNan",$h="LeakyRelu",ep="Less",tp="LessEqual",np="LinSpace",ap="Log",rp="Log1p",ip="LogicalAnd",sp="LogicalNot",op="LogicalOr",lp="LogicalXor",up="LogSoftmax",cp="LowerBound",dp="LRN",hp="LRNGrad",pp="MatrixBandPart",fp="Max",mp="Maximum",gp="MaxPool",yp="MaxPoolGrad",bp="MaxPool3D",vp="MaxPool3DGrad",xp="MaxPoolWithArgmax",wp="Mean",kp="Min",Sp="Minimum",Ip="MirrorPad",Np="Mod",Tp="Multinomial",Cp="Multiply",Ep="Neg",_p="NotEqual",Ap="NonMaxSuppressionV3",Fp="NonMaxSuppressionV4",Rp="NonMaxSuppressionV5",Dp="OnesLike",Mp="OneHot",Op="Pack",Pp="PadV2",Lp="Pool",zp="Pow",Bp="Prelu",Wp="Prod",Vp="RaggedGather",Up="RaggedRange",jp="RaggedTensorToTensor",Gp="Range",Hp="Real",qp="Reciprocal",Kp="Relu",Xp="Reshape",Yp="ResizeNearestNeighbor",Qp="ResizeNearestNeighborGrad",Jp="ResizeBilinear",Zp="ResizeBilinearGrad",$p="Relu6",ef="Reverse",tf="Round",nf="Rsqrt",af="ScatterNd",rf="TensorScatterUpdate",sf="SearchSorted",of="Select",lf="Selu",uf="Slice",cf="Sin",df="Sinh",hf="Sign",pf="Sigmoid",ff="Softplus",mf="Sqrt",gf="Sum",yf="SpaceToBatchND",bf="SplitV",vf="Softmax",xf="SparseFillEmptyRows",wf="SparseReshape",kf="SparseSegmentMean",Sf="SparseSegmentSum",If="SparseToDense",Nf="SquaredDifference",Tf="Square",Cf="StaticRegexReplace",Ef="StridedSlice",_f="StringNGrams",Af="StringSplit",Ff="StringToHashBucketFast",Rf="Sub",Df="Tan",Mf="Tanh",Of="Tile",Pf="TopK",Lf="Transform",zf="Transpose",Bf="Unique",Wf="Unpack",Vf="UnsortedSegmentSum",Uf="UpperBound",jf="ZerosLike",Gf="Step",Hf="FromPixels",qf="RotateWithOffset",Kf="_FusedMatMul",Xf="FusedConv2D",Yf="FusedDepthwiseConv2D";function Qf(){Td().getBool("IS_TEST")||Td().getBool("PROD")||console.warn(...arguments)}function Jf(){Td().getBool("IS_TEST")||Td().getBool("PROD")||console.log(...arguments)}var Zf=Ad("kernelRegistry",()=>new Map),$f=Ad("gradRegistry",()=>new Map);function em(e,t){let n=lm(e,t);return Zf.get(n)}function tm(e){return $f.get(e)}function nm(e){let t=Zf.entries(),n=[];for(;;){let{done:a,value:r}=t.next();if(a)break;let[i,s]=r,[o]=i.split("_");o===e&&n.push(s)}return n}function am(e){let{kernelName:t,backendName:n}=e,a=lm(t,n);Zf.has(a)&&Qf("The kernel '".concat(t,"' for backend '").concat(n,"' is already registered")),Zf.set(a,e)}function rm(e){let{kernelName:t}=e;$f.has(t)&&Td().getBool("DEBUG")&&Qf("Overriding the gradient for '".concat(t,"'")),$f.set(t,e)}function im(e,t){let n=lm(e,t);if(!Zf.has(n))throw new Error("The kernel '".concat(e,"' for backend '").concat(t,"' is not registered"));Zf.delete(n)}function sm(e){if(!$f.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));$f.delete(e)}function om(e,t){nm(e).forEach(e=>{am(Object.assign({},e,{backendName:t}))})}function lm(e,t){return"".concat(t,"_").concat(e)}var um={};function cm(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}ac(um,{arraysEqual:()=>jc,arraysEqualWithNull:()=>Uc,assert:()=>Lc,assertNonNegativeIntegerDimensions:()=>vd,assertNonNull:()=>Bc,assertShapesMatch:()=>zc,bytesFromStringArray:()=>id,bytesPerElement:()=>rd,checkConversionForErrors:()=>td,clamp:()=>Fc,computeStrides:()=>hd,convertBackendValuesAndArrayBuffer:()=>md,createScalarValue:()=>Nm,createShuffledIndices:()=>Kc,decodeString:()=>Am,distSquared:()=>Pc,encodeString:()=>_m,fetch:()=>Em,fingerPrint64:()=>Im,flatten:()=>Rm,getArrayFromDType:()=>ed,getTypedArrayFromDType:()=>$c,hasEncodingLoss:()=>ad,hexToLong:()=>pm,indexToLoc:()=>wd,inferDtype:()=>ud,inferFromImplicitShape:()=>Qc,isBoolean:()=>od,isFunction:()=>cd,isInt:()=>Gc,isNumber:()=>ld,isPromise:()=>kd,isScalarShape:()=>Vc,isString:()=>sd,isTypedArray:()=>Fm,isValidDtype:()=>nd,locToIndex:()=>xd,makeOnesTypedArray:()=>gd,makeZerosNestedTypedArray:()=>bd,makeZerosTypedArray:()=>yd,nearestDivisor:()=>dd,nearestLargerEven:()=>Rc,now:()=>Cm,parseAxisParam:()=>Jc,randUniform:()=>Oc,repeatedTry:()=>Yc,rightPad:()=>Xc,shuffle:()=>_c,shuffleCombo:()=>Ac,sizeFromShape:()=>Wc,sizeToSquarishShape:()=>qc,squeezeShape:()=>Zc,sum:()=>Mc,swap:()=>Dc,tanh:()=>Hc,toNestedArray:()=>fd,toTypedArray:()=>Tm});var dm=rc(ic()),hm=dm.default||dm;function pm(e){return hm.fromString(e,!0,16)}var fm=pm("c3a5c85c97cb3127"),mm=pm("b492b66fbe98f273"),gm=pm("9ae16a3b2f90404f");function ym(e){return e.xor(e.shru(47))}function bm(e,t,n){let a=e.slice(t,t+n);return hm.fromBytes(Array.from(a),!0,!0)}function vm(e,t){return bm(e,t,8)}function xm(e,t){return bm(e,t,4)}function wm(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function km(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pm("9ddfea08eb382d69"),a=e.xor(t).mul(n);a=a.xor(a.shru(47));let r=t.xor(a).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Sm(e,t,n,a){return function(e,t,n,a,r,i){r=r.add(e),i=wm(i.add(r).add(a),21);let s=r;return r=(r=r.add(t)).add(n),i=i.add(wm(r,44)),[r.add(a),i.add(s)]}(vm(e,t),vm(e,t+8),vm(e,t+16),vm(e,t+24),n,a)}function Im(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=hm.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){let n=gm.add(2*t),a=vm(e,0).add(gm),r=vm(e,t-8);return km(wm(r,37).mul(n).add(a),wm(a,25).add(r).mul(n),n)}if(t>=4){let n=gm.add(2*t);return km(xm(e,0).shl(3).add(t),xm(e,t-4),n)}if(t>0){let n=e[0]+(e[t>>1]<<8),a=t+(e[t-1]<<2);return ym(gm.mul(n).xor(fm.mul(a))).mul(gm)}return gm}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=gm.add(2*t),a=vm(e,0).mul(mm),r=vm(e,8),i=vm(e,t-8).mul(n),s=vm(e,t-16).mul(gm);return km(wm(a.add(r),43).add(wm(i,30)).add(s),a.add(wm(r.add(gm),18)).add(i),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=gm.add(2*t),a=vm(e,0).mul(gm),r=vm(e,8),i=vm(e,t-8).mul(n),s=vm(e,t-16).mul(gm),o=wm(a.add(r),43).add(wm(i,30)).add(s),l=km(o,a.add(wm(r.add(gm),18)).add(i),n),u=vm(e,16).mul(n),c=vm(e,24),d=o.add(vm(e,t-32)).mul(n),h=l.add(vm(e,t-24)).mul(n);return km(wm(u.add(c),43).add(wm(d,30)).add(h),u.add(wm(c.add(a),18)).add(d),n)}(e,t);let a=n,r=n.mul(mm).add(113),i=ym(r.mul(gm).add(113)).mul(gm),s=[hm.UZERO,hm.UZERO],o=[hm.UZERO,hm.UZERO];a=a.mul(gm).add(vm(e,0));let l=0,u=64*(t-1>>6),c=u+(t-1&63)-63;do{a=wm(a.add(r).add(s[0]).add(vm(e,l+8)),37).mul(mm),r=wm(r.add(s[1]).add(vm(e,l+48)),42).mul(mm),a=a.xor(o[1]),r=r.add(s[0]).add(vm(e,l+40)),i=wm(i.add(o[0]),33).mul(mm),s=Sm(e,l,s[1].mul(mm),a.add(o[0])),o=Sm(e,l+32,i.add(o[1]),r.add(vm(e,l+16))),[i,a]=[a,i],l+=64}while(l!==u);let d=mm.add(i.and(255).shl(1));return l=c,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),a=wm(a.add(r).add(s[0]).add(vm(e,l+8)),37).mul(d),r=wm(r.add(s[1]).add(vm(e,l+48)),42).mul(d),a=a.xor(o[1].mul(9)),r=r.add(s[0].mul(9).add(vm(e,l+40))),i=wm(i.add(o[0]),33).mul(d),s=Sm(e,l,s[1].mul(d),a.add(o[0])),o=Sm(e,l+32,i.add(o[1]),r.add(vm(e,l+16))),[i,a]=[a,i],km(km(s[0],o[0],d).add(ym(r).mul(fm)).add(i),km(s[1],o[1],d).add(a),d)}function Nm(e,t){return"string"===t?_m(e):Tm([e],t)}function Tm(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Rm(e)),Td().getBool("DEBUG")&&td(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function Cm(){return Td().platform.now()}function Em(e,t){return Td().platform.fetch(e,t)}function _m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Td().platform.encode(e,t)}function Am(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Td().platform.decode(e,t)}function Fm(e){return null!=Td().platform.isTypedArray?Td().platform.isTypedArray(e):cm(e)}function Rm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||kd(e)||null==e||Fm(e)&&n)t.push(e);else if(Array.isArray(e)||Fm(e))for(let a=0;a<e.length;++a)Rm(e[a],t,n);else{let a=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(a=Math.max(a,Number(t)));for(let r=0;r<=a;r++)Rm(e[r],t,n)}return t}var Dm=class{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Om)}profileKernel(e,t,n){let a,r,i=()=>{a=n()},s=Cm();if(this.backendTimer.timerAvailable())r=this.backendTimer.time(i);else{i();for(let e of a)e.dataSync();r=Promise.resolve({kernelMs:Cm()-s})}if(Td().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<a.length;o++){let t=a[o];t.data().then(n=>{Mm(n,t.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:r.then(e=>e.kernelMs),extraInfo:r.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:a,inputs:r,extraInfo:i}=e;n.forEach(e=>{Promise.all([e.data(),a,i]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],r,n[2])})})}};function Mm(e,t,n){if("float32"!==t)return!1;for(let a=0;a<e.length;a++){let t=e[a];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}var Om=class{logKernelProfile(e,t,n,a,r,i){let s="number"==typeof a?Xc("".concat(a,"ms"),9):a.error,o=Xc(e,25),l=t.rank,u=t.size,c=Xc(t.shape.toString(),14),d="";for(let h in r){let e=r[h];if(null!=e){let n=e.shape||t.shape,a=n.length;d+="".concat(h,": ").concat(a,"D ").concat(a>0?n:""," ")}}console.log("%c".concat(o,"\t%c").concat(s,"\t%c").concat(l,"D ").concat(c,"\t%c").concat(u,"\t%c").concat(d,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function Pm(e,t,n,a){let r=hd(t),i=function(e,t,n,a){let r=Wc(t),i=a[a.length-1],s=new Array(i).fill(0),o=t.length,l="complex64"===n?Wm(e):e;if(o>1)for(let u=0;u<r/i;u++){let e=u*i;for(let t=0;t<i;t++)s[t]=Math.max(s[t],Lm(l[e+t],0,n).length)}return s}(e,t,n,r),s=t.length,o=Bm(e,t,n,r,i),l=["Tensor"];return a&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(s)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(o.map(e=>"    "+e).join("\n")),l.join("\n")}function Lm(e,t,n){let a;return a=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ").concat(parseFloat(e[1].toFixed(7)),"j"):sd(e)?"'".concat(e,"'"):"bool"===n?zm(e):parseFloat(e.toFixed(7)).toString(),Xc(a,t)}function zm(e){return 0===e?"false":"true"}function Bm(e,t,n,a,r){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s="complex64"===n?2:1,o=t[0],l=t.length;if(0===l){if("complex64"===n){return[Lm(Wm(e)[0],0,n)]}return"bool"===n?[zm(e[0])]:[e[0].toString()]}if(1===l){if(o>20){let t=3*s,a=Array.from(e.slice(0,t)),i=Array.from(e.slice((o-3)*s,o*s));return"complex64"===n&&(a=Wm(a),i=Wm(i)),["["+a.map((e,t)=>Lm(e,r[t],n)).join(", ")+", ..., "+i.map((e,t)=>Lm(e,r[o-3+t],n)).join(", ")+"]"]}return["["+("complex64"===n?Wm(e):Array.from(e)).map((e,t)=>Lm(e,r[t],n)).join(", ")+"]"]}let u=t.slice(1),c=a.slice(1),d=a[0]*s,h=[];if(o>20){for(let t=0;t<3;t++){let a=t*d,i=a+d;h.push(...Bm(e.slice(a,i),u,n,c,r,!1))}h.push("...");for(let t=o-3;t<o;t++){let a=t*d,i=a+d;h.push(...Bm(e.slice(a,i),u,n,c,r,t===o-1))}}else for(let m=0;m<o;m++){let t=m*d,a=t+d;h.push(...Bm(e.slice(t,a),u,n,c,r,m===o-1))}let p=2===l?",":"";h[0]="["+(o>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=",\n";for(let m=2;m<l;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":f),h}function Wm(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Vm=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Wc(e),null!=n){let e=n.length;Lc(e===this.size,()=>"Length of values '".concat(e,"' does not match the size inferred by the shape '").concat(this.size,"'."))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||ed(t,this.size),this.strides=hd(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];0===n.length&&(n=[0]),Lc(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must match the rank (").concat(this.rank,")"));let r=this.locToIndex(n);this.values[r]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let a=0;for(let i of t){if(i<0||i>=this.shape[a]){let e="Requested out of range element at ".concat(t,".   Buffer shape=").concat(this.shape);throw new Error(e)}a++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Um().makeTensor(this.values,this.shape,this.dtype)}},Um=null,jm=null;var Gm=class{constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Wc(e),this.strides=hd(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return jm.buffer(this.shape,this.dtype,e)}bufferSync(){return jm.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return fd(this.shape,e,"complex64"===this.dtype)}arraySync(){return fd(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=Um().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map(e=>Am(e))}catch(ree){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Um().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=Um().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>Am(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await Um().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Um().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return jm.print(this,e)}clone(){return this.throwIfDisposed(),jm.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Pm(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),jm.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Um().makeVariable(this,e,t,n)}};function Hm(){return Ad("Tensor",()=>Gm)}Object.defineProperty(Gm,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),Hm();var qm=class extends Gm{constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and previous value (").concat(this.dtype,") must match"));if(!jc(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and previous value (").concat(this.shape,") must match"));Um().disposeTensor(this),this.dataId=e.dataId,Um().incRef(this,null)}dispose(){Um().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(qm,Symbol.hasInstance,{value:e=>e instanceof Gm&&null!=e.assign&&e.assign instanceof Function});var Km,Xm,Ym,Qm,Jm,Zm,$m={};ac($m,{assertTypesMatch:()=>sg,getTensorsInContainer:()=>lg,isTensorInList:()=>og,makeTypesMatch:()=>ig}),(Xm=Km||(Km={})).R0="R0",Xm.R1="R1",Xm.R2="R2",Xm.R3="R3",Xm.R4="R4",Xm.R5="R5",Xm.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Ym||(Ym={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Qm||(Qm={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Jm||(Jm={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Zm||(Zm={}));var eg={float32:Jm,int32:Ym,bool:Qm,complex64:Zm};function tg(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return eg[e][t]}function ng(e){return tg(e,"int32")}function ag(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function rg(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function ig(e,t){if(e.dtype===t.dtype)return[e,t];let n=tg(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function sg(e,t){Lc(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and second(").concat(t.dtype,") input must match"))}function og(e,t){return t.some(t=>t.id===e.id)}function lg(e){let t=[];return ug(e,t,new Set),t}function ug(e,t,n){if(null==e)return;if(e instanceof Gm)return void t.push(e);if(!function(e){return Array.isArray(e)||"object"==typeof e}(e))return;let a=e;for(let r in a){let e=a[r];n.has(e)||(n.add(e),ug(e,t,n))}}function cg(e){return null!=e.kernelName}var dg=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},hg=class e{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new dg}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(Qf("".concat(e," backend was already registered. Reusing existing backend factory.")),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Dm(this.backendInstance),!0}setupRegisteredKernels(){nm(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){nm(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{let n=t.factory();if(!n||n instanceof Cc||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let t=++this.pendingBackendInitId,a=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,Qf("Initialization of backend ".concat(e," failed")),Qf(n.stack||n.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}}catch(n){return Qf("Initialization of backend ".concat(e," failed")),Qf(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:a,asyncInit:r}=this.initializeBackend(n);if(r||a)return{name:n,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),a=n.backend,r=this.readSync(t),i=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,r,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(()=>this.startScope(a),()=>this.endScope(n),()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch(i9){throw t(),i9}}nextTensorId(){return e.nextTensorId++}nextVariableId(){return e.nextVariableId++}clone(e){let t=fg.runKernel(Kh,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{let t={x:e},n={dtype:"float32"};return fg.runKernel(th,t,n)}}),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==em(e,this.backendName))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let a=this.backend.numDataIds(),r=0;n.forEach(e=>{r+="complex64"===e.dtype?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-t-r-i;if(s>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak (").concat(s," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n,a=[],r=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let o,l=cg(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(cg(e)){let{kernelName:t,inputs:i,attrs:s}=e;null==this.backendName&&this.backend;let l=em(t,this.backendName);Lc(null!=l,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),n=()=>{let e=this.backend.numDataIds();o=l.kernelFunc({inputs:i,attrs:s,backend:this.backend});let n=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,n);let u=n.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(r){let e=this.getTensorsForGradient(t,i,u);a=this.saveTensorsForBackwardMode(e)}return u}}else{let{forwardFunc:t}=e,i=e=>{r&&(a=e.map(e=>this.keep(this.clone(e))))};n=()=>{let e=this.backend.numDataIds();o=this.tidy(()=>t(this.backend,i));let n=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}let u,{inputs:c,attrs:d}=e,h=cg(e)?null:e.backwardsFunc;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(u=this.profiler.profileKernel(l,c,()=>n()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(u),t=u.outputs):t=n()}),r&&this.addTapeNode(l,c,t,h,a,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(e=>null!=c[e]?c[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:u.timeMs,extraInfo:u.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){let a=tm(e);if(null!=a){let e,r=a.inputsToSave||[],i=a.outputsToSave||[];a.saveAllInputs?(Lc(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),e=Object.keys(t).map(e=>t[e])):e=r.map(e=>t[e]);let s=n.filter((e,t)=>i[t]);return e.concat(s)}return[]}makeTensor(e,t,n,a){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let r=e;"string"===n&&sd(e[0])&&(r=e.map(e=>_m(e)));let i=a.write(r,t,n),s=new Gm(t,n,i,this.nextTensorId());if(this.trackTensor(s,a),"string"===n){let e=this.state.tensorInfo.get(i),t=id(r);this.state.numBytes+=t-e.bytes,e.bytes=t}return s}makeTensorFromDataId(e,t,n,a){let r={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(r,a)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:a,dtype:r}=e,i=new Gm(a,r,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=a&&a!==e.dtype&&(e=e.cast(a));let r=new qm(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw new Error("Variable with name ".concat(r.name," was already registered"));return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*rd(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof qm||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let t=e.size*rd(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,a,r,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:r},o=tm(e);null!=o&&(a=o.gradFunc),null!=a&&(s.gradient=e=>(e=e.map((e,t)=>{if(null==e){let e=n[t],a=yd(e.size,e.dtype);return this.makeTensor(a,e.shape,e.dtype)}return e}),a(e.length>1?e:e[0],r,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=lg(e),n=new Set(t.map(e=>e.id));for(let r=0;r<this.state.activeScope.track.length;r++){let e=this.state.activeScope.track[r];!e.kept&&!n.has(e.id)&&e.dispose()}let a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{!e.kept&&e.scopeId===a.id&&this.track(e)})}gradients(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Lc(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));let r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Lc(r instanceof Gm,()=>"The result y returned by f() must be a tensor.");let i=function(e,t,n){let a={},r={};for(let l=0;l<t.length;l++)a[t[l].id]=!0;for(let l=0;l<e.length;l++){let n=e[l],i=n.inputs;for(let e in i){let s=i[e],o=!1;for(let e=0;e<t.length;e++)if(a[s.id]){n.outputs.forEach(e=>a[e.id]=!0),o=!0,r[n.id]=!0;break}if(o)break}}let i={};i[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(i[t.outputs[e].id]){for(let e in n)i[n[e].id]=!0,s[t.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let t=e[l];if(r[t.id]&&s[t.id]){let e={};for(let r in t.inputs){let n=t.inputs[r];a[n.id]&&(e[r]=n)}let n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,o.push(n)}}return o}(this.state.activeTape,t,r);if(!a&&0===i.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let e={};e[r.id]=null==n?function(e){let t=gd(Wc(e),"float32");return fg.makeTensor(t,e,"float32")}(r.shape):n,function(e,t,n,a){for(let r=t.length-1;r>=0;r--){let i=t[r],s=[];if(i.outputs.forEach(t=>{let n=e[t.id];null!=n?s.push(n):s.push(null)}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for ".concat(i.kernelName,"."));let o=i.gradient(s);for(let t in i.inputs){if(!(t in o))throw new Error("Cannot backprop through input ".concat(t,". Available gradients found: ").concat(Object.keys(o),"."));let r=n(()=>o[t]());if("float32"!==r.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ").concat(t," must have 'float32' dtype, but has '").concat(r.dtype,"'"));let s=i.inputs[t];if(!jc(r.shape,s.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input '").concat(t,"' has shape '").concat(r.shape,"', which does not match the shape of the input '").concat(s.shape,"'"));if(null==e[s.id])e[s.id]=r;else{let t=e[s.id];e[s.id]=a(t,r),t.dispose()}}}}(e,i,e=>this.tidy(e),mg);let a=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:r,grads:a}})}customGrad(e){var t=this;return Lc(cd(e),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];Lc(a.every(e=>e instanceof Gm),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let i,s={};a.forEach((e,t)=>{s[t]=e});return t.runKernelFunc({forwardFunc:(t,n)=>(i=e(...a,n),Lc(i.value instanceof Gm,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Lc(cd(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),backwardsFunc:(e,t)=>{let n=i.gradFunc(e,t),r=Array.isArray(n)?n:[n];Lc(r.length===a.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Lc(r.every(e=>e instanceof Gm),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let s={};return r.forEach((e,t)=>{s[t]=()=>e}),s},inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=Cm(),n=await this.backend.time(e);return n.wallMs=Cm()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new dg;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};function pg(){let e=_d();if(null==e._tfengine){let t=new Id(e);e._tfengine=new hg(t)}return function(e){Ed=e}(e._tfengine.ENV),function(e){Um=e}(()=>e._tfengine),e._tfengine}hg.nextTensorId=0,hg.nextVariableId=0;var fg=pg();function mg(e,t){let n={a:e,b:t};return fg.runKernel(Md,n)}var gg,yg={};function bg(e){gg=e}function vg(e){if(void 0!==gg)return gg;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function xg(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}ac(yg,{isBrowser:()=>xg,isMobile:()=>vg,mockIsMobile:()=>bg});var wg=Td();function kg(e,t){let n=e;if(Fm(e))return"string"===t?[]:[e.length];if(ag(e)){let t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(rg(e))return[e.buffer.size/(null==t?4:rd(t))];if(!Array.isArray(e))return[];let a=[];for(;Array.isArray(n)||Fm(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&Td().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Sg(e,a,[]),a}function Sg(e,t,n){if(n=n||[],!Array.isArray(e)&&!Fm(e))return void Lc(0===t.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, but should be an array/TypedArray of ").concat(t[0]," elements"));Lc(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, but is an array of ").concat(e.length," elements")),Lc(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," elements, but has ").concat(e.length," elements"));let a=t.slice(1);for(let r=0;r<e.length;++r)Sg(e[r],a,n.concat(r))}function Ig(e,t,n,a){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(a,"' must be ").concat(e," tensor, but got ").concat(t," tensor"))}}function Ng(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Hm())return Ig(a,e.dtype,t,n),e;let r=ud(e);if("string"!==r&&["bool","int32","float32"].indexOf(a)>=0&&(r=a),Ig(a,r,t,n),null==e||!Fm(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let a=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a Tensor or TensorLike, but got '").concat(a,"'"))}let i=kg(e,r);!Fm(e)&&!Array.isArray(e)&&(e=[e]);let s="string"!==r?Tm(e,r):Rm(e,[],!0);return fg.makeTensor(s,i,r)}function Tg(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a `Tensor[]` or `TensorLike[]`"));return e.map((e,r)=>Ng(e,"".concat(t,"[").concat(r,"]"),n,a))}wg.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),wg.registerFlag("IS_BROWSER",()=>xg()),wg.registerFlag("IS_NODE",()=>"undefined"!=typeof process&&"undefined"!=typeof process.versions&&"undefined"!=typeof process.versions.node),wg.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),wg.registerFlag("IS_SAFARI",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),wg.registerFlag("PROD",()=>!1),wg.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>wg.getBool("DEBUG")),wg.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),wg.registerFlag("IS_TEST",()=>!1),wg.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>wg.getBool("DEBUG")),wg.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),wg.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),wg.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var Cg="__op";function Eg(e){let t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with ".concat(t.length," keys."));let n=t[0],a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Cg;let r=function(){fg.startScope(n);try{let e=a(...arguments);return kd(e)&&console.error("Cannot return a Promise inside of tidy."),fg.endScope(e),e}catch(e){throw fg.endScope(null),e}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}var _g=Eg({complex_:function(e,t){let n=Ng(e,"real","complex"),a=Ng(t,"imag","complex");zc(n.shape,a.shape,"real and imag shapes, ".concat(n.shape," and ").concat(a.shape,", must match in call to tf.complex()."));let r={real:n,imag:a};return fg.runKernel(rh,r)}});function Ag(e,t,n,a){if(null==a)a=ud(e);else if("complex64"===a)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(rg(e)||ag(e)){if("float32"!==a&&"int32"!==a)throw new Error("Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ".concat(a,"."));return fg.backend.createTensorFromGPUData(e,t||n,a)}if(!Fm(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){vd(t);let e=Wc(t),a=Wc(n);Lc(e===a,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ").concat(e," values but has ").concat(a));for(let r=0;r<n.length;++r){let e=n[r],a=r!==n.length-1||e!==Wc(t.slice(r));Lc(n[r]===t[r]||!a,()=>"Error creating a new Tensor. Inferred shape (".concat(n,") does not match the provided shape (").concat(t,"). "))}}return!Fm(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e="string"!==a?Tm(e,a):Rm(e,[],!0),fg.makeTensor(e,t,a)}function Fg(e,t,n){return Ag(e,t,kg(e,n),n)}var Rg={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Dg=class e{static join(t){return new e(t).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e||(e instanceof Array||(e=[e]),0===(e=e.map(e=>Fm(e)?e.buffer:e)).length))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let r=t+a.byteLength;this.shards.push({buffer:a,start:t,end:r}),t=r}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);let n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));let a=new ArrayBuffer(t-e),r=new Uint8Array(a),i=0;for(let s=n;s<this.shards.length;s++){let n=this.shards[s],a=e+i-n.start,o=i,l=Math.min(t,n.end)-n.start,u=new Uint8Array(n.buffer,a,l-a);if(r.set(u,o),i+=u.length,t<n.end)break}return a}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;let n=function(e,t){let n=0,a=e.length;for(;n<=a;){let r=Math.floor((a-n)/2)+n,i=t(e[r]);if(0===i)return r;i<0?a=r:n=r+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function Mg(){Td().set("PROD",!0)}function Og(){Td().set("DEBUG",!0)}function Pg(){Td().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Lg(e){Td().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function zg(){fg.disposeVariables()}function Bg(){return fg}function Wg(){return fg.memory()}function Vg(e){return fg.profile(e)}function Ug(e,t){return fg.tidy(e,t)}function jg(e){lg(e).forEach(e=>e.dispose())}function Gg(e){return fg.keep(e)}function Hg(e){return fg.time(e)}function qg(e){return fg.setBackend(e)}function Kg(){return fg.ready()}function Xg(){return fg.backendName}function Yg(e){fg.removeBackend(e)}function Qg(e){return fg.findBackend(e)}function Jg(e){return fg.findBackendFactory(e)}function Zg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return fg.registerBackend(e,t,n)}function $g(){return fg.backend}function ey(e,t){Td().setPlatform(e,t)}!function(e){0}(Lg);async function ty(e,t){let n=[],a=[],r=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let i=0;i<r.length;++i){let s=r[i],o=Array.isArray(e)?e[i].tensor:e[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(o.dtype));let l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){let e=new Promise(async e=>{let t=await o.bytes(),n=t.reduce((e,t)=>e+t.length,0)+4*t.length,a=new Uint8Array(n),r=0;for(let i=0;i<t.length;i++){let e=t[i],n=new Uint8Array(new Uint32Array([e.length]).buffer);a.set(n,r),r+=4,a.set(e,r),r+=e.length}e(a)});a.push(e)}else a.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:ly(await Promise.all(a)),specs:n}}function ny(e,t){let n=new Dg(e),a={},r=0;for(let i of t){let e=ay(i,(e,t)=>n.slice(r+e,r+t));a[i.name]=iy(i,n.slice(r,r+e)),r+=e}return a}function ay(e,t){let n,a=Wc(e.shape);if("quantization"in e){let t=e.quantization;n=Rg[t.dtype]}else{if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(t(e,e+4))[0];return e}n=Rg[e.dtype]}return a*n}async function ry(e,t){let n,a=Wc(e.shape);if("quantization"in e){let t=e.quantization;n=Rg[t.dtype]}else{if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(await t(e,e+4))[0];return e}n=Rg[e.dtype]}return a*n}function iy(e,t){let n,a=e.name,r=e.dtype,i=e.shape,s=Wc(i),o=0;if("quantization"in e){let i=e.quantization;if("uint8"===i.dtype||"uint16"===i.dtype){if(!("min"in i)||!("scale"in i))throw new Error("Weight ".concat(e.name," with quantization ").concat(i.dtype," doesn't have corresponding metadata min and scale."))}else{if("float16"!==i.dtype)throw new Error("Weight ".concat(e.name," has unknown quantization dtype ").concat(i.dtype,". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'."));if("float32"!==r)throw new Error("Weight ".concat(e.name," is quantized with ").concat(i.dtype," which only supports weights of type float32 not ").concat(r,"."))}let l=Rg[i.dtype],u="uint8"===i.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===i.dtype||"uint16"===i.dtype){n=new Float32Array(u.length);for(let e=0;e<u.length;e++){let t=u[e];n[e]=t*i.scale+i.min}}else{if("float16"!==i.dtype)throw new Error("Unsupported quantization type ".concat(i.dtype," for weight type float32."));n=function(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;!(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return a=>{let r=new ArrayBuffer(4*a.length),i=new Uint32Array(r);for(let s=0;s<a.length;s++){let r=a[s],o=e[n[r>>10]+(1023&r)]+t[r>>10];i[s]=o}return new Float32Array(r)}}()(u)}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(a,"': ").concat(r));if("uint8"!==i.dtype&&"uint16"!==i.dtype)throw new Error("Unsupported quantization type ".concat(i.dtype," for weight type int32."));n=new Int32Array(u.length);for(let e=0;e<u.length;e++){let t=u[e];n[e]=Math.round(t*i.scale+i.min)}}o+=s*l}else if("string"===r){let a=Wc(e.shape);n=[];for(let e=0;e<a;e++){let e=new Uint32Array(t.slice(o,o+4))[0];o+=4;let a=new Uint8Array(t.slice(o,o+e));n.push(a),o+=e}}else{let e=Rg[r];if("float32"===r)n=new Float32Array(t);else if("int32"===r)n=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){n=new Float32Array(t);let e=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=n[2*t],a[t]=n[2*t+1];let r=Fg(e,i,"float32"),s=Fg(a,i,"float32"),o=_g(r,s);return r.dispose(),s.dispose(),o}throw new Error("Unsupported dtype in weight '".concat(a,"': ").concat(r))}n=new Uint8Array(t)}o+=s*e}return Fg(n,i,r)}async function sy(e,t,n){let a=new Uint8Array(t);for(;a.byteLength<n;){let{done:t,value:r}=await e.read();if(t&&null==r){let e=n-a.byteLength;throw new Error("Reader is done but ".concat(e," bytes are still expected"))}let i=new Uint8Array(a.length+r.byteLength);i.set(a,0),i.set(new Uint8Array(r),a.length),a=i}return a.buffer}async function oy(e,t){let n={},a=e.getReader(),r=new ArrayBuffer(0);for(let i of t){let e=await ry(i,async(e,t)=>(r=await sy(a,r,t),r.slice(e,t)));r=await sy(a,r,e);let t=r.slice(0,e);r=r.slice(e);let s=iy(i,t);if(n[i.name]=s,"webgpu"===Xg()){let e=$g();"uploadToGPU"in e&&Wc(s.shape)>=Td().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(s.dataId)}}return n}function ly(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});let a=new Uint8Array(t),r=0;return n.forEach(e=>{a.set(new Uint8Array(e.buffer),r),r+=e.byteLength}),a.buffer}var uy="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function cy(e){return uy?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function dy(e){return Dg.join(e)}function hy(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function py(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function fy(e,t,n){let a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(a.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");a.weightSpecs=t,a.weightData=n}return null!=e.signature&&(a.signature=e.signature),null!=e.userDefinedMetadata&&(a.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(a.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(a.initializerSignature=e.initializerSignature),a}async function my(e,t){let n,a;return null!=e.weightsManifest&&([n,a]=await t(e.weightsManifest)),fy(e,n,a)}function gy(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:cy(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:cy(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new Dg(e.weightData).byteLength}}function yy(e){let t=[];for(let n of e)t.push(...n.weights);return t}var by=class e{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==e.instance&&(e.instance=new e),e.instance}static registerSaveRouter(t){e.getInstance().saveRouters.push(t)}static registerLoadRouter(t){e.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return e.getHandlers(t,"save")}static getLoadHandlers(t,n){return e.getHandlers(t,"load",n)}static getHandlers(t,n,a){let r=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(e=>{let n=e(t,a);null!==n&&r.push(n)}),r}},vy=e=>by.registerSaveRouter(e),xy=e=>by.registerLoadRouter(e),wy=e=>by.getSaveHandlers(e),ky=(e,t)=>by.getLoadHandlers(e,t),Sy="tensorflowjs",Iy="models_store",Ny="model_info_store";function Ty(){if(!Td().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Cy(e){let t=e.result;t.createObjectStore(Iy,{keyPath:"modelPath"}),t.createObjectStore(Ny,{keyPath:"modelPath"})}var Ey=class{constructor(e){if(this.indexedDB=Ty(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let a=this.indexedDB.open(Sy,1);a.onupgradeneeded=()=>Cy(a),a.onsuccess=()=>{let r=a.result;if(null==t){let t=r.transaction(Iy,"readonly"),a=t.objectStore(Iy).get(this.modelPath);a.onsuccess=()=>{if(null==a.result)return r.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' in IndexedDB.")));e(a.result.modelArtifacts)},a.onerror=e=>(r.close(),n(a.error)),t.oncomplete=()=>r.close()}else{t.weightData=Dg.join(t.weightData);let a,s,o=gy(t),l=r.transaction(Ny,"readwrite"),u=l.objectStore(Ny);try{a=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(i){return n(i)}a.onsuccess=()=>{s=r.transaction(Iy,"readwrite");let a,i=s.objectStore(Iy);try{a=i.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(c){return n(c)}a.onsuccess=()=>e({modelArtifactsInfo:o}),a.onerror=e=>{u=l.objectStore(Ny);let t=u.delete(this.modelPath);t.onsuccess=()=>(r.close(),n(a.error)),t.onerror=e=>(r.close(),n(a.error))}},a.onerror=e=>(r.close(),n(a.error)),l.oncomplete=()=>{null==s?r.close():s.oncomplete=()=>r.close()}}},a.onerror=e=>n(a.error)})}};Ey.URL_SCHEME="indexeddb://";var _y=e=>Td().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ey.URL_SCHEME)?function(e){return new Ey(e)}(e.slice(Ey.URL_SCHEME.length)):null;by.registerSaveRouter(_y),by.registerLoadRouter(_y);var Ay="/",Fy="tensorflowjs_models",Ry="info",Dy="model_topology",My="weight_specs",Oy="weight_data",Py="model_metadata";function Ly(e){return{info:[Fy,e,Ry].join(Ay),topology:[Fy,e,Dy].join(Ay),weightSpecs:[Fy,e,My].join(Ay),weightData:[Fy,e,Oy].join(Ay),modelMetadata:[Fy,e,Py].join(Ay)}}function zy(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function By(e){let t=e.split(Ay);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Ay)}var Wy=class{constructor(e){if(!Td().getBool("IS_BROWSER")||"undefined"==typeof window||"undefined"==typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Ly(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let n=JSON.stringify(e.modelTopology),a=JSON.stringify(e.weightSpecs),r=gy(e),i=Dg.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,function(e){if(uy)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let a=0,r=t.length;a<r;a++)n+=String.fromCharCode(t[a]);return btoa(n)}(i));let t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:r}}catch(t){throw zy(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=").concat(r.modelTopologyBytes,", weightSpecsBytes=").concat(r.weightSpecsBytes,", weightDataBytes=").concat(r.weightDataBytes,"."))}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' is missing."));t.modelTopology=n;let a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==a)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' are missing."));t.weightSpecs=a;let r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){let e=JSON.parse(r);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error("In local storage, the binary weight values of model '".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(uy){let t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let a=0;a<t.length;++a)n.set([t.charCodeAt(a)],a);return n.buffer}(i),t}};Wy.URL_SCHEME="localstorage://";var Vy=e=>Td().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Wy.URL_SCHEME)?function(e){return new Wy(e)}(e.slice(Wy.URL_SCHEME.length)):null;by.registerSaveRouter(Vy),by.registerLoadRouter(Vy);var Uy="://",jy=class e{constructor(){this.managers={}}static getInstance(){return null==e.instance&&(e.instance=new e),e.instance}static registerManager(t,n){Lc(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(Uy)&&(t=t.slice(0,t.indexOf(Uy))),Lc(t.length>0,()=>"scheme must not be an empty string.");let a=e.getInstance();Lc(null==a.managers[t],()=>"A model store manager is already registered for scheme '".concat(t,"'.")),a.managers[t]=n}static getManager(t){let n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}static getSchemes(){return Object.keys(e.getInstance().managers)}};function Gy(e){if(-1===e.indexOf(Uy))throw new Error("The url string provided does not contain a scheme. Supported schemes are: ".concat(jy.getSchemes().join(",")));return{scheme:e.split(Uy)[0],path:e.split(Uy)[1]}}async function Hy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Lc(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));let a=by.getLoadHandlers(e);Lc(a.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),Lc(a.length<2,()=>"Copying failed because more than one (".concat(a.length,") load handlers for source URL ").concat(e,"."));let r=a[0],i=by.getSaveHandlers(t);Lc(i.length>0,()=>"Copying failed because no save handler is found for destination URL ".concat(t,".")),Lc(i.length<2,()=>"Copying failed because more than one (".concat(a.length,") save handlers for destination URL ").concat(t,"."));let s=i[0],o=Gy(e).scheme,l=Gy(e).path,u=o===Gy(e).scheme,c=await r.load();n&&u&&await jy.getManager(o).removeModel(l);let d=await s.save(c);return n&&!u&&await jy.getManager(o).removeModel(l),d.modelArtifactsInfo}async function qy(){let e=jy.getSchemes(),t={};for(let n of e){let e=await jy.getManager(n).listModels();for(let a in e){t[n+Uy+a]=e[a]}}return t}async function Ky(e){let t=Gy(e);return jy.getManager(t.scheme).removeModel(t.path)}async function Xy(e,t){return Hy(e,t,!1)}async function Yy(e,t){return Hy(e,t,!0)}if(Td().get("IS_BROWSER")){Td().setPlatform("browser",new class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!=typeof window&&Td().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))):setTimeout(e,t)}isTypedArray(e){return cm(e)}});try{jy.registerManager(Wy.URL_SCHEME,new class{constructor(){Lc(Td().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Lc("undefined"==typeof window||"undefined"!=typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=Fy+Ay,n=Ay+Ry;for(let a=0;a<this.LS.length;++a){let r=this.LS.key(a);r.startsWith(t)&&r.endsWith(n)&&(e[By(r)]=JSON.parse(this.LS.getItem(r)))}return e}async removeModel(e){let t=Ly(e=function(e){return e.startsWith(Wy.URL_SCHEME)?e.slice(Wy.URL_SCHEME.length):e}(e));if(null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '".concat(e,"'"));let n=JSON.parse(this.LS.getItem(t.info));return zy(t),n}})}catch(Xm){}try{jy.registerManager(Ey.URL_SCHEME,new class{constructor(){this.indexedDB=Ty()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(Sy,1);n.onupgradeneeded=()=>Cy(n),n.onsuccess=()=>{let a=n.result,r=a.transaction(Ny,"readonly"),i=r.objectStore(Ny).getAll();i.onsuccess=()=>{let t={};for(let e of i.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},i.onerror=e=>(a.close(),t(i.error)),r.oncomplete=()=>a.close()},n.onerror=e=>t(n.error)})}async removeModel(e){return e=function(e){return e.startsWith(Ey.URL_SCHEME)?e.slice(Ey.URL_SCHEME.length):e}(e),new Promise((t,n)=>{let a=this.indexedDB.open(Sy,1);a.onupgradeneeded=()=>Cy(a),a.onsuccess=()=>{let r,i=a.result,s=i.transaction(Ny,"readwrite"),o=s.objectStore(Ny),l=o.get(e);l.onsuccess=()=>{if(null==l.result)return i.close(),n(new Error("Cannot find model with path '".concat(e,"' in IndexedDB.")));{let a=o.delete(e),s=()=>{r=i.transaction(Iy,"readwrite");let a=r.objectStore(Iy).delete(e);a.onsuccess=()=>t(l.result.modelArtifactsInfo),a.onerror=e=>n(l.error)};a.onsuccess=s,a.onerror=e=>(s(),i.close(),n(l.error))}},l.onerror=e=>(i.close(),n(l.error)),s.oncomplete=()=>{null==r?i.close():r.oncomplete=()=>i.close()}},a.onerror=e=>n(a.error)})}})}catch(Xm){}}var Qy,Jy=()=>sc();function Zy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",vd(e),new Vm(e,t,n)}Td().get("IS_NODE")&&!Td().get("IS_BROWSER")&&Td().setPlatform("node",new class{constructor(){this.util=oc(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=Td().global.fetch?Td().global.fetch(e,t):(null==Qy&&(Qy=Jy()),Qy(e,t))}now(){let e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}});var $y=Eg({cast_:function(e,t){let n=Ng(e,"x","cast");if(!nd(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");let a={x:n},r={dtype:t};return fg.runKernel(th,a,r)}});var eb=Eg({clone_:function(e){let t={x:Ng(e,"x","clone","string_or_numeric")};return fg.runKernel(Kh,t)}});function tb(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}pg(),function(e){jm=e}({buffer:Zy,cast:$y,clone:eb,print:tb});var nb=Eg({add_:function(e,t){let n=Ng(e,"a","add"),a=Ng(t,"b","add");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Md,r)}});var ab=Eg({floorDiv_:function(e,t){let n=Ng(e,"a","floorDiv"),a=Ng(t,"b","floorDiv");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Vh,r)}});var rb=Eg({div_:function(e,t){let n=Ng(e,"a","div"),a=Ng(t,"b","div");if([n,a]=ig(n,a),"int32"===n.dtype&&"int32"===a.dtype)return ab(n,a);let r={a:n,b:a};return fg.runKernel(Eh,r,{})}});var ib=Eg({mul_:function(e,t){let n=Ng(e,"a","mul"),a=Ng(t,"b","mul");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Cp,r)}});var sb=Eg({abs_:function(e){let t=Ng(e,"x","abs");if("complex64"===t.dtype){let e={x:t};return fg.runKernel(ih,e)}{let e={x:t};return fg.runKernel(Fd,e)}}});var ob=Eg({acos_:function(e){let t={x:Ng(e,"x","acos")};return fg.runKernel(Rd,t)}});var lb=Eg({acosh_:function(e){let t={x:Ng(e,"x","acosh")};return fg.runKernel(Dd,t)}});var ub=Eg({addN_:function(e){Lc(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),Lc(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got ".concat(e.length));let t=e.map((e,t)=>Ng(e,"tensors".concat(t),"addN")),n=t[0];t.forEach(e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!jc(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let a=t;return fg.runKernel(Od,a)}});var cb=Eg({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Ng(e,"x","all","bool")},r={axis:t,keepDims:n};return fg.runKernel(Pd,a,r)}});var db=Eg({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Ng(e,"x","any","bool")},r={axis:t,keepDims:n};return fg.runKernel(Ld,a,r)}});var hb=Eg({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ng(e,"x","argMax")},a={axis:t};return fg.runKernel(zd,n,a)}});var pb=Eg({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ng(e,"x","argMin")},a={axis:t};return fg.runKernel(Bd,n,a)}});var fb=Eg({asin_:function(e){let t={x:Ng(e,"x","asin")};return fg.runKernel(Wd,t)}});var mb=Eg({asinh_:function(e){let t={x:Ng(e,"x","asinh")};return fg.runKernel(Vd,t)}});var gb=Eg({atan_:function(e){let t={x:Ng(e,"x","atan")};return fg.runKernel(Ud,t)}});var yb=Eg({atan2_:function(e,t){let n=Ng(e,"a","atan2"),a=Ng(t,"b","atan2");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Gd,r)}});var bb=Eg({atanh_:function(e){let t={x:Ng(e,"x","atanh")};return fg.runKernel(jd,t)}});function vb(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0;return kb(e,[...t,e[3]],n,i,a,null,null,Rb(r))}function xb(e,t,n,a,r,i){let s,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",[l,u]=Nb(t);if("channelsLast"===o)s=[l,u,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));s=[l,u,e[1],e[1]]}return kb(e,s,n,a,r,i,!1,o)}function wb(e,t,n,a,r,i){let s,o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",[u,c,d]=Tb(t);if("NDHWC"===l)o="channelsLast",s=[u,c,d,e[4],e[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));o="channelsFirst",s=[u,c,d,e[1],e[1]]}return Sb(e,s,n,a,r,!1,o,i)}function kb(e,t,n,a,r,i){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,u,c,d]=[-1,-1,-1,-1];if("channelsLast"===o)[l,u,c,d]=e;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[l,d,u,c]=e}let h,[p,f,,m]=t,[g,y]=Nb(n),[b,v]=Nb(a),x=Cb(p,b),w=Cb(f,v),{padInfo:k,outHeight:S,outWidth:I}=function(e,t,n,a,r,i,s,o,l){let u,c,d;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};let r=function(e,t,n,a,r){null==a&&(a=Ib(e,t,n));let i=e[0],s=e[1],o=Eb((i-t+2*a)/n+1,r),l=Eb((s-t+2*a)/n+1,r);return[o,l]}([t,n],i,a,e,o);c=r[0],d=r[1]}else if("same"===e){c=Math.ceil(t/a),d=Math.ceil(n/r);let e=Math.max(0,(c-1)*a+i-t),o=Math.max(0,(d-1)*r+s-n),l=Math.floor(e/2),h=e-l,p=Math.floor(o/2);u={top:l,bottom:h,left:p,right:o-p,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/a),d=Math.ceil((n-s+1)/r);else{if("object"!=typeof e)throw Error("Unknown padding parameter: ".concat(e));{let h="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];u={top:h,bottom:p,left:f,right:m,type:0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},c=Eb((t-i+h+p)/a+1,o),d=Eb((n-s+f+m)/r+1,o)}}return{padInfo:u,outHeight:c,outWidth:d}}(r,u,c,g,y,x,w,i,o),N=s?m*d:m;return"channelsFirst"===o?h=[l,N,S,I]:"channelsLast"===o&&(h=[l,S,I,N]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:d,outHeight:S,outWidth:I,outChannels:N,padInfo:k,strideHeight:g,strideWidth:y,filterHeight:p,filterWidth:f,effectiveFilterHeight:x,effectiveFilterWidth:w,dilationHeight:b,dilationWidth:v,inShape:e,outShape:h,filterShape:t}}function Sb(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",o=arguments.length>7?arguments[7]:void 0,[l,u,c,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[l,u,c,d,h]=e;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[l,h,u,c,d]=e}let p,[f,m,g,,y]=t,[b,v,x]=Tb(n),[w,k,S]=Tb(a),I=Cb(f,w),N=Cb(m,k),T=Cb(g,S),{padInfo:C,outDepth:E,outHeight:_,outWidth:A}=function(e,t,n,a,r,i,s,o,l,u,c){let d,h,p,f;if("valid"===e&&(e=0),"number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};let m=function(e,t,n,a,r,i){null==r&&(r=Ib(e,t[0],a[0]));let s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*r>=t[o]&&(s[o]=Eb((e[o]-t[o]+2*r)/a[o]+1,i));return s}([t,n,a,1],[o,l,u],1,[r,i,s],e,c);h=m[0],p=m[1],f=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{h=Math.ceil(t/r),p=Math.ceil(n/i),f=Math.ceil(a/s);let e=(h-1)*r+o-t,c=(p-1)*i+l-n,m=(f-1)*s+u-a,g=Math.floor(e/2),y=e-g,b=Math.floor(c/2),v=c-b,x=Math.floor(m/2);d={top:b,bottom:v,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(r,u,c,d,b,v,x,I,N,T,o),F=i?y*h:y;return"channelsFirst"===s?p=[l,F,E,_,A]:"channelsLast"===s&&(p=[l,E,_,A,F]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:E,outHeight:_,outWidth:A,outChannels:F,padInfo:C,strideDepth:b,strideHeight:v,strideWidth:x,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:N,effectiveFilterWidth:T,dilationDepth:w,dilationHeight:k,dilationWidth:S,inShape:e,outShape:p,filterShape:t}}function Ib(e,t,n){let a=Cb(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+a)/2)}function Nb(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Tb(e){return"number"==typeof e?[e,e,e]:e}function Cb(e,t){return t<=1?e:e+(e-1)*(t-1)}function Eb(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function _b(e){let[t,n,a]=Nb(e);return 1===t&&1===n&&1===a}function Ab(e,t){return _b(e)||_b(t)}function Fb(e){return Nb(e).every(e=>e>0)}function Rb(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function Db(e,t,n){if(null!=n){if("string"==typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));if("number"==typeof t)Lc(Gc(t),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."));else{if("object"!=typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach(t=>{t.forEach(t=>{Lc(Gc(t),()=>"Error in ".concat(e,": pad must be an integer when using dimRoundingMode ").concat(n," but got pad ").concat(t,"."))})})}}}var Mb=Eg({reshape_:function(e,t){let n={x:Ng(e,"x","reshape","string_or_numeric")},a={shape:t};return fg.runKernel(Xp,n,a)}});var Ob=Eg({avgPool_:function(e,t,n,a,r){let i=Ng(e,"x","avgPool","float32");Lc(Ab(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(1,"'"));let s=i,o=!1;3===i.rank&&(o=!0,s=Mb(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Lc(4===s.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(s.rank,".")),Db("avgPool",a,r);let l={x:s},u={filterSize:t,strides:n,pad:a,dimRoundingMode:r},c=fg.runKernel(Hd,l,u);return c=$y(c,i.dtype),o?Mb(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var Pb=Eg({avgPool3d_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",s=Ng(e,"x","avgPool3d","float32"),o=s,l=!1;4===s.rank&&(l=!0,o=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Lc(5===o.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),Lc("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(i)),Lc("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),Db("avgPool3d",a,r);let u={x:o},c={filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:i},d=fg.runKernel(Kd,u,c);return d=$y(d,o.dtype),l?Mb(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Lb=Eg({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Lc(e.length>=1,()=>"Pass at least one tensor to concat");let n=Tg(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)return eb(n[0]);let a=n,r={axis:t};return fg.runKernel(sh,a,r)}});var zb=Eg({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Ng(e,"a","matMul"),i=Ng(t,"b","matMul");[r,i]=ig(r,i);let s={a:r,b:i},o={transposeA:n,transposeB:a};return fg.runKernel(Yd,s,o)}});var Bb=Eg({sigmoid_:function(e){let t={x:Ng(e,"x","sigmoid","float32")};return fg.runKernel(pf,t)}});var Wb=Eg({slice_:function(e,t,n){let a=Ng(e,"x","slice","string_or_numeric");if(0===a.rank)throw new Error("Slicing scalar is not possible");let r={x:a},i={begin:t,size:n};return fg.runKernel(uf,r,i)}});var Vb=Eg({tanh_:function(e){let t={x:Ng(e,"x","tanh","float32")};return fg.runKernel(Mf,t)}});var Ub=Eg({basicLSTMCell_:function(e,t,n,a,r,i){let s=Ng(e,"forgetBias","basicLSTMCell"),o=Ng(t,"lstmKernel","basicLSTMCell"),l=Ng(n,"lstmBias","basicLSTMCell"),u=Ng(a,"data","basicLSTMCell"),c=Ng(r,"c","basicLSTMCell"),d=Ng(i,"h","basicLSTMCell"),h=Lb([u,d],1),p=zb(h,o),f=nb(p,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],b=Wb(f,[0,0],y),v=Wb(f,[0,g],y),x=Wb(f,[0,2*g],y),w=Wb(f,[0,3*g],y),k=nb(ib(Bb(b),Vb(v)),ib(c,Bb(nb(s,x))));return[k,ib(Vb(k),Bb(w))]}});var jb=Eg({batchToSpaceND_:function(e,t,n){let a=Ng(e,"x","batchToSpaceND"),r=t.reduce((e,t)=>e*t);Lc(a.rank>=1+t.length,()=>"input rank is ".concat(a.rank," but should be > than blockShape.length ").concat(t.length)),Lc(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),Lc(a.shape[0]%r===0,()=>"input tensor batch is ".concat(a.shape[0]," but is not divisible by the product of the elements of blockShape ").concat(t.join(" * ")," === ").concat(r));let i={x:a},s={blockShape:t,crops:n};return fg.runKernel(Qd,i,s)}});function Gb(e){let t;return t=0===e.rank||1===e.rank?Mb(e,[1,1,1,e.size]):2===e.rank?Mb(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Mb(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}var Hb=Eg({batchNorm_:function(e,t,n,a,r,i){null==i&&(i=.001);let s,o,l=Ng(e,"x","batchNorm"),u=Ng(t,"mean","batchNorm"),c=Ng(n,"variance","batchNorm");null!=r&&(s=Ng(r,"scale","batchNorm")),null!=a&&(o=Ng(a,"offset","batchNorm")),Lc(u.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Lc(null==o||u.rank===o.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Lc(null==s||u.rank===s.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:Gb(l),scale:s,offset:o,mean:u,variance:c},h={varianceEpsilon:i},p=fg.runKernel(Uh,d,h);return Mb(p,l.shape)}});var qb=Eg({batchNorm2d_:function(e,t,n,a,r,i){let s,o,l=Ng(e,"x","batchNorm"),u=Ng(t,"mean","batchNorm"),c=Ng(n,"variance","batchNorm");return null!=r&&(s=Ng(r,"scale","batchNorm")),null!=a&&(o=Ng(a,"offset","batchNorm")),Lc(2===l.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank ".concat(l.rank,".")),Lc(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ".concat(u.rank,".")),Lc(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ".concat(c.rank,".")),null!=s&&Lc(2===s.rank||1===s.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ".concat(s.rank,".")),null!=o&&Lc(2===o.rank||1===o.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ".concat(o.rank,".")),Hb(l,u,c,o,s,i)}});var Kb=Eg({batchNorm3d_:function(e,t,n,a,r,i){let s,o,l=Ng(e,"x","batchNorm"),u=Ng(t,"mean","batchNorm"),c=Ng(n,"variance","batchNorm");return null!=r&&(s=Ng(r,"scale","batchNorm")),null!=a&&(o=Ng(a,"offset","batchNorm")),Lc(3===l.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank ".concat(l.rank,".")),Lc(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ".concat(u.rank,".")),Lc(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ".concat(c.rank,".")),null!=s&&Lc(3===s.rank||1===s.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ".concat(s.rank,".")),null!=o&&Lc(3===o.rank||1===o.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ".concat(o.rank,".")),Hb(l,u,c,o,s,i)}});var Xb=Eg({batchNorm4d_:function(e,t,n,a,r,i){let s,o,l=Ng(e,"x","batchNorm"),u=Ng(t,"mean","batchNorm"),c=Ng(n,"variance","batchNorm");return null!=r&&(s=Ng(r,"scale","batchNorm")),null!=a&&(o=Ng(a,"offset","batchNorm")),Lc(4===l.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank ".concat(l.rank,".")),Lc(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ".concat(u.rank,".")),Lc(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ".concat(c.rank,".")),null!=s&&Lc(4===s.rank||1===s.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ".concat(s.rank,".")),null!=o&&Lc(4===o.rank||1===o.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ".concat(o.rank,".")),Hb(l,u,c,o,s,i)}});var Yb=Eg({bincount_:function(e,t,n){let a=Ng(e,"x","bincount"),r=Ng(t,"weights","bincount");Lc("int32"===a.dtype,()=>"Error in bincount: input dtype must be int32, but got ".concat(a.dtype)),Lc(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Lc(r.size===a.size||0===r.size,()=>"Error in bincount: weights must have the same size as input or0-length, but got input shape: ".concat(a.shape,", weights shape: ").concat(r.shape,"."));let i={x:a,weights:r},s={size:n};return fg.runKernel(Jd,i,s)}});var Qb=Eg({bitwiseAnd_:function(e,t){let n=Ng(e,"x","bitwiseAnd"),a=Ng(t,"y","bitwiseAnd");if(!jc(n.shape,a.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(a.shape));if("int32"!==n.dtype||"int32"!==a.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(a.dtype));let r={a:n,b:a};return fg.runKernel(Zd,r)}});var Jb=Eg({broadcastArgs_:function(e,t){let n=Ng(e,"s0","broadcastArgs","int32"),a=Ng(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). Has rank ".concat(n.rank));if(1!==a.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). Has rank ".concat(a.rank));let r={s0:n,s1:a};return fg.runKernel(eh,r)}});var Zb=Eg({broadcastTo_:function(e,t){let n=Ng(e,"broadcastTo","x"),a=n.shape;if(vd(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=Mb(n,e)}let r=n.shape,i=Array.from(t);for(let l=t.length-1;l>=0;l--)if(r[l]===t[l])i[l]=1;else if(1!==n.shape[l])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(t,"]."));if(0===i.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return eb(n);let s={x:n},o={reps:i};return fg.runKernel(Of,s,o)}});var $b=Eg({ceil_:function(e){let t={x:Ng(e,"x","ceil","float32")};return fg.runKernel(nh,t)}});function ev(e,t,n){vd(e);let a={shape:e,value:t,dtype:n=n||ud(t)};return fg.runKernel(zh,{},a)}var tv=Eg({clipByValue_:function(e,t,n){let a=Ng(e,"x","clipByValue");if(Lc(t<=n,()=>"Error in clip: min (".concat(t,") must be less than or equal to max (").concat(n,").")),t===n)return ev(a.shape,t,a.dtype);let r={x:a},i={clipValueMin:t,clipValueMax:n};return fg.runKernel(ah,r,i)}});var nv=Eg({concat1d_:function(e){return Lb(e,0)}});var av=Eg({concat2d_:function(e,t){return Lb(e,t)}});var rv=Eg({concat3d_:function(e,t){return Lb(e,t)}});var iv=Eg({concat4d_:function(e,t){return Lb(e,t)}});var sv=Eg({conv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=Ng(e,"x","conv2d","float32"),l=Ng(t,"filter","conv2d","float32"),u=o,c=!1;3===o.rank&&(c=!0,u=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Lc(4===u.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(u.rank,".")),Lc(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank ".concat(l.rank,".")),Db("conv2d",a,s);let d="NHWC"===r?u.shape[3]:u.shape[1];Lc(d===l.shape[2],()=>"Error in conv2d: depth of input (".concat(d,") must match input depth for filter ").concat(l.shape[2],".")),Lc(Ab(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'")),Lc(Fb(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),Lc(Fb(n),()=>"Error in conv2D: Strides should be larger than 0.");let h={x:u,filter:l},p={strides:n,pad:a,dataFormat:r,dilations:i,dimRoundingMode:s},f=fg.runKernel(oh,h,p);return c?Mb(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var ov=Eg({conv1d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6?arguments[6]:void 0,o=Ng(e,"x","conv1d"),l=Ng(t,"filter","conv1d"),u=o,c=!1;2===o.rank&&(c=!0,u=Mb(o,[1,o.shape[0],o.shape[1]])),Lc(3===u.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(u.rank,".")),Lc(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank ".concat(l.rank,".")),Db("conv1d",a,s),Lc(u.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(u.shape[2],") must match input depth for filter ").concat(l.shape[1],".")),Lc(Ab(n,i),()=>"Error in conv1D: Either stride or dilation must be 1. Got stride ".concat(n," and dilation '").concat(i,"'")),Lc(Fb(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),Lc(Fb(n),()=>"Error in conv1D: Stride should be larger than 0."),Lc("NWC"===r,()=>"Error in conv1d: got dataFormat of ".concat(r," but only NWC is currently supported."));let d=Mb(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Mb(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=sv(h,d,[1,n],a,"NHWC",[1,i],s);return Mb(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});var lv=Eg({conv2DBackpropInput_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=arguments.length>6?arguments[6]:void 0;Lc(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,l=t,u=!1;3===t.rank&&(u=!0,l=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),Lc(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length ".concat(o.length,".")),Lc(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank ".concat(l.rank)),Lc(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank ".concat(n.rank));let c="NHWC"===i?o[3]:o[1],d="NHWC"===i?l.shape[3]:l.shape[1];Lc(c===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(c,") must match input depth for filter ").concat(n.shape[2],".")),Lc(d===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(d,") must match output depth for filter ").concat(n.shape[3],".")),Db("conv2dDerInput",r,s);let h={dy:l,filter:n},p={strides:a,pad:r,dataFormat:i,dimRoundingMode:s,inputShape:o},f=fg.runKernel(uh,h,p);return u?Mb(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var uv=Eg({conv2dTranspose_:function(e,t,n,a,r,i){let s=Ng(e,"x","conv2dTranspose"),o=Ng(t,"filter","conv2dTranspose");return lv(n,s,o,a,r,"NHWC",i)}});var cv=Eg({conv3d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],s=Ng(e,"x","conv3d"),o=Ng(t,"filter","conv3d"),l=s,u=!1;4===s.rank&&(u=!0,l=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Lc(5===l.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),Lc(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank ".concat(o.rank,".")),Lc(l.shape[4]===o.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match input depth for filter ").concat(o.shape[3],".")),Lc(Ab(n,i),()=>"Error in conv3D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(i,"'")),Lc("NDHWC"===r,()=>"Error in conv3d: got dataFormat of ".concat(r," but only NDHWC is currently supported.")),Lc(Fb(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),Lc(Fb(n),()=>"Error in conv3D: Strides should be larger than 0.");let c={x:l,filter:o},d={strides:n,pad:a,dataFormat:r,dilations:i},h=fg.runKernel(ch,c,d);return u?Mb(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var dv=Eg({conv3DBackpropInput_:function(e,t,n,a,r){Lc(e.length===t.rank,()=>"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let i=e,s=t,o=!1;4===t.rank&&(o=!0,s=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);let l=i[4],u=s.shape[4];Lc(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length ".concat(i.length,".")),Lc(5===s.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank ".concat(s.rank)),Lc(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank ".concat(n.rank)),Lc(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must match input depth for filter ").concat(n.shape[3],".")),Lc(u===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(u,") must match output depth for filter ").concat(n.shape[4],"."));let c={dy:s,filter:n},d={pad:r,strides:a,inputShape:i},h=fg.runKernel(hh,c,d);return o?Mb(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var hv=Eg({conv3dTranspose_:function(e,t,n,a,r){let i=Ng(e,"x","conv3dTranspose"),s=Ng(t,"filter","conv3dTranspose");return dv(n,i,s,a,r)}});var pv=Eg({cos_:function(e){let t={x:Ng(e,"x","cos","float32")};return fg.runKernel(ph,t)}});var fv=Eg({cosh_:function(e){let t={x:Ng(e,"x","cosh","float32")};return fg.runKernel(fh,t)}});var mv=Eg({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={x:Ng(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:a};return fg.runKernel(mh,r,i)}});var gv=Eg({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={x:Ng(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:a};return fg.runKernel(gh,r,i)}});var yv=Eg({denseBincount_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Ng(e,"x","denseBincount"),i=Ng(t,"weights","denseBincount");Lc("int32"===r.dtype,()=>"Error in denseBincount: input dtype must be int32, but got ".concat(r.dtype)),Lc(r.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got rank ".concat(r.rank,".")),Lc(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Lc(i.size===r.size||0===i.size,()=>"Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ".concat(r.shape,", weights shape: ").concat(i.shape,"."));let s={x:r,weights:i},o={size:n,binaryOutput:a};return fg.runKernel(bh,s,o)}});var bv=Eg({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",a=Ng(e,"x","depthToSpace","float32"),r="NHWC"===n?a.shape[1]:a.shape[2],i="NHWC"===n?a.shape[2]:a.shape[3],s="NHWC"===n?a.shape[3]:a.shape[1];Lc(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),Lc(r*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(a.shape)),Lc(i*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(a.shape)),Lc(s%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(s," for depthToSpace with input shape ").concat(a.shape));let o={x:a},l={blockSize:t,dataFormat:n};return fg.runKernel(vh,o,l)}});var vv=Eg({depthwiseConv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=Ng(e,"x","depthwiseConv2d","float32"),l=Ng(t,"filter","depthwiseConv2d","float32"),u=o,c=!1;3===o.rank&&(c=!0,u=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Lc(4===u.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got rank ".concat(u.rank,".")),Lc(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank ".concat(l.rank,"."));let d="NHWC"===r?u.shape[3]:u.shape[1];Lc(d===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels (".concat(d,") must match the inChannels dimension in filter ").concat(l.shape[2],".")),Db("depthwiseConv2d",a,s);let h={x:u,filter:l},p={strides:n,pad:a,dataFormat:r,dilations:i,dimRoundingMode:s},f=fg.runKernel(xh,h,p);return c?Mb(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var xv=Eg({diag_:function(e){let t={x:Ng(e,"x","diag")};return fg.runKernel(Sh,t)}});var wv=Eg({dilation2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=Ng(e,"x","dilation2d"),o=Ng(t,"filter","dilation2d");Lc(3===s.rank||4===s.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank ".concat(s.rank,".")),Lc(3===o.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank ".concat(o.rank,".")),Lc("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ".concat(i));let l=s,u=!1;3===s.rank&&(l=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),Lc(l.shape[3]===o.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(o.shape[2]));let c={x:l,filter:o},d={strides:n,pad:a,dilations:r},h=fg.runKernel(Ih,c,d);return u?Mb(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),kv={};function Sv(e,t){let n=e.length,a=[];for(let r=0;r<n;r++){let i=n-1-r,s=e[i]||1;(t[t.length-1-r]||1)>1&&1===s&&a.unshift(i)}return a}function Iv(e,t){let n=[];for(let a=0;a<t.length;a++){let r=e[e.length-a-1],i=t.length-a-1,s=t[i];(null==r||1===r&&s>1)&&n.unshift(i)}return n}function Nv(e,t){let n=Math.max(e.length,t.length),a=new Array(n);for(let r=0;r<n;r++){let i=e[e.length-r-1];null==i&&(i=1);let s=t[t.length-r-1];if(null==s&&(s=1),1===i)a[n-r-1]=s;else if(1===s)a[n-r-1]=i;else{if(i!==s){let n="Operands could not be broadcast together with shapes ".concat(e," and ").concat(t,".");throw Error(n)}a[n-r-1]=i}}return a}ac(kv,{assertAndGetBroadcastShape:()=>Nv,getBroadcastDims:()=>Sv,getReductionAxes:()=>Iv});var Tv=Eg({equal_:function(e,t){let n=Ng(e,"a","equal","string_or_numeric"),a=Ng(t,"b","equal","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(Dh,r)}});var Cv=Eg({where_:function(e,t,n){let a=Ng(t,"a","where"),r=Ng(n,"b","where"),i=Ng(e,"condition","where","bool"),s=Nv(Nv(i.shape,a.shape),r.shape),o={condition:Zb(i,s),t:Zb(a,s),e:Zb(r,s)};return fg.runKernel(of,o)}});var Ev=Eg({zerosLike_:function(e){let t={x:Ng(e,"x","zerosLike")};return fg.runKernel(jf,t)}});var _v=Eg({divNoNan_:function(e,t){let n=Ng(e,"a","div"),a=Ng(t,"b","div");[n,a]=ig(n,a);let r=rb(n,a),i=Ev(r),s=Tv(a,i);return Cv(s,i,r)}});var Av=Eg({dot_:function(e,t){let n=Ng(e,"t1","dot"),a=Ng(t,"t2","dot");Lc((1===n.rank||2===n.rank)&&(1===a.rank||2===a.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks ".concat(n.rank," and ").concat(a.rank,"."));let r=1===n.rank?n.size:n.shape[1],i=1===a.rank?a.size:a.shape[0];if(Lc(r===i,()=>"Error in dot: inner dimensions of inputs must match, but got ".concat(r," and ").concat(i,".")),1===n.rank&&1===a.rank){let e=Mb(n,[1,-1]),t=Mb(a,[-1,1]),r=zb(e,t);return Mb(r,[])}if(1===n.rank&&2===a.rank){let e=Mb(n,[1,-1]),t=Mb(a,[a.shape[0],a.shape[1]]),r=zb(e,t);return Mb(r,[r.size])}if(2===n.rank&&1===a.rank){let e=Mb(a,[-1,1]),t=zb(n,e);return Mb(t,[t.size])}{let e=Mb(a,[a.shape[0],a.shape[1]]);return zb(n,e)}}});var Fv=Eg({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];let r=n.map((e,t)=>Ng(e,"tensors".concat(t),"einsum")),i={equation:e};return fg.runKernel(_h,r,i)}});var Rv=Eg({elu_:function(e){let t={x:Ng(e,"x","elu","float32")};return fg.runKernel(Ah,t)}});var Dv=Eg({ensureShape_:function(e,t){let n=Ng(e,"x","ensureShape","string_or_numeric");if(!Uc(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});var Mv=Eg({erf_:function(e){let t=Ng(e,"x","erf");Lc("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=$y(t,"float32"));let n={x:t};return fg.runKernel(Rh,n)}});function Ov(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Pv(e,t,n){let a=e.length+t.length,r=[],i=0,s=0;for(let o=0;o<a;o++)-1===n.indexOf(o)?r.push(e[i++]):r.push(t[s++]);return r}function Lv(e,t){let n=[],a=e.length;for(let r=0;r<a;r++)-1===t.indexOf(r)&&n.push(e[r]);return[n,t.map(t=>e[t])]}function zv(e,t){return Pv(e,t.map(e=>1),t)}function Bv(e,t,n){Lc(Ov(t,n),()=>"".concat(e," supports only inner-most axes for now. Got axes ").concat(t," and rank-").concat(n," input."))}function Wv(e,t){if(Ov(e,t))return null;let n=[];for(let a=0;a<t;++a)-1===e.indexOf(a)&&n.push(a);return e.forEach(e=>n.push(e)),n}function Vv(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Uv(e,t){let n=[];for(let a=t-e;a<t;++a)n.push(a);return n}var jv=Eg({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Ng(e,"x","max")},r={reductionIndices:t,keepDims:n};return fg.runKernel(fp,a,r)}});var Gv=Eg({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Ng(e,"x","min")},r={axis:t,keepDims:n};return fg.runKernel(kp,a,r)}});var Hv=Eg({pow_:function(e,t){let n=Ng(e,"base","pow"),a=Ng(t,"exp","pow");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(zp,r)}});function qv(e,t){if((Fm(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Fm(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ag(e,[],[],t)}var Kv=Eg({sqrt_:function(e){let t={x:Ng(e,"x","sqrt","float32")};return fg.runKernel(mf,t)}});var Xv=Eg({square_:function(e){let t=Ng(e,"x","square");return fg.runKernel("Square",{x:t},{})}});var Yv=Eg({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Ng(e,"x","sum");"bool"===a.dtype&&(a=$y(a,"int32"));let r={x:a},i={axis:t,keepDims:n};return fg.runKernel(gf,r,i)}});function Qv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return sb(e);if(1!==e.rank&&null===n)return Qv(Mb(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Yv(sb(e),n);if(t===1/0)return jv(sb(e),n);if(t===-1/0)return Gv(sb(e),n);if("euclidean"===t||2===t)return Kv(Yv(Hv(sb(e),qv(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return jv(Yv(sb(e),n[0]),n[1]-1);if(t===1/0)return jv(Yv(sb(e),n[1]),n[0]);if(t===-1/0)return Gv(Yv(sb(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Kv(Yv(Xv(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Jv=Eg({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Qv(e=Ng(e,"x","norm"),t,n),i=r.shape;if(a){let t=Jc(n,e.shape);i=zv(r.shape,t)}return Mb(r,i)}});var Zv=Eg({euclideanNorm_:function(e){return Jv(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});var $v=Eg({exp_:function(e){let t={x:Ng(e,"x","exp")};return fg.runKernel(Mh,t)}});var ex=Eg({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ng(e,"x","expandDims","string_or_numeric");Lc(t<=n.rank,()=>"Axis must be <= rank of the tensor");let a={input:n},r={dim:t};return fg.runKernel(Oh,a,r)}});var tx=Eg({expm1_:function(e){let t={x:Ng(e,"x","expm1")};return fg.runKernel(Ph,t)}});var nx=Eg({tile_:function(e,t){let n=Ng(e,"x","tile","string_or_numeric");Lc(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," must match length of reps ").concat(t,"."));let a={x:n},r={reps:t};return fg.runKernel(Of,a,r)}});var ax=Eg({eye_:function(e,t,n){null==t&&(t=e);let a=Zy([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),r=e<=t?e:t;for(let s=0;s<r;++s)a.set(1,s,s);let i=Mb(a.toTensor(),[e,t]);if(null==n)return i;if(1===n.length)return nx(ex(i,0),[n[0],1,1]);if(2===n.length)return nx(ex(ex(i,0),0),[n[0],n[1],1,1]);if(3===n.length)return nx(ex(ex(ex(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received ".concat(n.length,"D."))}});var rx=Eg({floor_:function(e){let t={x:Ng(e,"x","floor","float32")};return fg.runKernel(Wh,t)}});var ix=Eg({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r={x:Ng(e,"x","gather"),indices:Ng(t,"indices","gather","int32")},i={axis:n,batchDims:a};return fg.runKernel(jh,r,i)}});var sx=Eg({greater_:function(e,t){let n=Ng(e,"a","greater","string_or_numeric"),a=Ng(t,"b","greater","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(Hh,r)}});var ox=Eg({greaterEqual_:function(e,t){let n=Ng(e,"a","greaterEqual","string_or_numeric"),a=Ng(t,"b","greaterEqual","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(qh,r)}});var lx=Eg({imag_:function(e){let t={input:Ng(e,"input","imag")};return fg.runKernel(Yh,t)}});var ux=Eg({isFinite_:function(e){let t={x:Ng(e,"x","isFinite")};return fg.runKernel(Qh,t)}});var cx=Eg({isInf_:function(e){let t={x:Ng(e,"x","isInf")};return fg.runKernel(Jh,t)}});var dx=Eg({isNaN_:function(e){let t={x:Ng(e,"x","isNaN")};return fg.runKernel(Zh,t)}});var hx=Eg({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:Ng(e,"x","leakyRelu")},a={alpha:t};return fg.runKernel($h,n,a)}});var px=Eg({less_:function(e,t){let n=Ng(e,"a","less","string_or_numeric"),a=Ng(t,"b","less","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(ep,r)}});var fx=Eg({lessEqual_:function(e,t){let n=Ng(e,"a","lessEqual","string_or_numeric"),a=Ng(t,"b","lessEqual","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(tp,r)}});function mx(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let a={start:e,stop:t,num:n};return fg.runKernel(np,{},a)}var gx=Eg({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=Ng(e,"x","localResponseNormalization");Lc(4===i.rank||3===i.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")),Lc(Gc(t),()=>"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ".concat(t,"."));let s=i,o=!1;3===i.rank&&(o=!0,s=Mb(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},u={depthRadius:t,bias:n,alpha:a,beta:r},c=fg.runKernel(dp,l,u);return o?Mb(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var yx=Eg({log_:function(e){let t={x:Ng(e,"x","log","float32")};return fg.runKernel(ap,t)}});var bx=Eg({log1p_:function(e){let t={x:Ng(e,"x","log1p")};return fg.runKernel(rp,t)}});function vx(e){return Lc(cd(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let a=Ng(t,"x","tf.grad","string_or_numeric"),r=null!=n?Ng(n,"dy","tf.grad"):null;return fg.tidy(()=>{let{value:t,grads:n}=fg.gradients(()=>e(a),[a],r);return null!=r&&zc(t.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Nx(n),n[0]})}}function xx(e){return Lc(cd(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{Lc(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let a=Tg(t,"args","tf.grads","string_or_numeric"),r=null!=n?Ng(n,"dy","tf.grads"):null;return fg.tidy(()=>{let{value:t,grads:n}=fg.gradients(()=>e(...a),a,r);return null!=r&&zc(t.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Nx(n),n})}}function wx(e){return Lc(cd(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{Lc(t instanceof Gm,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Lc(null==n||n instanceof Gm,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:a,value:r}=fg.gradients(()=>e(t),[t],n);return Nx(a),{grad:a[0],value:r}}}function kx(e){return Lc(cd(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{Lc(Array.isArray(t)&&t.every(e=>e instanceof Gm),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Lc(null==n||n instanceof Gm,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let a=fg.gradients(()=>e(...t),t,n);return null!=n&&zc(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Nx(a.grads),a}}function Sx(e,t){Lc(cd(e),()=>"The f passed in variableGrads(f) must be a function"),Lc(null==t||Array.isArray(t)&&t.every(e=>e instanceof qm),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=null!=t;if(!n){t=[];for(let e in fg.registeredVariables)t.push(fg.registeredVariables[e])}let a=n?t.filter(e=>!e.trainable):null,r=t.length;Lc((t=t.filter(e=>e.trainable)).length>0,()=>"variableGrads() expects at least one of the input variables to be trainable, but none of the ".concat(r," variables is trainable."));let{value:i,grads:s}=fg.gradients(e,t,null,!0);Lc(s.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Lc(0===i.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it returned a rank-".concat(i.rank," tensor"));let o={};return t.forEach((e,t)=>{null!=s[t]&&(o[e.name]=s[t])}),null!=a&&a.forEach(e=>o[e.name]=null),{value:i,grads:o}}function Ix(e){return fg.customGrad(e)}function Nx(e){if(e.filter(e=>null==e).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var Tx=Eg({neg_:function(e){let t={x:Ng(e,"x","neg")};return fg.runKernel(Ep,t)}});var Cx=Eg({softplus_:function(e){let t={x:Ng(e,"x","softplus")};return fg.runKernel(ff,t)}});var Ex=Eg({logSigmoid_:function(e){let t=Ng(e,"x","logSigmoid");return Ix(e=>({value:Tx(Cx(Tx(e))),gradFunc:t=>ib(t,Bb(Tx(e)))}))(t)}});var _x=Eg({sub_:function(e,t){let n=Ng(e,"a","sub"),a=Ng(t,"b","sub");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Rf,r)}});var Ax=Eg({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Ng(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and axis was ").concat(t));return Ix((e,n)=>{let a=jv(e,t,!0),r=_x(e,a),i=_x($y(r,"float32"),yx(Yv($v(r),t,!0)));return n([i]),{value:i,gradFunc:(e,n)=>{let[a]=n,r=$v(a);return _x(e,ib(Yv(e,t,!0),r))}}})(n)}});var Fx=Eg({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Ng(e,"x","logSumExp"),r=Jc(t,a.shape),i=jv(a,r,!0),s=_x(a,i),o=$v(s),l=Yv(o,r),u=yx(l),c=nb(Mb(i,u.shape),u);if(n){let e=zv(c.shape,r);return Mb(c,e)}return c}});var Rx=Eg({logicalAnd_:function(e,t){let n=Ng(e,"a","logicalAnd","bool"),a=Ng(t,"b","logicalAnd","bool");Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(ip,r)}});var Dx=Eg({logicalNot_:function(e){let t={x:Ng(e,"x","logicalNot","bool")};return fg.runKernel(sp,t)}});var Mx=Eg({logicalOr_:function(e,t){let n=Ng(e,"a","logicalOr","bool"),a=Ng(t,"b","logicalOr","bool");Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(op,r)}});var Ox=Eg({logicalXor_:function(e,t){let n=Ng(e,"a","logicalXor","bool"),a=Ng(t,"b","logicalXor","bool");return Nv(n.shape,a.shape),Rx(Mx(e,t),Dx(Rx(e,t)))}}),Px=2147483648;var Lx=Eg({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",a=Ng(e,"sortedSequence","searchSorted"),r=Ng(t,"values","searchSorted"),i=a.shape[a.shape.length-1],s=r.shape[r.shape.length-1],o=Mb(a,[-1,i]),l=Mb(r,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Wc(l.shape)>=Px)throw new Error("values tensor size must less than ".concat(Px));if(o.shape[1]>=Px)throw new Error("trailing dim_size must less than ".concat(Px," for int32 output type, was ").concat(o.shape[1]));let u={sortedSequence:o,values:l},c={side:n};return fg.runKernel(sf,u,c)}});function zx(e,t){return Lx(e,t,"left")}var Bx=Eg({maxPool_:function(e,t,n,a,r){let i=Ng(e,"x","maxPool"),s=i,o=!1;3===i.rank&&(o=!0,s=Mb(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Lc(4===s.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(s.rank,".")),Lc(Ab(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(1,"'")),Db("maxPool",a,r);let l={x:s},u={filterSize:t,strides:n,pad:a,dimRoundingMode:r},c=fg.runKernel(gp,l,u);return o?Mb(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var Wx=Eg({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",s=Ng(e,"x","maxPool3d"),o=s,l=!1;4===s.rank&&(l=!0,o=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Lc(5===o.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),Lc("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ".concat(i)),Db("maxPool3d",a,r);let u={x:o},c={filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:i},d=fg.runKernel(bp,u,c);return l?Mb(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Vx=Eg({maxPoolWithArgmax_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={x:Ng(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:a,includeBatchInIndex:r},o=fg.runKernel(xp,i,s);return{result:o[0],indexes:o[1]}}});var Ux=Eg({maximum_:function(e,t){let n=Ng(e,"a","maximum"),a=Ng(t,"b","maximum");[n,a]=ig(n,a),"bool"===n.dtype&&(n=$y(n,"int32"),a=$y(a,"int32")),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(mp,r)}});var jx=Eg({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={x:Ng(e,"x","mean")},r={axis:t,keepDims:n};return fg.runKernel(wp,a,r)}});function Gx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(vd(e),"complex64"===t){let t=Gx(e,"float32"),n=Gx(e,"float32");return _g(t,n)}let n=yd(Wc(e),t);return fg.makeTensor(n,e,t)}function Hx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(vd(e),"complex64"===t){let t=Hx(e,"float32"),n=Gx(e,"float32");return _g(t,n)}let n=gd(Wc(e),t);return fg.makeTensor(n,e,t)}function qx(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let a=Ng(e,"x","meshgrid",e instanceof Gm?e.dtype:"float32");if(void 0===t)return[a];let r=Ng(t,"y","meshgrid",t instanceof Gm?t.dtype:"float32"),i=Wc(a.shape),s=Wc(r.shape);return"xy"===n?(a=Mb(a,[1,-1]),r=Mb(r,[-1,1]),[zb(Hx([s,1],a.dtype),a),zb(r,Hx([1,i],r.dtype))]):(a=Mb(a,[-1,1]),r=Mb(r,[1,-1]),[zb(a,Hx([1,s],a.dtype)),zb(Hx([i,1],r.dtype),r)])}var Kx=Eg({minimum_:function(e,t){let n=Ng(e,"a","minimum"),a=Ng(t,"b","minimum");[n,a]=ig(n,a),"bool"===n.dtype&&(n=$y(n,"int32"),a=$y(a,"int32")),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(Sp,r)}});var Xx=Eg({mirrorPad_:function(e,t,n){Lc("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. Got ".concat(n,"."));let a=Ng(e,"x","mirrorPad");if(0===a.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Lc(t.length===a.rank,()=>"Padding doesn't match input. Must be ".concat(a.rank,". Got ").concat(t.length,"."));let r="reflect"===n?1:0;for(let o=0;o<a.rank;o++)Lc(2===t[o].length,()=>"Invalid number of paddings. Must be length of 2 each."),Lc(t[o][0]>=0&&t[o][0]<=a.shape[o]-r&&t[o][1]>=0&&t[o][1]<=a.shape[o]-r,()=>"Padding in dimension ".concat(o," cannot be greater than or equal to ").concat(a.shape[o]-r," or less than 0 for input of shape ").concat(a.shape));let i={paddings:t,mode:n},s={x:a};return fg.runKernel(Ip,s,i)}});var Yx=Eg({mod_:function(e,t){let n=Ng(e,"a","mod"),a=Ng(t,"b","mod");[n,a]=ig(n,a);let r={a:n,b:a};return fg.runKernel(Np,r)}});var Qx=Eg({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Jc(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=Ng(e,"x","moments")).shape),a=jx(e,n,t),r=a.shape;t||(r=zv(a.shape,n));let i=Xv(_x($y(e,"float32"),Mb(a,r)));return{mean:a,variance:jx(i,n,t)}}});var Jx=Eg({multiRNNCell_:function(e,t,n,a){let r=Ng(t,"data","multiRNNCell"),i=Tg(n,"c","multiRNNCell"),s=Tg(a,"h","multiRNNCell"),o=r,l=[];for(let d=0;d<e.length;d++){let t=e[d](o,i[d],s[d]);l.push(t[0]),l.push(t[1]),o=t[1]}let u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}});var Zx=Eg({multinomial_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Ng(e,"logits","multinomial"),i=r.size,s=r.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got ".concat(i,"."));if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(s));n=n||Math.random();let o={logits:1===s?Mb(r,[1,-1]):r},l={numSamples:t,seed:n,normalized:a},u=fg.runKernel(Tp,o,l);return 1===s?Mb(u,[u.size]):u}});var $x=Eg({notEqual_:function(e,t){let n=Ng(e,"a","notEqual","string_or_numeric"),a=Ng(t,"b","notEqual","string_or_numeric");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(_p,r)}});var ew=Eg({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));let i={indices:Ng(e,"indices","oneHot","int32")},s={dtype:r,depth:t,onValue:n,offValue:a};return fg.runKernel(Mp,i,s)}});var tw=Eg({onesLike_:function(e){let t={x:Ng(e,"x","onesLike")};return fg.runKernel(Dp,t)}});var nw=Eg({outerProduct_:function(e,t){let n=Ng(e,"v1","outerProduct"),a=Ng(t,"v2","outerProduct");Lc(1===n.rank&&1===a.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks ".concat(n.rank," and ").concat(a.rank,"."));let r=Mb(n,[-1,1]),i=Mb(a,[1,-1]);return zb(r,i)}});var aw=Eg({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Ng(e,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let r={paddings:t,constantValue:n},i={x:a};return fg.runKernel(Pp,i,r)}});var rw=Eg({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lc(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),aw(e,[t],n)}});var iw=Eg({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lc(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),aw(e,t,n)}});var sw=Eg({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lc(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),aw(e,t,n)}});var ow=Eg({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lc(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),aw(e,t,n)}});var lw=Eg({spaceToBatchND_:function(e,t,n){let a=Ng(e,"x","spaceToBatchND");Lc(a.rank>=1+t.length,()=>"input rank ".concat(a.rank," should be > than [blockShape] ").concat(t.length)),Lc(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),Lc(a.shape.reduce((e,a,r)=>r>0&&r<=t.length?e&&(a+n[r-1][0]+n[r-1][1])%t[r-1]===0:e,!0),()=>"input spatial dimensions ".concat(a.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));let r={x:a},i={blockShape:t,paddings:n};return fg.runKernel(yf,r,i)}});var uw=Eg({pool_:function(e,t,n,a,r,i,s){null==r&&(r=[1,1]),null==i&&(i=1),0===a&&(a="valid");let o=Ng(e,"x","maxPool"),l=o,u=!1;3===o.rank&&(u=!0,l=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Lc(Ab(i,r),()=>"Error in pool: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(r,"'"));let c,d=xb(l.shape,t,i,r,a),h=[d.dilationHeight,d.dilationWidth];c="same"===a?function(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)).map(e=>e-1),a=n.map(e=>Math.floor(e/2)),r=n.map((e,t)=>e-a[t]);return n.map((e,t)=>[a[t],r[t]])}([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];let p=1===h[0]&&1===h[1],[f,m]=function(e,t,n){let a=n.map(e=>e[0]),r=n.map(e=>e[1]),i=e.concat(a,r),s=t.map((e,t)=>(e-i[t]%e)%e),o=r.map((e,t)=>e+s[t]),l=t.map((e,t)=>[a[t],o[t]]),u=t.map((e,t)=>[0,s[t]]);return[l,u]}([d.inHeight,d.inWidth],h,c),g=p?a:"valid",y=p?l:lw(l,h,f),b=("avg"===n?()=>Ob(y,t,i,g,s):()=>Bx(y,t,i,g,s))(),v=p?b:jb(b,h,m);return u?Mb(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});var cw=Eg({prelu_:function(e,t){let n={x:Ng(e,"x","prelu"),alpha:Ng(t,"alpha","prelu")};return fg.runKernel(Bp,n)}});var dw=Eg({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Ng(e,"x","prod");"bool"===a.dtype&&(a=$y(a,"int32"));let r={x:a},i={axis:t,keepDims:n};return fg.runKernel(Wp,r,i)}});var hw=Eg({raggedGather_:function(e,t,n,a){let r={paramsNestedSplits:e.map((e,t)=>Ng(e,"tensors".concat(t),"raggedGather","int32")),paramsDenseValues:Ng(t,"paramsDenseValues","raggedGather"),indices:Ng(n,"indices","raggedGather","int32")},i={outputRaggedRank:a},s=fg.runKernel(Vp,r,i);return{outputNestedSplits:s.slice(0,s.length-1),outputDenseValues:s[s.length-1]}}});var pw=Eg({raggedRange_:function(e,t,n){let a=Ng(e,"starts","raggedRange"),r={starts:a,limits:Ng(t,"limits","raggedRange",a.dtype),deltas:Ng(n,"deltas","raggedRange",a.dtype)},i=fg.runKernel(Up,r);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});var fw=Eg({raggedTensorToTensor_:function(e,t,n,a,r){let i=Ng(e,"shape","raggedTensorToTensor","int32"),s=Ng(t,"values","raggedTensorToTensor"),o={shape:i,values:s,defaultValue:Ng(n,"defaultValue","raggedTensorToTensor",s.dtype),rowPartitionTensors:a.map((e,t)=>Ng(e,"tensors".concat(t),"raggedTensorToTensor","int32"))},l={rowPartitionTypes:r};return fg.runKernel(jp,o,l)}});var mw=Eg({rand_:function(e,t,n){vd(e);let a=Wc(e),r=null;if(null==n||"float32"===n)r=new Float32Array(a);else if("int32"===n)r=new Int32Array(a);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));r=new Uint8Array(a)}for(let i=0;i<a;i++)r[i]=t();return fg.makeTensor(r,e,n)}}),gw=rc(gc()),yw={};ac(yw,{TEST_EPSILON_FLOAT16:()=>vw,createVideoElement:()=>Aw,encodeStrings:()=>_w,expectArrayBuffersEqual:()=>Ew,expectArraysClose:()=>xw,expectArraysEqual:()=>Iw,expectNumbersClose:()=>Nw,expectPromiseToFail:()=>Sw,expectValuesInRange:()=>Cw,play:()=>Fw,testEpsilon:()=>ww});var bw=.001,vw=.1;function xw(e,t,n){return null==n&&(n=ww()),kw(e,t,(e,t)=>Tw(e,t,n))}function ww(){return 32===fg.backend.floatPrecision()?bw:vw}function kw(e,t,n){let a=!0;if((Fm(e)||Fm(t))&&(a=!1),Fm(e)&&Fm(t)&&(a=!0),a){let n=e.constructor.name,a=t.constructor.name;if(n!==a)throw new Error("Arrays are of different type. Actual: ".concat(n,". Expected: ").concat(a))}if(Array.isArray(e)&&Array.isArray(t)){let n=kg(e),a=kg(t);if(!jc(n,a))throw new Error("Arrays have different shapes. Actual: [".concat(n,"]. Expected: [").concat(a,"]"))}let r=Fm(e)?e:Rm(e),i=Fm(t)?t:Rm(t);if(r.length!==i.length)throw new Error("Arrays have different lengths actual: ".concat(r.length," vs expected: ").concat(i.length,".\nActual:   ").concat(r,".\nExpected: ").concat(i,"."));for(let s=0;s<i.length;++s){let e=r[s],t=i[s];if(!n(e,t))throw new Error("Arrays differ: actual[".concat(s,"] = ").concat(e,", expected[").concat(s,"] = ").concat(t,".\nActual:   ").concat(r,".\nExpected: ").concat(i,"."))}"undefined"!=typeof expect&&expect().nothing()}function Sw(e,t){e().then(()=>t.fail(),()=>t()),"undefined"!=typeof expect&&expect().nothing()}function Iw(e,t){let n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return sd(e)||sd(e[0])||sd(t)||sd(t[0])?kw(e,n,(e,t)=>e==t):kw(e,t,(e,t)=>Tw(e,t,0))}function Nw(e,t,n){if(null==n&&(n=ww()),!Tw(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));"undefined"!=typeof expect&&expect().nothing()}function Tw(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function Cw(e,t,n){for(let a=0;a<e.length;a++)if(e[a]<t||e[a]>n)throw new Error("Value out of range:".concat(e[a]," low: ").concat(t,", high: ").concat(n))}function Ew(e,t){let n=new Float32Array(e),a=new Float32Array(t);if(n.length!==a.length)throw new Error("Expected ArrayBuffer to be of length ".concat(a.length,", but it was ").concat(n.length));for(let r=0;r<a.length;r++)if(n[r]!==a[r])throw new Error("Expected ArrayBuffer value at ".concat(r," to be ").concat(a[r]," but got ").concat(n[r]," instead"))}function _w(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?_w(n):e[t]=_m(n)}return e}function Aw(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(e=>{t.addEventListener("loadeddata",n=>e(t)),t.load()})}async function Fw(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var Rw=class{constructor(e,t,n,a,r){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let i=r||Math.random();this.random=gw.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let a,r,i;do{a=2*this.random()-1,r=2*this.random()-1,i=a*a+r*r}while(i>=1||0===i);let s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*s,t=this.mean+this.stdDev*r*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},Dw=class{constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;let r=a||Math.random();this.randu=gw.alea(r.toString()),this.randn=new Rw(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,a,r,i;for(;;){do{a=this.randn.nextValue(),i=1+this.c*a}while(i<=0);if(i*=i*i,e=a*a,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),r=this.randu(),r<t||Math.log(r)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}},Mw=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==a&&(a=Math.random()),"number"==typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=gw.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};var Ow=Eg({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;if(vd(e),null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type ".concat(a));let i=new Dw(t,n,a,r),s=Zy(e,a);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}});var Pw=Eg({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(vd(e),null!=a&&"bool"===a)throw new Error("Unsupported data type ".concat(a));let i=new Rw(t,n,a,!1,r),s=Zy(e,a);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}});var Lw=Eg({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return Pw(e,0,1,t,n)}});var zw=Eg({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;vd(e);let i=Zy(e,a),s=new Mw(t,n,null,r);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}});var Bw=Eg({randomUniformInt_:function(e,t,n,a){return zw(e,t,n,"int32",a)}});function Ww(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");let r={start:e,stop:t,step:n,dtype:a};return fg.runKernel(Gp,{},r)}var Vw=Eg({real_:function(e){let t={input:Ng(e,"input","real")};return fg.runKernel(Hp,t)}});var Uw=Eg({reciprocal_:function(e){let t={x:Ng(e,"x","reciprocal")};return fg.runKernel(qp,t)}});var jw=Eg({relu_:function(e){let t={x:Ng(e,"x","relu")};return fg.runKernel(Kp,t)}});var Gw=Eg({relu6_:function(e){let t={x:Ng(e,"x","relu6")};return fg.runKernel($p,t)}});var Hw=Eg({reverse_:function(e,t){let n={x:Ng(e,"x","reverse")},a={dims:t};return fg.runKernel(ef,n,a)}});var qw=Eg({reverse1d_:function(e){let t=Ng(e,"x","reverse");return Lc(1===t.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),Hw(t,0)}});var Kw=Eg({reverse2d_:function(e,t){let n=Ng(e,"x","reverse");return Lc(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),Hw(n,t)}});var Xw=Eg({reverse3d_:function(e,t){let n=Ng(e,"x","reverse");return Lc(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),Hw(n,t)}});var Yw=Eg({reverse4d_:function(e,t){let n=Ng(e,"x","reverse");return Lc(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),Hw(n,t)}});var Qw=Eg({round_:function(e){let t={x:Ng(e,"x","round")};return fg.runKernel(tf,t)}});var Jw=Eg({rsqrt_:function(e){let t={x:Ng(e,"x","rsqrt","float32")};return fg.runKernel(nf,t)}});var Zw=Eg({selu_:function(e){let t={x:Ng(e,"x","selu")};return fg.runKernel(lf,t)}});var $w=Eg({separableConv2d_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",o=Ng(e,"x","separableConv2d"),l=Ng(t,"depthwiseFilter","separableConv2d"),u=Ng(n,"pointwiseFilter","separableConv2d"),c=o,d=!1;if(3===o.rank&&(d=!0,c=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Lc(4===c.rank,()=>"Error in separableConv2d: input must be rank 4, but got rank ".concat(c.rank,".")),Lc(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but got rank ".concat(l.rank,".")),Lc(4===u.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but got rank ".concat(l.rank,".")),Lc(1===u.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ".concat(u.shape[0],".")),Lc(1===u.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ".concat(u.shape[1],"."));let h=l.shape[2],p=l.shape[3];Lc(u.shape[2]===h*p,()=>"Error in separableConv2d: the third dimension of pointwise filter must be ".concat(h*p,", but got ").concat(u.shape[2],"."));let f=vv(c,l,a,r,s,i),m=sv(f,u,1,"valid",s);return d?Mb(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});var ek=async function(e,t){let n=Ng(e,"x","setdiff1d"),a=Ng(t,"y","setdiff1d");Lc(n.dtype===a.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(a.dtype,").")),Lc(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),Lc(1===a.rank,()=>"y should be 1D tensor, but got y (".concat(a.shape,")."));let r=await n.data(),i=await a.data(),s=new Set(i),o=0;for(let c=0;c<r.length;c++)s.has(r[c])||o++;let l=new Vm([o],n.dtype),u=new Vm([o],"int32");for(let c=0,d=0;c<r.length;c++)s.has(r[c])||(l.values[d]=r[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]};var tk=Eg({sign_:function(e){let t={x:Ng(e,"x","sign")};return fg.runKernel(hf,t)}});var nk=Eg({sin_:function(e){let t={x:Ng(e,"x","sin","float32")};return fg.runKernel(cf,t)}});var ak=Eg({sinh_:function(e){let t={x:Ng(e,"x","sinh")};return fg.runKernel(df,t)}});var rk=Eg({slice1d_:function(e,t,n){let a=Ng(e,"x","slice1d");return Lc(1===a.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(a.rank," tensor")),Wb(a,[t],[n])}});var ik=Eg({slice2d_:function(e,t,n){let a=Ng(e,"x","slice2d");return Lc(2===a.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(a.rank," tensor")),Wb(a,t,n)}});var sk=Eg({slice3d_:function(e,t,n){let a=Ng(e,"x","slice3d");return Lc(3===a.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(a.rank," tensor")),Wb(a,t,n)}});var ok=Eg({slice4d_:function(e,t,n){let a=Ng(e,"x","slice4d");return Lc(4===a.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(a.rank," tensor")),Wb(a,t,n)}});var lk=Eg({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Ng(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and dim was ").concat(t));let a={logits:n},r={dim:t};return fg.runKernel(vf,a,r)}});var uk=Eg({fft_:function(e){Lc("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return fg.runKernel(Lh,t)}});var ck=Eg({ifft_:function(e){Lc("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 but got ".concat(e.dtype,"."));let t={input:e};return fg.runKernel(Xh,t)}});var dk=Eg({irfft_:function(e){let t,n=e.shape[e.shape.length-1],a=e.size/n;if(n<=2){let r=Mb(e,[a,n]);t=ck(r)}else{let r=[a,2*(n-1)],i=Mb(Vw(e),[a,n]),s=Mb(lx(e),[a,n]),o=Hw(Wb(i,[0,1],[a,n-2]),1),l=ib(Hw(Wb(s,[0,1],[a,n-2]),1),qv(-1)),u=Lb([i,o],1),c=Lb([s,l],1),d=Mb(_g(u,c),[r[0],r[1]]);t=ck(d)}if(t=Vw(t),3===e.rank&&0!==e.shape[0]){let n=t,a=e.shape[0];t=Mb(t,[a,t.shape[0]/a,t.shape[1]]),n.dispose()}return t}});var hk=Eg({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a={x:Ng(e,"x","split")},r={numOrSizeSplits:t,axis:n};return fg.runKernel(bf,a,r)}});var pk=Eg({rfft_:function(e,t){Lc("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n,a=e.shape[e.shape.length-1],r=e.size/a;if(null!=t&&t<a){let r=e.shape.map(e=>0),i=e.shape.map(e=>e);i[e.shape.length-1]=t,n=Wb(e,r,i),a=t}else if(null!=t&&t>a){let r=e.shape.map(e=>e);r[e.shape.length-1]=t-a,n=Lb([e,Gx(r)],e.shape.length-1),a=t}else n=e;let i=Ev(n),s=Mb(_g(n,i),[r,a]),o=uk(s),l=Math.floor(a/2)+1,u=Vw(o),c=lx(o),d=hk(u,[l,a-l],u.shape.length-1),h=hk(c,[l,a-l],c.shape.length-1),p=n.shape.slice();return p[n.shape.length-1]=l,Mb(_g(d[0],h[0]),p)}});var fk=Eg({squaredDifference_:function(e,t){let n=Ng(e,"a","squaredDifference"),a=Ng(t,"b","squaredDifference");[n,a]=ig(n,a),Nv(n.shape,a.shape);let r={a:n,b:a};return fg.runKernel(Nf,r,{})}});var mk=Eg({squeeze_:function(e,t){let n=Ng(e,"x","squeeze","string_or_numeric");return Mb(n,Zc(n.shape,t).newShape)}});var gk=Eg({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Tg(e,"tensors","stack","string_or_numeric");Lc(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Lc(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let a=n,r={axis:t};return fg.runKernel(Op,a,r)}});var yk=Eg({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:Ng(e,"x","step")},a={alpha:t};return fg.runKernel(Gf,n,a)}});var bk=Eg({stridedSlice_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u={x:Ng(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:n,strides:a,beginMask:r,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return fg.runKernel(Ef,u,c)}});var vk=Eg({tan_:function(e){let t={x:Ng(e,"x","tan","float32")};return fg.runKernel(Df,t)}});function xk(e,t){Bc(e);let n=kg(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ag(e,null,n,t)}function wk(e,t,n){if(Bc(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");let a=kg(e,n);if(2!==a.length&&1!==a.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ag(e,t,a,n)}function kk(e,t,n){if(Bc(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");let a=kg(e,n);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ag(e,t,a,n)}function Sk(e,t,n){if(Bc(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");let a=kg(e,n);if(4!==a.length&&1!==a.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ag(e,t,a,n)}function Ik(e,t,n){if(Bc(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");let a=kg(e,n);if(5!==a.length&&1!==a.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ag(e,t,a,n)}function Nk(e,t,n){if(Bc(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");let a=kg(e,n);if(6!==a.length&&1!==a.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ag(e,t=t||a,a,n)}var Tk={};function Ck(e,t,n){let a=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ".concat(n.shape,", indices.shape: ").concat(t.shape,", shape: ").concat(e,", sliceDim: ").concat(a,", and batchDim: ").concat(r,".");if(n.rank<r)throw new Error(i+" update.rank < ".concat(r,". "));if(e.length<a+(n.rank-r))throw new Error(i+" Output shape length < ".concat(a+(n.rank-r)));if(n.rank!==r+e.length-a)throw new Error(i+" update.rank != ".concat(r+e.length-a));for(let s=0;s<r;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+" updates.shape[".concat(s,"] (").concat(n.shape[s],") != indices.shape[").concat(s,"] (").concat(t.shape[s],")."));for(let s=0;s<n.rank-r;++s)if(n.shape[s+r]!==e[s+a])throw new Error(i+" updates.shape[".concat(s+r,"] (").concat(n.shape[s+r],") != shape[").concat(s+r,"] (").concat(e[s+r],")"))}function Ek(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}Ck(n,t,e)}function _k(e,t,n){let a=t.shape.length,r=a>1?t.shape[a-1]:1,i=n.length,s=1;for(let l=r;l<i;++l)s*=n[l];let o=r<1?1:r;return{sliceRank:r,numUpdates:Wc(t.shape)/o,sliceSize:s,strides:[...hd(n.slice(0,r)),1],outputSize:Wc(n)}}ac(Tk,{calculateShapes:()=>_k,validateInput:()=>Ek,validateUpdateShape:()=>Ck});var Ak=Eg({tensorScatterUpdate_:function(e,t,n){let a=Ng(e,"tensor","tensorScatterupdate"),r=Ng(t,"indices","tensorScatterupdate","int32"),i=Ng(n,"updates","tensorScatterupdate");if(Ek(i,r,a.shape),a.dtype!==i.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(a.dtype," and ").concat(i.dtype,"."));let s={tensor:a,indices:r,updates:i};return fg.runKernel(rf,s,{})}});var Fk=Eg({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Ng(e,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");let r=a.shape[a.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>r)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(r,") but got ").concat(t));let i={x:a},s={k:t,sorted:n},[o,l]=fg.runKernel(Pf,i,s);return{values:o,indices:l}}});var Rk=Eg({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(vd(e),null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");let i=new Rw(t,n,a,!0,r),s=Zy(e,a);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}});var Dk=Eg({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ng(e,"x","unique","string_or_numeric");Lc(n.rank>0,()=>"The input tensor must be at least 1D");let a={x:n},r={axis:t},[i,s]=fg.runKernel(Bf,a,r);return{values:i,indices:s}}});var Mk=Eg({unsortedSegmentSum_:function(e,t,n){let a=Ng(e,"x","unsortedSegmentSum"),r=Ng(t,"segmentIds","unsortedSegmentSum","int32");Lc(Gc(n),()=>"numSegments must be of dtype int");let i={x:a,segmentIds:r},s={numSegments:n};return fg.runKernel(Vf,i,s)}});var Ok=Eg({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Ng(e,"x","unstack","string_or_numeric");Lc(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));let a={value:n},r={axis:t};return fg.runKernel(Wf,a,r)}});function Pk(e,t){return Lx(e,t,"right")}function Lk(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return fg.makeVariable(e,t,n,a)}function zk(e,t){let n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);let a=Zy(e,"int32"),r=Zy([n.length,e.length],"int32");for(let i=0;i<n.length;i++){let t=a.indexToLoc(n[i]),s=i*e.length;r.values.set(t,s)}return r.toTensor()}var Bk=async function(e){let t=Ng(e,"condition","whereAsync","bool"),n=await t.data(),a=zk(t.shape,n);return e!==t&&t.dispose(),a};var Wk=async function(e,t,n){let a=Ng(e,"tensor","boolMask"),r=Ng(t,"mask","boolMask","bool"),i=null==n?0:n,s=r.rank,o=a.shape;Lc(s>0,()=>"mask cannot be scalar"),zc(o.slice(i,i+s),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+s;m++)l*=o[m];let u=o.slice(0,i).concat([l],o.slice(i+s)),c=Mb(a,u),d=Mb(r,[-1]),h=await Bk(d),p=mk(h,[1]),f=ix(c,p,i);return e!==a&&a.dispose(),t!==r&&r.dispose(),p.dispose(),c.dispose(),d.dispose(),h.dispose(),f};var Vk=Eg({transpose_:function(e,t,n){let a=Ng(e,"x","transpose");if(null==t&&(t=a.shape.map((e,t)=>t).reverse()),Lc(a.rank===t.length,()=>"Error in transpose: rank of input ".concat(a.rank," must match length of perm ").concat(t,".")),t.forEach(e=>{Lc(e>=0&&e<a.rank,()=>"All entries in 'perm' must be between 0 and ".concat(a.rank-1," but got ").concat(t))}),a.rank<=1)return a.clone();let r={x:a},i={perm:t};return"complex64"===a.dtype?Ug(()=>{let e=Vw(a),t=lx(a);return e=fg.runKernel(zf,{x:e},i),t=fg.runKernel(zf,{x:t},i),n&&(t=Tx(t)),_g(e,t)}):fg.runKernel(zf,r,i)}});var Uk=Eg({movingAverage_:function(e,t,n,a){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Ng(e,"v","movingAverage"),s=Ng(t,"x","movingAverage"),o=Ng(n,"decay","movingAverage");sg(i,s),Lc(jc(i.shape,s.shape),()=>"Shape mismatch in v and x");let l=qv(1),u=_x(l,o),c=ib(_x(s,i),u);if(r){Lc(null!=a,()=>"When using zeroDebias: true, step is required.");let e=Ng(a,"step","movingAverage");c=rb(c,_x(l,Hv(o,e)))}return nb(i,c)}});var jk=Eg({scatterND_:function(e,t,n){vd(n);let a=Ng(e,"indices","scatterND","int32"),r=Ng(t,"updates","scatterND");Ek(r,a,n);let i={indices:a,updates:r},s={shape:n};return fg.runKernel(af,i,s)}});var Gk=Eg({sparseToDense_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;vd(n);let r=Ng(e,"sparseIndices","sparseToDense","int32"),i=Ng(t,"sparseValues","sparseToDense","string_or_numeric"),s=Ng(a,"defaultValue","sparseToDense",i.dtype);!function(e,t,n,a){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape ".concat(e.shape,"."));let r=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, ".concat(n.length,", should be: ").concat(i,"."));let s=t.size;if(0!==t.rank&&(1!==t.rank||s!==r))throw new Error("sparseValues has incorrect shape ".concat(t.shape,", should be [] or [").concat(r,"]"));if(t.dtype!==a.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,i,n,s);let o={sparseIndices:r,sparseValues:i,defaultValue:s},l={outputShape:n};return fg.runKernel(If,o,l)}});var Hk=Eg({gatherND_:function(e,t){let n=Ng(t,"indices","gatherND","int32"),a={params:Ng(e,"x","gatherND","string_or_numeric"),indices:n};return fg.runKernel(Gh,a)}});var qk=Eg({dropout_:function(e,t,n,a){let r=Ng(e,"x","dropout");if(Lc("float32"===r.dtype,()=>"x has to be a floating point tensor since it's going to be scaled, but got a ".concat(r.dtype," tensor instead.")),Lc(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof Gm?r.clone():r;let i=function(e,t){if(null==t)return e.shape.slice();if(jc(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let a=0;a<e.shape.length;a++)null==t[a]&&null!=e.shape[a]?n.push(e.shape[a]):n.push(t[a]);return n}return t}(r,n),s=1-t,o=rb(rx(nb(zw(i,0,1,"float32",a),s)),s);return ib(r,o)}});function Kk(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Xk(e,t,n){let a=1-e%2,r=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+a-1);r[i]=t-n*Math.cos(s)}return xk(r,"float32")}var Yk=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Ng(e,"predictions","inTopK"),r=Ng(t,"targets","inTopK");Lc(a.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got ".concat(a.rank)),Lc(a.rank-1===r.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank ".concat(a.rank," and targets rank ").concat(r.rank)),zc(a.shape.slice(0,a.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let i=a.shape[a.shape.length-1];Lc(n>0&&n<=i,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last dimension (".concat(i,"), but got ").concat(n));let s=await a.data(),o=await r.data(),[l,u]=[s.length/i,i],c=$c("bool",l);for(let d=0;d<l;d++){let e=d*u,t=s.subarray(e,e+u),a=[];for(let n=0;n<t.length;n++)a.push({value:t[n],index:n});a.sort((e,t)=>t.value-e.value),c[d]=0;for(let r=0;r<n;r++)if(a[r].index===o[d]){c[d]=1;break}}return e!==a&&a.dispose(),t!==r&&r.dispose(),Fg(c,r.shape,"bool")},Qk={};ac(Qk,{conv2d:()=>nS,depthwiseConv2d:()=>iS,matMul:()=>sS});var Jk=Eg({conv2DBackpropFilter_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Mb(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Lc(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape ".concat(o.shape,".")),Lc(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape ".concat(l.shape,".")),Lc(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got ".concat(n,"."));let u="NHWC"===i?o.shape[3]:o.shape[1],c="NHWC"===i?l.shape[3]:l.shape[1];Lc(u===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(u,") must match input depth in filter (").concat(n[2],".")),Lc(c===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(c,") must match output depth for filter (").concat(n[3],").")),Db("conv2dDerFilter",r,s);let d={x:o,dy:l},h={strides:a,pad:r,dataFormat:i,dimRoundingMode:s,filterShape:n};return fg.runKernel(lh,d,h)}});function Zk(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return ib(e,yk(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function $k(e,t){let n=t,a=Iv(e.shape,t.shape);return a.length>0&&(n=Yv(n,a)),Mb(n,e.shape)}function eS(e,t,n,a){if("linear"===t)return e;if("relu"===t)return jw(e);if("elu"===t)return Rv(e);if("relu6"===t)return Gw(e);if("prelu"===t)return cw(e,n);if("leakyrelu"===t)return hx(e,a);if("sigmoid"===t)return Bb(e);throw new Error("Unknown fused activation ".concat(t,"."))}var tS=(e,t)=>!(e>0)||"linear"===t;var nS=Eg({fusedConv2d_:function(e){let{x:t,filter:n,strides:a,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:l,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:d}=e;if(u=u||"linear",!1===tS(fg.state.gradientDepth,u)){Lc("NHWC"===i,()=>"Error in fused conv2d: got dataFormat of ".concat(i," but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let e=sv(t,n,a,r,i,s,o);return null!=l&&(e=nb(e,l)),eS(e,u,c,d)}let h=Ng(t,"x","conv2d","float32"),p=Ng(n,"filter","conv2d","float32"),f=h,m=!1;3===h.rank&&(m=!0,f=Mb(h,[1,h.shape[0],h.shape[1],h.shape[2]])),Lc(4===f.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank ".concat(f.rank,".")),Lc(4===p.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank ".concat(p.rank,".")),Db("fused conv2d",r,o);let g="NHWC"===i?f.shape[3]:f.shape[1];Lc(p.shape[2]===g,()=>"Error in conv2d: depth of input (".concat(g,") must match input depth for filter ").concat(p.shape[2],".")),Lc(Ab(a,s),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(s,"'"));let y,b,v=kb(f.shape,p.shape,a,s,r,o);if(null!=l&&(y=Ng(l,"bias","fused conv2d"),[y]=ig(y,h),"NHWC"===i?Nv(v.outShape,y.shape):(Lc(y.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-".concat(y.shape.length,".")),Lc(0===y.shape.length||y.shape[0]===v.outChannels||1===y.shape[0],()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not compatible with the number of output channels (").concat(v.outChannels,")")))),null!=c){let e=c.shape;if(Lc(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-".concat(e.length,".")),1===e.length)Lc(1===e[0]||e[0]===v.outChannels,()=>"Error in fused conv2d: PReLU activation weights (".concat(e,") is not compatible with the number of output channels (").concat(v.outChannels,")."));else if(3===e.length)try{Nv(e,v.outShape)}catch(S){let t="Error in fused conv2d: PReLU activation weights (".concat(e,") is not compatible with the output shape of the conv2d (").concat(v.outShape,").");throw Error(t)}b=Ng(c,"prelu weights","fused conv2d")}let x=(e,t)=>{Lc("NHWC"===i,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(i," but only NHWC is currently supported."));let[n,o,l,c]=t,d=Zk(e,l,u);Lc(_b(s),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(s,"'"));let h=[lv(o.shape,d,n,a,r),Jk(o,d,n.shape,a,r)];if(null!=c){let e=$k(c,d);h.push(e)}return h},w={x:f,filter:p,bias:y,preluActivationWeights:b},k={strides:a,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:d};return null==l?Ix((e,t,n)=>{let a=fg.runKernel(Xf,w,k);return n([t,e,a]),m&&(a=Mb(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:x}})(f,p):Ix((e,t,n,a)=>{let r=fg.runKernel(Xf,w,k);return a([t,e,r,n]),m&&(r=Mb(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}})(f,p,y)}});var aS=Eg({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Mb(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={x:o,dy:l},c={strides:a,pad:r,dimRoundingMode:s,dilations:i,filterShape:n};return fg.runKernel(wh,u,c)}});var rS=Eg({depthwiseConv2dNativeBackpropInput_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=t,l=!1;3===t.rank&&(l=!0,o=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={dy:o,filter:n},c={strides:a,pad:r,dimRoundingMode:s,dilations:i,inputShape:e},d=fg.runKernel(kh,u,c);return l?Mb(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var iS=Eg({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:a,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:l,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:d}=e;if(!1===tS(fg.state.gradientDepth,u)){let e=vv(t,n,a,r,i,s,o);return null!=l&&(e=nb(e,l)),eS(e,u,c,d)}let h=Ng(t,"x","depthwiseConv2d","float32"),p=Ng(n,"filter","depthwiseConv2d","float32"),f=h,m=!1;3===h.rank&&(m=!0,f=Mb(h,[1,h.shape[0],h.shape[1],h.shape[2]])),Lc(4===f.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got rank ".concat(f.rank,".")),Lc(4===p.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, but got rank ".concat(p.rank,".")),Lc(f.shape[3]===p.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels (".concat(f.shape[3],") must match the inChannels dimension in filter ").concat(p.shape[2],".")),null==s&&(s=[1,1]),Lc(Ab(a,s),()=>"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(s,"'")),Db("fused depthwiseConv2d",r,o);let g,y,b=kb(f.shape,p.shape,a,s,r,o,!0);null!=l&&(g=Ng(l,"bias","fused conv2d"),[g]=ig(g,h),Nv(b.outShape,g.shape)),null!=c&&(y=Ng(c,"prelu weights","fused depthwiseConv2d"));let v=(e,t)=>{Lc(_b(s),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '".concat(s,"'"));let[n,i,l,c]=t,d=Zk(e,l,u),h=rS(i.shape,d,n,a,r,s,o),p=aS(i,d,n.shape,a,r,s,o);if(null!=c){return[h,p,$k(g,d)]}return[h,p]},x={x:f,filter:p,bias:g,preluActivationWeights:y},w={strides:a,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:d};return null==l?Ix((e,t,n)=>{let a=fg.runKernel(Yf,x,w);return n([t,e,a]),m&&(a=Mb(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}})(f,p):Ix((e,t,n,a)=>{let r=fg.runKernel(Yf,x,w);return a([t,e,r,n]),m&&(r=Mb(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}})(f,p,g)}});var sS=Eg({fusedMatMul_:function(e){let{a:t,b:n,transposeA:a=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}=e;if(!1===tS(fg.state.gradientDepth,s)){let e=zb(t,n,a,r);return null!=i&&(e=nb(e,i)),eS(e,s,o,l)}let u=Ng(t,"a","fused matMul"),c=Ng(n,"b","fused matMul");[u,c]=ig(u,c);let d=a?u.shape[u.rank-2]:u.shape[u.rank-1],h=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=a?u.shape[u.rank-1]:u.shape[u.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],m=u.shape.slice(0,-2),g=c.shape.slice(0,-2),y=Wc(m),b=Wc(g);Lc(d===h,()=>"Error in fused matMul: inner shapes (".concat(d,") and (").concat(h,") of Tensors with shapes ").concat(u.shape," and ").concat(c.shape," and transposeA=").concat(a," and transposeB=").concat(r," must match."));let v,x,w=Nv(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,f]),k=Mb(u,a?[y,d,p]:[y,p,d]),S=Mb(c,r?[b,f,h]:[b,h,f]);null!=i&&(v=Ng(i,"bias","fused matMul"),[v]=ig(v,u),Nv(w,v.shape)),null!=o&&(x=Ng(o,"prelu weights","fused matMul"));let I=(e,t)=>{let n,o,[l,u,c,d]=t,h=Zk(Mb(e,c.shape),c,s);if(a||r?!a&&r?(n=zb(h,u,!1,!1),o=zb(h,l,!0,!1)):a&&!r?(n=zb(u,h,!1,!0),o=zb(l,h,!1,!1)):(n=zb(u,h,!0,!0),o=zb(h,l,!0,!0)):(n=zb(h,u,!1,!0),o=zb(l,h,!0,!1)),null!=i){return[n,o,$k(d,h)]}return[n,o]},N={a:k,b:S,bias:v,preluActivationWeights:x},T={transposeA:a,transposeB:r,activation:s,leakyreluAlpha:l};return null==i?Ix((e,t,n)=>{let a=fg.runKernel(Kf,N,T);return n([e,t,a]),{value:Mb(a,w),gradFunc:I}})(k,S):Ix((e,t,n,a)=>{let r=fg.runKernel(Kf,N,T);return a([e,t,r,n]),{value:Mb(r,w),gradFunc:I}})(k,S,v)}});var oS=Eg({hammingWindow_:function(e){return Xk(e,.54,.46)}});var lS=Eg({hannWindow_:function(e){return Xk(e,.5,.5)}});var uS=Eg({frame_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,s=[];for(;i+t<=e.size;)s.push(Wb(e,i,t)),i+=n;if(a)for(;i<e.size;){let a=i+t-e.size,o=Lb([Wb(e,i,t-a),ev([a],r)]);s.push(o),i+=n}return 0===s.length?wk([],[0,t]):Mb(Lb(s),[s.length,t])}});var cS=Eg({stft_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:lS;null==a&&(a=Kk(t));let i=uS(e,t,n),s=ib(i,r(t));return pk(s,a)}});var dS=Eg({cropAndResize_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=Ng(e,"image","cropAndResize"),o=Ng(t,"boxes","cropAndResize","float32"),l=Ng(n,"boxInd","cropAndResize","int32"),u=o.shape[0];Lc(4===s.rank,()=>"Error in cropAndResize: image must be rank 4,but got rank ".concat(s.rank,".")),Lc(2===o.rank&&4===o.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(u,",4] but had shape ").concat(o.shape,".")),Lc(1===l.rank&&l.shape[0]===u,()=>"Error in cropAndResize: boxInd must be have size [".concat(u,"] but had shape ").concat(o.shape,".")),Lc(2===a.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got length ".concat(a.length,".")),Lc(a[0]>=1&&a[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(a)),Lc("bilinear"===r||"nearest"===r,()=>"method must be bilinear or nearest, but was ".concat(r));let c={image:s,boxes:o,boxInd:l},d={method:r,extrapolationValue:i,cropSize:a};return fg.runKernel(yh,c,d)}});var hS=Eg({flipLeftRight_:function(e){let t=Ng(e,"image","flipLeftRight","float32");Lc(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,but got rank ".concat(t.rank,"."));let n={image:t};return fg.runKernel(Bh,n,{})}});var pS=Eg({grayscaleToRGB_:function(e){let t=Ng(e,"image","grayscaleToRGB"),n=t.rank-1,a=t.shape[n];Lc(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, but got rank ".concat(t.rank,".")),Lc(1===a,()=>"Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ".concat(a,"."));let r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,nx(t,r)}});var fS=Eg({rgbToGrayscale_:function(e){let t=Ng(e,"image","RGBToGrayscale"),n=t.rank-1,a=t.shape[n];Lc(t.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, but got rank ".concat(t.rank,".")),Lc(3===a,()=>"Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ".concat(a,"."));let r,i=t.dtype,s=$y(t,"float32"),o=xk([.2989,.587,.114]);switch(t.rank){case 2:r=Fv("ij,j->i",s,o);break;case 3:r=Fv("ijk,k->ij",s,o);break;case 4:r=Fv("ijkl,l->ijk",s,o);break;case 5:r=Fv("ijklm,m->ijkl",s,o);break;case 6:r=Fv("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return r=ex(r,-1),$y(r,i)}});var mS=Eg({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=Ng(e,"image","rotateWithOffset","float32");Lc(4===r.rank,()=>"Error in rotateWithOffset: image must be rank 4,but got rank ".concat(r.rank,"."));let i={image:r},s={radians:t,fillValue:n,center:a};return fg.runKernel(qf,i,s)}});function gS(e,t,n,a,r,i){null==a&&(a=.5),null==r&&(r=Number.NEGATIVE_INFINITY),null==i&&(i=0);let s=e.shape[0];return n=Math.min(n,s),Lc(0<=a&&a<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(a,"'")),Lc(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),Lc(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),Lc(1===t.rank,()=>"scores must be a 1D tensor"),Lc(t.shape[0]===s,()=>"scores has incompatible shape with boxes. Expected ".concat(s,", but was ").concat(t.shape[0])),Lc(0<=i&&i<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'")),{maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i}}var yS=Eg({nonMaxSuppression_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Ng(e,"boxes","nonMaxSuppression","float32"),s=Ng(t,"scores","nonMaxSuppression","float32"),o=gS(i,s,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:a,scoreThreshold:r};return fg.runKernel(Ap,{boxes:i,scores:s},l)}});function bS(e,t,n){let a=function(e,t,n){return function(e,t,n){let a=0,r=e.length,i=0,s=!1;for(;a<r;){i=a+(r-a>>>1);let o=n(t,e[i]);o>0?a=i+1:(r=i,s=!o)}return s?a:-a-1}(e,t,n||vS)}(e,t,n),r=a<0?-(a+1):a;e.splice(r,0,t)}function vS(e,t){return e>t?1:e<t?-1:0}function xS(e,t,n,a,r){return SS(e,t,n,a,r,0)}function wS(e,t,n,a,r,i){return SS(e,t,n,a,r,0,!1,i,!0)}function kS(e,t,n,a,r,i){return SS(e,t,n,a,r,i,!0)}function SS(e,t,n,a,r,i){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=[];for(let g=0;g<t.length;g++)t[g]>r&&u.push({score:t[g],boxIndex:g,suppressBeginIndex:0});u.sort(TS);let c=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&u.length>0;){let t=u.pop(),{score:n,boxIndex:i,suppressBeginIndex:s}=t;if(n<r)break;let o=!1;for(let l=d.length-1;l>=s;--l){let n=IS(e,i,d[l]);if(n>=a){o=!0;break}if(t.score=t.score*NS(a,c,n),t.score<=r)break}t.suppressBeginIndex=d.length,o||(t.score===n?(d.push(i),h.push(t.score)):t.score>r&&bS(u,t,TS))}let p=d.length,f=n-p;o&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));let m={selectedIndices:d};return s&&(m.selectedScores=h),l&&(m.validOutputs=p),m}function IS(e,t,n){let a=e.subarray(4*t,4*t+4),r=e.subarray(4*n,4*n+4),i=Math.min(a[0],a[2]),s=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),l=Math.max(a[1],a[3]),u=Math.min(r[0],r[2]),c=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),p=(o-i)*(l-s),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;let m=Math.max(i,u),g=Math.max(s,c),y=Math.min(o,d),b=Math.min(l,h),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(p+f-v)}function NS(e,t,n){let a=Math.exp(t*n*n);return n<=e?a:0}function TS(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}var CS=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Ng(e,"boxes","nonMaxSuppressionAsync"),s=Ng(t,"scores","nonMaxSuppressionAsync"),o=gS(i,s,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),u=l[0],c=l[1],{selectedIndices:d}=xS(u,c,n,a,r);return i!==e&&i.dispose(),s!==t&&s.dispose(),xk(d,"int32")};var ES=Eg({nonMaxSuppressionWithScore_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=Ng(e,"boxes","nonMaxSuppression"),o=Ng(t,"scores","nonMaxSuppression"),l=gS(s,o,n,a,r,i);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;let u={boxes:s,scores:o},c={maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i},d=fg.runKernel(Rp,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}});var _S=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=Ng(e,"boxes","nonMaxSuppressionAsync"),o=Ng(t,"scores","nonMaxSuppressionAsync"),l=gS(s,o,n,a,r,i);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;let u=await Promise.all([s.data(),o.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=kS(c,d,n,a,r,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:xk(h,"int32"),selectedScores:xk(p)}};var AS=Eg({nonMaxSuppressionPadded_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=Ng(e,"boxes","nonMaxSuppression"),o=Ng(t,"scores","nonMaxSuppression"),l=gS(s,o,n,a,r,null),u={boxes:s,scores:o},c={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:i},d=fg.runKernel(Fp,u,c);return{selectedIndices:d[0],validOutputs:d[1]}}});var FS=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=Ng(e,"boxes","nonMaxSuppressionAsync"),o=Ng(t,"scores","nonMaxSuppressionAsync"),l=gS(s,o,n,a,r,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=wS(h,p,u,c,d,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:xk(f,"int32"),validOutputs:qv(m,"int32")}};var RS=Eg({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Ng(e,"images","resizeBilinear");Lc(3===r.rank||4===r.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got rank ".concat(r.rank,".")),Lc(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape ".concat(t,".")),Lc(!1===a||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,s=!1;3===r.rank&&(s=!0,i=Mb(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:i},l={alignCorners:n,halfPixelCenters:a,size:t},u=fg.runKernel(Jp,o,l);return s?Mb(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var DS=Eg({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Ng(e,"images","resizeNearestNeighbor");Lc(3===r.rank||4===r.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ".concat(r.rank,".")),Lc(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape ".concat(t,".")),Lc("float32"===r.dtype||"int32"===r.dtype,()=>"`images` must have `int32` or `float32` as dtype"),Lc(!1===a||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,s=!1;3===r.rank&&(s=!0,i=Mb(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:i},l={alignCorners:n,halfPixelCenters:a,size:t},u=fg.runKernel(Yp,o,l);return s?Mb(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var MS=Eg({threshold_:function(e){let t,n,a,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,l=Ng(e,"image","threshold"),u=l.shape[0]*l.shape[1],c=ib(xk([o]),255);if(Lc(3===l.rank,()=>"Error in threshold: image must be rank 3,but got rank ".concat(l.rank,".")),Lc(3===l.shape[2]||1===l.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1but got ".concat(l.shape[2],".")),Lc("int32"===l.dtype||"float32"===l.dtype,()=>"Error in dtype: image dtype must be int32 or float32,but got dtype ".concat(l.dtype,".")),Lc("otsu"===i||"binary"===i,()=>"Method must be binary or otsu, but was ".concat(i)),3===l.shape[2]){[t,n,a]=hk(l,[1,1,1],-1);let e=ib(t,.2989),i=ib(n,.587),s=ib(a,.114);r=nb(nb(e,i),s)}else r=e;if("otsu"===i){c=function(e,t){let n,a,r,i,s,o,l=xk([-1]),u=xk([0]),c=xk([0]);for(let d=0;d<e.size-1;d++){n=Wb(e,0,d+1),a=Wb(e,d+1),s=rb(Yv(n),t),o=rb(Yv(a),t);let h=Yv(ib(n,Ww(0,n.size)));r=rb(h,Yv(n));let p=ev(a.shape,n.size),f=nb(Ww(0,a.size),p),m=ib(a,f);i=rb(Yv(m),Yv(a));let g=_x(r,i),y=_x(r,i),b=ib(s,o);c=ib(ib(b,g),y);let v=sx(c,u);u=Cv(v,c,u),l=Cv(v,xk([d]),l)}return l}(Yb($y(Qw(r),"int32"),Fg([]),256),u)}let d=s?fx(r,c):sx(r,c);return $y(ib(d,255),"int32")}});var OS=Eg({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,s=Ng(e,"image","transform","float32"),o=Ng(t,"transforms","transform","float32");Lc(4===s.rank,()=>"Error in transform: image must be rank 4,but got rank ".concat(s.rank,".")),Lc(2===o.rank&&(o.shape[0]===s.shape[0]||1===o.shape[0])&&8===o.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Lc(null==i||2===i.length,()=>"Error in transform: outputShape must be [height, width] or null, but got ".concat(i,"."));let l={image:s,transforms:o},u={interpolation:n,fillMode:a,fillValue:r,outputShape:i};return fg.runKernel(Lf,l,u)}});var PS=Eg({bandPart_:function(e,t,n){let a=Ng(e,"a","bandPart");Lc(a.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(a.rank,"."));let r,i,s=a.shape,[o,l]=a.shape.slice(-2);"number"==typeof t?(Lc(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),Lc(t<=o,()=>"bandPart(): numLower (".concat(t,") must not be greater than the number of rows (").concat(o,").")),r=Ng(t<0?o:t,"numLower","bandPart")):(Lc("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),r=Cv(px(t,0),o,Kx(t,o))),"number"==typeof n?(Lc(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),Lc(n<=l,()=>"bandPart(): numUpper (".concat(n,") must not be greater than the number of columns (").concat(l,").")),i=Ng(n<0?l:n,"numUpper","bandPart")):(Lc("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),i=Cv(px(n,0),l,Kx(n,l)));let u=Mb(Ww(0,o,1,"int32"),[-1,1]),c=Ww(0,l,1,"int32"),d=_x(u,c),h=Rx(fx(d,r),ox(d,Tx(i))),p=Gx([o,l],a.dtype);return Mb(gk(Ok(Mb(a,[-1,o,l])).map(e=>Cv(h,e,p))),s)}});var LS=Eg({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,Lc(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let n=e[0].shape[0];for(let t=1;t<e.length;++t)Lc(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: (".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=hk(e,e.shape[0],0).map(e=>mk(e,[0]));Lc(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds number of dimensions (").concat(e[0].shape[0],")."));let n=[],a=e;for(let r=0;r<e.length;++r)n.push(fg.tidy(()=>{let e=a[r];if(r>0)for(let t=0;t<r;++t){let a=ib(Yv(ib(n[t],e)),n[t]);e=_x(e,a)}return rb(e,Jv(e,"euclidean"))}));return t?gk(n,0):n}});function zS(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return fg.tidy(()=>{Lc(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));let n=e.shape[0],a=e.shape[1],r=ax(n),i=eb(e),s=wk([[1]],[1,1]),o=eb(s),l=n>=a?a:n;for(let e=0;e<l;++e){let t=i,l=o,u=r;[o,i,r]=fg.tidy(()=>{let t=Wb(i,[e,e],[n-e,1]),l=Jv(t),u=Wb(i,[e,e],[1,1]),c=Cv(sx(u,0),wk([[-1]]),wk([[1]])),d=_x(u,ib(c,l)),h=rb(t,d);o=1===h.shape[0]?eb(s):Lb([s,Wb(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);let p=Tx(rb(zb(c,d),l)),f=Wb(i,[e,0],[n-e,a]),m=ib(p,o),g=Vk(o);if(0===e)i=_x(f,zb(m,zb(g,f)));else{let t=_x(f,zb(m,zb(g,f)));i=Lb([Wb(i,[0,0],[e,a]),t],0)}let y=Vk(m),b=Wb(r,[0,e],[n,r.shape[1]-e]);if(0===e)r=_x(b,zb(zb(b,o),y));else{let t=_x(b,zb(zb(b,o),y));r=Lb([Wb(r,[0,0],[n,e]),t],1)}return[o,i,r]}),jg([t,l,u])}return!t&&n>a&&(r=Wb(r,[0,0],[n,a]),i=Wb(i,[0,0],[a,a])),[r,i]})}var BS,WS=Eg({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Lc(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return zS(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),a=Ok(Mb(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],i=[];return a.forEach(e=>{let[n,a]=zS(e,t);r.push(n),i.push(a)}),[Mb(gk(r,0),e.shape),Mb(gk(i,0),e.shape)]}}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(BS||(BS={}));var VS=Eg({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:BS.SUM_BY_NONZERO_WEIGHTS,a=Ng(e,"losses","computeWeightedLoss"),r=null;null!=t&&(r=Ng(t,"weights","computeWeightedLoss"));let i=null==r?a:ib(a,r);if(n===BS.NONE)return i;if(n===BS.SUM)return Yv(i);if(n===BS.MEAN){if(null==r)return jx(i);{let e=a.size/r.size,t=rb(Yv(i),Yv(r));return e>1?rb(t,qv(e)):t}}if(n===BS.SUM_BY_NONZERO_WEIGHTS){if(null==r)return rb(Yv(i),qv(a.size));{let e=ib(r,Hx(a.shape)),t=$y(Yv($x(e,qv(0))),"float32");return rb(Yv(i),t)}}throw Error("Unknown reduction: ".concat(n))}});var US=Eg({absoluteDifference_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BS.SUM_BY_NONZERO_WEIGHTS,r=Ng(e,"labels","absoluteDifference"),i=Ng(t,"predictions","absoluteDifference"),s=null;null!=n&&(s=Ng(n,"weights","absoluteDifference")),zc(r.shape,i.shape,"Error in absoluteDifference: ");let o=sb(_x(r,i));return VS(o,s,a)}});var jS=Eg({cosineDistance_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:BS.SUM_BY_NONZERO_WEIGHTS,i=Ng(e,"labels","cosineDistance"),s=Ng(t,"predictions","cosineDistance"),o=null;null!=a&&(o=Ng(a,"weights","cosineDistance")),zc(i.shape,s.shape,"Error in cosineDistance: ");let l=qv(1),u=_x(l,Yv(ib(i,s),n,!0));return VS(u,o,r)}});var GS=Eg({hingeLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BS.SUM_BY_NONZERO_WEIGHTS,r=Ng(e,"labels","hingeLoss"),i=Ng(t,"predictions","hingeLoss"),s=null;null!=n&&(s=Ng(n,"weights","hingeLoss")),zc(r.shape,i.shape,"Error in hingeLoss: ");let o=qv(1);r=_x(ib(qv(2),r),o);let l=jw(_x(o,ib(r,i)));return VS(l,s,a)}});var HS=Eg({huberLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:BS.SUM_BY_NONZERO_WEIGHTS,i=Ng(e,"labels","huberLoss"),s=Ng(t,"predictions","huberLoss"),o=null;null!=n&&(o=Ng(n,"weights","huberLoss")),zc(i.shape,s.shape,"Error in huberLoss: ");let l=qv(a),u=sb(_x(s,i)),c=Kx(u,l),d=_x(u,c),h=nb(ib(qv(.5),Xv(c)),ib(l,d));return VS(h,o,r)}});var qS=Eg({logLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:BS.SUM_BY_NONZERO_WEIGHTS,i=Ng(e,"labels","logLoss"),s=Ng(t,"predictions","logLoss"),o=null;null!=n&&(o=Ng(n,"weights","logLoss")),zc(i.shape,s.shape,"Error in logLoss: ");let l=qv(1),u=qv(a),c=Tx(ib(i,yx(nb(s,u)))),d=ib(_x(l,i),yx(nb(_x(l,s),u))),h=_x(c,d);return VS(h,o,r)}});var KS=Eg({meanSquaredError_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BS.SUM_BY_NONZERO_WEIGHTS,r=Ng(e,"labels","meanSquaredError"),i=Ng(t,"predictions","meanSquaredError"),s=null;null!=n&&(s=Ng(n,"weights","meanSquaredError")),zc(r.shape,i.shape,"Error in meanSquaredError: ");let o=fk(r,i);return VS(o,s,a)}});var XS=Eg({sigmoidCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:BS.SUM_BY_NONZERO_WEIGHTS,i=Ng(e,"multiClassLabels","sigmoidCrossEntropy"),s=Ng(t,"logits","sigmoidCrossEntropy"),o=null;if(null!=n&&(o=Ng(n,"weights","sigmoidCrossEntropy")),zc(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),a>0){let e=qv(a),t=qv(1),n=qv(.5);i=nb(ib(i,_x(t,e)),ib(n,e))}let l=function(e,t){let n=Ng(e,"labels","sigmoidCrossEntropyWithLogits"),a=Ng(t,"logits","sigmoidCrossEntropyWithLogits");zc(n.shape,a.shape,"Error in sigmoidCrossEntropyWithLogits: ");let r=jw(a),i=ib(a,n),s=bx($v(Tx(sb(a))));return nb(_x(r,i),s)}(i,s);return VS(l,o,r)}});var YS=Eg({softmaxCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:BS.SUM_BY_NONZERO_WEIGHTS,i=Ng(e,"onehotLabels","softmaxCrossEntropy"),s=Ng(t,"logits","softmaxCrossEntropy"),o=null;if(null!=n&&(o=Ng(n,"weights","softmaxCrossEntropy")),zc(i.shape,s.shape,"Error in softmaxCrossEntropy: "),a>0){let e=qv(a),t=qv(1),n=qv(i.shape[1]);i=nb(ib(i,_x(t,e)),rb(e,n))}let l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ".concat(t.rank," and dim was ").concat(n));return Ix((e,t,a)=>{let r=Fx(t,[n],!0),i=_x($y(t,"float32"),r);a([e,i]);let s=Tx(ib(i,e));return{value:Yv(s,[n]),gradFunc:(e,t)=>{let[a,r]=t,i=zv(e.shape,[n]);return[ib(Mb(e,i),_x($y(a,"float32"),$v(r))),ib(Mb(e,i),_x($v(r),$y(a,"float32")))]}}})(e,t)}(i,s);return VS(l,o,r)}});var QS=Eg({sparseFillEmptyRows_:function(e,t,n,a){let r=Ng(e,"indices","sparseFillEmptyRows","int32"),i=Ng(t,"values","sparseFillEmptyRows"),s=Ng(n,"denseShape","sparseFillEmptyRows","int32"),o=Ng(a,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==r.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==s.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(s.shape));if(0!==o.rank)throw new Error("Default value should be a scalar but received shape ".concat(o.shape));let l={indices:r,values:i,denseShape:s,defaultValue:o},u=fg.runKernel(xf,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}});var JS=Eg({sparseReshape_:function(e,t,n){let a=Ng(e,"inputIndices","sparseReshape","int32"),r=Ng(t,"inputShape","sparseReshape","int32"),i=Ng(n,"newShape","sparseReshape","int32");if(2!==a.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==r.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(r.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));let s={inputIndices:a,inputShape:r,newShape:i},o=fg.runKernel(wf,s);return{outputIndices:o[0],outputShape:o[1]}}});var ZS=Eg({sparseSegmentMean_:function(e,t,n){let a=Ng(e,"data","sparseSegmentMean"),r=Ng(t,"indices","sparseSegmentMean","int32"),i=Ng(n,"segmentIds","sparseSegmentMean","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(r.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));let s={data:a,indices:r,segmentIds:i};return fg.runKernel(kf,s)}});var $S=Eg({sparseSegmentSum_:function(e,t,n){let a=Ng(e,"data","sparseSegmentSum"),r=Ng(t,"indices","sparseSegmentSum","int32"),i=Ng(n,"segmentIds","sparseSegmentSum","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(r.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));let s={data:a,indices:r,segmentIds:i};return fg.runKernel(Sf,s)}});var eI=Eg({stringNGrams_:function(e,t,n,a,r,i,s,o){let l=Ng(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error("Data must be a vector, saw: ".concat(l.shape));let u=Ng(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");let c={separator:n,nGramWidths:a,leftPad:r,rightPad:i,padWidth:s,preserveShortSequences:o},d={data:l,dataSplits:u},h=fg.runKernel(_f,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}});var tI=Eg({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Ng(e,"input","stringSplit","string"),r=Ng(t,"delimiter","stringSplit","string");if(1!==a.rank)throw new Error("Input should be Tensor1D but received shape ".concat(a.shape));if(0!==r.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(r.shape));let i={skipEmpty:n},s={input:a,delimiter:r},o=fg.runKernel(Af,s,i);return{indices:o[0],values:o[1],shape:o[2]}}});var nI=Eg({stringToHashBucketFast_:function(e,t){let n=Ng(e,"input","stringToHashBucketFast","string"),a={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let r={input:n};return fg.runKernel(Ff,r,a)}});var aI=Eg({staticRegexReplace_:function(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=Ng(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:a};return fg.runKernel(Cf,{x:r},i)}}),rI={fft:uk,ifft:ck,rfft:pk,irfft:dk},iI={hammingWindow:oS,hannWindow:lS,frame:uS,stft:cS},sI={flipLeftRight:hS,grayscaleToRGB:pS,resizeNearestNeighbor:DS,resizeBilinear:RS,rgbToGrayscale:fS,rotateWithOffset:mS,cropAndResize:dS,nonMaxSuppression:yS,nonMaxSuppressionAsync:CS,nonMaxSuppressionWithScore:ES,nonMaxSuppressionWithScoreAsync:_S,nonMaxSuppressionPadded:AS,nonMaxSuppressionPaddedAsync:FS,threshold:MS,transform:OS},oI={bandPart:PS,gramSchmidt:LS,qr:WS},lI={absoluteDifference:US,computeWeightedLoss:VS,cosineDistance:jS,hingeLoss:GS,huberLoss:HS,logLoss:qS,meanSquaredError:KS,sigmoidCrossEntropy:XS,softmaxCrossEntropy:YS},uI={sparseFillEmptyRows:QS,sparseReshape:JS,sparseSegmentMean:ZS,sparseSegmentSum:$S},cI={stringNGrams:eI,stringSplit:tI,stringToHashBucketFast:nI,staticRegexReplace:aI},dI={};ac(dI,{Serializable:()=>fI,SerializationMap:()=>mI,getRegisteredName:()=>yI,registerClass:()=>gI});var hI=new Map,pI=new Map,fI=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},mI=class e{constructor(){this.classNameMap={}}static getMap(){return null==e.instance&&(e.instance=new e),e.instance}static register(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function gI(e,t,n){Lc(null!=e.className,()=>"Class being registered does not have the static className property defined."),Lc("string"==typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),Lc(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),"undefined"==typeof t&&(t="Custom"),"undefined"==typeof n&&(n=e.className);let a=t+">"+n;return mI.register(e),hI.set(a,e),pI.set(e,a),e}function yI(e){return pI.has(e)?pI.get(e):e.className}var bI=class extends fI{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,{value:a,grads:r}=this.computeGradients(e,n);if(null!=n){let e=n.map(e=>({name:e.name,tensor:r[e.name]}));this.applyGradients(e)}else this.applyGradients(r);return jg(r),t?a:(a.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return Sx(e,t)}dispose(){null!=this.iterations_&&jg(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:qv(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class ".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(bI,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});var vI=class extends bI{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=fg.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=fg.registeredVariables[t],r=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:Ug(()=>Ev(a).variable(r))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:Ug(()=>Ev(a).variable(r))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;Ug(()=>{let e=nb(ib(s,this.rho),ib(Xv(i),1-this.rho)),t=ib(rb(Kv(nb(o,this.epsilon)),Kv(nb(s,this.epsilon))),i),n=nb(ib(o,this.rho),ib(Xv(t),1-this.rho));s.assign(e),o.assign(n);let r=nb(ib(t,-this.learningRate),a);a.assign(r)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(jg(this.accumulatedGrads.map(e=>e.variable)),jg(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){let t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},xI=class extends bI{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=fg.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:Ug(()=>ev(a.shape,this.initialAccumulatorValue).variable(!1))});let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let i=this.accumulatedGrads[n].variable;Ug(()=>{let e=nb(i,Xv(r));i.assign(e);let t=nb(ib(rb(r,Kv(nb(e,fg.backend.epsilon()))),-this.learningRate),a);a.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&jg(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},wI=class extends bI{static get className(){return"Adam"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ug(()=>{this.accBeta1=qv(t).variable(),this.accBeta2=qv(n).variable()}),null==a&&(this.epsilon=fg.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);Ug(()=>{let n=_x(1,this.accBeta1),a=_x(1,this.accBeta2);t.forEach((t,r)=>{let i=fg.registeredVariables[t],s=!1;null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:Ug(()=>Ev(i).variable(s))}),null==this.accumulatedSecondMoment[r]&&(this.accumulatedSecondMoment[r]={originalName:"".concat(t,"/v"),variable:Ug(()=>Ev(i).variable(s))});let o=Array.isArray(e)?e[r].tensor:e[t];if(null==o)return;let l=this.accumulatedFirstMoment[r].variable,u=this.accumulatedSecondMoment[r].variable,c=nb(ib(l,this.beta1),ib(o,1-this.beta1)),d=nb(ib(u,this.beta2),ib(Xv(o),1-this.beta2)),h=rb(c,n),p=rb(d,a);l.assign(c),u.assign(d);let f=nb(ib(rb(h,nb(Kv(p),this.epsilon)),-this.learningRate),i);i.assign(f)}),this.accBeta1.assign(ib(this.accBeta1,this.beta1)),this.accBeta2.assign(ib(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&jg(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&jg(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),Ug(()=>{this.accBeta1.assign(Hv(this.beta1,this.iterations_+1)),this.accBeta2.assign(Hv(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},kI=class extends bI{static get className(){return"Adamax"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ug(()=>{this.iteration=qv(0).variable(),this.accBeta1=qv(t).variable()}),null==a&&(this.epsilon=fg.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);Ug(()=>{let n=_x(1,this.accBeta1),a=rb(-this.learningRate,nb(ib(this.iteration,this.decay),1));t.forEach((t,r)=>{let i=fg.registeredVariables[t],s=!1;null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:Ev(i).variable(s)}),null==this.accumulatedWeightedInfNorm[r]&&(this.accumulatedWeightedInfNorm[r]={originalName:"".concat(t,"/v"),variable:Ev(i).variable(s)});let o=Array.isArray(e)?e[r].tensor:e[t];if(null==o)return;let l=this.accumulatedFirstMoment[r].variable,u=this.accumulatedWeightedInfNorm[r].variable,c=nb(ib(l,this.beta1),ib(o,1-this.beta1)),d=ib(u,this.beta2),h=sb(o),p=Ux(d,h);l.assign(c),u.assign(p);let f=nb(ib(rb(a,n),rb(c,nb(p,this.epsilon))),i);i.assign(f)}),this.iteration.assign(nb(this.iteration,1)),this.accBeta1.assign(ib(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&jg(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&jg(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},SI=class extends bI{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let r=fg.registeredVariables[t];Ug(()=>{let e=nb(ib(this.c,a),r);r.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Gg(qv(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},II=class extends SI{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=qv(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=fg.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:Ug(()=>Ev(a).variable(!1))});let r=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&Ug(()=>{let e,t=nb(ib(this.m,r),i);e=this.useNesterov?nb(ib(this.c,nb(i,ib(t,this.m))),a):nb(ib(this.c,t),a),r.assign(t),a.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&jg(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},NI=class extends bI{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==a&&(this.epsilon=fg.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=fg.registeredVariables[t],r=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:Ug(()=>Ev(a).variable(r))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:Ug(()=>Ev(a).variable(r))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:Ug(()=>Ev(a).variable(r))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;Ug(()=>{let e=nb(ib(s,this.decay),ib(Xv(i),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,r=nb(ib(t,this.decay),ib(i,1-this.decay)),l=rb(ib(i,this.learningRate),Kv(_x(e,nb(Xv(r),this.epsilon)))),u=nb(ib(o,this.momentum),l);s.assign(e),t.assign(r),o.assign(u);let c=_x(a,u);a.assign(c)}else{let e=nb(ib(s,this.decay),ib(Xv(i),1-this.decay)),t=nb(ib(o,this.momentum),rb(ib(i,this.learningRate),Kv(nb(e,this.epsilon))));s.assign(e),o.assign(t);let n=_x(a,t);a.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&jg(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&jg(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&jg(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},TI=[vI,xI,wI,kI,II,NI,SI];var CI={};ac(CI,{CompositeArrayBuffer:()=>Dg,browserFiles:()=>FI,browserHTTPRequest:()=>WI,concatenateArrayBuffers:()=>dy,copyModel:()=>Xy,decodeWeights:()=>ny,decodeWeightsStream:()=>oy,encodeWeights:()=>ty,fromMemory:()=>GI,fromMemorySync:()=>HI,getLoadHandlers:()=>ky,getModelArtifactsForJSON:()=>my,getModelArtifactsForJSONSync:()=>fy,getModelArtifactsInfoForJSON:()=>gy,getSaveHandlers:()=>wy,getWeightSpecs:()=>yy,http:()=>BI,isHTTPScheme:()=>LI,listModels:()=>qy,loadWeights:()=>MI,moveModel:()=>Yy,registerLoadRouter:()=>xy,registerSaveRouter:()=>vy,removeModel:()=>Ky,weightsLoaderFactory:()=>OI,withSaveHandler:()=>qI,withSaveHandlerSync:()=>KI});function EI(e){return new Promise(e=>setTimeout(e)).then(e)}var _I=class e{constructor(t){if(!Td().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),(null==t||0===t.length)&&(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=Dg.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let t=py(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),a=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),r=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(r.download=this.modelJsonFileName,r.href=a,await EI(()=>r.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){let e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await EI(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:gy(e)}}}};_I.URL_SCHEME="downloads://";var AI=class{constructor(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=n=>{let a=JSON.parse(n.target.result),r=a.modelTopology;if(null==r)return void t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==a.weightsManifest)return void t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void e({modelTopology:r});let i=my(a,e=>this.loadWeights(e));e(i)},n.onerror=e=>t("Failed to read model topology and weights manifest JSON from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let i of e)t.push(...i.weights),n.push(...i.paths);let a=this.checkManifestAndWeightFiles(e),r=n.map(e=>this.loadWeightsFile(e,a[e]));return Promise.all(r).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,a)=>{let r=new FileReader;r.onload=e=>{let t=e.target.result;n(t)},r.onerror=t=>a("Failed to weights data from file of path '".concat(e,"'.")),r.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(e=>hy(e.name)),a={};for(let r of e)r.paths.forEach(e=>{let r=hy(e);if(-1!==t.indexOf(r))throw new Error("Duplicate file basename found in weights manifest: '".concat(r,"'"));if(t.push(r),-1===n.indexOf(r))throw new Error("Weight file with basename '".concat(r,"' is not provided."));a[e]=this.weightsFiles[n.indexOf(r)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest (".concat(t.length,") and the number of weight files provided (").concat(this.weightsFiles.length,")."));return a}};function FI(e){return new AI(e)}function RI(e,t,n,a){var r;Lc(null!=(r=e)&&Array.isArray(r)&&r.length>0,()=>"promises must be a none empty array"),function(e,t){Lc(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction ".concat(e)),Lc(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction ".concat(t)),Lc(t>=e,()=>"startFraction must be no more than endFraction, but got startFraction ".concat(e," and endFraction ").concat(t))}(n=null==n?0:n,a=null==a?1:a);let i=0;return Promise.all(e.map(r=>(r.then(r=>{let s=n+ ++i/e.length*(a-n);return t(s),r}),r)))}async function DI(e,t){null==t&&(t={});let n=null==t.fetchFunc?Td().platform.fetch:t.fetchFunc,a=e.map(e=>n(e,t.requestInit,{isBinary:!0})),r=(null==t.onProgress?await Promise.all(a):await RI(a,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(r):await RI(r,t.onProgress,.5,1)}async function MI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return OI(e=>DI(e,{requestInit:a}))(e,t,n)}function OI(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,r=t.map(()=>!1),i={},s=null!=a?a.map(()=>!1):[],o=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{let l="quantization"in e?e.quantization.dtype:e.dtype,u=Rg[l]*Wc(e.shape),c=()=>{r[t]=!0,null==i[t]&&(i[t]=[]),i[t].push({manifestEntry:e,groupOffset:n,sizeBytes:u})};null!=a?a.forEach((t,n)=>{t===e.name&&(c(),s[n]=!0)}):c(),o.push(e.name),n+=u})}),!s.every(e=>e)){let e=a.filter((e,t)=>!s[t]);throw new Error("Could not find weights in manifest with names: ".concat(e.join(", "),". \nManifest JSON has weights with names: ").concat(o.join(", "),"."))}let l=r.reduce((e,t,n)=>(t&&e.push(n),e),[]),u=[];l.forEach(e=>{t[e].paths.forEach(e=>{let t=n+(n.endsWith("/")?"":"/")+e;u.push(t)})});let c=await e(u),d={},h=0;return l.forEach(e=>{let n=t[e].paths.length,a=new Dg(c.slice(h,h+n));i[e].forEach(e=>{let t=ny(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(let n in t)d[n]=t[n]}),h+=n}),d}}by.registerSaveRouter(e=>Td().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(_I.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new _I(e)}(e.slice(_I.URL_SCHEME.length)):null);var PI=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(Lc("function"==typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Td().platform.fetch,Lc(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Lc(2===e.length,()=>"URL paths for http must have a length of 2, (actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=py(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){let n=Dg.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:gy(e),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status ".concat(a.status,"."))}async loadModelJSON(){let e,t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ").concat(t.status,". Please verify this URL points to the model JSON of the model to load."));try{e=await t.json()}catch(i9){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}let n=e.modelTopology,a=e.weightsManifest;if(null==n&&null==a)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model topology or manifest for weights."));return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return my(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=yy(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;let a,r=null==t.fetchFunc?Td().platform.fetch:t.fetchFunc,i=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var s;i<e.length;){a||(a=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader());let{done:o,value:l}=await a.read();if(!o)return void n.enqueue(l);i++,a=void 0,null===(s=t.onProgress)||void 0===s||s.call(t,i/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,a]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),a=e.substring(0,t),r=n>t?e.substring(n):"";return[a+"/",r]}(t),r=this.weightPathPrefix||n,i=[],s=[];for(let o of e)for(let e of o.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(e)):i.push(r+e+a);return this.weightUrlConverter&&i.push(...await Promise.all(s)),i}async loadWeights(e){let t=await this.getWeightUrls(e);return[yy(e),await DI(t,this.loadOptions)]}};function LI(e){return null!=e.match(PI.URL_SCHEME_REGEX)}PI.URL_SCHEME_REGEX=/^https?:\/\//;var zI=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>LI(e)):LI(e),n)return BI(e,t)}return null};function BI(e,t){return new PI(e,t)}function WI(e,t){return BI(e,t)}by.registerSaveRouter(zI),by.registerLoadRouter(zI);var VI=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},UI=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},jI=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function GI(e,t,n,a){return new jI(HI(...arguments))}function HI(e,t,n,a){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new VI(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new VI({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new VI({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a}))}function qI(e){return new UI(e)}function KI(e){return new UI(e)}var XI={};ac(XI,{confusionMatrix:()=>YI});var YI=Eg({confusionMatrix_:function(e,t,n){let a=Ng(e,"labels","confusionMatrix"),r=Ng(t,"predictions","confusionMatrix");Lc(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got ".concat(n)),Lc(1===a.rank,()=>"Expected the rank of labels to be 1, but got ".concat(a.rank)),Lc(1===r.rank,()=>"Expected the rank of predictions to be 1, but got ".concat(r.rank)),Lc(a.shape[0]===r.shape[0],()=>"Mismatch in the number of examples: ".concat(a.shape[0]," vs. ").concat(r.shape[0],". Labels and predictions should have the same number of elements.")),Lc(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got ".concat(n));let i=ew($y(a,"int32"),n),s=ew($y(r,"int32"),n),o=Vk(i),l=zb(o,s);return $y(l,"int32")}}),QI={};ac(QI,{draw:()=>rN,fromPixels:()=>iN,fromPixelsAsync:()=>tN,toPixels:()=>aN});var JI,ZI=!1;function $I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,a=!1,r=!1,i=!1,s=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)a=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)r=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)s=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ".concat(e.constructor.name));o=!0}if(null!=em(Hf,fg.backendName)){let n={pixels:e},a={numChannels:t};return fg.runKernel(Hf,n,a)}let l,u,[c,d]=r?[e.videoWidth,e.videoHeight]:[e.width,e.height];if(s)l=e.getContext("2d").getImageData(0,0,c,d).data;else if(a||n)l=e.data;else if(i||r||o){if(null==JI)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");JI=new OffscreenCanvas(1,1).getContext("2d")}else JI=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});JI.canvas.width=c,JI.canvas.height=d,JI.drawImage(e,0,0,c,d),l=JI.getImageData(0,0,c,d).data}if(4===t)u=new Int32Array(l);else{let e=c*d;u=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)u[n*t+e]=l[4*n+e]}return kk(u,[d,c,t],"int32")}function eN(e){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}async function tN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=null;if(Td().getBool("WRAP_TO_IMAGEBITMAP")&&eN(e)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(i9){t=null}n=null!=t&&t.width===e.width&&t.height===e.height?t:e}else n=e;return $I(n,t)}function nN(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));let t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,". Please use float32 or int32 tensors."))}async function aN(e,t){let n=Ng(e,"img","toPixels");if(!(e instanceof Gm)){let e=n;n=$y(e,"int32"),e.dispose()}nN(n);let[a,r]=n.shape.slice(0,2),i=2===n.rank?1:n.shape[2],s=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(r*a*4);for(let u=0;u<a*r;++u){let e=[0,0,0,255];for(let a=0;a<i;a++){let t=s[u*i+a];if("float32"===n.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===n.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(t,"."));1===i?(e[0]=t*o,e[1]=t*o,e[2]=t*o):e[a]=t*o}let t=4*u;l[t+0]=Math.round(e[0]),l[t+1]=Math.round(e[1]),l[t+2]=Math.round(e[2]),l[t+3]=Math.round(e[3])}if(null!=t){ZI||null!=em(Ch,fg.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),ZI=!0),t.width=r,t.height=a;let e=t.getContext("2d"),n=new ImageData(l,r,a);e.putImageData(n,0,0)}return n!==e&&n.dispose(),l}function rN(e,t,n){let a=Ng(e,"img","draw");if(!(e instanceof Gm)){let e=a;a=$y(e,"int32"),e.dispose()}nN(a),function(e){let t=(null==e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error("Alpha value ".concat(t," is suppoed to be in range [0 - 1]."))}(null==n?void 0:n.imageOptions);let r={image:a},i={canvas:t,options:n};fg.runKernel(Ch,r,i)}var iN=Eg({fromPixels_:$I}),sN={};function oN(e,t){let n=e.shape.length,a=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was ".concat(n,"."));if(a<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ".concat(a,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was ".concat(t.dtype,"."));if(t.shape[a-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: ".concat(t.shape[a-1]," vs. ").concat(n));if(0===Wc(e.shape))throw new Error("Requested more than 0 entries, but input is empty. Input shape: ".concat(e.shape,"."));let r=t.shape,i=r[r.length-1],s=1;for(let d=0;d<r.length-1;++d)s*=r[d];let o=e.shape,l=r.slice();l.pop();let u=1;for(let d=i;d<n;++d)u*=o[d],l.push(o[d]);let c=[...hd(e.shape).map(e=>e/u),1].slice(0,i);return[l,s,u,c]}ac(sN,{prepareAndValidate:()=>oN});var lN={};ac(lN,{assertParamsValid:()=>dN,computeFlatOffset:()=>IN,computeOutShape:()=>pN,getNormalizedAxes:()=>yN,isSliceContinous:()=>SN,maskToAxes:()=>hN,parseSliceParams:()=>NN,sliceInfo:()=>TN,startForAxis:()=>wN,startIndicesWithElidedDims:()=>bN,stopForAxis:()=>kN,stopIndicesWithElidedDims:()=>vN,stridesForAxis:()=>xN,stridesWithElidedDims:()=>fN});var uN=-2,cN=-1;function dN(e,t,n){let a=e.shape.length;Lc(a===t.length,()=>"Error in slice".concat(a,"D: Length of begin ").concat(t," must match the rank of the array (").concat(a,").")),Lc(a===n.length,()=>"Error in slice".concat(a,"D: Length of size ").concat(n," must match the rank of the array (").concat(a,")."));for(let r=0;r<a;++r)Lc(t[r]+n[r]<=e.shape[r],()=>"Error in slice".concat(a,"D: begin[").concat(r,"] + size[").concat(r,"] (").concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")"))}function hN(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function pN(e,t,n){let a=[];for(let r=0;r<e.length;r++)a[r]=Math.ceil((t[r]-e[r])/n[r]);return a}function fN(e,t,n,a){let r=[...e];for(let i=r.length;i<a.length;i++)r.push(1);for(let i=0;i<n;i++)0===i?r[t]=1:(r.splice(t,0,1),r.pop());return r}function mN(e,t,n){return n<=e?n:n-(t-1)}function gN(e,t){let n=[];for(let a=0;a<e;a++)n.push(t+a);return n}function yN(e,t,n,a,r,i,s,o,l){let u=e.length,c=new Array(u),d=new Array(u),h=new Array(u);if(t.length&&n>0){let l=t[0],u=n+1;c=bN(s,l,u,a,e),d=vN(o,l,u,r,e),h=fN(i,l,u,e)}else for(let p=0;p<u;p++)c[p]=wN(s,a,i,e,p,l),d[p]=kN(o,r,i,e,p,l),h[p]=xN(i,p,l);return{begin:c,end:d,strides:h}}function bN(e,t,n,a,r){let i=[...r],s=gN(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=0;else{let r=mN(t,n,o),s=a[r];e&1<<r&&(s=0),i[o]=s}return i}function vN(e,t,n,a,r){let i=[...r],s=gN(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{let r=mN(t,n,o),s=a[r];e&1<<r&&(s=Number.MAX_SAFE_INTEGER),i[o]=s}for(let o=0;o<i.length;o++){let e=r[o];i[o]<0&&(i[o]+=e),i[o]=Fc(0,i[o],r[o])}return i}function xN(e,t,n){let a=e[t];return(n&1<<t||null==a)&&(a=1),a}function wN(e,t,n,a,r,i){let s=t[r],o=n[r]||1;(e&1<<r||i&1<<r||null==s)&&(s=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let l=a[r];return s<0&&(s+=l),s=Fc(0,s,l-1),s}function kN(e,t,n,a,r,i){let s=t[r],o=n[r]||1;(e&1<<r||i&1<<r||null==s)&&(s=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let l=a[r];return s<0&&(s+=l),s=o>0?Fc(0,s,l):Fc(-1,s,l-1),s}function SN(e,t,n){let a=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){a=r;break}for(let r=a+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function IN(e,t){let n=e.length>0?e[e.length-1]:1;for(let a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function NN(e,t,n){let a,r,i=e.shape.length;return a="number"==typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),a.forEach(e=>{Lc(-1!==e,()=>"slice() does not support negative begin indexing.")}),r=null==n?new Array(i).fill(-1):"number"==typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,r=r.map((t,n)=>t>=0?t:(Lc(-1===t,()=>"Negative size values should be exactly -1 but got ".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-a[n])),[a,r]}function TN(e,t,n,a,r,i,s,o,l){let u;if(null==a?(u=new Array(t.length),u.fill(1)):u=a,null!=s&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1,d={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:r,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&s&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);let h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let a=0;a<e.dims;a++)if(1<<a&e.ellipsisMask){let r=Math.min(t.dims-(e.dims-a)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=a}else if(1<<a&e.newAxisMask)t.finalShapeGatherIndices.push(uN),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input has only ").concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[a]),null!=e.end&&(t.end[n]=e.end[a]),t.strides[n]=e.strides[a],e.beginMask&1<<a&&(t.beginMask|=1<<n),e.endMask&1<<a&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<a?(t.finalShapeGatherIndices.push(cN),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(a)),t.inputShapeGatherIndicesSparse[n]=a,n++}}(d,h);let p=!0,f=!0,m=!0,g=[],y=[];for(let b=0;b<e.length;++b){if(0===h.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));let t=!!(h.shrinkAxisMask&1<<b),n=e[b];if(-1===n){g.push(t?1:-1);continue}let a=[h.beginMask&1<<b,h.endMask&1<<b],r=[h.strides[b]>0?0:-1,h.strides[b]>0?n:n-1];if(t&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[b];let i=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(t){let e=h.begin[b]<0?n+h.begin[b]:h.begin[b];if(h.begin[b]=e,h.end[b]=h.begin[b]+1,e<0||e>=n)throw Error("slice index ".concat(h.begin[b]," of dimension ").concat(b," out of bounds."))}else h.begin[b]=CN(h.begin[b],0,h.strides[b],n,a,r),h.end[b]=CN(h.end[b],1,h.strides[b],n,a,r);let e=1===h.strides[b]&&0===h.begin[b]&&h.end[b]===n;p=p&&e,f=f&&(0===b&&1===h.strides[b]||e)}else p=p&&1===h.strides[b]&&i,f=f&&(0===b&&1===h.strides[b]||i);let s,o=!1;if(h.beginValid&&h.endValid?(s=h.end[b]-h.begin[b],o=!0):t?(s=1,o=!0):i&&n>=0&&(s=h.strides[b]<0?-n:n,o=!0),o){let e;e=0===s||s<0!=h.strides[b]<0?0:Math.trunc(s/h.strides[b])+(s%h.strides[b]!==0?1:0),g.push(e)}else g.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){let e=h.finalShapeGatherIndices[b];e>=0?y.push(g[e]):e===uN&&y.push(1)}return{finalShapeSparse:y.filter((e,t)=>h.finalShapeGatherIndices[t]!==uN),finalShape:y,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function CN(e,t,n,a,r,i){if(r[t])return n>0?i[t]:i[t+1&1];{let t=e<0?a+e:e;return t<i[0]?i[0]:t>i[1]?i[1]:t}}var EN="4.22.0",_N=class{static sgd(e){return new SI(e)}static momentum(e,t){return new II(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new NI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new wI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new vI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new kI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new xI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},AN=_N,FN="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function RN(){return new Promise(e=>FN(()=>e()))}var DN,MN={};function ON(e,t){let n=e[0].length;e.forEach((e,t)=>{Lc(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same as the rank of the rest (").concat(n,")"))}),Lc(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));let a=e[0];e.forEach((e,r)=>{for(let i=0;i<n;i++)Lc(i===t||e[i]===a[i],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(r,"] (").concat(e,") does not match the shape of the rest (").concat(a,") along the non-concatenated axis ").concat(r,"."))})}function PN(e,t){let n=e[0].slice();for(let a=1;a<e.length;a++)n[t]+=e[a][t];return n}function LN(e,t,n){let a=new Array;if(null==n&&null==t)return a;if(null==t)for(;a.length<e+n.length;)a.push(-1);else a=t.slice();if(null==n)return a;if(e+n.length!==a.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(a.length));for(let r=1;r<n.length;++r){let i=n[r],s=a[a.length-n.length+r],o=a[s];if(i>=0)if(o>=0){if(o!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(r+e,"] = ").concat(i," but shape[").concat(r+e,"] = ").concat(o))}else a[s]=i}return a}function zN(e){let t={FIRST_DIM_SIZE:DN.FIRST_DIM_SIZE,VALUE_ROWIDS:DN.VALUE_ROWIDS,ROW_LENGTHS:DN.ROW_LENGTHS,ROW_SPLITS:DN.ROW_SPLITS,ROW_LIMITS:DN.ROW_LIMITS,ROW_STARTS:DN.ROW_STARTS},n=[];for(let a of e){if(!(a in t))break;n.push(t[a])}return n}function BN(e){return 0===e.length?0:e[0]===DN.FIRST_DIM_SIZE?e.length-1:e.length}function WN(e,t){if(null==e||null==t)return;let n=e.length,a=t.length;if(n>=a)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(a,")"));for(let r=0;r<Math.min(n,a-1);++r){let n=e[r],a=t[r+1];if(n>=0&&a>=0&&1!==n&&n!==a)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(r-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(r-e.length,"] = ").concat(a))}}ac(MN,{ERF_A1:()=>ZN,ERF_A2:()=>$N,ERF_A3:()=>eT,ERF_A4:()=>tT,ERF_A5:()=>nT,ERF_P:()=>JN,PARALLELIZE_THRESHOLD:()=>VN,RowPartitionType:()=>DN,SELU_SCALE:()=>QN,SELU_SCALEALPHA:()=>YN,applyActivation:()=>eS,assertAndGetBroadcastShape:()=>Nv,assertAxesAreInnerMostDims:()=>Bv,assertParamsConsistent:()=>ON,assignToTypedArray:()=>lT,axesAreInnerMostDims:()=>Ov,calculateShapes:()=>_k,checkEinsumDimSizes:()=>yT,checkPadOnDimRoundingMode:()=>Db,combineLocations:()=>Pv,combineRaggedTensorToTensorShapes:()=>LN,complexWithEvenIndex:()=>iT,complexWithOddIndex:()=>sT,computeConv2DInfo:()=>kb,computeConv3DInfo:()=>Sb,computeDefaultPad:()=>Ib,computeDilation2DInfo:()=>vb,computeOptimalWindowSize:()=>UN,computeOutAndReduceShapes:()=>Lv,computeOutShape:()=>PN,computePool2DInfo:()=>xb,computePool3DInfo:()=>wb,convertConv2DDataFormat:()=>Rb,decodeEinsumEquation:()=>mT,eitherStridesOrDilationsAreOne:()=>Ab,expandShapeToKeepDim:()=>zv,exponent:()=>cT,exponents:()=>uT,fromStringArrayToUint8:()=>BT,fromUint8ToStringArray:()=>zT,getAxesPermutation:()=>Wv,getBroadcastDims:()=>Sv,getComplexWithIndex:()=>oT,getEinsumComputePath:()=>bT,getEinsumPermutation:()=>gT,getFusedBiasGradient:()=>$k,getFusedDyActivation:()=>Zk,getImageCenter:()=>jN,getInnerMostAxes:()=>Uv,getPermuted:()=>HN,getRaggedRank:()=>BN,getReductionAxes:()=>Iv,getReshaped:()=>GN,getReshapedPermuted:()=>qN,getRowPartitionTypesHelper:()=>zN,getSliceBeginCoords:()=>KN,getSliceSize:()=>XN,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>kT,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>ST,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>IT,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>CT,getSparseReshapeInputOutputMismatchErrorMessage:()=>_T,getSparseReshapeInputOutputMultipleErrorMessage:()=>ET,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>NT,getSparseReshapeNegativeOutputDimErrorMessage:()=>TT,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>DT,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>AT,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>FT,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>RT,getUndoAxesPermutation:()=>Vv,isIdentityPermutation:()=>vT,log:()=>Jf,mergeRealAndImagArrays:()=>aT,prepareAndValidate:()=>oN,prepareSplitSize:()=>wT,segment_util:()=>MT,shouldFuse:()=>tS,slice_util:()=>lN,splitRealAndImagArrays:()=>rT,stridesOrDilationsArePositive:()=>Fb,tupleValuesAreOne:()=>_b,upcastType:()=>tg,validateDefaultValueShape:()=>WN,validateInput:()=>Ek,validateUpdateShape:()=>Ck,warn:()=>Qf}),function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(DN||(DN={}));var VN=30;function UN(e){return e<=VN?e:dd(e,Math.floor(Math.sqrt(e)))}function jN(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function GN(e,t,n){let a=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let n=t.length;for(let r=0;r<n;++r)a=a.concat([e[r+1]/t[r],t[r]]);a=a.concat(e.slice(n+1))}return a}function HN(e,t){let n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let a=t+1;a<e;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{let a=[],r=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?r.push(n):a.push(n);n.push(...a),n.push(0),n.push(...r)}return n}function qN(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=[];a?r.push(e[0]/n):r.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?a?r.push(t[i-1]*e[i]):r.push(e[i]/t[i-1]):r.push(e[i]);return r}function KN(e,t){let n=[0];for(let a=0;a<t;++a)n.push(e[a][0]);return n}function XN(e,t,n){let a=e.slice(0,1);for(let r=0;r<n;++r)a.push(e[r+1]-t[r][0]-t[r][1]);return a}var YN=1.7580993408473768,QN=1.0507009873554805,JN=.3275911,ZN=.254829592,$N=-.284496736,eT=1.421413741,tT=-1.453152027,nT=1.061405429;function aT(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:".concat(e.length,", imag: ").concat(t.length,"."));let n=new Float32Array(2*e.length);for(let a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function rT(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=e[a],n[a/2]=e[a+1];return{real:t,imag:n}}function iT(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],a[Math.floor(r/4)]=e[r+1];return{real:n,imag:a}}function sT(e){let t=Math.floor(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],a[Math.floor(r/4)]=e[r+1];return{real:n,imag:a}}function oT(e,t){return{real:e[2*t],imag:e[2*t+1]}}function lT(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function uT(e,t){let n=new Float32Array(e/2),a=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){let i=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(i),a[r]=Math.sin(i)}return{real:n,imag:a}}function cT(e,t,n){let a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}var dT="->",hT=/->/g,pT=",",fT="...";function mT(e,t){let n=((e=e.replace(/\s/g,"")).length-e.replace(hT,"").length)/dT.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(dT,'").'));let[a,r]=e.split(dT);Lc(-1===a.indexOf(fT),()=>'The ellipsis notation ("'.concat(fT,'") is not supported yet.'));let i=a.split(pT),s=i.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let d=0;d<r.length;++d){let e=r[d];if(!i.some(t=>-1!==t.indexOf(e)))throw new Error("Output subscripts contain the label ".concat(e," not present in the input subscripts."));-1===o.indexOf(e)&&o.push(e)}for(let d=0;d<a.length;++d){let e=a[d];-1===o.indexOf(e)&&e!==pT&&o.push(e)}let l=new Array(i.length);for(let d=0;d<s;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error("Found duplicate axes in input component ".concat(i[d],". Support for duplicate axes in input is not implemented yet."));l[d]=[];for(let e=0;e<i[d].length;++e)l[d].push(o.indexOf(i[d][e]))}let u=o.length,c=[];for(let d=r.length;d<u;++d)c.push(d);return{allDims:o,summedDims:c,idDims:l}}function gT(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;let a=[];for(let r=0;r<e;++r)-1===n[r]&&a.push(r);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:a}}function yT(e,t,n){let a=new Array(e);for(let r=0;r<n.length;++r){let e=n[r].shape;for(let n=0;n<t[r].length;++n)void 0===a[t[r][n]]?a[t[r][n]]=e[n]:Lc(a[t[r][n]]===e[n],()=>"Expected dimension ".concat(a[t[r][n]]," at axis ").concat(n," of input shaped ").concat(JSON.stringify(e),", but got dimension ").concat(e[n]))}}function bT(e,t){let n=e,a=[],r=0;0===e.length&&n.push(-1),r=e.length+1;for(let s=0;s<r;++s)a.push([]);let i=[];for(let s=0;s<n.length;++s){let e=xT(t,n[s]);for(let t of e)-1===i.indexOf(t)&&(a[s].push(t),i.push(t))}return{path:n,steps:a}}function vT(e){return e.every((e,t)=>e===t)}function xT(e,t){let n=[];for(let a=0;a<e.length;++a)(0===e[a].length||-1!==e[a].indexOf(t)||-1===t)&&n.push(a);return n}function wT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if("number"==typeof t)Lc(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),a=new Array(t).fill(e.shape[n]/t);else{Lc(t.reduce((e,t)=>(-1===t&&(e+=1),e),0)<=1,()=>"There should be only one negative value in split array.");let r=t.indexOf(-1);if(-1!==r){let a=t.reduce((e,t)=>t>0?e+t:e);t[r]=e.shape[n]-a}Lc(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),a=t}return a}function kT(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function ST(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function IT(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function NT(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function TT(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function CT(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function ET(e,t){let n=Wc(e),a=Wc(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(a,". inputShape=").concat(e," outputShape= ").concat(t)}function _T(e,t){let n=Wc(e),a=Wc(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(a,". inputShape=").concat(e," outputShape=").concat(t)}function AT(){return"segment ids must be >= 0"}function FT(){return"segment ids are not increasing"}function RT(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function DT(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}var MT={};function OT(e,t){let n,a=!1;for(e<=VN?(n=e,a=!0):n=dd(e,Math.floor(Math.sqrt(e)));!a;)n>t||n===e?a=!0:n=dd(e,n+1);return n}function PT(e,t,n){let a=[],r=e.length;for(let i=0;i<r;i++)i!==t?a.push(e[i]):a.push(n);return a}function LT(e,t,n,a){let r=t.shape.length,i=e.shape.length;if(0!==a&&(a<-r||a>r))throw new Error("Expect batchDims in the range of [-".concat(r,", ").concat(r,"], but got ").concat(a));if(a<0&&(a+=r),a>i)throw new Error("batchDims (".concat(a,") must be less than rank(x) (\n    ").concat(i,")."));if(n<a)throw new Error("batchDims (".concat(a,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<a;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));let s=e.shape[n],o=[],l=1,u=1,c=1;for(let d=0;d<a;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=a;d<n;d++)o.push(e.shape[d]),u*=e.shape[d];for(let d=a;d<r;d++)o.push(t.shape[d]);for(let d=n+1;d<i;d++)o.push(e.shape[d]),c*=e.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:o}}function zT(e){try{return e.map(e=>Am(e))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(t))}}function BT(e){return e.map(e=>_m(e))}ac(MT,{collectGatherOpShapeInfo:()=>LT,computeOutShape:()=>PT,segOpComputeOptimalWindowSize:()=>OT});var WT={};ac(WT,{nonMaxSuppressionV3Impl:()=>xS,nonMaxSuppressionV4Impl:()=>wS,nonMaxSuppressionV5Impl:()=>kS,whereImpl:()=>zk}),function(){for(let e of TI)gI(e)}();var VT={kernelName:Fd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,yk($y(n,"float32"),-1))}}},UT={kernelName:Rd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=Xv($y(n,"float32")),a=Kv(_x(qv(1),t));return Tx(rb(e,a))}}}},jT={kernelName:Dd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=Kv(_x(Xv($y(n,"float32")),1));return rb(e,t)}}}},GT={kernelName:Md,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=e,a=Iv(n.shape,r);return a.length>0&&(t=Yv(t,a)),Mb(t,n.shape)},b:()=>{let t=e,n=Iv(a.shape,r);return n.length>0&&(t=Yv(t,n)),Mb(t,a.shape)}}}},HT={kernelName:Od,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((t,a)=>{n[a]=()=>e.clone()}),n}},qT={kernelName:zd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ev(n)}}},KT={kernelName:Bd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ev(n)}}},XT={kernelName:Wd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,Kv(_x(qv(1),Xv($y(n,"float32")))))}}},YT={kernelName:Vd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=Kv(nb(qv(1),Xv($y(n,"float32"))));return rb(e,t)}}}},QT={kernelName:Gd,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=nb(Xv(n),Xv(a)),i=ib(e,rb(a,t)),s=Iv(n.shape,r);return s.length>0&&(i=Yv(i,s)),Mb(i,n.shape)},b:()=>{let t=nb(Xv(n),Xv(a)),i=Tx(ib(e,rb(n,t))),s=Iv(a.shape,r);return s.length>0&&(i=Yv(i,s)),Mb(i,a.shape)}}}},JT={kernelName:Ud,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,nb(Xv($y(n,"float32")),1))}}},ZT={kernelName:jd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,_x(qv(1),Xv($y(n,"float32"))))}}};var $T=Eg({avgPool3dGrad_:function(e,t,n,a,r,i){let s=Ng(e,"dy","avgPool3dGrad"),o=Ng(t,"input","avgPool3dGrad"),l=s,u=o,c=!1;4===o.rank&&(c=!0,l=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Lc(5===l.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank ".concat(l.rank,".")),Lc(5===u.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank ".concat(u.rank,".")),Db("avgPool3dGrad",r,i);let d={dy:l,input:u},h={filterSize:n,strides:a,pad:r,dimRoundingMode:i},p=fg.runKernel(Xd,d,h);return c?Mb(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),eC={kernelName:Kd,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>$T(e,a,r,i,s,o)}}};var tC=Eg({avgPoolGrad_:function(e,t,n,a,r){let i=Ng(e,"dy","avgPoolGrad"),s=Ng(t,"input","avgPoolGrad");Lc(s.rank===i.rank,()=>"Rank of input (".concat(s.rank,") does not match rank of dy (").concat(i.rank,")"));let o=s,l=i,u=!1;3===s.rank&&(u=!0,o=Mb(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=Mb(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Lc(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank ".concat(l.rank,".")),Lc(4===o.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank ".concat(o.rank,"."));let c={dy:l,input:o},d={filterSize:n,strides:a,pad:r},h=fg.runKernel(qd,c,d);return u?Mb(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),nC={kernelName:Hd,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:i,pad:s}=n;return{x:()=>tC(e,a,r,i,s)}}},aC={kernelName:Yd,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[a,r]=t,{transposeA:i,transposeB:s}=n;return i||s?!i&&s?{a:()=>zb(e,r,!1,!1),b:()=>zb(e,a,!0,!1)}:i&&!s?{a:()=>zb(r,e,!1,!0),b:()=>zb(a,e,!1,!1)}:{a:()=>zb(r,e,!0,!0),b:()=>zb(e,a,!0,!0)}:{a:()=>zb(e,r,!1,!0),b:()=>zb(a,e,!0,!1)}}},rC={kernelName:Qd,gradFunc:(e,t,n)=>{let{blockShape:a,crops:r}=n;return{x:()=>lw(e,a,r)}}},iC={kernelName:$d,gradFunc:(e,t,n)=>{let a=n,r=a.inputShape,i=a.shape,s=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])s[l]=1;else if(1!==r[l])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(i,"]."));let o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>Yv(e,o,!0)}}},sC={kernelName:th,gradFunc:e=>({x:()=>e.clone()})},oC={kernelName:nh,gradFunc:e=>({x:()=>Ev(e)})},lC={kernelName:ah,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Cv(Rx(ox(a,r),fx(a,i)),e,Ev(e))}}},uC={kernelName:ih,inputsToSave:["x"],gradFunc:VT.gradFunc},cC={kernelName:sh,saveAllInputs:!0,gradFunc:(e,t,n)=>{let a=t.map(e=>e.shape),{axis:r}=n,i=Jc(r,t[0].shape)[0],s=a.map(e=>e[i]);return hk(e,s,i).map(e=>()=>e)}},dC={kernelName:oh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return Lc(_b(i),()=>"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(i,"'")),{x:()=>lv(a.shape,e,r,s,o,l),filter:()=>Jk(a,e,r.shape,s,o,l)}}},hC={kernelName:uh,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>sv(e,r,i,s,o,1,l),filter:()=>Jk(e,a,r.shape,i,s,o,l)}}};var pC=Eg({conv3DBackpropFilter_:function(e,t,n,a,r){let i=e;4===e.rank&&(i=Mb(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;4===s.rank&&(s=Mb(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Lc(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape ".concat(i.shape,".")),Lc(5===s.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape ".concat(s.shape,".")),Lc(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got ".concat(n,".")),Lc(i.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must match input depth in filter (").concat(n[3],".")),Lc(s.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(s.shape[4],") must match output depth for filter (").concat(n[4],")."));let o={x:i,dy:s},l={strides:a,pad:r,filterShape:n};return fg.runKernel(dh,o,l)}}),fC={kernelName:ch,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:i}=n;Lc(_b(a),()=>"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(a,"'"));let[s,o]=t;return{x:()=>dv(s.shape,e,o,r,i),filter:()=>pC(s,e,o.shape,r,i)}}},mC={kernelName:ph,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(Tx(nk($y(n,"float32"))),e)}}},gC={kernelName:fh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(ak($y(n,"float32")),e)}}},yC={kernelName:gh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r,exclusive:i,reverse:s}=n;return{x:()=>{let t=Wv([r],a.rank),n=gv(e,r,i,!s);return null!=t&&(n=Vk(n,t)),n}}}},bC={kernelName:xh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:i,dimRoundingMode:s}=n,o=null==a?[1,1]:a;Lc(_b(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '".concat(o,"'"));let[l,u]=t;return Lc(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ".concat(l.rank,".")),Lc(4===u.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ".concat(u.rank,".")),Lc(l.shape[3]===u.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input channels (".concat(l.shape[3],") must match the inChannels dimension in filter ").concat(u.shape[2],".")),Lc(Ab(r,o),()=>"Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ".concat(r," and dilations '").concat(o,"'.")),Db("depthwiseConv2d",i,s),{x:()=>rS(l.shape,e,u,r,i,o,s),filter:()=>aS(l,e,u.shape,r,i,o,s)}}},vC={kernelName:Ih,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,i={x:a,filter:r,dy:e},s={x:a,filter:r,dy:e};return{x:()=>fg.runKernel(Nh,i,n),filter:()=>fg.runKernel(Th,s,n)}}},xC={kernelName:Ah,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,a={dy:e,y:n};return{x:()=>fg.runKernel(Fh,a)}}},wC={kernelName:Rh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=ib($v(Tx(Xv(n))),2/Math.sqrt(Math.PI));return{x:()=>ib(e,a)}}},kC={kernelName:Mh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,n)}}},SC={kernelName:Oh,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>Mb(e,n.shape)}}},IC={kernelName:Ph,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,$v(n))}}},NC={kernelName:Wh,gradFunc:e=>({x:()=>Ev(e)})},TC={kernelName:Vh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=rb(e,$y(a,"float32")),i=Iv(n.shape,r);return i.length>0?Mb(Yv(t,i),n.shape):t},b:()=>{let t=ib(e,$y(n,"float32")),i=Iv(a.shape,r);i.length>0&&(t=Mb(Yv(t,i),a.shape));let s=Xv(a);return Tx(rb(t,$y(s,"float32")))}}}},CC={kernelName:Uh,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:a}=n,[r,i,s,o]=t,l=null==o?qv(1):o,u=Iv(i.shape,r.shape),c=[];if(1===i.rank){for(let e=0;e<r.shape.length-1;++e)c.push(r.shape[e]);c.push(1)}let d=_x(r,i),h=ib(e,l),p=Jw(nb(s,qv(a))),f=ib(ib(ib(p,p),p),qv(-.5));return{x:()=>1===i.rank?Mb(ib(ib(e,nx(Mb(p,[1,1,1,i.shape[0]]),c)),l),r.shape):Mb(ib(ib(e,p),l),r.shape),mean:()=>{let e=ib(ib(p,qv(-1)),h);return 1===i.rank&&(e=Yv(e,u)),Mb(e,i.shape)},variance:()=>{let e=ib(ib(f,d),h);return 1===i.rank&&(e=Yv(e,u)),Mb(e,i.shape)},scale:()=>{let t=ib(d,p),n=ib(e,t);return 1===i.rank&&(n=Yv(n,u)),Mb(n,i.shape)},offset:()=>{let t=e;return 1===i.rank&&(t=Yv(t,u)),Mb(t,i.shape)}}}},EC={kernelName:jh,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[a,r]=t,{axis:i,batchDims:s}=n,o=Jc(i,a.shape)[0],l=(e,t,n)=>()=>{let a=e.shape,r=t.size,s=a.slice(0,o),l=s.length,u=a.slice(i,a.length).slice(1),c=u.length,d=_C(0,l),h=_C(l+1,l+1+c),p=AC([s,[r],u]),f=Mb(n,p),m=Mb(t,[r]),g=AC([[l],d,h]),y=Vk(f,g),b=Mk(y,m,e.shape[o]),v=Vv(g);return b=Vk(b,v),b};if(1===s){let t=a.shape[0],n=a.split(t,0);return{x:()=>gk(n.map((t,n)=>l(t,r.slice(n,1),e.slice(n,1))())).reshape(a.shape),indices:()=>r}}return{x:l(a,r,e),indices:()=>r}}};function _C(e,t){let n=[];for(let a=e;a<t;++a)n.push(a);return n}function AC(e){let t=[];for(let n=0;n<e.length;++n)for(let a=0;a<e[n].length;++a)t.push(e[n][a]);return t}var FC={kernelName:qh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>Ev(n),b:()=>Ev(a)}}},RC={kernelName:Kh,gradFunc:e=>({x:()=>$y(e,"float32")})},DC={kernelName:Qh,gradFunc:e=>({x:()=>Ev(e)})},MC={kernelName:Jh,gradFunc:e=>({x:()=>Ev(e)})},OC={kernelName:Zh,gradFunc:e=>({x:()=>Ev(e)})},PC={kernelName:$h,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{alpha:r}=n,i=sx(a,0);return{x:()=>Cv(i,e,ib(e,r))}}},LC={kernelName:rp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,nb(n,1))}}},zC={kernelName:ap,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,$y(n,"float32"))}}},BC={kernelName:up,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n;return{logits:()=>{let t=$v(a);return _x(e,ib(Yv(e,r,!0),t))}}}};var WC=Eg({localResponseNormalizationBackprop_:function(e,t,n){let a={x:e,y:t,dy:n},r={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return fg.runKernel(hp,a,r)}}),VC={kernelName:dp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>WC(a,r,e,i,s,o,l)}}};function UC(e,t,n,a){return t.rank<n.rank&&(t=Mb(t,zv(t.shape,a))),e.rank<n.rank&&(e=Mb(e,zv(e.shape,a))),{x:()=>ib(e,$y(Tv(n,t),e.dtype))}}var jC={kernelName:fp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let a=n,{reductionIndices:r}=a,i=t[0],s=UC(e,t[1],i,Jc(r,i.shape));return{x:()=>s.x()}}},GC={kernelName:mp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>ib(e,$y(ox(n,a),"float32")),b:()=>ib(e,$y(px(n,a),"float32"))}}};var HC=Eg({maxPool3dGrad_:function(e,t,n,a,r,i,s){let o=Ng(e,"dy","maxPool3dGrad"),l=Ng(t,"input","maxPool3dGrad"),u=Ng(n,"output","maxPool3dGrad"),c=o,d=l,h=u,p=!1;4===l.rank&&(p=!0,c=Mb(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=Mb(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=Mb(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Lc(5===c.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank ".concat(c.rank,".")),Lc(5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank ".concat(d.rank,".")),Lc(5===h.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank ".concat(h.rank,".")),Db("maxPool3dGrad",i,s);let f={dy:c,input:d,output:h},m={filterSize:a,strides:r,pad:i,dimRoundingMode:s},g=fg.runKernel(vp,f,m);return p?Mb(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),qC={kernelName:bp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>HC(e,a,r,i,s,o,l)}}};var KC=Eg({maxPoolGrad_:function(e,t,n,a,r,i,s){let o=Ng(e,"dy","maxPoolGrad"),l=Ng(t,"input","maxPoolGrad"),u=Ng(n,"output","maxPoolGrad");Lc(l.rank===o.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy (").concat(o.rank,")")),Lc(4===o.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank ".concat(o.rank,".")),Lc(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank ".concat(l.rank,".")),Db("maxPoolGrad",i,s);let c={dy:o,input:l,output:u},d={filterSize:a,strides:r,pad:i,dimRoundingMode:s};return fg.runKernel(yp,c,d)}}),XC={kernelName:gp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>KC(e,a,r,i,s,o)}}},YC={kernelName:wp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,i=Jc(r,a.shape),s=Wc(Lv(a.shape,i)[1]);return{x:()=>{let t=a.shape.slice();i.forEach(e=>{t[e]=1});let n=Mb(e,t);return rb(ib(n,Hx(a.shape,"float32")),s)}}}},QC={kernelName:kp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let a=n,{axis:r}=a,[i,s]=t,o=UC(e,s,i,Jc(r,i.shape));return{x:()=>o.x()}}},JC={kernelName:Sp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>ib(e,$y(fx(n,a),"float32")),b:()=>ib(e,$y(sx(n,a),"float32"))}}},ZC={kernelName:Ip,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,i=r.map(e=>e[0]);return{x:()=>Wb(e,i,a.shape)}}},$C={kernelName:Np,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=Iv(n.shape,r);return t.length>0?Mb(Yv(e,t),n.shape):e},b:()=>{let t=ib(e,Tx(rx(rb(n,a)))),i=Iv(a.shape,r);return i.length>0?Mb(Yv(t,i),a.shape):t}}}},eE={kernelName:Cp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=ib(e,$y(a,"float32")),i=Iv(n.shape,r);return i.length>0?Mb(Yv(t,i),n.shape):t},b:()=>{let t=ib(e,$y(n,"float32")),i=Iv(a.shape,r);return i.length>0?Mb(Yv(t,i),a.shape):t}}}},tE={kernelName:Ep,gradFunc:e=>({x:()=>Tx(e)})},nE={kernelName:Mp,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>Gx(n.shape,"float32")}}},aE={kernelName:Dp,gradFunc:e=>({x:()=>Ev(e)})},rE={kernelName:Op,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:a}=n;return Ok(e,a).map(e=>()=>e)}},iE={kernelName:Pp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,i=r.map(e=>e[0]);return{x:()=>Wb(e,i,a.shape)}}},sE={kernelName:zp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,a,r]=t,i=n,s=a,o=Nv(i.shape,s.shape);return{a:()=>{let t=$y(s,"float32"),n=ib(e,ib(t,Hv(i,_x(t,qv(1))))),a=Iv(i.shape,o);return a.length>0&&(n=Yv(n,a)),Mb(n,i.shape)},b:()=>{let t=sx(i,0),n=Cv(t,yx(i),Ev(i)),a=ib(e,ib(r,n)),l=Iv(s.shape,o);return l.length>0&&(a=Yv(a,l)),Mb(a,s.shape)}}}},oE={kernelName:Bp,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,a]=t,r=sx(n,0);return{x:()=>Cv(r,e,ib(e,a)),alpha:()=>{let t=Cv(r,Ev(e),ib(e,n)),i=Iv(a.shape,e.shape);return i.length>0&&(t=Yv(t,i)),Mb(t,a.shape)}}}};function lE(e,t,n){let a=e.shape.length,r=a-n.length,i=MN.getAxesPermutation(n,a),s=e;null!=i&&(s=Vk(e,i));let o=s.shape.slice(),l=o.splice(a-n.length,n.length).reduce((e,t)=>e*t,1);o.push(l);let u=function(e,t,n){let a=e.shape.slice();a[n]=1;let r=Mb(t,a),i=mv(e,n,!0,!1),s=mv(e,n,!0,!0),o=ib(i,s);return ib(r,o)}(s.reshape(o),t,r);if(u=u.reshape(s.shape),null!=i){let e=MN.getUndoAxesPermutation(i);u=Vk(u,e)}return u}var uE={kernelName:Wp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,i=[];return i=null==r?a.shape.map((e,t)=>t):"number"==typeof r?[r]:r,{x:()=>lE(a,e,i)}}},cE={kernelName:Eh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=rb(e,$y(a,"float32")),i=Iv(n.shape,r);return i.length>0?Mb(Yv(t,i),n.shape):t},b:()=>{let t=ib(e,$y(n,"float32")),i=Iv(a.shape,r);i.length>0&&(t=Mb(Yv(t,i),a.shape));let s=Xv(a);return Tx(rb(t,$y(s,"float32")))}}}},dE={kernelName:qp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,Tx(Xv(n)))}}},hE={kernelName:$p,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=ib(fx(n,6),yk(n));return{x:()=>ib(e,$y(a,"float32"))}}},pE={kernelName:Kp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,$y(yk(n),"float32"))}}},fE={kernelName:Xp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Mb(e,n.shape)}}},mE={kernelName:Jp,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>fg.runKernel(Zp,r,n)}}},gE={kernelName:Yp,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>fg.runKernel(Qp,r,n)}}},yE={kernelName:ef,gradFunc:(e,t,n)=>{let{dims:a}=n,r=Jc(a,e.shape);return{x:()=>Hw(e,r)}}},bE={kernelName:tf,gradFunc:e=>({x:()=>Ev(e)})},vE={kernelName:nf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Tx(rb(e,ib(Hv(n,1.5),2)))}}},xE={kernelName:of,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>$y(Ev(n),"float32"),t:()=>ib(e,$y(n,e.dtype)),e:()=>ib(e,$y(Dx(n),e.dtype))}}},wE={kernelName:lf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=sx(n,qv(0)),a=qv(YN),r=qv(QN),i=ib(e,r),s=ib(ib(e,a),$v($y(n,"float32")));return Cv(t,i,s)}}}},kE={kernelName:pf,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,ib(n,_x(qv(1),n)))}}},SE={kernelName:hf,gradFunc:e=>({x:()=>Ev(e)})},IE={kernelName:cf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(pv($y(n,"float32")),e)}}},NE={kernelName:df,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(fv($y(n,"float32")),e)}}},TE={kernelName:uf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{begin:r,size:i}=n,s=a.shape,[o,l]=NN(a,r,i),u=[];for(let c=0;c<e.rank;c++)u.push([o[c],s[c]-o[c]-l[c]]);return{x:()=>aw(e,u)}}},CE={kernelName:vf,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{dim:r}=n,i=ib(e,a);return{logits:()=>_x(i,ib(Yv(i,[r],true),a))}}},EE={kernelName:ff,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,Bb(n))}}},_E={kernelName:yf,gradFunc:(e,t,n)=>{let{blockShape:a,paddings:r}=n;return{x:()=>jb(e,a,r)}}},AE={kernelName:bf,gradFunc:(e,t,n)=>{let{axis:a}=n;return{x:()=>Lb(e,a)}}},FE={kernelName:mf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,ib(Kv($y(n,"float32")),2))}}},RE={kernelName:Tf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(e,ib($y(n,"float32"),2))}}},DE={kernelName:Nf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=qv(2);return{a:()=>ib(e,ib(r,_x(n,a))),b:()=>ib(e,ib(r,_x(a,n)))}}},ME={kernelName:Gf,gradFunc:e=>({x:()=>Ev(e)})},OE={kernelName:Rf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=Nv(n.shape,a.shape);return{a:()=>{let t=e,a=Iv(n.shape,r);return a.length>0&&(t=Yv(t,a)),Mb(t,n.shape)},b:()=>{let t=e,n=Iv(a.shape,r);return n.length>0&&(t=Yv(t,n)),Mb(Tx(t),a.shape)}}}},PE={kernelName:gf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,r=a.shape.slice(),{axis:i}=n;Jc(i,a.shape).forEach(e=>{r[e]=1});let s=Mb(e,r),o=ib(s,Hx(a.shape,"float32"));return{x:()=>o}}},LE={kernelName:Df,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rb(e,Xv(pv(n)))}}},zE={kernelName:Mf,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ib(_x(qv(1),Xv(n)),e)}}},BE={kernelName:Of,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{reps:r}=n;return{x:()=>{let t=Ev(a);if(1===a.rank)for(let n=0;n<r[0];++n)t=nb(t,Wb(e,[n*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)t=nb(t,Wb(e,[n*a.shape[0],i*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)for(let s=0;s<r[2];++s)t=nb(t,Wb(e,[n*a.shape[0],i*a.shape[1],s*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(4!==a.rank)throw new Error("Gradient for tile operation is not implemented for rank-".concat(a.rank," tensors yet."));for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)for(let s=0;s<r[2];++s)for(let o=0;o<r[3];++o)t=nb(t,Wb(e,[n*a.shape[0],i*a.shape[1],s*a.shape[2],o*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return t}}}},WE={kernelName:zf,gradFunc:(e,t,n)=>{let a=n,{perm:r}=a,i=Vv(r);return{x:()=>Vk(e,i)}}},VE={kernelName:Wf,gradFunc:(e,t,n)=>{let a=n,{axis:r}=a;return{value:()=>gk(e,r)}}},UE={kernelName:Vf,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>function(e,t){let n=Ux(t,Ev(t)),a=ix(e,n),r=ox(t,qv(0,"int32")),i=a.rank-r.rank;for(let o=0;o<i;++o)r=ex(r,o+1);r=Rx(r,Hx(a.shape,"bool"));let s=Ev(a);return Cv(r,a,s)}(e,n)}}};var jE={kernelName:jf,gradFunc:e=>({x:()=>Ev(e)})},GE=[VT,UT,jT,GT,HT,qT,KT,XT,YT,QT,JT,ZT,eC,nC,aC,rC,iC,sC,oC,lC,uC,cC,hC,dC,fC,mC,gC,yC,bC,vC,cE,xC,wC,kC,SC,IC,TC,NC,CC,EC,FC,RC,DC,MC,OC,PC,LC,zC,BC,VC,jC,jC,GC,qC,XC,YC,QC,JC,ZC,$C,eE,tE,nE,aE,rE,iE,iE,sE,oE,uE,dE,hE,pE,fE,mE,gE,yE,bE,vE,xE,wE,kE,SE,IE,NE,TE,CE,EE,_E,_E,AE,AE,FE,DE,RE,ME,OE,PE,LE,zE,BE,WE,VE,UE,jE];for(let n of GE)rm(n);Hm().prototype.abs=function(){return this.throwIfDisposed(),sb(this)},Hm().prototype.acos=function(){return this.throwIfDisposed(),ob(this)},Hm().prototype.acosh=function(){return this.throwIfDisposed(),lb(this)},Hm().prototype.add=function(e){return this.throwIfDisposed(),nb(this,e)},Hm().prototype.all=function(e,t){return this.throwIfDisposed(),cb(this,e,t)},Hm().prototype.any=function(e,t){return this.throwIfDisposed(),db(this,e,t)},Hm().prototype.argMax=function(e){return this.throwIfDisposed(),hb(this,e)},Hm().prototype.argMin=function(e){return this.throwIfDisposed(),pb(this,e)},Hm().prototype.asScalar=function(){return this.throwIfDisposed(),Lc(1===this.size,()=>"The array must have only 1 element."),Mb(this,[])},Hm().prototype.asType=function(e){return this.throwIfDisposed(),$y(this,e)},Hm().prototype.as1D=function(){return this.throwIfDisposed(),Mb(this,[this.size])},Hm().prototype.as2D=function(e,t){return this.throwIfDisposed(),Mb(this,[e,t])},Hm().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Mb(this,[e,t,n])},Hm().prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),Mb(this,[e,t,n,a])},Hm().prototype.as5D=function(e,t,n,a,r){return this.throwIfDisposed(),Mb(this,[e,t,n,a,r])},Hm().prototype.asin=function(){return this.throwIfDisposed(),fb(this)},Hm().prototype.asinh=function(){return this.throwIfDisposed(),mb(this)},Hm().prototype.atan=function(){return this.throwIfDisposed(),gb(this)},Hm().prototype.atan2=function(e){return this.throwIfDisposed(),yb(this,e)},Hm().prototype.atanh=function(){return this.throwIfDisposed(),bb(this)},Hm().prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),Ob(this,e,t,n,a)},Hm().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),jb(this,e,t)},Hm().prototype.batchNorm=function(e,t,n,a,r){return this.throwIfDisposed(),Hb(this,e,t,n,a,r)},Hm().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Zb(this,e)},Hm().prototype.cast=function(e){return this.throwIfDisposed(),$y(this,e)},Hm().prototype.ceil=function(){return this.throwIfDisposed(),$b(this)},Hm().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),tv(this,e,t)},Hm().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Gm&&(e=[e]),Lb([this,...e],t)},Hm().prototype.conv1d=function(e,t,n,a,r,i){return this.throwIfDisposed(),ov(this,e,t,n,a,r,i)},Hm().prototype.conv2dTranspose=function(e,t,n,a,r){return this.throwIfDisposed(),uv(this,e,t,n,a,r)},Hm().prototype.conv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),sv(this,e,t,n,a,r,i)},Hm().prototype.cos=function(){return this.throwIfDisposed(),pv(this)},Hm().prototype.cosh=function(){return this.throwIfDisposed(),fv(this)},Hm().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),mv(this,e,t,n)},Hm().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),gv(this,e,t,n)},Hm().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),bv(this,e,t)},Hm().prototype.depthwiseConv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),vv(this,e,t,n,a,r,i)},Hm().prototype.dilation2d=function(e,t,n,a,r){return this.throwIfDisposed(),wv(this,e,t,n,a,r)},Hm().prototype.divNoNan=function(e){return this.throwIfDisposed(),_v(this,e)},Hm().prototype.div=function(e){return this.throwIfDisposed(),rb(this,e)},Hm().prototype.dot=function(e){return this.throwIfDisposed(),Av(this,e)},Hm().prototype.elu=function(){return this.throwIfDisposed(),Rv(this)},Hm().prototype.equal=function(e){return this.throwIfDisposed(),Tv(this,e)},Hm().prototype.erf=function(){return this.throwIfDisposed(),Mv(this)},Hm().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),Zv(this,e,t)},Hm().prototype.exp=function(){return this.throwIfDisposed(),$v(this)},Hm().prototype.expandDims=function(e){return this.throwIfDisposed(),ex(this,e)},Hm().prototype.expm1=function(){return this.throwIfDisposed(),tx(this)},Hm().prototype.fft=function(){return this.throwIfDisposed(),uk(this)},Hm().prototype.flatten=function(){return this.throwIfDisposed(),Mb(this,[this.size])},Hm().prototype.floor=function(){return this.throwIfDisposed(),rx(this)},Hm().prototype.floorDiv=function(e){return this.throwIfDisposed(),ab(this,e)},Hm().prototype.gather=function(e,t,n){return this.throwIfDisposed(),ix(this,e,t,n)},Hm().prototype.greaterEqual=function(e){return this.throwIfDisposed(),ox(this,e)},Hm().prototype.greater=function(e){return this.throwIfDisposed(),sx(this,e)},Hm().prototype.ifft=function(){return this.throwIfDisposed(),ck(this)},Hm().prototype.irfft=function(){return this.throwIfDisposed(),dk(this)},Hm().prototype.isFinite=function(){return this.throwIfDisposed(),ux(this)},Hm().prototype.isInf=function(){return this.throwIfDisposed(),cx(this)},Hm().prototype.isNaN=function(){return this.throwIfDisposed(),dx(this)},Hm().prototype.leakyRelu=function(e){return this.throwIfDisposed(),hx(this,e)},Hm().prototype.lessEqual=function(e){return this.throwIfDisposed(),fx(this,e)},Hm().prototype.less=function(e){return this.throwIfDisposed(),px(this,e)},Hm().prototype.localResponseNormalization=function(e,t,n,a){return this.throwIfDisposed(),gx(this,e,t,n,a)},Hm().prototype.logSigmoid=function(){return this.throwIfDisposed(),Ex(this)},Hm().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Ax(this,e)},Hm().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Fx(this,e,t)},Hm().prototype.log=function(){return this.throwIfDisposed(),yx(this)},Hm().prototype.log1p=function(){return this.throwIfDisposed(),bx(this)},Hm().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Rx(this,e)},Hm().prototype.logicalNot=function(){return this.throwIfDisposed(),Dx(this)},Hm().prototype.logicalOr=function(e){return this.throwIfDisposed(),Mx(this,e)},Hm().prototype.logicalXor=function(e){return this.throwIfDisposed(),Ox(this,e)},Hm().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),zb(this,e,t,n)},Hm().prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),Bx(this,e,t,n,a)},Hm().prototype.max=function(e,t){return this.throwIfDisposed(),jv(this,e,t)},Hm().prototype.maximum=function(e){return this.throwIfDisposed(),Ux(this,e)},Hm().prototype.mean=function(e,t){return this.throwIfDisposed(),jx(this,e,t)},Hm().prototype.min=function(e,t){return this.throwIfDisposed(),Gv(this,e,t)},Hm().prototype.minimum=function(e){return this.throwIfDisposed(),Kx(this,e)},Hm().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Xx(this,e,t)},Hm().prototype.mod=function(e){return this.throwIfDisposed(),Yx(this,e)},Hm().prototype.mul=function(e){return this.throwIfDisposed(),ib(this,e)},Hm().prototype.neg=function(){return this.throwIfDisposed(),Tx(this)},Hm().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Jv(this,e,t,n)},Hm().prototype.notEqual=function(e){return this.throwIfDisposed(),$x(this,e)},Hm().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),ew(this,e,t,n)},Hm().prototype.onesLike=function(){return this.throwIfDisposed(),tw(this)},Hm().prototype.pad=function(e,t){return this.throwIfDisposed(),aw(this,e,t)},Hm().prototype.pool=function(e,t,n,a,r,i){return this.throwIfDisposed(),uw(this,e,t,n,a,r,i)},Hm().prototype.pow=function(e){return this.throwIfDisposed(),Hv(this,e)},Hm().prototype.prelu=function(e){return this.throwIfDisposed(),cw(this,e)},Hm().prototype.prod=function(e,t){return this.throwIfDisposed(),dw(this,e,t)},Hm().prototype.reciprocal=function(){return this.throwIfDisposed(),Uw(this)},Hm().prototype.relu=function(){return this.throwIfDisposed(),jw(this)},Hm().prototype.relu6=function(){return this.throwIfDisposed(),Gw(this)},Hm().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Mb(this,e.shape)},Hm().prototype.reshape=function(e){return this.throwIfDisposed(),Mb(this,e)},Hm().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),RS(this,e,t,n)},Hm().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),DS(this,e,t,n)},Hm().prototype.reverse=function(e){return this.throwIfDisposed(),Hw(this,e)},Hm().prototype.rfft=function(){return this.throwIfDisposed(),pk(this)},Hm().prototype.round=function(){return this.throwIfDisposed(),Qw(this)},Hm().prototype.rsqrt=function(){return this.throwIfDisposed(),Jw(this)},Hm().prototype.selu=function(){return this.throwIfDisposed(),Zw(this)},Hm().prototype.separableConv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),$w(this,e,t,n,a,r,i)},Hm().prototype.sigmoid=function(){return this.throwIfDisposed(),Bb(this)},Hm().prototype.sign=function(){return this.throwIfDisposed(),tk(this)},Hm().prototype.sin=function(){return this.throwIfDisposed(),nk(this)},Hm().prototype.sinh=function(){return this.throwIfDisposed(),ak(this)},Hm().prototype.slice=function(e,t){return this.throwIfDisposed(),Wb(this,e,t)},Hm().prototype.softmax=function(e){return this.throwIfDisposed(),lk(this,e)},Hm().prototype.softplus=function(){return this.throwIfDisposed(),Cx(this)},Hm().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),lw(this,e,t)},Hm().prototype.split=function(e,t){return this.throwIfDisposed(),hk(this,e,t)},Hm().prototype.sqrt=function(){return this.throwIfDisposed(),Kv(this)},Hm().prototype.square=function(){return this.throwIfDisposed(),Xv(this)},Hm().prototype.squaredDifference=function(e){return this.throwIfDisposed(),fk(this,e)},Hm().prototype.squeeze=function(e){return this.throwIfDisposed(),mk(this,e)},Hm().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof Gm?[this,e]:[this,...e];return gk(n,t)},Hm().prototype.step=function(e){return this.throwIfDisposed(),yk(this,e)},Hm().prototype.stridedSlice=function(e,t,n,a,r,i,s,o){return this.throwIfDisposed(),bk(this,e,t,n,a,r,i,s,o)},Hm().prototype.sub=function(e){return this.throwIfDisposed(),_x(this,e)},Hm().prototype.sum=function(e,t){return this.throwIfDisposed(),Yv(this,e,t)},Hm().prototype.tan=function(){return this.throwIfDisposed(),vk(this)},Hm().prototype.tanh=function(){return this.throwIfDisposed(),Vb(this)},Hm().prototype.tile=function(e){return this.throwIfDisposed(),nx(this,e)},Hm().prototype.toBool=function(){return this.throwIfDisposed(),$y(this,"bool")},Hm().prototype.toFloat=function(){return this.throwIfDisposed(),$y(this,"float32")},Hm().prototype.toInt=function(){return this.throwIfDisposed(),$y(this,"int32")},Hm().prototype.topk=function(e,t){return this.throwIfDisposed(),Fk(this,e,t)},Hm().prototype.transpose=function(e){return this.throwIfDisposed(),Vk(this,e)},Hm().prototype.unique=function(e){return this.throwIfDisposed(),Dk(this,e)},Hm().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Mk(this,e,t)},Hm().prototype.unstack=function(e){return this.throwIfDisposed(),Ok(this,e)},Hm().prototype.where=function(e,t){return this.throwIfDisposed(),Cv(e,this,t)},Hm().prototype.zerosLike=function(){return this.throwIfDisposed(),Ev(this)};var HE=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},qE=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},KE=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},XE=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},YE=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},QE=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}};function JE(e,t){if(Array.isArray(e)){let n=[];for(let a=0;a<t;a++)n=n.concat(e);return n}{let n=new Array(t);return n.fill(e),n}}function ZE(e,t){if(!e)throw new YE(t)}function $E(e,t){let n=0;for(let a of e)a===t&&n++;return n}function e_(e){return 1===e.length?e[0]:e}function t_(e){return Array.isArray(e)?e:[e]}function n_(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function a_(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}var r_={};function i_(e){if(null==e)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function s_(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(e=>s_(e));else{let t=Object.keys(e);for(let n of t){let t=e[n];null!=t&&"object"==typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!=typeof t.value?s_(t):e[n]=t.value)}}}function o_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){let r,i=e;if(i in n)r=n[i];else if(i in r_)r=r_[i];else if(r=t[i],null==r)throw new KE("Unknown ".concat(a,": ").concat(e,". This may be due to one of the following reasons:\n1. The ").concat(a," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(a," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));return r}{let i=e;if(null==i.className||null==i.config)throw new KE("".concat(a,": Improper config format: ").concat(JSON.stringify(i),".\n'className' and 'config' must set."));let s,o,l=i.className;if(l in n?[s,o]=n[l]:l in r_?[s,o]=r_.className:l in t&&([s,o]=t[l]),null==s)throw new KE("Unknown ".concat(a,": ").concat(l,". This may be due to one of the following reasons:\n1. The ").concat(a," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(a," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));if(null!=o){let e={};for(let n of Object.keys(r_))e[n]=r_[n];for(let r of Object.keys(n))e[r]=n[r];i.config.customObjects=e;let t=Object.assign({},r_);for(let r of Object.keys(n))r_[r]=n[r];s_(i.config);let a=o(s,i.config,n,r);return r_=Object.assign({},t),a}{let e=Object.assign({},r_);for(let a of Object.keys(n))r_[a]=n[a];let t=new s(i.config);return r_=Object.assign({},e),t}}}function l_(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function u_(e){if(null==e)return e;let t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t}function c_(e){if(null==e)throw new KE("Invalid value in obj: ".concat(JSON.stringify(e)));for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function d_(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new KE("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function h_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return ZE(n>=0),ZE(a>=n),Array.isArray(e)&&e.length>=n&&e.length<=a&&e.every(e=>typeof e===t)}function p_(e,t){Array.isArray(e)?(um.assert(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((e,n)=>p_(e,"element ".concat(n+1," of ").concat(t)))):um.assert(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ").concat(f_(e),"."))}function f_(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>f_(e)).join(",")+"]":"string"==typeof e?'"'.concat(e,'"'):"".concat(e)}function m_(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var g_=0;function y_(){return g_++}var b_={};function v_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in b_||(b_[e]=0),b_[e]+=1,e+b_[e].toString()}var x_=["channelsFirst","channelsLast"],w_=["nearest","bilinear"],k_=["valid","same","causal"],S_=["max","avg"],I_=["sum","mul","concat","ave"],N_=new Map;function T_(e){d_(x_,"DataFormat",e)}function C_(e){d_(k_,"PaddingMode",e)}function E_(e){d_(S_,"PoolMode",e)}var __=[];function A_(e,t){__.push(e);try{let e=t();return __.pop(),e}catch(ree){throw __.pop(),ree}}function F_(e){if(!O_(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===__.length?"":__.join("/")+"/")+e}function R_(e){if(!O_(e))throw new Error("Not a valid tensor name: '"+e+"'");N_.has(e)||N_.set(e,0);let t=N_.get(e);if(N_.set(e,N_.get(e)+1),t>0){let n="".concat(e,"_").concat(t);return N_.set(n,1),n}return e}var D_,M_=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function O_(e){return!!e.match(M_)}function P_(e){return e===parseInt(e.toString(),10)}function L_(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let a=1;for(let r=t;r<n;++r)a*=e[r];return a}function z_(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let a=e[n];a<t&&(t=a)}return t}function B_(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let a=e[n];a>t&&(t=a)}return t}function W_(e,t){if(t<e)throw new KE("end (".concat(t,") < begin (").concat(e,") is forbidden."));let n=[];for(let a=e;a<t;++a)n.push(a);return n}function V_(){return null==D_&&(D_=$g().epsilon()),D_}function U_(e,t){return $y(e,t)}function j_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Mb(e,n)}function G_(e,t,n){return Ug(()=>{switch(e.rank){case 1:return rk(e,t,n);case 2:return ik(e,[t,0],[n,e.shape[1]]);case 3:return sk(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ok(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Wb(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Wb(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new KE("sliceAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function H_(e,t,n){return Ug(()=>{switch(e.rank){case 1:return rk(e,t,n);case 2:return ik(e,[0,t],[e.shape[0],n]);case 3:return sk(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ok(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new KE("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function q_(e,t,n,a){return Ug(()=>{switch(e.rank){case 1:return rk(e,t,n);case 2:switch(a){case 1:return G_(e,t,n);case 2:return H_(e,t,n);default:throw new KE("The axis is not within the rank of the tensor ".concat(a))}case 3:switch(a){case 1:return G_(e,t,n);case 2:return sk(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return H_(e,t,n);default:throw new KE("The axis is not within the rank of the tensor ".concat(a))}case 4:switch(a){case 1:return G_(e,t,n);case 2:return ok(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ok(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return H_(e,t,n);default:throw new KE("The axis is not within the rank of the tensor ".concat(a))}default:throw new KE("sliceAlongLastAxis() received an unsupported tensor rank: ".concat(e.rank))}})}function K_(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),Lb(e,n)}function X_(e,t){switch(e.rank){case 1:return nv([e,t]);case 2:return av([e,t],0);case 3:return rv([e,t],0);case 4:return iv([e,t],0);default:throw new KE("concatAlongFirstAxis() received an unsupported tensor rank: ".concat(e.rank))}}function Y_(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new KE("The length of input n (".concat(t.length,") does not match the number of dimensions in input x (").concat(e.rank,")"));return nx(e,t)}function Q_(e){return Pw(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function J_(e,t,n,a){if(e.rank<2||t.rank<2)throw new XE("dot requires both inputs to be rank >= 2 but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new XE("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ".concat(e.shape," and  y shape = ").concat(t.shape))}if(2===e.rank&&2===t.rank)return Qk.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?eA(e.rank,a,"channelsLast"):null,activation:n});{let r=e.shape.slice(),i=r.pop();e=Mb(e,[-1,i]);let s=t.shape.slice(),o=s.pop(),l=s.pop(),u=[...s,o],c=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=Mb(Vk(t,c),[l,-1]);let d=[...r,...u];return Mb(Qk.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?eA(e.rank,a,"channelsLast"):null,activation:n}),d)}}function Z_(e,t,n){return Ug(()=>(t=Array.isArray(t)?xk(t,"int32"):$y(t,"int32"),ix(e,t,n)))}function $_(e){return ib(e,e)}function eA(e,t,n){let a=t.shape;if(1!==t.rank&&t.rank!==e)throw new KE("Unexpected bias dimensions: ".concat(t.rank,"; expected it to be 1 or ").concat(e));if(5===e){if("channelsFirst"===n)return 1===a.length?Mb(t,[1,a[0],1,1,1]):Mb(t,[1,a[3],a[0],a[1],a[2]]);if("channelsLast"===n)return 1===a.length?Mb(t,[1,1,1,1,a[0]]):Mb(t,[1].concat(a))}else if(4===e){if("channelsFirst"===n)return 1===a.length?Mb(t,[1,a[0],1,1]):Mb(t,[1,a[2],a[0],a[1]]);if("channelsLast"===n)return 1===a.length?Mb(t,[1,1,1,a[0]]):Mb(t,[1].concat(a))}else if(3===e){if("channelsFirst"===n)return 1===a.length?Mb(t,[1,a[0],1]):Mb(t,[1,a[1],a[0]]);if("channelsLast"===n)return 1===a.length?Mb(t,[1,1,a[0]]):Mb(t,[1].concat(a))}else if(e<3)return t;throw new KE("Unsupported input rank by biasAdd: ".concat(t.rank))}function tA(e,t,n){return Ug(()=>(null==n&&(n="channelsLast"),T_(n),nb(e,eA(e.rank,t,n))))}function nA(e,t,n,a){return Ug(()=>qk(e,t,n,a))}function aA(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}var rA=["fanIn","fanOut","fanAvg"],iA=["normal","uniform","truncatedNormal"];var sA=class extends dI.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},oA=class extends sA{apply(e,t){return Gx(e,t)}};oA.className="Zeros",dI.registerClass(oA);var lA=class extends sA{apply(e,t){return Hx(e,t)}};lA.className="Ones",dI.registerClass(lA);var uA=class extends sA{constructor(e){if(super(),"object"!=typeof e)throw new KE("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new KE("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return Ug(()=>ib(qv(this.value),Hx(e,t)))}getConfig(){return{value:this.value}}};uA.className="Constant",dI.registerClass(uA);var cA=class extends sA{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return zw(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};cA.className="RandomUniform",dI.registerClass(cA);var dA=class extends sA{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new XE("randomNormal does not support dType ".concat(t,"."));return Q_(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};dA.className="RandomNormal",dI.registerClass(dA);var hA=class extends sA{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new XE("truncatedNormal does not support dType ".concat(t,"."));return Rk(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};hA.className="TruncatedNormal",dI.registerClass(hA);var pA=class extends sA{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return Ug(()=>{if(2!==e.length||e[0]!==e[1])throw new KE("Identity matrix initializer can only be used for 2D square matrices.");return ib(this.gain,ax(e[0]))})}getConfig(){return{gain:this.gain}}};pA.className="Identity",dI.registerClass(pA);var fA=class extends sA{constructor(e){if(super(),e.scale<0)throw new KE("scale must be a positive float. Got: ".concat(e.scale));this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function(e){d_(rA,"FanMode",e)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function(e){d_(iA,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){let n=function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(T_(a),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===a){let a=L_(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===a){let a=L_(e,0,e.length-2);t=e[e.length-2]*a,n=e[e.length-1]*a}}else{let a=L_(e);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}(e),a=n[0],r=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,a):"fanOut"===this.mode?i/=Math.max(1,r):i/=Math.max(1,(a+r)/2),"normal"===this.distribution){let n=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new XE("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Rk(e,0,n,t,this.seed)}{let n=Math.sqrt(3*i);return zw(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};fA.className="VarianceScaling",dI.registerClass(fA);var mA=class extends fA{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return fA.className}};mA.className="GlorotUniform",dI.registerClass(mA);var gA=class extends fA{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return fA.className}};gA.className="GlorotNormal",dI.registerClass(gA);var yA=class extends fA{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return fA.className}};yA.className="HeNormal",dI.registerClass(yA);var bA=class extends fA{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return fA.className}};bA.className="HeUniform",dI.registerClass(bA);var vA=class extends fA{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return fA.className}};vA.className="LeCunNormal",dI.registerClass(vA);var xA=class extends fA{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return fA.className}};xA.className="LeCunUniform",dI.registerClass(xA);var wA=class extends sA{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return Ug(()=>{if(e.length<2)throw new XE("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));let n=um.sizeFromShape(e.slice(0,-1)),a=e[e.length-1],r=n*a;r>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(r,") elements: Slowness may result."));let i=Q_([Math.max(a,n),Math.min(a,n)],0,1,t,this.seed),s=oI.qr(i,!1),o=s[0],l=s[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return o=ib(o,l.sign()),n<a&&(o=o.transpose()),ib(qv(this.gain),o.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};wA.className="Orthogonal",dI.registerClass(wA);var kA={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function SA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o_(e,dI.SerializationMap.getMap().classNameMap,t,"initializer")}function IA(e){return i_(e)}function NA(e){if("string"==typeof e){let t=e in kA?kA[e]:e;if("GlorotNormal"===t)return new gA;if("GlorotUniform"===t)return new mA;if("HeNormal"===t)return new yA;if("HeUniform"===t)return new bA;if("LeCunNormal"===t)return new vA;if("LeCunUniform"===t)return new xA;{let e={};return e.className=t,e.config={},SA(e)}}return e instanceof sA?e:SA(e)}function TA(e){return Array.isArray(e)&&Array.isArray(e[0])}function CA(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function EA(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new KE("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function _A(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new KE("Expected exactly 1 Shape; got ".concat(e.length))}return e}function AA(e){let t=0;for(let n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}var FA="Variable",RA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:FA,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=y_(),n=null==n?FA:n,this.originalName=F_(n),this.name=R_(this.originalName),this.trainable_=a,this.constraint=r,this.val=Lk(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function DA(e){return e.map(e=>e.read())}function MA(e){e.forEach(e=>{e[0].write(e[1])})}var OA=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},PA=class{constructor(e,t,n,a,r,i,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=r,this.outputTensorIndex=s,this.id=y_(),null!=i&&(this.originalName=F_(i),this.name=R_(this.originalName)),this.rank=t.length}},LA=0,zA=class{constructor(e,t){this.callArgs=t,this.id=LA++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},BA=0,WA=class extends dI.Serializable{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=BA++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let e=this.getClassName();t=n_(e)+"_"+v_(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new qE("The layer has never been called and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new KE("Asked to get ".concat(t," at node ").concat(e,", but the layer has only ").concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return e_(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return e_(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new HE("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.'));if(0===this.inboundNodes.length)throw new HE("Layer ".concat(this.name," is not connected, no input to return."));return e_(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new HE("Layer ".concat(this.name," has no inbound nodes."));if(this.inboundNodes.length>1)throw new HE("Layer ".concat(this.name,' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.'));return e_(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=t_(e);if(null==this.inputSpec||0===this.inputSpec.length)return;let n=t_(this.inputSpec);if(t.length!==n.length)throw new KE("Layer ".concat(this.name," expects ").concat(n.length," inputs, but it received ").concat(t.length," input tensors. Input received: ").concat(e));for(let a=0;a<t.length;a++){let e=t[a],r=n[a];if(null==r)continue;let i=e.rank;if(null!=r.ndim&&i!==r.ndim)throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected ndim=").concat(r.ndim,", found ndim=").concat(i));if(null!=r.maxNDim&&i>r.maxNDim)throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected max_ndim=").concat(r.maxNDim,", found ndim=").concat(i));if(null!=r.minNDim&&i<r.minNDim)throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected min_ndim=").concat(r.minNDim,", found ndim=").concat(i,"."));if(null!=r.dtype&&e.dtype!==r.dtype)throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name," : expected dtype=").concat(r.dtype,", found dtype=").concat(e.dtype,"."));if(r.axes){let t=e.shape;for(let e in r.axes){let n=Number(e),i=r.axes[e],s=n>=0?t[n]:t[t.length+n];if(null!=i&&-1===[i,null].indexOf(s))throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected axis ").concat(n," of input shape to have value ").concat(i," but got shape ").concat(t,"."))}}if(null!=r.shape)for(let t=0;t<r.shape.length;++t){let n=r.shape[t],i=e.shape[t];if(null!=n&&null!=i&&n!==i)throw new KE("Input ".concat(a," is incompatible with layer ").concat(this.name,": expected shape=").concat(r.shape,", found shape=").concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=t_(e),a=function(e){let t=!0;for(let n of t_(e))if(!(n instanceof PA)){t=!1;break}return t}(e),r=function(e){let t=!0;for(let n of t_(e))if(n instanceof PA){t=!1;break}return t}(e);if(a===r)throw new KE("Arguments to apply() must be all SymbolicTensors or all Tensors");return A_(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let t=[];for(let n of t_(e))t.push(n.shape);this.build(e_(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);let r=t_(a),i=[];for(let e of r)-1!==n.indexOf(e)&&(e=e.clone()),i.push(e);if(a=e_(i),null!=this.activityRegularizer)throw new XE("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}{let n,a=function(e){e=t_(e);let t=[];for(let n of e)t.push(n.shape);return e_(t)}(e),r=this.computeOutputShape(a),i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),n=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,a)=>new PA(i,n,this,t_(e),t,this.name,a)):new PA(i,r,this,t_(e),t,this.name),this.addInboundNode(e,n,null,null,a,r,t),this._refCount++,null!=this.activityRegularizer)throw new XE("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return n}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: ".concat(JSON.stringify(e),") does not match that of the batchInputShape (").concat(JSON.stringify(this.batchInputShape),") of the layer ").concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{null!=n&&null!=e[a]&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor (".concat(JSON.stringify(e),") does not match the expectation of layer ").concat(this.name,": ").concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new HE("The layer ".concat(this.name," has never been called and thus has no defined output shape."));let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new HE("The layer ".concat(this.name,' has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.'))}countParams(){if(!this.built)throw new qE("You tried to call countParams() on ".concat(this.name,", but the layer is not built yet. Build it first by calling build(batchInputShape)."));return AA(this.weights)}build(e){this.built=!0}getWeights(){return DA(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){Ug(()=>{let t=this.weights;if(t.length!==e.length)throw new KE('You called setWeights(weights) on layer "'.concat(this.name,'" with a weight list of length ').concat(e.length,", but the layer was expecting ").concat(t.length," weights. Provided weights: ").concat(e,"..."));if(0===t.length)return;let n=[],a=DA(t);for(let r=0;r<a.length;++r){let i=a[r],s=t[r],o=e[r];if(!um.arraysEqual(i.shape,o.shape))throw new KE("Layer weight shape ".concat(i.shape," not compatible with provided weight shape ").concat(o.shape));n.push([s,o])}MA(n)})}addWeight(e,t,n,a,r,i,s,o){if(-1!==this._addedWeightNames.indexOf(e))throw new KE("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(a=null!=o?o():NA("zeros"));let l=a.apply(t,n),u=new RA(l,n,e,i,s);return l.dispose(),null!=r&&this.addLoss(()=>r.apply(u.read())),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=t_(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."));t.forEach(e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."))})}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let a=this.computeMask(e,n),r=t_(t),i=t_(a);if(r.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(r.length," tensors but ").concat(r.length," masks for those tensors"));for(let s=0;s<r.length;s++)r[s].kerasMask=i[s]}addInboundNode(e,t,n,a,r,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=t_(e);t=t_(t),n=t_(n),a=t_(a),r=CA(r),i=CA(i);let l=[],u=[],c=[];for(let d of o)l.push(d.sourceLayer),u.push(d.nodeIndex),c.push(d.tensorIndex);new zA({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:r,outputShapes:i},s);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){let e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been built yet."));if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used yet."));this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function VA(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{let e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{let t=[];for(let n=0;n<e.inboundLayers.length;n++){let a=VA(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(let e of a)-1===t.indexOf(e)&&t.push(e)}return t}}}var UA=class extends WA{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:v_("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new KE("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new KE("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new KE("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let a=new PA(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new zA({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new KE("Cannot pass any input to an InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};function jA(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new KE("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new UA({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}UA.className="InputLayer",dI.registerClass(UA);var GA=class e{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(let e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(let e of t)this.add(e.key,e.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new KE("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,n){if(null==e.dtype||e.dtype===n.dtype)return n;try{return $y(n,e.dtype)}catch(t){throw new KE("The dtype of the feed (".concat(n.dtype,") can not be cast to the dtype of the key '").concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof PA){if(null==this.id2Value[e.id])throw new KE("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{let t=this.name2Id[e];if(null==t)throw new KE("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof PA){if(null==this.id2Value[e.id])throw new KE("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{let t=this.name2Id[e];if(null==t)throw new KE("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&jg(this.id2Mask)}},HA=new QE,qA=new QE;function KA(e,t,n,a){let r=null!=n&&n.training,i=Array.isArray(e),s=i?e:[e],o=s.map(e=>e.name),l=[],u=t.names();for(let f of o)-1!==u.indexOf(f)?l.push(t.getValue(f)):l.push(null);null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);let c,d=o.join(",")+"|"+t.names().sort().join(","),h=HA.get(d);if(null==h){let e=function(e,t){um.assert(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],a={};if(1===e.length){let r=YA(e[0],t);n=r.sorted,a=r.recipientMap}else{let r=new Set;for(let i of e){let{sorted:e,recipientMap:s}=YA(i,t);for(let t of e)r.has(t.name)||(n.push(t),r.add(t.name));for(let t in s)null==a[t]&&(a[t]=new Set),s[t].forEach(e=>a[t].add(e))}}return{sorted:n,recipientCounts:XA(a)}}(s,t);h=e.sorted,c=e.recipientCounts,HA.put(d,h),qA.put(d,c)}c={},r||Object.assign(c,qA.get(d));let p=new GA(t);for(let f=0;f<h.length;++f){if(null!=a){let e=Wg().numTensors;e>a.maxNumTensors&&(a.maxNumTensors=e),e<a.minNumTensors&&(a.minNumTensors=e)}let e=h[f],i=e.sourceLayer;if(i instanceof UA)continue;let s=[],u=[],d=[],m=!1;for(let n of e.inputs){let e=p.getValue(n),a=p.getMask(n);s.push(e),u.push(a),null!=a&&(m=!0),r||(c[n.name]--,0===c[n.name]&&!t.hasKey(n)&&-1===o.indexOf(n.name)&&!e.isDisposed&&!0!==n.sourceLayer.stateful&&d.push(e))}m&&((n=n||{}).mask=u[0]);let g=t_(i.apply(s,n)),y=null;i.supportsMasking&&(y=i.computeMask(s,u));let b=QA(e),v=Array.isArray(b)?b:[b];for(let t=0;t<v.length;++t){p.hasKey(v[t])||p.add(v[t],g[t],Array.isArray(y)?y[0]:y);let e=o.indexOf(v[t].name);-1!==e&&(l[e]=g[t])}r||jg(d)}return p.disposeMasks(),i?l:l[0]}function XA(e){let t={};for(let n in e)t[n]=e[n].size;return t}function YA(e,t){let n=new Set,a=[],r={};for(let o of t.names())n.add(o);let i=[],s=[];for(i.push(e);i.length>0;){let e=i[i.length-1];if(n.has(e.name)){i.pop();continue}let t=s[s.length-1]===i.length-1;if(0===e.inputs.length||t)i.pop(),a.push(e),n.add(e.name),t&&s.pop();else{s.push(i.length-1);for(let t of e.inputs)null==r[t.name]&&(r[t.name]=new Set),r[t.name].add(e.name),!n.has(t.name)&&i.push(t)}}return{sorted:a,recipientMap:r}}function QA(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(let a of e.sourceLayer.inboundNodes[t].outputTensors)if(a.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}Td().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(e){null!=HA&&HA.setMaxEntries(e),null!=qA&&qA.setMaxEntries(e)});var JA={};function ZA(e,t){return Ug(()=>Kv(Yv(ib(e,e),t,!0)))}ac(JA,{maxNorm:()=>lF,minMaxNorm:()=>dF,nonNeg:()=>cF,unitNorm:()=>uF});var $A=class extends dI.Serializable{getConfig(){return{}}},eF=class extends $A{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ug(()=>{let t=ZA(e,this.axis),n=tv(t,0,this.maxValue);return ib(e,rb(n,nb(V_(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};eF.className="MaxNorm",dI.registerClass(eF);var tF=class extends $A{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ug(()=>rb(e,nb(V_(),ZA(e,this.axis))))}getConfig(){return{axis:this.axis}}};tF.className="UnitNorm",dI.registerClass(tF);var nF=class extends $A{apply(e){return jw(e)}};nF.className="NonNeg",dI.registerClass(nF);var aF=class extends $A{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ug(()=>{let t=ZA(e,this.axis),n=nb(ib(this.rate,tv(t,this.minValue,this.maxValue)),ib(1-this.rate,t));return ib(e,rb(n,nb(V_(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};aF.className="MinMaxNorm",dI.registerClass(aF);var rF={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function iF(e){return i_(e)}function sF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o_(e,dI.SerializationMap.getMap().classNameMap,t,"constraint")}function oF(e){if(null==e)return null;if("string"==typeof e){return sF({className:e in rF?rF[e]:e,config:{}})}return e instanceof $A?e:sF(e)}function lF(e){return new eF(e)}function uF(e){return new tF(e)}function cF(){return new nF}function dF(e){return new aF(e)}var hF={};function pF(){return new oA}function fF(){return new lA}function mF(e){return new uA(e)}function gF(e){return new cA(e)}function yF(e){return new dA(e)}function bF(e){return new hA(e)}function vF(e){return new pA(e)}function xF(e){return new fA(e)}function wF(e){return new mA(e)}function kF(e){return new gA(e)}function SF(e){return new yA(e)}function IF(e){return new bA(e)}function NF(e){return new vA(e)}function TF(e){return new xA(e)}function CF(e){return new wA(e)}ac(hF,{constant:()=>mF,glorotNormal:()=>kF,glorotUniform:()=>wF,heNormal:()=>SF,heUniform:()=>IF,identity:()=>vF,leCunNormal:()=>NF,leCunUniform:()=>TF,ones:()=>fF,orthogonal:()=>CF,randomNormal:()=>yF,randomUniform:()=>gF,truncatedNormal:()=>bF,varianceScaling:()=>xF,zeros:()=>pF});var EF,_F={};async function AF(e){if(null==e)return;let t=[],n=[],a=[];for(let r in e){let i=e[r];if("number"!=typeof i){let e=i;t.push(e.data()),n.push(r),a.push(e)}}if(t.length>0){let r=await Promise.all(t);for(let t=0;t<r.length;++t)e[n[t]]=r[t][0];jg(a)}}function FF(e){if(null!=e)for(let t in e){let n=e[t];"number"!=typeof n&&n.dispose()}}ac(_F,{Layer:()=>WA,RNN:()=>HD,RNNCell:()=>qD,activation:()=>IO,add:()=>DO,alphaDropout:()=>SP,average:()=>MO,averagePooling1d:()=>jO,averagePooling2d:()=>qO,averagePooling3d:()=>YO,avgPool1d:()=>GO,avgPool2d:()=>KO,avgPool3d:()=>QO,avgPooling1d:()=>HO,avgPooling2d:()=>XO,avgPooling3d:()=>JO,batchNormalization:()=>WO,bidirectional:()=>mP,categoryEncoding:()=>EP,centerCrop:()=>TP,concatenate:()=>OO,conv1d:()=>mO,conv2d:()=>gO,conv2dTranspose:()=>yO,conv3d:()=>bO,conv3dTranspose:()=>vO,convLstm2d:()=>dP,convLstm2dCell:()=>hP,cropping2D:()=>wO,dense:()=>NO,depthwiseConv2d:()=>SO,dot:()=>BO,dropout:()=>TO,elu:()=>uO,embedding:()=>RO,flatten:()=>EO,gaussianDropout:()=>kP,gaussianNoise:()=>wP,globalAveragePooling1d:()=>ZO,globalAveragePooling2d:()=>$O,globalMaxPool1d:()=>yP,globalMaxPool2d:()=>bP,globalMaxPooling1d:()=>eP,globalMaxPooling2d:()=>tP,gru:()=>iP,gruCell:()=>sP,input:()=>GR,inputLayer:()=>lO,layerNormalization:()=>VO,leakyReLU:()=>dO,lstm:()=>oP,lstmCell:()=>lP,masking:()=>IP,maxPool1d:()=>vP,maxPool2d:()=>xP,maxPooling1d:()=>nP,maxPooling2d:()=>aP,maxPooling3d:()=>rP,maximum:()=>PO,minimum:()=>LO,multiply:()=>zO,permute:()=>FO,prelu:()=>hO,randomWidth:()=>_P,reLU:()=>cO,repeatVector:()=>_O,rescaling:()=>NP,reshape:()=>AO,resizing:()=>CP,rnn:()=>pP,separableConv2d:()=>xO,simpleRNN:()=>uP,simpleRNNCell:()=>cP,softmax:()=>pO,spatialDropout1d:()=>CO,stackedRNNCells:()=>fP,thresholdedReLU:()=>fO,timeDistributed:()=>gP,upSampling2d:()=>kO,zeroPadding2d:()=>UO}),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(EF||(EF={}));var RF=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},DF=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},MF=class extends RF{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});let n=null==t.size?0:t.size;this.seen+=n;for(let a in t){let e=t[a];if("number"==typeof e)this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+e*n;else{let t;a in this.totals?t=this.totals[a]:this.totals[a]=0;let r=Ug(()=>nb(this.totals[a],ib(e,n)));this.totals[a]=r,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(let n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?t[n]=this.totals[n]/this.seen:Ug(()=>{let e=ib(rb(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),Gg(t[n])}))}},OF=class extends RF{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(let n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let r in this.history){let a=this.history[r];for(let i=0;i<a.length;++i)if("number"!=typeof a[i]){let s=a[i];e.push(s.data()),t.push(r),n.push(i)}}let a=await Promise.all(e);for(let r=0;r<a.length;++r)this.history[t[r]][n[r]].dispose(),this.history[t[r]][n[r]]=a[r][0]}},PF=class extends RF{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||RN,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");um.isNumber(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let a,r=null!=n?n():um.now();return function(){let i=null!=n?n():um.now();return i-r<t||(r=i,a=e(...arguments)),a}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let a=[];null!=this.yield&&(await AF(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await AF(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];null!=this.epochEnd&&(await AF(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await AF(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];null!=this.batchEnd&&(await AF(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):um.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await AF(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await AF(e),await this.trainEnd(e))}};function LF(e,t){return null==e&&(e={}),e instanceof RF?[e]:Array.isArray(e)&&e[0]instanceof RF?e:t_(e).map(e=>new PF(e,t))}var zF=class e{constructor(){}static registerCallbackConstructor(t,n){um.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got ".concat(t)),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}static checkForDuplicate(t){for(let n in e.constructors)e.constructors[+n].forEach(e=>{if(e===t)throw new KE("Duplicate callback constructor.")})}static clear(){e.constructors={}}static createCallbacks(t){let n=[];for(let a in e.constructors){let r=+a;t>=r&&n.push(...e.constructors[r])}return n.map(e=>new e)}};function BF(e,t,n,a,r,i,s,o,l){let u=new OF,c=[new MF,...zF.createCallbacks(t)];null!=e&&c.push(...e),c.push(u);let d=new DF(c);return d.setParams({epochs:n,initialEpoch:a,samples:r,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:u}}function WF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o_(e,dI.SerializationMap.getMap().classNameMap,t,"layer",n)}function VF(e,t){return Ug(()=>{"float32"!==e.dtype&&(e=$y(e,"float32"));let n=Yv($_(e),t,!0),a=ev(n.shape,V_()),r=Kv(Ux(n,a));return rb(e,r)})}function UF(e,t){return Ug(()=>jx($_(_x(t,e)),-1))}function jF(e,t){return Ug(()=>jx(sb(_x(t,e)),-1))}function GF(e,t){return Ug(()=>{let n=_x(e,t),a=tv(sb(e),V_(),Number.MAX_VALUE),r=sb(rb(n,a));return ib(100,jx(r,-1))})}function HF(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ug(()=>{if(n)t=lk(t);else{let e=Yv(t,t.shape.length-1,!0);t=rb(t,e)}return t=tv(t,V_(),1-V_()),Tx(Yv(ib($y(e,"float32"),yx(t)),t.shape.length-1))})}function qF(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ug(()=>{let a=$y(rx(function(e){let t=[L_(e.shape)];return Mb(e,t)}(e)),"int32"),r=(t=tv(t,V_(),1-V_())).shape;return HF(Mb(ew(a,r[r.length-1]),r),t,n)})}function KF(e,t){return Ug(()=>{let n;return n=tv(t,V_(),1-V_()),n=yx(rb(n,_x(1,n))),jx(function(e,t){if(!um.arraysEqual(e.shape,t.shape))throw new KE("logits and labels must have the same shape, but got shapes ".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Ug(()=>{let n=jw(t),a=Tx(sb(t));return nb(_x(n,ib(t,e)),bx($v(a)))})}(e,n),-1)})}function XF(e,t){return Ug(()=>{let n=VF(e,-1),a=VF(t,-1),r=ib(n,a);return Tx(Yv(r,-1))})}zF.constructors={};var YF={meanSquaredError:UF,meanAbsoluteError:jF,meanAbsolutePercentageError:GF,meanSquaredLogarithmicError:function(e,t){return Ug(()=>{let n=tv(t,V_(),Number.MAX_VALUE),a=yx(nb(1,n)),r=tv(e,V_(),Number.MAX_VALUE),i=yx(nb(1,r));return jx($_(_x(a,i)),-1)})},squaredHinge:function(e,t){return Ug(()=>{let n=Ux(0,_x(1,ib(e,t)));return jx($_(n),-1)})},hinge:function(e,t){return Ug(()=>{let n=Ux(0,_x(1,ib(e,t)));return jx(n,-1)})},categoricalHinge:function(e,t){return Ug(()=>{let n=Yv(ib(e,t),-1),a=jv(ib(_x(1,e),t),-1);return Ux(0,nb(1,_x(a,n)))})},logcosh:function(e,t){return Ug(()=>{let n=Math.log(2),a=_x(t,e),r=_x(nb(a,Cx(ib(-2,a))),n);return jx(r,-1)})},categoricalCrossentropy:HF,sparseCategoricalCrossentropy:qF,binaryCrossentropy:KF,kullbackLeiblerDivergence:function(e,t){return Ug(()=>{let n=tv(e,V_(),1),a=tv(t,V_(),1);return Yv(ib(e,yx(rb(n,a))),-1)})},poisson:function(e,t){return Ug(()=>{let n=yx(nb(V_(),t));return jx(_x(t,ib(e,n)),-1)})},cosineProximity:XF};function QF(e){if("string"==typeof e){if(e in YF)return YF[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy')),new KE(t)}return e}function JF(e,t){return Ug(()=>{let n=ib(.5,tw(t)),a=U_(sx(t,n),e.dtype);return jx(Tv(e,a),-1)})}function ZF(e,t){return Ug(()=>U_(Tv(hb(e,-1),hb(t,-1)),"float32"))}function $F(e,t){return Ug(()=>$y(Yv(Rx(Tv(e,1),Tv(t,1))),"float32"))}function eR(e,t){return Ug(()=>{let n=$F(e,t),a=function(e,t){return Ug(()=>$y(Yv(Rx(Tv(e,0),Tv(t,1))),"float32"))}(e,t),r=nb(n,a);return $y(Cv(sx(r,0),rb(n,r),0),"float32")})}function tR(e,t){return Ug(()=>{let n=$F(e,t),a=function(e,t){return Ug(()=>$y(Yv(Rx(Tv(e,1),Tv(t,0))),"float32"))}(e,t),r=nb(n,a);return $y(Cv(sx(r,0),rb(n,r),0),"float32")})}function nR(e,t){return KF(e,t)}function aR(e,t){return e.rank===t.rank&&(e=mk(e,[e.rank-1])),(t=hb(t,-1)).dtype!==e.dtype&&(t=$y(t,e.dtype)),$y(Tv(e,t),"float32")}var rR=HF,iR=qF,sR={binaryAccuracy:JF,categoricalAccuracy:ZF,precision:eR,categoricalCrossentropy:rR,sparseCategoricalCrossentropy:iR,mse:UF,MSE:UF,mae:jF,MAE:jF,mape:GF,MAPE:GF,cosine:XF};function oR(e){if("string"==typeof e&&e in sR)return sR[e];if("string"!=typeof e&&null!=e)return e;throw new KE("Unknown metric ".concat(e))}function lR(e){if(ZE(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"==typeof e)return e;{let t;for(let n of Object.keys(YF))if(YF[n]===e){t=n;break}if(void 0!==t)return t;for(let n of Object.keys(sR))if(sR[n]===e){t=n;break}return void 0!==t?t:e.name}}function uR(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!cR(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let n=JSON.stringify(e);n.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in size (length=').concat(n.length," when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576."))}}function cR(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if("string"!=typeof n||!cR(e[n]))return!1;return!0}if(Array.isArray(e)){for(let t of e)if(!cR(t))return!1;return!0}return!1}{let t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function dR(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){let t=!0,n=[],a=[];for(let r in e.nodesByDepth)n.push(e.nodesByDepth[r]);for(let r of n){if(r.length>1||1===r.length&&r[0].inboundLayers.length>1){t=!1;break}a.push(...r)}if(t)for(let r of e.layers){let e=!1;for(let n of r.inboundNodes)if(-1!==a.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),s=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!i){s.push("Receives inputs"),a=[];for(let t in e.nodesByDepth)a.push(...e.nodesByDepth[t])}r("_".repeat(t)),hR(s,n,r),r("=".repeat(t));let o=e.layers;for(let c=0;c<o.length;++c)i?pR(o[c],n,r):fR(o[c],n,a,r),r((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=function(e){let t;return t=null!=e.collectedTrainableWeights?AA(e.collectedTrainableWeights):AA(e.trainableWeights),t}(e),u=AA(e.nonTrainableWeights);r("Total params: ".concat(l+u)),r("Trainable params: ".concat(l)),r("Non-trainable params: ".concat(u)),r("_".repeat(t))}function hR(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,a="";for(let r=0;r<e.length;++r)r>0&&(a=a.slice(0,a.length-1)+" "),a+=e[r],a=a.slice(0,t[r]),a+=" ".repeat(t[r]-a.length);n(a)}function pR(e,t,n){let a,r;try{r=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(o){r="multiple"}try{a=JSON.stringify(e.outputShape)}catch(o){a="multiple"}let i=e.name,s=e.getClassName();hR(["".concat(i," (").concat(s,")"),r,a,e.countParams().toString()],t,n)}function fR(e,t,n,a){let r,i;try{i=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(c){i="multiple"}try{r=JSON.stringify(e.outputShape)}catch(c){r="multiple"}let s=[];for(let d of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(d)))for(let e=0;e<d.inboundLayers.length;++e){let t=d.inboundLayers[e].name,n=d.nodeIndices[e],a=d.tensorIndices[e];s.push("".concat(t,"[").concat(n,"][").concat(a,"]"))}let o=e.name,l=e.getClassName(),u=0===s.length?"":s[0];hR(["".concat(o," (").concat(l,")"),i,r,e.countParams().toString(),u],t,a);for(let d=1;d<s.length;++d)hR(["","","","",s[d]],t,a)}function mR(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function gR(e,t){if(null===e)return null;if("string"==typeof e)return a_(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],a=e.length;for(let r=0;r<a;++r){let a=e[r];mR(t,r,a)?n.push(a):n.push(gR(a,t))}return n}{let t={};for(let n of Object.keys(e)){let a=e[n];if("name"===n&&"string"==typeof a)t[n]=a;else{let e=a_(n);t[e]=gR(a,e)}}return t}}function yR(e,t){if(null==e)return null;if("string"==typeof e)return n_(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],a=e.length;for(let r=0;r<a;++r){let a=e[r];mR(t,r,a)?n.push(a):n.push(yR(a,t))}return n}{let t={};for(let n of Object.keys(e)){let a=e[n],r=n_(n);t[r]="name"!==n&&"className"!==n||"string"!=typeof a?yR(a,n):a}return t}}var bR="4.22.0",vR=class e extends WA{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){let e=this.getClassName().toLowerCase();this.name=v_(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],u_(this.inputs).length!==this.inputs.length)throw new KE("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ".concat(this.inputs.map(e=>e.name)));u_(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ".concat(this.outputs.map(e=>e.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let e of this.outputs){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(a)}for(let e of this.inputs){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;ZE(0===n,"input layer has >1 nodes"),ZE(0===a,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(a)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){let n=this.inputLayers[e];if(!(n instanceof UA))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: ".concat(t.inputs,". Input ").concat(e," (0-based) originates from layer type ").concat(n.getClassName(),"."));this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(let e of this.outputLayers)this.outputNames.push(e.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);let n={},a={},r={},i={},s={},o=[],l=(t,n,a,r,i,u)=>{(null==r||null==i||null==u)&&(r=t.sourceLayer,i=t.nodeIndex,u=t.tensorIndex);let c=r.inboundNodes[i];if(-1!==a.indexOf(c))throw new qE("The tensor ".concat(t.name,' at layer "').concat(r.name,'" is part of a cycle.'));if(-1!==n.indexOf(c))return;this.containerNodes.add(e.nodeKey(r,i)),r.id in s||(s[r.id]=Object.keys(s).length),-1===a.indexOf(c)&&a.push(c);let d=c.inboundLayers.length;for(let e=0;e<d;e++){let t=c.inputTensors[e],r=c.inboundLayers[e],i=c.nodeIndices[e],s=c.tensorIndices[e];l(t,n,a,r,i,s)}for(n.push(c);a.indexOf(c)>=0;)a.splice(a.indexOf(c),1);o.push(c)},u=[],c=[];for(let e of this.outputs)l(e,u,c);let d=o.slice().reverse();for(let e of d){a[e.id]=e,e.id in n||(n[e.id]=0);let t=n[e.id],s=null==r[e.outboundLayer.id]?0:r[e.outboundLayer.id];t=Math.max(t,s),r[e.outboundLayer.id]=t,i[e.outboundLayer.id]=e.outboundLayer,n[e.id]=t;for(let r=0;r<e.inboundLayers.length;r++){let i=e.inboundLayers[r],s=e.nodeIndices[r],o=i.inboundNodes[s],l=null==n[o.id]?0:n[o.id];n[o.id]=Math.max(t+1,l),a[o.id]=o}}let h={};for(let e in n){let t=n[e];t in h||(h[t]=[]),h[t].push(a[e])}let p={};for(let e in r){let t=r[e];t in p||(p[t]=[]),p[t].push(i[e])}let f=Object.keys(p).map(e=>parseInt(e,10)).sort(l_);this.layers=[];for(let b of f){let t=p[b];t.sort((e,t)=>{let n=s[e.id],a=s[t.id];return n<a?-1:n>a?1:0});for(let n of t)n instanceof e&&this.internalContainerRefs.push(n),this.layers.push(n)}this.layersByDepth=p,f=Object.keys(h).map(e=>parseInt(e,10)).sort(l_);let m=this.inputs.slice(),g=[];for(let e of f)for(let t of h[e]){let e=t.outboundLayer;if(null!=e){for(let n of t.inputTensors)if(-1===m.indexOf(n))throw new qE("Graph disconnected: cannot obtain value for tensor ".concat(n,' at layer "').concat(e.name,'". The following previous layers were accessed without issue: ').concat(g));for(let e of t.outputTensors)m.push(e);g.push(e.name)}}this.nodesByDepth=h;let y=this.layers.map(e=>e.name);for(let e of y){let t=y.filter(t=>t===e).length;if(1!==t)throw new qE('The name "'.concat(e,'" is used ').concat(t," times in the model. All layer names should be unique. Layer names: ")+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new zA({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new KE("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},a=0,r=(e=>{let t=Object.keys(e);if(0===t.length)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);r&&this.parseWeights(e);for(let s of this.layers)for(let[e,t]of s.weights.entries()){let i=r?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[i])throw new KE("Duplicate weight name: ".concat(i));n[i]=t,a++}let i=[];for(let s in e){let a=s;if(null==n[s]){let e=s.split("/");a=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[a])i.push([n[a],e[s]]);else if(t)throw new KE("Provided weight data has no target variable: ".concat(s));delete n[a]}if(t){let e=[];for(let t in n)e.push(t);if(e.length>0)throw new KE("".concat(e.length," of ").concat(a," weights are not set: ").concat(e))}MA(i)}parseWeights(e){for(let t in Object.keys(e)){let n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],r=n.map(e=>e.startsWith("_")?e.slice(1):e).filter(e=>!a.includes(e)).join("/");r!==t&&(e[r]=e[t],delete e[t])}}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(bR),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=yR(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return Ug(()=>{e=t_(e);let n=new GA;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return KA(this.outputs,n,t)})}computeMask(e,t){return Ug(()=>{let n;return e=t_(e),n=null==t?JE(null,e.length):t_(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=CA(e);if(t.length!==this.inputLayers.length)throw new KE("Invalid inputShape argument ".concat(e,": model has ").concat(this.inputLayers.length," tensor inputs."));let n={};for(let s=0;s<t.length;s++){let e=this.inputLayers[s],a=t[s];n[e.name+"_0_0"]=a}let a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(l_);if(a.length>1)for(let s of a){let e=this.nodesByDepth[s];for(let t of e){let e=t.outboundLayer;if(-1!==this.inputLayers.map(e=>e.id).indexOf(e.id))continue;let a=[];for(let s=0;s<t.inboundLayers.length;s++){let e=t.inboundLayers[s],r=t.nodeIndices[s],i=t.tensorIndices[s],o=n["".concat(e.name,"_").concat(r,"_").concat(i)];a.push(o)}let r=CA(e.computeOutputShape(e_(a))),i=e.inboundNodes.indexOf(t);for(let t=0;t<r.length;t++){n["".concat(e.name,"_").concat(i,"_").concat(t)]=r[t]}}}let r=[],i=[];for(let s=0;s<this.outputLayers.length;s++){let e=this.outputLayers[s],t=this.outputLayersNodeIndices[s],n=this.outputLayersTensorIndices[s],a="".concat(e.name,"_").concat(t,"_").concat(n);i.push(a)}for(let s=0;s<i.length;s++){let e=i[s];ZE(e in n),r.push(n[e])}return e_(r)}runInternalGraph(e,t){null==t&&(t=JE(null,e.length));let n={};for(let o=0;o<this.inputs.length;++o){let a=this.inputs[o],r=e[o],i=t[o];n[a.id]=[r,i]}let a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(l_);for(let o of a){let e=this.nodesByDepth[o];for(let t of e){let e=t.outboundLayer,a=t.inputTensors,r=t.outputTensors,i=new Array;for(let t of a)t.id in n&&i.push(n[t.id]);if(i.length===a.length){let a,s,o,l,u={};if(null!=t.callArgs&&(u=t.callArgs),1===i.length){let[t,n]=i[0];null==u.mask&&(u.mask=n),o=t_(e.call(t,u)),l=t_(e.computeMask(t,n)),a=[t],s=[n]}else a=i.map(e=>e[0]),s=i.map(e=>e[1]),null==u.mask&&(u.mask=s),o=t_(e.call(a,u)),l=t_(e.computeMask(a,s));if(e.activityRegularizer)throw new XE("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<r.length;++e){let t=r[e],a=o[e],i=l[e];n[t.id]=[a,i]}}}}let r=[],i=[],s=[];for(let o of this.outputs){ZE(o.id in n,"Could not compute output ".concat(o.name," : ").concat(o.id));let[e,t]=n[o.id];s.push(e.shape),r.push(e),i.push(t)}return[r,i,s]}buildNodeConversionMap(t){let n,a={};for(let r of this.layers){n=r instanceof e?1:0;for(let t=0;t<r.inboundNodes.length;t++){let i=e.nodeKey(r,t);this.containerNodes.has(i)&&(a[i]=n,n+=1)}}return a}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new KE("Provide either a layer name or layer index");if("number"==typeof e)return this.findLayer(e);for(let n of this.layers)if(n.name===e)return n;throw new KE("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new KE("Was asked to retrieve layer at index ".concat(e,", but model only has ").concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return Ug(()=>{let t=[];for(let n of this.layers)for(let a=0;a<n.inboundNodes.length;++a){let r=e.nodeKey(n,a);this.containerNodes.has(r)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),a=[];for(let o of this.layers){let t=o.getClassName(),r=o.getConfig(),i=[];for(let a=0;a<o.inboundNodes.length;a++){let t=o.inboundNodes[a],r=e.nodeKey(o,a),l={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),l=t.callArgs}catch(s){console.warn("Layer ".concat(o.name," was passed non-serializable keyword arguments: ").concat(t.callArgs,". They will not be included in the serialized model (and thus will be missing at deserialization time).")),l={}}if(t.inboundLayers.length>0){let a=[];for(let r=0;r<t.inboundLayers.length;r++){let i=t.inboundLayers[r],s=t.nodeIndices[r],o=t.tensorIndices[r],u=n[e.nodeKey(i,s)];null==u&&(u=0),a.push([i.name,u,o,l])}i.push(a)}}}let l={};l.name=o.name,l.className=t,l.config=r,l.inboundNodes=i,a.push(l)}t.layers=a;let r=[];for(let o=0;o<this.inputLayers.length;o++){let t=this.inputLayers[o],a=this.inputLayersNodeIndices[o],i=e.nodeKey(t,a);if(!this.containerNodes.has(i))continue;let s=n[i];null==s&&(s=0);let l=this.inputLayersTensorIndices[o];r.push([t.name,s,l])}t.inputLayers=r;let i=[];for(let o=0;o<this.outputLayers.length;o++){let t=this.outputLayers[o],a=this.outputLayersNodeIndices[o],r=e.nodeKey(t,a);if(!this.containerNodes.has(r))continue;let s=n[r];null==s&&(s=0);let l=this.outputLayersTensorIndices[o];i.push([t.name,s,l])}return t.outputLayers=i,t}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={},r={};function i(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}function s(e,t){let n,r=[];for(let s of t){let o=s[0],l=s[1],u=s[2];if(n=null==s[3]?{}:s[3],!(o in a))return void i(e,t);let c=a[o];if(c.inboundNodes.length<=l)return void i(e,t);let d=c.inboundNodes[l];r.push(d.outputTensors[u])}r.length>0&&e.apply(e_(r),n)}function o(e){let r=e.name,s=WF(e,null!=t.customObjects?t.customObjects:{});s.setFastWeightInitDuringBuild(n),a[r]=s,e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new KE("Corrupted configuration, expected array for nodeData: ".concat(e));i(s,e)})}let l=t.name,u=t.layers;for(let f of u)o(f);for(;!c_(r);)for(let e of u){let t=a[e.name];if(t.name in r){let e=r[t.name];delete r[t.name];for(let n of e)s(t,n)}}let c=[],d=[],h=t.inputLayers;for(let f of h){let e=f[0],t=f[1],n=f[2];ZE(e in a);let r=a[e].inboundNodes[t].outputTensors;c.push(r[n])}let p=t.outputLayers;for(let f of p){let e=f[0],t=f[1],n=f[2];ZE(e in a);let r=a[e].inboundNodes[t].outputTensors;d.push(r[n])}return new e({inputs:c,outputs:d,name:l})}get stateful(){if(this._stateful)throw new KE("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Ug(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}};function xR(e,t){return function(e,t,n){let a=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===a)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==a)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," element(s), but the model has ").concat(a," outputs. Make sure a set of weights is provided for each model output."));return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){let n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}throw new Error("The model has multiple (".concat(a,") outputs, so ").concat(n," must be either an array with ").concat(a," elements or an object with ").concat(t," keys. Provided ").concat(n," not understood: ").concat(JSON.stringify(e)))}(e,t,"classWeight")}async function wR(e,t,n,a){if(null!=t||null!=a)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){let t=Ug(()=>{if(1===e.shape.length)return eb(e);if(2===e.shape.length){if(e.shape[1]>1)return hb(e,1);if(1===e.shape[1])return Mb(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") during handling of class weights. The size is expected to be >= 1."))}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during handling of class weights. The rank is expected to be 1 or 2."))}),a=Array.from(await t.data());jg(t);let r=[];return a.forEach(e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. The class ".concat(e," exists in the data but not in classWeight"));r.push(n[e])}),xk(r,"float32")}return null}function kR(e,t){return ib(e,t)}function SR(e,t){let n,a,r=t;n=r.xs,a=r.ys,um.assert(null!=n&&null!=a,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ".concat(t));let i=IR("input",e.inputNames,n),s=IR("output",e.outputNames,a),o=i[0].shape[0];um.assert(i.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset provides ").concat(i.length," inputs.  (Expected input keys: ").concat(JSON.stringify(e.inputNames),")")),um.assert(s.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset provides ").concat(s.length," outputs.  (Expected output keys: ").concat(JSON.stringify(e.outputNames),")"));for(let l=0;l<i.length;l++)um.assert(i[l].shape[0]===o,()=>"Batch size mismatch: input ".concat(e.inputNames[l]," has ").concat(i[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));for(let l=0;l<s.length;l++)um.assert(s[l].shape[0]===o,()=>"Batch size mismatch: output ".concat(e.outputNames[l]," has ").concat(s[l].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],"."));return{xs:i,ys:s}}function IR(e,t,n){if(n instanceof Gm)return[n];if(Array.isArray(n))return um.assert(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{let a=[];for(let r of t){if(null==n[r])throw new KE("The feature data generated by the dataset lacks the required ".concat(e," key '").concat(r,"'."));a.push(n[r])}return a}}async function NR(e,t,n){let a=null!=n.batchesPerEpoch;if(um.assert(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),um.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),um.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got ".concat(n.epochs)),um.assert(!a||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ".concat(n.batchesPerEpoch)),um.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let r,i,s=null!=n.validationData;if(s)if(TR(n.validationData))um.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ".concat(n.validationBatches));else{let e=function(e){if(3===e.length)throw new XE("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);r=e.xs,i=e.ys}let o,l=e.makeTrainFunction(),u=e.getDedupedMetricsNames();o=s?u.slice().concat(u.map(e=>"val_"+e)):u.slice();let c=LF(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:h,history:p}=BF(c,d,n.epochs,null,null,function(e,t){let n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(t,n),null,s,o);h.setModel(e),e.history=p,await h.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){let o={};await h.onEpochBegin(f);let c=0,d=0;for(a||(m=await t.iterator());!a||c<n.batchesPerEpoch;){let t=await m.next();if(a&&t.done){console.warn("You provided `batchesPerEpoch` as ".concat(n.batchesPerEpoch,", but your dataset iterator ran out of data after ").concat(c," batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, ").concat(n.batchesPerEpoch*n.epochs," batches). You may need to use the repeat() function when building your dataset."));break}if(null!=t.value){let{xs:a,ys:r}=SR(e,t.value),i={};i.batch=d,i.size=a[0].shape[0],await h.onBatchBegin(d,i);let s=[];if(null!=n.classWeight){let t=xR(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)s.push(await wR(r[e],null,t[e]))}let o=a.concat(r).concat(s),p=l(o);jg(o);for(let e=0;e<u.length;++e){let t=u[e],n=p[e];i[t]=n,Gg(n)}await h.onBatchEnd(d,i),FF(i),d++,c++}if(a?c>=n.batchesPerEpoch:t.done){if(s){let t;t=TR(n.validationData)?t_(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):t_(e.evaluate(r,i,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)o["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(f,o),f++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function TR(e){return"function"==typeof e.iterator}function CR(e){um.assert(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function ER(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>G_(e,t,n-t)):G_(e,t,n-t)}function _R(e,t){return Ug(()=>null==e?null:Array.isArray(e)?e.map(e=>_R(e,t)):Z_(e,"int32"===t.dtype?t:$y(t,"int32")))}function AR(e,t){let n=[],a=0,r=null;for(;a<e;)r=a+t,r>=e&&(r=e),n.push([a,r]),a=r;return n}function FR(e){let t=[];e instanceof Gm&&(e=[e]);for(let n=0;n<e.length;++n){let a=e[n];if(1===a.rank)t.push(j_(a,1));else{if(0===a.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(a)}}return t}function RR(e,t){if(null==e)return;let n=[];if(t instanceof Gm)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(let r in t){let e=t[r];n.push(e.id)}let a=[];if(e instanceof Gm)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&a.push(e)});else if(null!=e)for(let r in e){let t=e[r];-1===n.indexOf(t.id)&&a.push(t)}a.forEach(e=>{e.isDisposed||e.dispose()})}function DR(e){return Array.isArray(e)}function MR(e){return!function(e){return e instanceof Gm}(e)&&!DR(e)}function OR(e,t,n){let a,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(DR(e)&&e.length>0)t=!0;else if(MR(e)){for(let n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new KE("Error when checking model ".concat(i," expected no data, but got ").concat(e))}return[]}if(null==e)return t.map(e=>null);if(MR(e)){a=[];for(let n of t){if(null==e[n])throw new KE('No data provided for "'.concat(n,'". Need data for each key in: ').concat(t));a.push(e[n])}}else if(DR(e)){if(e.length!==t.length)throw new KE("Error when checking model ".concat(i,": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got the following list of Tensor(s): ").concat(e));a=e}else{if(t.length>1)throw new KE("The model ".concat(i," expects ").concat(t.length," Tensor(s), but only received one Tensor. Found: Tensor with shape ").concat(e.shape));a=[e]}if(a=FR(a),null!=n)for(let s=0;s<t.length;++s){if(null==n[s])continue;let e=a[s];if(e.shape.length!==n[s].length)throw new KE("Error when checking ".concat(i,": expected ").concat(t[s]," to have ").concat(n[s].length," dimension(s). but got array with shape ").concat(e.shape));for(let t=0;t<n[s].length;++t){if(0===t&&!r)continue;let a=e.shape[t],o=n[s][t];if(null!=o&&o>=0&&a!==o)throw new KE("".concat(i," expected a batch of elements where each example has shape [").concat(n[s].slice(1,n[s].length),"] (i.e.,tensor shape [*,").concat(n[s].slice(1,n[s].length),"]) but the ").concat(i," received an input with ").concat(e.shape[0]," examples, each with shape [").concat(e.shape.slice(1,e.shape.length),"] (tensor shape [").concat(e.shape,"])"))}}return a}function PR(e,t,n){let a,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new KE("Error when checking model ".concat(i,": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got ").concat(e.length," Tensors(s)."));a=e}else{if(t.length>1)throw new KE("The model expects ".concat(t.length," ").concat(i," Tensors, but only received one Tensor. Found: array with shape ").concat(JSON.stringify(e.shape),"."));a=[e]}if(null!=n)for(let s=0;s<t.length;++s){if(null==n[s])continue;let e=a[s];if(e.shape.length!==n[s].length)throw new KE("Error when checking ".concat(i,": expected ").concat(t[s]," to have ").concat(n[s].length," dimension(s), but got array with shape ").concat(JSON.stringify(e.shape)));for(let a=0;a<n[s].length;++a){if(0===a&&!r)continue;let o=e.shape[a],l=n[s][a];if(null!=l&&l!==o)throw new KE("Error when checking ".concat(i,": expected ").concat(t[s]," to have shape ").concat(JSON.stringify(n[s])," but got array with shape ").concat(JSON.stringify(e.shape),"."))}}}var LR=class extends vR{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new KE("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");dR(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){let t={Adagrad:()=>AN.adagrad(.01),Adadelta:()=>AN.adadelta(1,.95,V_()),Adam:()=>AN.adam(.001,.9,.999,V_()),Adamax:()=>AN.adamax(.002,.9,.999,V_(),0),RMSProp:()=>AN.rmsprop(.001,.9,0,V_()),SGD:()=>AN.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new KE("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof bI))throw new KE("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new KE("When passing an Array as loss, it should have one entry per model output. The model has ".concat(this.outputs.length," output(s), but you passed loss=").concat(e.loss,"."));t=e.loss.map(e=>QF(e))}else{let n=QF(e.loss);this.outputs.forEach(e=>{t.push(n)})}else{e.loss=e.loss;for(let t in e.loss)if(-1===this.outputNames.indexOf(t))throw new KE('Unknown entry in loss dictionary: "'.concat(t,'". Only expected the following keys: ').concat(this.outputNames));for(let n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ').concat(n," during training")),t.push(QF(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){let e=this.internalOutputShapes[i],t=this.outputNames[i];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[i])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],A_("loss",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;let t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}});let a=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>[]);let n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map(e=>n);{let e=[];for(let a of t){let t=n.hasOwnProperty(a)?n[a]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),r=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};A_("metric",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,a,i;for(let s of t){if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){let t,r=this.internalOutputShapes[e];1===r[r.length-1]||this.lossFunctions[e]===KF?-1!==["accuracy","acc"].indexOf(s)?a=JF:-1!==["crossentropy","ce"].indexOf(s)&&(a=nR):this.lossFunctions[e]===qF?-1!==["accuracy","acc"].indexOf(s)?a=aR:-1!==["crossentropy","ce"].indexOf(s)&&(a=iR):-1!==["accuracy","acc"].indexOf(s)?a=ZF:-1!==["crossentropy","ce"].indexOf(s)&&(a=rR),-1!==["accuracy","acc"].indexOf(s)?t="acc":-1!==["crossentropy","ce"].indexOf(s)&&(t="ce"),i=a,n=""+t}else i=oR(s),n=""+lR(s);let t;A_(n,()=>{t=i}),r(e,n,t)}})(a[e])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null==n.batchSize?32:n.batchSize;CR(a);let r=this.standardizeUserDataXY(e,t,!0,a);try{let e=r[0].concat(r[1]);this.makeTestFunction();let t=this.testFunction;return e_(this.testLoop(t,e,a,n.verbose,n.steps))}finally{RR(r[0],e),RR(r[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){let a=null!=(n=n||{}).batches,r=e.testFunction,i=[];if(n.verbose>0)throw new XE("Verbose mode is not implemented yet.");um.assert(!a||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received ".concat(JSON.stringify(n.batches)));let s=function(e){return"function"==typeof e.next}(t)?t:await t.iterator(),o=0,l=0;for(;!a||l<n.batches;){let t=await s.next();if(i=Ug(()=>{if(t.value){let{xs:n,ys:a}=SR(e,t.value),s=n.concat(a),u=Ug(()=>r(s));if(jg(s),0===l)for(let e=0;e<u.length;++e)i.push(qv(0));let c=s[0].shape[0];for(let e=0;e<u.length;++e){let t=u[e],n=i[e];i[e]=Ug(()=>nb(i[e],ib(c,t))),l>0&&jg(n)}jg(u),o+=c,++l}return i}),t.done){a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, ".concat(n.batches," batches). You may need to use the repeat() function when building your dataset."));break}}for(let u=0;u<i.length;++u){let e=i[u];i[u]=rb(i[u],o),jg(e)}return e_(i)}(this,e,t)}checkNumSamples(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(a=null,null!=t)throw new KE("If ".concat(r," is set, batchSize must be null or undefined.Got batchSize = ").concat(t))}else{if(null==e)throw new KE("Either the input data should have a defined shape, or ".concat(r," shoud be specified."));a=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return a}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new KE("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),a=n?t:[t],r=this.retrieveSymbolicTensors(a),i=new GA;if(e instanceof Gm&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new KE("The number of inputs provided (".concat(e.length,") does not match the number of inputs of this model (").concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)i.add(this.inputs[t],e[t])}else for(let o of this.inputs){let t=e[o.name];if(null==t)throw new KE("No value is provided for the model's input ".concat(o.name));i.add(o,t)}let s=KA(r,i);return n?s:s[0]}retrieveSymbolicTensors(e){let t=JE(null,e.length),n=e.length;for(let a of this.layers){let r=Array.isArray(a.output)?a.output:[a.output],i=r.map(e=>e.name);for(let a=0;a<e.length;++a){let s=i.indexOf(e[a]);if(-1!==s&&(t[a]=r[s],n--),0===n)break}if(0===n)break}if(n>0){let n=[];throw t.forEach((t,a)=>{null==t&&n.push(e[a])}),new KE("Cannot find SymbolicTensors for output name(s): ".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ug(()=>{let a=this.checkNumSamples(e);if(n)throw new XE("Verbose predictLoop() is not implemented yet.");let r=AR(a,t),i=this.outputs.map(e=>[]);for(let t=0;t<r.length;++t)Ug(()=>{let n=r[t][0],a=r[t][1],i=ER(e,n,a),s=[];if(Array.isArray(i))for(let e=0;e<i.length;++e)s.push({key:this.inputs[e],value:i[e]});else s.push({key:this.inputs[0],value:i});let o=new GA(s);return KA(this.outputs,o)}).forEach((e,t)=>i[t].push(e));return e_(i.map(e=>Lb(e,0)))})}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=FR(e);PR(n,this.inputNames,this.feedInputShapes,!1);try{let e=null==t.batchSize?32:t.batchSize;return CR(e),this.predictLoop(n,e)}finally{RR(n,e)}}predictOnBatch(e){PR(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new qE("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let r=0;r<this.feedOutputShapes.length;++r){let e=this.feedOutputShapes[r];this.feedLossFns[r]===qF?a.push(e.slice(0,e.length-1).concat([1])):a.push(e)}if(function(e,t){let n=u_(e.map(e=>e.shape[0]));n.sort();let a=u_(t.map(e=>e.shape[0]));if(a.sort(),n.length>1)throw new KE("All input Tensors (x) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(e.map(e=>e.shape))));if(a.length>1)throw new KE("All target Tensors (y) should have the same number of samples. Got array shapes: ".concat(JSON.stringify(t.map(e=>e.shape))));if(n.length>0&&a.length>0&&!um.arraysEqual(n,a))throw new KE("Input Tensors should have the same number of samples as target Tensors. Found ".concat(n[0]," input sample(s) and ").concat(a[0]," target sample(s)."))}(e=OR(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=OR(t,this.feedOutputNames,a,!1,"target")),function(e,t,n){let a=[UF,KF,HF];for(let r=0;r<e.length;++r){let i=e[r],s=t[r],o=n[r];if(null!=s){if(s===HF&&1===i.shape[i.shape.length-1])throw new KE("You are passing a target array of shape ".concat(i.shape," while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes]."));if(-1!==a.indexOf(s)){let e=i.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){let a=e[n],r=t[n];if(null!=r&&a!==r)throw new KE("A target Tensor with shape ".concat(i.shape," was passed for an output of shape ").concat(o,", while using a loss function that expects targets to have the same shape as the output."))}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new KE("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0,[s,o]=this.standardizeUserDataXY(e,t,r,i);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=a){let e=xR(a,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await wR(o[t],null,e[t]))}return[s,o,l]}testLoop(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;return Ug(()=>{let i=this.checkNumSamples(t,n,r,"steps"),s=[];if(a>0)throw new XE("Verbose mode is not implemented yet.");if(null!=r)throw new XE("steps mode in testLoop() is not implemented yet");{let a=AR(i,n),r=xk(W_(0,i));for(let n=0;n<a.length;++n){let i=a[n][0],o=a[n][1],l=G_(r,i,o-i),u=_R(t,l),c=e(u);if(0===n)for(let e=0;e<c.length;++e)s.push(qv(0));for(let e=0;e<c.length;++e){let t=c[e];s[e]=nb(s[e],ib(o-i,t))}}for(let e=0;e<s.length;++e)s[e]=rb(s[e],i)}return s})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let a=e[n],r=a;if($E(e,a)>1){let t=$E(e.slice(0,n),a);r+="_".concat(t)}t.push(r)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],s=this.collectedTrainableWeights.map(e=>e.read());return[this.optimizer_.minimize(()=>{let e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});let s,o=new GA(e),l=KA(this.outputs,o,{training:!0});for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(a[n],l[n]);null!=r[n]&&(e=kR(e,r[n]));let i=jx(e);t.push(i),s=0===n?e:nb(s,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{let t=this.metricsTensors[n][0],r=this.metricsTensors[n][1];e=jx(t(a[r],l[r]))}Gg(e),i.push(e)}return s=jx(s),this.calculateLosses().forEach(e=>{s=nb(s,e)}),s},!0,s)].concat(i)}}makeTestFunction(){this.testFunction=e=>Ug(()=>{let t,n=[],a=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let e=0;e<this.inputs.length;++e)i.push({key:this.inputs[e],value:a[e]});let s=new GA(i),o=KA(this.outputs,s);for(let e=0;e<this.lossFunctions.length;++e){let a=this.lossFunctions[e],i=jx(a(r[e],o[e]));t=0===e?i:nb(t,i),n.push(t)}for(let e=0;e<this.metricsTensors.length;++e){let t=this.metricsTensors[e][0],a=this.metricsTensors[e][1],i=jx(t(r[a],o[a]));n.push(i)}return n})}async fit(e,t){let n,a,r,i,s,o,l,u,c,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{let h=null==d.batchSize?32:d.batchSize;CR(h);let p=await this.standardizeUserData(e,t,d.sampleWeight,d.classWeight,!1,h);n=p[0],a=p[1],c=p[2];let f,m=!1;if(null!=d.validationData&&d.validationData.length>0){if(m=!0,2!==d.validationData.length)throw 3===d.validationData.length?new XE("validationData including sample weights is not supported yet."):new KE("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ".concat(d.validationData," is invalid."));s=d.validationData[0],o=d.validationData[1];let e=await this.standardizeUserData(s,o,null,null,!0,h);l=e[0],u=e[1],f=l.concat(u)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){m=!0;let e=Math.floor(n[0].shape[0]*(1-d.validationSplit)),t=n[0].shape[0];l=ER(n,e,t),r=n,n=ER(n,0,e),u=ER(a,e,t),i=a,a=ER(a,0,e),f=l.concat(u)}else null!=d.validationSteps&&(m=!0);let g=n.concat(a).concat(c);this.checkTrainableWeightsConsistency();let y,b,v=this.makeTrainFunction(),x=this.getDedupedMetricsNames();m?(this.makeTestFunction(),y=this.testFunction,b=x.slice().concat(x.map(e=>"val_"+e))):(y=null,f=[],b=x.slice());let w=LF(d.callbacks,d.yieldEvery);return await this.fitLoop(v,g,x,h,d.epochs,d.verbose,w,y,f,d.shuffle,b,d.initialEpoch,null,null)}finally{this.isTraining=!1,RR(n,e),RR(a,t),RR(r,e),RR(i,t),RR(l,s),RR(u,o),null!=c&&jg(c)}}async fitLoop(e,t,n,a,r,i,s,o,l,u,c,d,h,p){null==a&&(a=32),null==r&&(r=1),null==u&&(u=!0),null==d&&(d=0);let f=!1;if(null!=o&&null!=l&&(f=!0),null!=p&&(f=!0,null==h))throw new KE("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m,g=this.checkNumSamples(t,a,h,"steps_per_epoch");null!=g&&(m=W_(0,g)),null==i&&(i=1);let{callbackList:y,history:b}=BF(s,i,r,d,g,h,a,f,c);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=d;v<r;++v){await y.onEpochBegin(v);let r={};if(null!=h)throw new XE("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new XE("batch shuffling is not implemneted yet");u&&um.shuffle(m);let i=xk(m),s=AR(g,a);for(let u=0;u<s.length;++u){let c={};if(await y.onBatchBegin(u,c),Ug(()=>{let d=s[u][0],h=s[u][1],p=G_(i,d,h-d);c.batch=u,c.size=h-d;let m=_R(t,p),g=e(m);for(let e=0;e<n.length;++e){let t=n[e],a=g[e];c[t]=a,Gg(a)}if(u===s.length-1&&f){let e=this.testLoop(o,l,a);for(let t=0;t<n.length;++t){let a=n[t],i=e[t];Gg(i),r["val_"+a]=i}}}),await y.onBatchEnd(u,c),FF(c),this.stopTraining_)break}i.dispose()}if(await y.onEpochEnd(v,r),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return NR(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),a=n[0],r=n[1],i=this.makeTrainFunction()(a.concat(r)),s=[];for(let o of i){let e=await o.data();s.push(e[0])}return jg(i),RR(n[0],e),RR(n[1],t),e_(s)}getNamedWeights(e){let t=[],n=null!=e&&e.trainableOnly,a=n?this.trainableWeights:this.weights,r=this.getWeights(n);for(let i=0;i<a.length;++i)n&&!a[i].trainable||t.push({name:a[i].originalName,tensor:r[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){let t=Wg().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Wg().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=n_(this.loss);else if(Array.isArray(this.loss)){for(let e of this.loss)if("string"!=typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(e=>n_(e))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let a of t){if("string"!=typeof n[a])throw new Error("Serialization of non-string loss is not supported.");e[a]=n_(n[a])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[n_(lR(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>n_(lR(e)));{let e={};for(let t in this.metrics)e[t]=n_(lR(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");let t,n,a=WF(gR(e.optimizer_config));if("string"==typeof e.loss)t=a_(e.loss);else if(Array.isArray(e.loss))t=e.loss.map(e=>a_(e));else if(null!=e.loss){t={};for(let n in e.loss)t[n]=a_(e.loss[n])}if(Array.isArray(e.metrics))n=e.metrics.map(e=>a_(e));else if(null!=e.metrics){n={};for(let t in e.metrics)n[t]=a_(e.metrics[t])}this.compile({loss:t,metrics:n,optimizer:a})}async save(e,t){if("string"==typeof e){let t=CI.getSaveHandlers(e);if(0===t.length)throw new KE("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new KE("Found more than one (".concat(t.length,") save handlers for URL '").concat(e,"'"));e=t[0]}if(null==e.save)throw new KE("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await CI.encodeWeights(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(bR),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){a.trainingConfig=this.getTrainingConfig();let e="optimizer",{data:t,specs:r}=await CI.encodeWeights(await this.optimizer.getWeights(),e);n.specs.push(...r),n.data=CI.concatenateArrayBuffers([n.data,t])}return null!=this.userDefinedMetadata&&(uR(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=n.data,a.weightSpecs=n.specs,e.save(a)}setUserDefinedMetadata(e){uR(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};LR.className="Model",dI.registerClass(LR);var zR=class extends LR{};async function BR(e,t){"modelTopology"in e||(e={modelTopology:e});let n=e.modelTopology;null!=n.model_config&&(n=n.model_config);let a=WF(gR(n),t);if(null!=e.weightsManifest){let t=await CI.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(e=>e.originalName)),n={};for(let e of a.weights)n[e.originalName]=t[e.originalName];a.loadWeights(n),jg(t)}return a}async function WR(e,t){if(null==t&&(t={}),"string"==typeof e){let n=CI.getLoadHandlers(e,t);if(0===n.length)n.push(CI.browserHTTPRequest(e,t));else if(n.length>1)throw new KE("Found more than one (".concat(n.length,") load handlers for URL '").concat(e,"'"));e=n[0]}return async function(e,t,n){if(null==n&&(n={}),null==e.load)throw new KE("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let a=await e.load(),r=a.modelTopology;null!=r.model_config&&(r=r.model_config);let i=null==n.strict||n.strict,s=null!=a.weightData&&null!=a.weightSpecs&&i,o=WF(gR(r),t,s),l=a.trainingConfig;if(null!=l&&o.loadTrainingConfig(l),null!=a.userDefinedMetadata&&o.setUserDefinedMetadata(a.userDefinedMetadata),null!=a.weightData){if(null==a.weightSpecs)throw new KE("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:e,optimizerWeights:t}=function(e,t){let n=CI.decodeWeights(e,t),a={},r=[];return t.forEach(e=>{"optimizer"===e.group?r.push({name:e.name,tensor:n[e.name]}):a[e.name]=n[e.name]}),{modelWeights:a,optimizerWeights:r}}(a.weightData,a.weightSpecs);o.loadWeights(e,i),null!=o.optimizer&&t.length>0&&await o.optimizer.setWeights(t),jg(e),jg(t.map(e=>e.tensor))}return o}(e,void 0,t)}zR.className="Functional",dI.registerClass(zR);var VR=class e extends LR{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:v_("sequential_"),null!=e.layers)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new KE("Negative dimension size caused by adding layer ".concat(e.name," with input shape [").concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){let n,a=t instanceof e||t instanceof LR;if(a){if(n=t,1!==n.outputs.length)throw new KE("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new KE("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new KE("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let e=jA({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(a)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new KE("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ".concat(t.name," which has ").concat(t.inboundNodes.length," pre-existing inbound connections."));if(1!==t.inboundNodes[0].outputTensors.length)throw new KE("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=VA(this.outputs[0])}this.inboundNodes=[],new zA({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:JE(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{let e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(_A(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new LR({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new qE("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new qE("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new qE("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new qE("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(t,n){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new KE("Legacy serialization format not supported yet.");a=n}else um.assert(null!=n.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,i=n;let s=new t(i);if(!(s instanceof e))throw new XE("Sequential.fromConfig called on non-Sequential input: ".concat(s));for(let e of a){let t=WF(e,void 0,r);r&&t.setFastWeightInitDuringBuild(!0),s.add(t)}return s}set stopTraining(e){if(null==this.model)throw new KE("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new KE("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};function UR(e){return new LR(e)}function jR(e){return new VR(e)}function GR(e){return jA(e)}function HR(e,t){zF.registerCallbackConstructor(e,t)}VR.className="Sequential",dI.registerClass(VR);var qR=class extends dI.Serializable{getConfig(){return{}}},KR=class extends qR{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new XE("Support for alpha values other than 1 (".concat(t,") is not implemented yet."));return Rv(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}};KR.className="elu",dI.registerClass(KR);var XR=class extends qR{apply(e){return Zw(e)}};XR.className="selu",dI.registerClass(XR);var YR=class extends qR{apply(e){return jw(e)}};YR.className="relu",dI.registerClass(YR);var QR=class extends qR{apply(e){return Ug(()=>Kx(6,jw(e)))}};QR.className="relu6",dI.registerClass(QR);var JR=class extends qR{apply(e){return e}};JR.className="linear",dI.registerClass(JR);var ZR=class extends qR{apply(e){return Bb(e)}};ZR.className="sigmoid",dI.registerClass(ZR);var $R=class extends qR{apply(e){return function(e){return Ug(()=>{let t=nb(.5,ib(.2,e));return tv(t,0,1)})}(e)}};$R.className="hardSigmoid",dI.registerClass($R);var eD=class extends qR{apply(e){return Cx(e)}};eD.className="softplus",dI.registerClass(eD);var tD=class extends qR{apply(e){return function(e){return Ug(()=>rb(e,nb(sb(e),1)))}(e)}};tD.className="softsign",dI.registerClass(tD);var nD=class extends qR{apply(e){return Vb(e)}};nD.className="tanh",dI.registerClass(nD);var aD=class extends qR{apply(e){return lk(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}};aD.className="softmax",dI.registerClass(aD);var rD=class extends qR{apply(e){return Ax(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}};rD.className="logSoftmax",dI.registerClass(rD);var iD=class extends qR{apply(e){return Ug(()=>Ug(()=>{let t=Math.sqrt(2),n=ib(.5,nb(1,Mv(rb(e,t))));return ib(e,n)}))}};iD.className="gelu",dI.registerClass(iD);var sD=class extends qR{apply(e){return Ug(()=>ib(.5,ib(e,nb(1,Vb(ib(Kv(rb(2,Math.PI)),nb(e,ib(.044715,Hv(e,3)))))))))}};sD.className="gelu_new",dI.registerClass(sD);var oD=class extends qR{apply(e){return Ug(()=>ib(e,Vb(Cx(e))))}};oD.className="mish",dI.registerClass(oD);var lD=class extends qR{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ug(()=>ib(Bb(ib(e,t)),e))}};function uD(e){return e.getClassName()}function cD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o_(e,dI.SerializationMap.getMap().classNameMap,t,"activation")}function dD(e){if(null==e){let e={className:"linear",config:{}};return cD(e)}if("string"==typeof e){let t={};return t.className=e,t.config={},cD(t)}return e instanceof qR?e:cD(e)}function hD(e){if(null!=e&&"object"!=typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: ".concat(e))}lD.className="swish",dI.registerClass(lD);var pD=class extends dI.Serializable{},fD=class extends pD{constructor(e){super(),hD(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return Ug(()=>{let t=Gx([1]);return this.hasL1&&(t=nb(t,Yv(ib(this.l1,sb(e))))),this.hasL2&&(t=nb(t,Yv(ib(this.l2,$_(e))))),Mb(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};fD.className="L1L2",dI.registerClass(fD);var mD={l1l2:"L1L2"};function gD(e){return i_(e)}function yD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o_(e,dI.SerializationMap.getMap().classNameMap,t,"regularizer")}function bD(e){if(null==e)return null;if("string"==typeof e){return yD({className:e in mD?mD[e]:e,config:{}})}return e instanceof pD?e:yD(e)}var vD=class extends WA{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=EA(e);let n=jw(e);return null!=this.maxValue&&(n=tv(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};vD.className="ReLU",dI.registerClass(vD);var xD=class extends WA{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=EA(e);return hx(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};xD.className="LeakyReLU",dI.registerClass(xD);var wD=class extends WA{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=NA(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=bD(e.alphaRegularizer),this.alphaConstraint=oF(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new KE("Expected sharedAxes to be a number or an array of numbers, but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){let t=(e=_A(e)).slice(1);if(null!=this.sharedAxes)for(let a of this.sharedAxes)t[a-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(null!=this.sharedAxes)for(let a=1;a<e.length;++a)n[a]=e[a];this.inputSpec=[new OA({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=EA(e),cw(e,this.alpha.read())}getConfig(){let e={alphaInitializer:IA(this.alphaInitializer),alphaRegularizer:gD(this.alphaRegularizer),alphaConstraint:iF(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};wD.className="PReLU",dI.registerClass(wD);var kD=class extends WA{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new XE("Non-default alpha value (".concat(e.alpha,") is not supported by the ELU layer yet."));this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=EA(e);return Rv(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};kD.className="ELU",dI.registerClass(kD);var SD=class extends WA{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){let n=EA(e);return ib(n,$y(sx(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};SD.className="ThresholdedReLU",dI.registerClass(SD);var ID=class extends WA{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new aD).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return Ug(()=>{let n=EA(e),a=t.mask;if(null!=a){let e=ib(_x(Hx(n.shape),$y(a,n.dtype)),qv(-1e9));n=nb(n,e)}return this.axis instanceof Array?this.axis.length>1?$v(_x(n,Fx(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function ND(e,t,n){if("number"==typeof e)return JE(e,t);if(e.length!==t)throw new KE("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(e.length," elements."));for(let a=0;a<t;++a){let r=e[a];if(!P_(r))throw new KE("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(JSON.stringify(e)," including a non-integer number ").concat(r))}return e}function TD(e,t,n,a){let r;return null==e?e:(r="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((r+a-1)/a))}function CD(e,t,n,a){if(null==e)return null;if("valid"===a)e=e*t+B_([n-t,0]);else{if("same"!==a)throw new KE("Unsupport padding mode: ".concat(a,"."));e*=t}return e}function ED(e,t){return Ug(()=>(T_(t),"channelsFirst"===t?Vk(e,[0,2,3,1]):e))}function _D(e,t){return Ug(()=>(T_(t),"channelsFirst"===t?Vk(e,[0,2,3,4,1]):e))}function AD(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Ug(()=>{if(null==i&&(i="channelsLast"),T_(i),3!==e.rank&&4!==e.rank)throw new KE("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new KE("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ".concat(e.rank,"."));let l=ED(e,i);if("causal"===r)throw new XE("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Qk.conv2d({x:l,filter:t,strides:a,pad:"same"===r?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===i&&(l=Vk(l,[0,3,1,2])),l})}ID.className="Softmax",dI.registerClass(ID);var FD=class e extends WA{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(n),this.rank=t,p_(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new XE("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is not implemented yet."));if(this.kernelSize=ND(n.kernelSize,t,"kernelSize"),this.strides=ND(null==n.strides?1:n.strides,t,"strides"),this.padding=null==n.padding?"valid":n.padding,C_(this.padding),this.dataFormat=null==n.dataFormat?"channelsLast":n.dataFormat,T_(this.dataFormat),this.activation=dD(n.activation),this.useBias=null==n.useBias||n.useBias,this.biasInitializer=NA(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=oF(n.biasConstraint),this.biasRegularizer=bD(n.biasRegularizer),this.activityRegularizer=bD(n.activityRegularizer),this.dilationRate=ND(null==n.dilationRate?1:n.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new KE("dilationRate must be a number or an array of a single number for 1D convolution, but received ".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new KE("dilationRate must be a number or array of two numbers for 2D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new KE("dilationRate must be a number or array of three numbers for 3D convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(ZE("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!h_(e.kernelSize,"number",1,3))throw new KE("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:uD(this.activation),useBias:this.useBias,biasInitializer:IA(this.biasInitializer),biasRegularizer:gD(this.biasRegularizer),activityRegularizer:gD(this.activityRegularizer),biasConstraint:iF(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},RD=class e extends FD{constructor(t,n){super(t,n),this.kernel=null,e.verifyArgs(n),this.filters=n.filters,p_(this.filters,"filters"),this.kernelInitializer=NA(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=oF(n.kernelConstraint),this.kernelRegularizer=bD(n.kernelRegularizer)}build(e){e=_A(e);let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new KE("The channel dimension of the input should be defined. Found ".concat(e[t]));let n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return Ug(()=>{e=EA(e);let t,n=null==this.bias?null:this.bias.read(),a=m_(this.activation.getClassName());if(null!=a&&2===this.rank)t=AD(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(1===this.rank)t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Ug(()=>{if(null==i&&(i="channelsLast"),T_(i),3!==e.shape.length)throw new KE("The input of a conv1dWithBias operation should be 3, but is ".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new KE("The kernel for a conv1dWithBias operation should be 3, but is ".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new KE("The bias for a conv1dWithBias operation should be 1, but is ".concat(n.shape.length," instead"));if("channelsFirst"===i&&(e=Vk(e,[0,2,1])),"causal"===r)throw new XE("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=ov(e,t,a,"same"===r?"same":"valid","NWC",s);return null!=n&&(o=tA(o,n)),o})}(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=AD(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new XE("convolutions greater than 3D are not implemented yet.");t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return Ug(()=>{if(null==i&&(i="channelsLast"),T_(i),4!==e.rank&&5!==e.rank)throw new KE("conv3dWithBias expects input to be of rank 4 or 5, but received ".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new KE("conv3dWithBias expects kernel to be of rank 4 or 5, but received ".concat(e.rank,"."));let o=_D(e,i);if("causal"===r)throw new XE("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=cv(o,t,a,"same"===r?"same":"valid","NDHWC",s),null!=n&&(o=tA(o,n)),"channelsFirst"===i&&(o=Vk(o,[0,4,1,2,3])),o})}(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=_A(e);let t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<n.length;++r){let e=TD(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(e)}let a=[e[0]];return"channelsLast"===this.dataFormat?(a=a.concat(t),a.push(this.filters)):(a.push(this.filters),a=a.concat(t)),a}getConfig(){let e={filters:this.filters,kernelInitializer:IA(this.kernelInitializer),kernelRegularizer:gD(this.kernelRegularizer),kernelConstraint:iF(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new KE("Convolution layer expected config.filters to be a 'number' > 0 but got ".concat(JSON.stringify(e.filters)))}},DD=class e extends RD{constructor(t){super(2,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!h_(e.kernelSize,"number",1,2))throw new KE("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}};DD.className="Conv2D",dI.registerClass(DD);var MD=class e extends RD{constructor(t){super(3,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new KE("Conv3D expects config.kernelSize to be number or [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}};MD.className="Conv3D",dI.registerClass(MD);var OD=class extends DD{constructor(e){if(super(e),this.inputSpec=[new OA({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new KE("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=_A(e)).length)throw new KE("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new KE("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new OA({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return Ug(()=>{let t=EA(e);if(4!==t.shape.length)throw new KE("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(t.shape.length));let n,a,r=t.shape,i=r[0];"channelsFirst"===this.dataFormat?(n=2,a=3):(n=1,a=2);let s=r[n],o=r[a],l=this.kernelSize[0],u=this.kernelSize[1],c=this.strides[0],d=this.strides[1],h=[i,CD(s,c,l,this.padding),CD(o,d,u,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Vk(t,[0,2,3,1]));let p=uv(t,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=Vk(p,[0,3,1,2])),null!=this.bias&&(p=tA(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p})}computeOutputShape(e){let t,n,a,r=(e=_A(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3):(t=3,n=1,a=2);let i=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return r[t]=this.filters,r[n]=CD(r[n],o,i,this.padding),r[a]=CD(r[a],l,s,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};OD.className="Conv2DTranspose",dI.registerClass(OD);var PD=class extends MD{constructor(e){if(super(e),this.inputSpec=[new OA({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new KE("Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=_A(e)).length)throw new KE("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new KE("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new OA({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return Ug(()=>{let t=EA(e);if(5!==t.shape.length)throw new KE("Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-".concat(t.shape.length));let n,a,r,i=t.shape,s=i[0];"channelsFirst"===this.dataFormat?(r=2,n=3,a=4):(r=1,n=2,a=3);let o=i[r],l=i[n],u=i[a],c=this.kernelSize[0],d=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],f=this.strides[1],m=this.strides[2],g=[s,CD(o,p,c,this.padding),CD(l,f,d,this.padding),CD(u,m,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Vk(t,[0,2,3,4,1]));let y=hv(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=Vk(y,[0,4,1,2,3])),null!==this.bias&&(y=tA(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y})}computeOutputShape(e){let t,n,a,r,i=(e=_A(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3,r=4):(t=4,n=1,a=2,r=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],c=this.strides[1],d=this.strides[2];return i[t]=this.filters,i[n]=CD(i[n],u,s,this.padding),i[a]=CD(i[a],c,o,this.padding),i[r]=CD(i[r],d,l,this.padding),i}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};PD.className="Conv3DTranspose",dI.registerClass(PD);var LD=class extends RD{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new KE("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new KE("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new KE("SeparableConv".concat(this.rank,"D supports only padding modes: 'same' and 'valid', but received ").concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=NA(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=bD(t.depthwiseRegularizer),this.depthwiseConstraint=oF(t.depthwiseConstraint),this.pointwiseInitializer=NA(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=bD(t.pointwiseRegularizer),this.pointwiseConstraint=oF(t.pointwiseConstraint)}build(e){if((e=_A(e)).length<this.rank+2)throw new KE("Inputs to SeparableConv".concat(this.rank,"D should have rank ").concat(this.rank+2,", but received input shape: ").concat(JSON.stringify(e)));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new KE("The channel dimension of the inputs should be defined, but found ".concat(JSON.stringify(e[t])));let n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),r=[];for(let s=0;s<this.rank;++s)r.push(1);r.push(n*this.depthMultiplier,this.filters);let i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new OA({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return Ug(()=>{let t;if(e=EA(e),1===this.rank)throw new XE("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=Vk(e,[0,2,3,1])),t=$w(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=tA(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=Vk(t,[0,3,1,2])),t})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=IA(this.depthwiseInitializer),e.pointwiseInitializer=IA(this.pointwiseInitializer),e.depthwiseRegularizer=gD(this.depthwiseRegularizer),e.pointwiseRegularizer=gD(this.pointwiseRegularizer),e.depthwiseConstraint=iF(this.depthwiseConstraint),e.pointwiseConstraint=iF(this.pointwiseConstraint),e}};LD.className="SeparableConv";var zD=class extends LD{constructor(e){super(2,e)}};zD.className="SeparableConv2D",dI.registerClass(zD);var BD=class e extends RD{constructor(t){super(1,t),e.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!h_(e.kernelSize,"number",1,1))throw new KE("Conv1D expects config.kernelSize to be number or number[] with length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}};BD.className="Conv1D",dI.registerClass(BD);var WD=class extends WA{constructor(e){super(e),"number"==typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return Ug(()=>{if(e=EA(e),"channelsLast"===this.dataFormat){let t=q_(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return q_(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{let t=q_(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return q_(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};WD.className="Cropping2D",dI.registerClass(WD);var VD=class extends WA{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,T_(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){d_(w_,"InterpolationFormat",e)}(this.interpolation)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){let t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{let t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return Ug(()=>{let t=EA(e),n=t.shape;if("channelsFirst"===this.dataFormat){t=Vk(t,[0,2,3,1]);let e=this.size[0]*n[2],a=this.size[1]*n[3],r="nearest"===this.interpolation?sI.resizeNearestNeighbor(t,[e,a]):sI.resizeBilinear(t,[e,a]);return Vk(r,[0,3,1,2])}{let e=this.size[0]*n[1],a=this.size[1]*n[2];return"nearest"===this.interpolation?sI.resizeNearestNeighbor(t,[e,a]):sI.resizeBilinear(t,[e,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};VD.className="UpSampling2D",dI.registerClass(VD);var UD=class extends FD{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=NA(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=oF(e.depthwiseConstraint),this.depthwiseRegularizer=bD(e.depthwiseRegularizer)}build(e){if((e=_A(e)).length<4)throw new KE("Inputs to DepthwiseConv2D should have rank 4. Received input shape: ".concat(JSON.stringify(e),"."));let t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new KE("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (".concat(e[t],")."));let n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ug(()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return Ug(()=>{null==r&&(r="channelsLast"),T_(r);let s=ED(e,r);if(4!==e.rank)throw new KE("Input for depthwiseConv2d is required to be 4-D, but is instead ".concat(e.rank,"-D"));if(4!==t.rank)throw new KE("depthwiseKernel is required to be 4-D, but is instead ".concat(t.rank,"-D"));return s=vv(s,t,n,"same"===a?"same":"valid","NHWC",i),"channelsFirst"===r&&(s=Vk(s,[0,3,1,2])),s})}(e=EA(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=tA(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=_A(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=TD(t,this.kernelSize[0],this.padding,this.strides[0]),i=TD(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],a,r,i]:[e[0],r,i,a]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=IA(this.depthwiseInitializer),e.depthwiseRegularizer=gD(this.depthwiseRegularizer),e.depthwiseConstraint=iF(this.depthwiseRegularizer),e}};function jD(e,t,n,a){if(Array.isArray(e)){if(null!=t||null!=n)throw new KE("When inputs is an array, neither initialState or constants should be provided");null!=a&&(n=e.slice(e.length-a,e.length),e=e.slice(0,e.length-a)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=r(t),constants:n=r(n)}}function GD(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Ug(()=>{let l=t.shape.length;if(l<3)throw new KE("Input should be at least 3D, but is ".concat(l,"D."));let u=[1,0].concat(W_(2,l));if(t=Vk(t,u),null!=i)throw new XE("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=r&&(r=$y($y(r,"bool"),"float32"),r.rank===l-1&&(r=ex(r,-1)),r=Vk(r,u)),a&&(t=Hw(t,0),null!=r&&(r=Hw(r,0)));let c,d,h,p=[],f=n,m=t.shape[0],g=Ok(t);null!=r&&(d=Ok(r));for(let t=0;t<m;++t){let n=g[t],a=Ug(()=>e(n,f));if(null==r)c=a[0],f=a[1];else{let e=Ug(()=>{let e=d[t],n=_x(tw(e),e);return{output:nb(ib(a[0],e),ib(f[0],n)),newStates:f.map((t,r)=>nb(ib(a[1][r],e),ib(t,n)))}});c=e.output,f=e.newStates}o&&p.push(c)}return o&&(h=gk(p,1)),[c,h,f]})}UD.className="DepthwiseConv2D",dI.registerClass(UD);var HD=class e extends WA{constructor(e){let t;if(super(e),null==e.cell)throw new KE("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new $D({cells:e.cell}):e.cell,null==t.stateSize)throw new KE("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new OA({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return W_(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(e=>null)}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){TA(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n,a=t[0];if(n=this.returnSequences?[e[0],e[1],a]:[e[0],a],this.returnState){let a=[];for(let n of t)a.push([e[0],n]);return[n].concat(a)}return n}computeMask(e,t){return Ug(()=>{Array.isArray(t)&&(t=t[0]);let e=this.returnSequences?t:null;if(this.returnState){let t=this.states.map(e=>null);return[e].concat(t)}return e})}get states(){if(null==this.states_){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new XE("Constants support is not implemented in RNN yet.");TA(e)&&(e=e[0]);let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new OA({shape:[t,null,...n]});let a,r=[e[0]].concat(e.slice(2));if(this.cell.build(r),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!um.arraysEqual(this.stateSpec.map(e=>e.shape[e.shape.length-1]),a))throw new KE("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; However cell.stateSize is ").concat(this.cell.stateSize))}else this.stateSpec=a.map(e=>new OA({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ug(()=>{if(!this.stateful)throw new HE("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(null==n)throw new KE("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>Gx([n,e])):this.states_=[Gx([n,this.cell.stateSize])];else if(null==e)jg(this.states_),null!=this.keptStates&&(jg(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>Gx([n,e])):this.states_[0]=Gx([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new KE("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));!0===t?this.keptStates.push(this.states_.slice()):jg(this.states_);for(let t=0;t<this.states_.length;++t){let a=e[t],r=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,i=[n,r];if(!um.arraysEqual(a.shape,i))throw new KE("State ".concat(t," is incompatible with layer ").concat(this.name,": expected shape=").concat(i,", received shape=").concat(a.shape));this.states_[t]=a}}this.states_=this.states_.map(e=>Gg(e.clone()))})}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=jD(e,n,a,this.numConstants);e=r.inputs,n=r.initialState,a=r.constants;let i=[],s=[];if(null!=n){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(let e of n)this.stateSpec.push(new OA({shape:e.shape}));s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof PA){let n=[e].concat(i),a=this.inputSpec.concat(s),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}return super.apply(e,t)}call(e,t){return Ug(()=>{let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;e=EA(e),null==r&&(r=this.stateful?this.states_:this.getInitialState(e));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new KE("RNN Layer has ".concat(i," state(s) but was passed ").concat(r.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let s={training:a},o=GD((e,t)=>{let n=this.cell.call([e].concat(t),s);return[n[0],n.slice(1)]},e,r,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],c=o[2];this.stateful&&this.resetStates(c,a);let d=this.returnSequences?u:l;return this.returnState?[d].concat(c):d})}getInitialState(e){return Ug(()=>{let t=Gx(e.shape);return t=Yv(t,[1,2]),t=j_(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(e=>e>1?Y_(t,[1,e]):t):this.cell.stateSize>1?[Y_(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(n.numConstants=this.numConstants);let a=this.cell.getConfig();return this.getClassName()===e.className&&(n.cell={className:this.cell.getClassName(),config:a}),Object.assign(Object.assign(Object.assign({},a),t),n)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=WF(t.cell,n);return new e(Object.assign(t,{cell:a}))}};HD.className="RNN",dI.registerClass(HD);var qD=class extends WA{},KD=class extends qD{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,p_(this.units,"units"),this.activation=dD(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=NA(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=NA(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=NA(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bD(e.kernelRegularizer),this.recurrentRegularizer=bD(e.recurrentRegularizer),this.biasRegularizer=bD(e.biasRegularizer),this.kernelConstraint=oF(e.kernelConstraint),this.recurrentConstraint=oF(e.recurrentConstraint),this.biasConstraint=oF(e.biasConstraint),this.dropout=z_([1,B_([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=z_([1,B_([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=_A(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ug(()=>{if(2!==e.length)throw new KE("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];let a=null!=t.training&&t.training;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eM({ones:()=>tw(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eM({ones:()=>tw(n),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let r,i=this.dropoutMask,s=this.recurrentDropoutMask;r=J_(null!=i?ib(e,i):e,this.kernel.read()),null!=this.bias&&(r=tA(r,this.bias.read())),null!=s&&(n=ib(n,s));let o=nb(r,J_(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:uD(this.activation),useBias:this.useBias,kernelInitializer:IA(this.kernelInitializer),recurrentInitializer:IA(this.recurrentInitializer),biasInitializer:IA(this.biasInitializer),kernelRegularizer:gD(this.kernelRegularizer),recurrentRegularizer:gD(this.recurrentRegularizer),biasRegularizer:gD(this.biasRegularizer),activityRegularizer:gD(this.activityRegularizer),kernelConstraint:iF(this.kernelConstraint),recurrentConstraint:iF(this.recurrentConstraint),biasConstraint:iF(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};KD.className="SimpleRNNCell",dI.registerClass(KD);var XD=class extends HD{constructor(e){e.cell=new KD(e),super(e)}call(e,t){return Ug(()=>{null!=this.cell.dropoutMask&&(jg(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(jg(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return new e(t)}};XD.className="SimpleRNN",dI.registerClass(XD);var YD=class extends qD{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new KE("GRUCell does not support reset_after parameter set to true.");this.units=e.units,p_(this.units,"units"),this.activation=dD(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dD(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=NA(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=NA(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=NA(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bD(e.kernelRegularizer),this.recurrentRegularizer=bD(e.recurrentRegularizer),this.biasRegularizer=bD(e.biasRegularizer),this.kernelConstraint=oF(e.kernelConstraint),this.recurrentConstraint=oF(e.recurrentConstraint),this.biasConstraint=oF(e.biasConstraint),this.dropout=z_([1,B_([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=z_([1,B_([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){let t=(e=_A(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ug(()=>{if(2!==e.length)throw new KE("GRUCell expects 2 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=null!=t.training&&t.training,a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eM({ones:()=>tw(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eM({ones:()=>tw(a),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let r,i,s,o=this.dropoutMask,l=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=ib(e,o[0]));let u=J_(e,this.kernel.read());this.useBias&&(u=tA(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ib(a,l[0]));let c=this.recurrentKernel.read(),[d,h]=hk(c,[2*this.units,this.units],c.rank-1),p=J_(a,d),[f,m,g]=hk(u,3,u.rank-1),[y,b]=hk(p,2,p.rank-1);r=this.recurrentActivation.apply(nb(f,y)),i=this.recurrentActivation.apply(nb(m,b));let v=J_(ib(i,a),h);s=this.activation.apply(nb(g,v));let x=nb(ib(r,a),ib(nb(1,Tx(r)),s));return[x,x]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:uD(this.activation),recurrentActivation:uD(this.recurrentActivation),useBias:this.useBias,kernelInitializer:IA(this.kernelInitializer),recurrentInitializer:IA(this.recurrentInitializer),biasInitializer:IA(this.biasInitializer),kernelRegularizer:gD(this.kernelRegularizer),recurrentRegularizer:gD(this.recurrentRegularizer),biasRegularizer:gD(this.biasRegularizer),activityRegularizer:gD(this.activityRegularizer),kernelConstraint:iF(this.kernelConstraint),recurrentConstraint:iF(this.recurrentConstraint),biasConstraint:iF(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};YD.className="GRUCell",dI.registerClass(YD);var QD=class extends HD{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new YD(e),super(e)}call(e,t){return Ug(()=>{null!=this.cell.dropoutMask&&(jg(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(jg(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};QD.className="GRU",dI.registerClass(QD);var JD=class extends qD{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,p_(this.units,"units"),this.activation=dD(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dD(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=NA(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=NA(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=NA(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=bD(e.kernelRegularizer),this.recurrentRegularizer=bD(e.recurrentRegularizer),this.biasRegularizer=bD(e.biasRegularizer),this.kernelConstraint=oF(e.kernelConstraint),this.recurrentConstraint=oF(e.recurrentConstraint),this.biasConstraint=oF(e.biasConstraint),this.dropout=z_([1,B_([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=z_([1,B_([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;let n,a=(e=_A(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){let e=this.biasInitializer,a=this.units;n=new((t=class extends sA{apply(t,n){let r=e.apply([a]),i=(new lA).apply([a]),s=e.apply([2*a]);return X_(X_(r,i),s)}}).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return Ug(()=>{let n=null!=t.training&&t.training;if(3!==e.length)throw new KE("LSTMCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let a=e[1],r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eM({ones:()=>tw(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eM({ones:()=>tw(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let i,s,o,l,u=this.dropoutMask,c=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=ib(e,u[0]));let d=J_(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=ib(a,c[0])),d=nb(d,J_(a,this.recurrentKernel.read())),this.useBias&&(d=tA(d,this.bias.read()));let[h,p,f,m]=hk(d,4,d.rank-1);i=this.recurrentActivation.apply(h),s=this.recurrentActivation.apply(p),o=nb(ib(s,r),ib(i,this.activation.apply(f))),l=this.recurrentActivation.apply(m);let g=ib(l,this.activation.apply(o));return[g,g,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:uD(this.activation),recurrentActivation:uD(this.recurrentActivation),useBias:this.useBias,kernelInitializer:IA(this.kernelInitializer),recurrentInitializer:IA(this.recurrentInitializer),biasInitializer:IA(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:gD(this.kernelRegularizer),recurrentRegularizer:gD(this.recurrentRegularizer),biasRegularizer:gD(this.biasRegularizer),activityRegularizer:gD(this.activityRegularizer),kernelConstraint:iF(this.kernelConstraint),recurrentConstraint:iF(this.recurrentConstraint),biasConstraint:iF(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};JD.className="LSTMCell",dI.registerClass(JD);var ZD=class extends HD{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new JD(e),super(e)}call(e,t){return Ug(()=>{null!=this.cell.dropoutMask&&(jg(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(jg(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}};ZD.className="LSTM",dI.registerClass(ZD);var $D=class extends qD{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return Ug(()=>{let n=e.slice(1),a=[];for(let e of this.cells.slice().reverse())Array.isArray(e.stateSize)?a.push(n.splice(0,e.stateSize.length)):a.push(n.splice(0,1));a.reverse();let r,i=[];for(let s=0;s<this.cells.length;++s){let o=this.cells[s];n=a[s],r=0===s?[e[0]].concat(n):[r[0]].concat(n),r=o.call(r,t),i.push(r.slice(1))}n=[];for(let e of i.slice().reverse())n.push(...e);return[r[0]].concat(n)})}build(e){let t;TA(e)&&(e=e[0]),this.cells.forEach((n,a)=>{A_("RNNCell_".concat(a),()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t={cells:this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[];for(let r of t.cells)a.push(WF(r,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return DA(e)}setWeights(e){let t=[];for(let n of this.cells){let a=n.weights.length,r=e.splice(a);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],r[e]])}MA(t)}};function eM(e){let{ones:t,rate:n,training:a=!1,count:r=1,dropoutFunc:i}=e,s=()=>null!=i?i(t(),n):nA(t(),n),o=()=>aA(s,t,a);return!r||r<=1?Gg(o().clone()):Array(r).fill(void 0).map(o).map(e=>Gg(e.clone()))}$D.className="StackedRNNCells",dI.registerClass($D);var tM=class extends HD{constructor(e){if(e.unroll)throw new XE("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new XE("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new OA({ndim:5})]}call(e,t){return Ug(()=>{if(null!=this.cell.dropoutMask&&(jg(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(jg(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new KE("ConvRNN2D cell does not support constants");let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return Ug(()=>{let{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),r=Gx([a[0],...a.slice(2)]);return Array.isArray(t)?Array(t.length).fill(r):[r]})}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ug(()=>{if(!this.stateful)throw new HE("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),r=[a[0],...a.slice(2)];if(null==n[0])throw new KE("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gx(r)):this.states_=[Gx(r)];else if(null==e)jg(this.states_),null!=this.keptStates&&(jg(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gx(r)):this.states_[0]=Gx(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new KE("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ").concat(e));t?this.keptStates.push(this.states_.slice()):jg(this.states_);for(let t=0;t<this.states_.length;++t){let n=e[t],a=r;if(!um.arraysEqual(n.shape,a))throw new KE("State ".concat(t," is incompatible with layer ").concat(this.name,": expected shape=").concat(a,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map(e=>Gg(e.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:a,padding:r,strides:i,dilationRate:s}=this.cell,o="channelsFirst"===t,l=e[o?3:2],u=e[o?4:3],c=TD(l,a[0],r,i[0],s[0]),d=TD(u,a[1],r,i[1],s[1]);return[...e.slice(0,2),...o?[n,c,d]:[c,d,n]]}};tM.className="ConvRNN2D";var nM=class extends JD{constructor(e){let{filters:t,kernelSize:n,strides:a,padding:r,dataFormat:i,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,p_(this.filters,"filters"),this.kernelSize=ND(n,2,"kernelSize"),this.kernelSize.forEach(e=>p_(e,"kernelSize")),this.strides=ND(a||1,2,"strides"),this.strides.forEach(e=>p_(e,"strides")),this.padding=r||"valid",C_(this.padding),this.dataFormat=i||"channelsLast",T_(this.dataFormat),this.dilationRate=ND(s||1,2,"dilationRate"),this.dilationRate.forEach(e=>p_(e,"dilationRate"))}build(e){var t;e=_A(e);let n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new KE("The channel dimension of the input should be defined. Found ".concat(e[n]));let a=e[n],r=this.kernelSize.concat([a,4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){let n=this.biasInitializer,a=this.filters;e=new((t=class extends sA{apply(e,t){return K_([n.apply([a]),Hx([a]),n.apply([2*a])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return Ug(()=>{if(3!==e.length)throw new KE("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ".concat(e.length,"."));let n=t.training||!1,a=e[0],r=e[1],i=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eM({ones:()=>tw(a),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,o=(e,t,n)=>t&&t[n]?ib(t[n],e):e,l=o(a,s,0),u=o(a,s,1),c=o(a,s,2),d=o(a,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eM({ones:()=>tw(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let h=this.recurrentDropoutMask,p=o(r,h,0),f=o(r,h,1),m=o(r,h,2),g=o(r,h,3),[y,b,v,x]=hk(this.kernel.read(),4,3),[w,k,S,I]=this.useBias?hk(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,y,w,this.padding),u=this.inputConv(u,b,k,this.padding),c=this.inputConv(c,v,S,this.padding),d=this.inputConv(d,x,I,this.padding);let[N,T,C,E]=hk(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,N),f=this.recurrentConv(f,T),m=this.recurrentConv(m,C),g=this.recurrentConv(g,E);let _=this.recurrentActivation.apply(nb(l,p)),A=this.recurrentActivation.apply(nb(u,f)),F=nb(ib(A,i),ib(_,this.activation.apply(nb(c,m)))),R=ib(this.recurrentActivation.apply(nb(d,g)),this.activation.apply(F));return[R,R,F]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){let r=sv(e,t,this.strides,a||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?tA(r,n,this.dataFormat):r}recurrentConv(e,t){return sv(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}};nM.className="ConvLSTM2DCell",dI.registerClass(nM);var aM=class extends tM{constructor(e){let t=new nM(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};aM.className="ConvLSTM2D",dI.registerClass(aM);var rM=class extends WA{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;let t=e.shape,n=[];for(let a=0;a<this.noiseShape.length;++a)n.push(null==this.noiseShape[a]?t[a]:this.noiseShape[a]);return n}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);if(0<this.rate&&this.rate<1){let e=null!=t.training&&t.training,a=this.getNoiseShape(n);return aA(()=>nA(n,this.rate,a,this.seed),()=>n,e)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};rM.className="Dropout",dI.registerClass(rM);var iM=class extends rM{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};iM.className="SpatialDropout1D",dI.registerClass(iM);var sM=class extends WA{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,p_(this.units,"units"),this.activation=dD(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=NA(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=NA(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=oF(e.kernelConstraint),this.biasConstraint=oF(e.biasConstraint),this.kernelRegularizer=bD(e.kernelRegularizer),this.biasRegularizer=bD(e.biasRegularizer),this.activityRegularizer=bD(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){let t=(e=_A(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){let t=(e=_A(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n,a=EA(e),r=m_(this.activation.getClassName());return null!=r?n=J_(a,this.kernel.read(),r,this.bias?this.bias.read():null):(n=J_(a,this.kernel.read()),null!=this.bias&&(n=tA(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n})}getConfig(){let e={units:this.units,activation:uD(this.activation),useBias:this.useBias,kernelInitializer:IA(this.kernelInitializer),biasInitializer:IA(this.biasInitializer),kernelRegularizer:gD(this.kernelRegularizer),biasRegularizer:gD(this.biasRegularizer),activityRegularizer:gD(this.activityRegularizer),kernelConstraint:iF(this.kernelConstraint),biasConstraint:iF(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};sM.className="Dense",dI.registerClass(sM);var oM=class extends WA{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=_A(e);for(let t of e.slice(1))if(null==t)throw new KE('The shape of the input to "Flatten" is not fully defined (got '.concat(e.slice(1),'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.'));return[e[0],L_(e,1)]}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);if("channelsFirst"===this.dataFormat&&n.rank>1){let e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=Vk(n,e)}return function(e){if(e.rank<=1)throw new KE("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));let t=[e.shape[0],L_(e.shape,1)];return Mb(e,t)}(n)})}getConfig(){let e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};oM.className="Flatten",dI.registerClass(oM);var lM=class extends WA{constructor(e){super(e),this.supportsMasking=!0,this.activation=dD(e.activation)}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);return this.activation.apply(n)})}getConfig(){let e={activation:uD(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};lM.className="Activation",dI.registerClass(lM);var uM=class extends WA{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return Ug(()=>function(e,t){return Ug(()=>{if(2!==e.shape.length)throw new KE("repeat() expects a rank-2 tensor, but received a rank-".concat(e.shape.length," tensor."));return Y_(j_(e,1),[1,t,1])})}(e=EA(e),this.n))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};uM.className="RepeatVector",dI.registerClass(uM);var cM=class extends WA{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",a=t.slice(),r=1,i=null;for(let o=0;o<a.length;++o){let e=a[o];if(this.isUnknown(e)){if(null!==i)throw new KE("Can only specifiy one unknown dimension.");i=o}else r*=e}let s=L_(e);if(null!==i){if(0===r||s%r!==0)throw new KE(n);a[i]=s/r}else if(s!==r)throw new KE(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e),a=n.shape,r=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return Mb(n,r)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};cM.className="Reshape",dI.registerClass(cM);var dM=class extends WA{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received ".concat(e.dims," instead."));let t=W_(1,e.dims.length+1);if(!um.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new OA({ndim:this.dims.length+1})]}computeOutputShape(e){let t=(e=_A(e)).slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return Vk(EA(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};dM.className="Permute",dI.registerClass(dM);var hM=class extends WA{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=EA(e);return db($x(n,this.maskValue),-1)}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e),a=db($x(n,this.maskValue),-1,!0);return ib(n,$y(a,n.dtype))})}};hM.className="Masking",dI.registerClass(hM);var pM=class extends WA{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(t_(e.inputLength))}this.inputDim=e.inputDim,p_(this.inputDim,"inputDim"),this.outputDim=e.outputDim,p_(this.outputDim,"outputDim"),this.embeddingsInitializer=NA(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=bD(e.embeddingsRegularizer),this.activityRegularizer=bD(e.activityRegularizer),this.embeddingsConstraint=oF(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return Ug(()=>this.maskZero?(e=EA(e),$x(e,Ev(e))):null)}computeOutputShape(e){if(e=_A(e),null==this.inputLength)return[...e,this.outputDim];let t=t_(this.inputLength);if(t.length!==e.length-1)throw new KE('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));{let n=0;for(let a=0;a<t.length;++a){let r=t[a],i=e[a+1];if(null!=r&&null!=i&&r!==i)throw new KE('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ").concat(e));null==r&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);"int32"!==n.dtype&&(n=U_(n,"int32"));let a=Z_(this.embeddings.read(),Mb(n,[n.size]));return Mb(a,_A(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:IA(this.embeddingsInitializer),embeddingsRegularizer:gD(this.embeddingsRegularizer),activityRegularizer:gD(this.activityRegularizer),embeddingsConstraint:iF(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};pM.className="Embedding",dI.registerClass(pM);var fM=class extends WA{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new XE}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;let n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){let r=e[e.length-t.length+a],i=t[a];if(null==r||null==i||r<0||i<0)n.push(null);else if(1===r)n.push(i);else if(1===i)n.push(r);else{if(r!==i)throw new KE("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(r)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[_A(e)]),e.length<2)throw new KE("A merge layer should be called on an Array of at least 2 inputs. Got ".concat(e.length," input(s)."));let t=[];for(let r of e)null!=r&&null!==r[0]&&t.push(r[0]);if(t=u_(t),t.length>1)throw new KE("Can not merge tensors with different batch sizes. Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){let t=null==e[r]?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}let a=e.map(e=>e.length);-1===e.indexOf(null)&&1===u_(a).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return Ug(()=>{if(this.reshapeRequired){let t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){let a=B_(n);for(let n of e){let e=n.rank;for(let t=0;t<a-e;++t)n=j_(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(let i of e){let e=i.rank;if(null==e){let e=i.shape,a=e[0],r=e.slice(1).concat([a]),s=Mb(i,[a].concat(L_(e.slice(1))));s=Vk(s,[1,0]),s=Mb(s,r),t.push(s),n=!0}else if(e>1){let a=W_(1,e).concat([0]);t.push(Vk(i,a)),n=!0}else t.push(i)}let a=this.mergeFunction(t),r=a.rank;if(n)if(null==r){let e=a.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));a=Mb(Vk(Mb(a,[-1,t]),[1,0]),n)}else if(r>1){let e=[r-1].concat(W_(0,r-1));a=Vk(a,e)}return a}}return this.mergeFunction(e)})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){let n=null==e[a]?null:e[a].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(let a of e)null!=a&&null!==a[0]&&n.push(a[0]);return n=u_(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return Ug(()=>{if(null==t)return null;if(!Array.isArray(t))throw new KE("`mask` should be an Array");if(!Array.isArray(e))throw new KE("`inputs` should be an Array");if(t.length!==e.length)throw new KE("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (".concat(e.length," vs ").concat(t.length,")"));if(t.every(e=>null==e))return null;let n=(t=t.map(e=>null==e?e:ex(e,0)))[0];for(let e=1;e<t.length-1;++e)n=Rx(n,t[e]);return n})}},mM=class extends fM{constructor(e){super(e)}mergeFunction(e){return Ug(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=nb(t,e[n]);return t})}};mM.className="Add",dI.registerClass(mM);var gM=class extends fM{constructor(e){super(e)}mergeFunction(e){return Ug(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ib(t,e[n]);return t})}};gM.className="Multiply",dI.registerClass(gM);var yM=class extends fM{constructor(e){super(e)}mergeFunction(e){return Ug(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=nb(t,e[n]);return ib(1/e.length,t)})}};yM.className="Average",dI.registerClass(yM);var bM=class extends fM{constructor(e){super(e)}mergeFunction(e){return Ug(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Ux(t,e[n]);return t})}};bM.className="Maximum",dI.registerClass(bM);var vM=class extends fM{constructor(e){super(e)}mergeFunction(e){return Ug(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Kx(t,e[n]);return t})}};vM.className="Minimum",dI.registerClass(vM);var xM=class extends fM{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new KE("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(let a of e)if(null!=a){t=!1;break}if(t)return;let n=[];for(let a=0;a<e.length;++a){let t=e[a].slice();t.splice(this.axis,1);let r=!1;for(let e of n)if(um.arraysEqual(e,t)){r=!0;break}r||n.push(t)}if(n.length>1)throw new KE("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ug(()=>K_(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new KE("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),a=this.axis<0?n.length+this.axis:this.axis;for(let r of t.slice(1)){if(null==n[a]||null==r[a]){n[a]=null;break}n[a]+=r[a]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new KE("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new KE("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new KE("Mismatch in the length of mask (".concat(t.length,") and the legnth of inputs (").concat(e.length,")"));return Ug(()=>{let n=!0;if(t.forEach(e=>{null==e||(n=!1)}),n)return null;let a=[];for(let i=0;i<e.length;++i)null==t[i]?a.push($y(tw(e[i]),"bool")):t[i].rank<e[i].rank?a.push(ex(t[i],-1)):a.push(t[i]);let r=Lb(a,this.axis);return cb(r,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};function wM(e,t){for(;e<0;)e+=t;return e}xM.className="Concatenate",dI.registerClass(xM);var kM=class extends fM{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){um.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new XE("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new KE("Dimension incompatibility: ".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){if(2!==e.length)throw new KE("A `Dot` layer must be called on exactly 2 inputs, but received ".concat(e.length," input(s)."));let t,n=e[0],a=e[1];return t=Array.isArray(this.axes)?this.axes.map((t,n)=>wM(t,e[n].shape.length)):[wM(this.axes,n.shape.length),wM(this.axes,a.shape.length)],this.normalize&&(n=VF(n,t[0]),a=VF(a,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new XE("batchDot is not implemented for tensors of 4D or higher rank yet");if(um.assert(e.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got ".concat(e.shape.length)),um.assert(e.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got ".concat(t.shape.length)),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new XE("batchDot is not implemented for complex64-type Tensors yet.");let a=e.shape.length,r=t.shape.length;null==n&&(n=[a-1,r-2]);let i=n;return Ug(()=>{let n,s;if(a>r){n=a-r;let e=[];for(let t=0;t<n;++t)e.push(1);t=Mb(t,t.shape.concat(e))}else if(r>a){n=r-a;let t=[];for(let e=0;e<n;++e)t.push(1);e=Mb(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)s=i[0]===i[1]?Yv(ib(e,t),i[0]):Yv(ib(Vk(e,[1,0]),t),i[1]);else{let n=i[0]!==e.shape.length-1,a=i[1]===t.shape.length-1;s=zb(e,t,n,a)}if(n>0){let e;e=a>r?a+r-3:a-1;let t=[];for(let a=e;a<e+n;++a)t.push(a);s=mk(s,t)}return 1===s.shape.length&&(s=ex(s,1)),s})}(n,a,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[wM(this.axes,e.length),wM(this.axes,t.length)],n}computeOutputShape(e){um.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new XE("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);let r=t.concat(n);return 1===r.length&&r.push(1),r}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};kM.className="Dot",dI.registerClass(kM);var SM=class extends WA{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);return aA(()=>nb(Q_(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};SM.className="GaussianNoise",dI.registerClass(SM);var IM=class extends WA{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ug(()=>{this.invokeCallHook(e,t);let n=EA(e);return this.rate>0&&this.rate<1?aA(()=>{let e=Math.sqrt(this.rate/(1-this.rate));return ib(n,Q_(n.shape,1,e))},()=>n,t.training||!1):n})}};IM.className="GaussianDropout",dI.registerClass(IM);var NM=class extends WA{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||EA(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ug(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return aA(()=>{let t=EA(e),a=-1.7580993408473766,r=ox(zw(n),this.rate);r=U_(r,"float32");let i=((1-this.rate)*(1+this.rate*a**2))**-.5,s=-i*a*this.rate,o=nb(ib(t,r),ib(nb(r,-1),a));return nb(ib(o,i),s)},()=>EA(e),t.training||!1)}return e})}};function TM(e,t,n,a,r){let i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=qb(e,t,n,a,r,s);else if(3===e.rank)i=Kb(e,t,n,a,r,s);else{if(4!==e.rank)throw new XE("batchNormalization is not implemented for array of rank ".concat(e.rank," yet"));i=Xb(e,t,n,a,r,s)}return i}function CM(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return um.arraysEqual(a.slice().sort(),W_(0,e.rank-1))?function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Ug(()=>{let i=Qx(e,a),s=i.mean,o=i.variance;return[TM(e,s,o,n,t,r),s,o]})}(e,t,n,a,r):function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Ug(()=>{let i=Qx(e,a),s=i.mean,o=i.variance,l=[];for(let t of W_(0,e.rank))-1!==a.indexOf(t)?l.push(1):l.push(e.shape[t]);let u=Mb(s,l),c=Mb(o,l),d=null==t?null:Mb(t,l),h=null==n?null:Mb(n,l);return[TM(e,u,c,h,d,r),s,o]})}(e,t,n,a,r)}NM.className="AlphaDropout",dI.registerClass(NM);var EM=class extends WA{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=NA(e.betaInitializer||"zeros"),this.gammaInitializer=NA(e.gammaInitializer||"ones"),this.movingMeanInitializer=NA(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=NA(e.movingVarianceInitializer||"ones"),this.betaConstraint=oF(e.betaConstraint),this.gammaConstraint=oF(e.gammaConstraint),this.betaRegularizer=bD(e.betaRegularizer),this.gammaRegularizer=bD(e.gammaRegularizer)}build(e){e=_A(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new KE("Axis ".concat(t," of input tensor should have a defined dimension but the layer received an input with shape ").concat(JSON.stringify(e),"."));this.inputSpec=[new OA({ndim:e.length,axes:{[t]:n}})];let a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return Ug(()=>{let n=null!=t.training&&t.training,a=EA(e),r=a.shape,i=r.length,s=W_(0,i),o=this.axis>=0?this.axis:this.axis+i;s.splice(o,1);let l=JE(1,i);l[o]=r[o];let u=s.slice();u.sort();let c=!um.arraysEqual(u,W_(0,i).slice(0,i-1));if(!n)return(()=>{if(c){let e=Mb(this.movingMean.read(),l),t=Mb(this.movingVariance.read(),l),n=this.center?Mb(this.beta.read(),l):null,r=this.scale?Mb(this.gamma.read(),l):null;return TM(a,e,t,n,r,this.epsilon)}return TM(a,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();let[d,h,p]=CM(a,this.gamma.read(),this.beta.read(),s,this.epsilon),f=(e,t,n)=>{Ug(()=>{let a=1-n,r=e.read(),i=ib(_x(r,t),a);e.write(_x(r,i))})};return f(this.movingMean,h,this.momentum),f(this.movingVariance,p,this.momentum),d})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:IA(this.betaInitializer),gammaInitializer:IA(this.gammaInitializer),movingMeanInitializer:IA(this.movingMeanInitializer),movingVarianceInitializer:IA(this.movingVarianceInitializer),betaRegularizer:gD(this.betaRegularizer),gammaRegularizer:gD(this.gammaRegularizer),betaConstraint:iF(this.betaConstraint),gammaConstraint:iF(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};EM.className="BatchNormalization",dI.registerClass(EM);var _M=class extends WA{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received ".concat(JSON.stringify(this.axis)));for(let e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=NA(e.betaInitializer||"zeros"),this.gammaInitializer=NA(e.gammaInitializer||"ones"),this.betaRegularizer=bD(e.betaRegularizer),this.gammaRegularizer=bD(e.gammaRegularizer),this.supportsMasking=!0}build(e){let t=(e=_A(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=t);for(let r of this.axis)if(r<0||r>=t)throw new Error("Invalid axis: ".concat(r));if(this.axis.length!==u_(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));let n=this.axis.map(t=>e[t]),a=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,t){let n=EA(e),a=n.shape,r=a.length;return Ug(()=>{let{mean:e,variance:t}=Qx(n,this.axis,!0),i=JE(1,r);for(let n of this.axis)i[n]=a[n];let s=e=>null!=e&&e.shape.length!==r?Mb(e,i):e,o=this.scale?s(this.gamma.read()):null,l=this.center?s(this.beta.read()):null,u=[],c=[];for(let n=0;n<r;++n)-1!==this.axis.indexOf(n)?(u.push(a[n]),c.push(1)):(u.push(1),c.push(a[n]));return e=nx(e,u),t=nx(t,u),null!=o&&(o=nx(o,c)),null!=l&&(l=nx(l,c)),TM(n,e,t,l,o,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:IA(this.betaInitializer),gammaInitializer:IA(this.gammaInitializer),betaRegularizer:gD(this.betaRegularizer),gammaRegularizer:gD(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};_M.className="LayerNormalization",dI.registerClass(_M);var AM=class extends WA{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new KE("ZeroPadding2D expects padding to be a length-2 array, but received a length-".concat(e.padding.length," array."));let t,n;if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new KE("ZeroPadding2D expects height padding to be a length-2 array, but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new KE("ZeroPadding2D expects width padding to be a length-2 array, but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new OA({ndim:4})]}computeOutputShape(e){let t,n;return e=_A(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return Ug(()=>function(e,t,n){return Ug(()=>{if(4!==e.rank)throw new KE("temporalPadding expects input tensor to be 4-D, but received a ".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new KE("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new KE("Unknown data format: ".concat(n,". Supported data formats are 'channelsLast' and 'channelsFirst."));let a;return a="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],aw(e,a)})}(EA(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};function FM(e,t,n,a,r,i){return Ug(()=>{T_(r),E_(i),C_(a),null==n&&(n=[1,1]),null==a&&(a="valid"),null==r&&(r="channelsLast"),null==i&&(i="max"),e=ED(e,r);let s,o="same"===a?"same":"valid";return s="max"===i?Bx(e,t,n,o):Ob(e,t,n,o),"channelsFirst"===r&&(s=Vk(s,[0,3,1,2])),s})}function RM(e,t,n,a,r,i){return Ug(()=>{T_(r),E_(i),C_(a),null==n&&(n=[1,1,1]),null==a&&(a="valid"),null==r&&(r="channelsLast"),null==i&&(i="max"),e=_D(e,r);let s,o="same"===a?"same":"valid";return s="max"===i?Wx(e,t,n,o):Pb(e,t,n,o),"channelsFirst"===r&&(s=Vk(s,[0,4,1,2,3])),s})}AM.className="ZeroPadding2D",dI.registerClass(AM);var DM=class extends WA{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new KE("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(p_(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new KE("strides for 1D convolutional layer must be a number or an Array of a single number, but received ".concat(JSON.stringify(e.strides)));this.strides=e.strides}p_(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,C_(this.padding),this.inputSpec=[new OA({ndim:3})]}computeOutputShape(e){let t=TD((e=_A(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return Ug(()=>{this.invokeCallHook(e,t),e=j_(EA(e),2);let n=this.poolingFunction(EA(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return mk(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},MM=class extends DM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),FM(e,t,n,a,r,"max")}};MM.className="MaxPooling1D",dI.registerClass(MM);var OM=class extends DM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),FM(e,t,n,a,r,"avg")}};OM.className="AveragePooling1D",dI.registerClass(OM);var PM=class extends WA{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new KE("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];p_(this.poolSize,"poolSize"),p_(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,T_(this.dataFormat),C_(this.padding),this.inputSpec=[new OA({ndim:4})]}computeOutputShape(e){e=_A(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=TD(t,this.poolSize[0],this.padding,this.strides[0]),n=TD(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return Ug(()=>(this.invokeCallHook(e,t),this.poolingFunction(EA(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},LM=class extends PM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),FM(e,t,n,a,r,"max")}};LM.className="MaxPooling2D",dI.registerClass(LM);var zM=class extends PM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),FM(e,t,n,a,r,"avg")}};zM.className="AveragePooling2D",dI.registerClass(zM);var BM=class extends WA{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new KE("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];p_(this.poolSize,"poolSize"),p_(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,T_(this.dataFormat),C_(this.padding),this.inputSpec=[new OA({ndim:5})]}computeOutputShape(e){e=_A(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[4]:e[3];return t=TD(t,this.poolSize[0],this.padding,this.strides[0]),n=TD(n,this.poolSize[1],this.padding,this.strides[1]),a=TD(a,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return Ug(()=>(this.invokeCallHook(e,t),this.poolingFunction(EA(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},WM=class extends BM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),RM(e,t,n,a,r,"max")}};WM.className="MaxPooling3D",dI.registerClass(WM);var VM=class extends BM{constructor(e){super(e)}poolingFunction(e,t,n,a,r){return T_(r),C_(a),RM(e,t,n,a,r,"avg")}};VM.className="AveragePooling3D",dI.registerClass(VM);var UM=class extends WA{constructor(e){super(e),this.inputSpec=[new OA({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new XE}},jM=class extends UM{constructor(e){super(e||{})}call(e,t){return Ug(()=>{let t=EA(e);return jx(t,1)})}};jM.className="GlobalAveragePooling1D",dI.registerClass(jM);var GM=class extends UM{constructor(e){super(e||{})}call(e,t){return Ug(()=>{let t=EA(e);return jv(t,1)})}};GM.className="GlobalMaxPooling1D",dI.registerClass(GM);var HM=class extends WA{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,T_(this.dataFormat),this.inputSpec=[new OA({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new XE}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},qM=class extends HM{call(e,t){return Ug(()=>{let t=EA(e);return"channelsLast"===this.dataFormat?jx(t,[1,2]):jx(t,[2,3])})}};qM.className="GlobalAveragePooling2D",dI.registerClass(qM);var KM=class extends HM{call(e,t){return Ug(()=>{let t=EA(e);return"channelsLast"===this.dataFormat?jv(t,[1,2]):jv(t,[2,3])})}};KM.className="GlobalMaxPooling2D",dI.registerClass(KM);var XM=class extends WA{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=WF(t.layer,n);delete t.layer;let r={layer:a};return Object.assign(r,t),new e(r)}},YM=class extends XM{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=_A(e)).length<3)throw new KE("TimeDistributed layer expects an input shape >= 3D, but received input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){let t=[(e=_A(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return Ug(()=>GD((e,n)=>[EA(this.layer.call(e,t)),[]],e=EA(e),[],!1,null,null,!1,!0)[1])}};YM.className="TimeDistributed",dI.registerClass(YM);var QM=class extends XM{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=WF(n),t.goBackwards=!0!==t.goBackwards;let a={};if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=WF(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){d_(I_,"BidirectionalMergeMode",e)}(this.mergeMode),e.weights)throw new XE("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,a,r=this.forwardLayer.computeOutputShape(e);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),this.returnState&&(a=r.slice(1)),t=r[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(a).concat(a.slice()):[t].concat(a).concat(a.slice()):e_(n)}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=jD(e,n,a,this.numConstants);if(e=r.inputs,n=r.initialState,a=r.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==a)return super.apply(e,t);let i=[],s=[];if(null!=n){let e=n.length;if(e%2>0)throw new KE("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let a=n.map(e=>new OA({shape:e.shape}));this.forwardLayer.stateSpec=a.slice(0,e/2),this.backwardLayer.stateSpec=a.slice(e/2),s.push(...a)}if(null!=a)throw new XE("Support for constants in Bidirectional layers is not implemented yet.");let o=i[0]instanceof PA;for(let l of i)if(l instanceof PA!==o)throw new KE("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let n=[e].concat(i),a=this.inputSpec.concat(s),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}return super.apply(e,t)}call(e,t){return Ug(()=>{let n,a,r,i,s=t.initialState;if(null==s)n=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let r=s.slice(0,s.length/2),i=s.slice(s.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:r})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return this.returnState&&(Array.isArray(n)&&(r=n.slice(1).concat(a.slice(1))),n=n[0],a=a[0]),this.returnSequences&&(a=Hw(a,1)),"concat"===this.mergeMode?i=K_([n,a]):"sum"===this.mergeMode?i=nb(n,a):"ave"===this.mergeMode?i=ib(.5,nb(n,a)):"mul"===this.mergeMode?i=ib(n,a):null==this.mergeMode&&(i=[n,a]),this.returnState?null==this.mergeMode?i.concat(r):[i].concat(r):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){A_(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),A_(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){let e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=WF(t.layer);if(delete t.layer,null!=t.numConstants)throw new XE("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let a=t;return a.layer=n,new e(a)}};QM.className="Bidirectional",dI.registerClass(QM);var JM=class extends WA{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ug(()=>("float32"!==(e=EA(e)).dtype&&(e=U_(e,"float32")),nb(ib(e,this.scale),this.offset)))}};JM.className="Rescaling",dI.registerClass(JM);var{resizeBilinear:ZM,cropAndResize:$M}=sI,eO=class extends WA{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,a,r,i,s,o){return Ug(()=>{let l,u=!1,c=[t/i,n/s,(a+t)/i,(r+n)/s],d=[];3===e.rank?(u=!0,l=gk([e])):l=e;for(let e=0;e<l.shape[0];e++)d.push(c);let h=Fg(d,[d.length,4]),p=Ww(0,d.length,1,"int32"),f=$M(l,h,p,[a,r],"nearest");return U_(u?EA(Ok(f)):f,o)})}upsize(e,t,n,a){return Ug(()=>U_(ZM(e,[t,n]),a))}call(e,t){return Ug(()=>{let t=EA(e),n=t.dtype,a=t.shape,r=a[a.length-3],i=a[a.length-2],s=0;r!==this.height&&(s=Math.floor((r-this.height)/2));let o=0;return i!==this.width&&(o=Math.floor((i-this.width)/2),0===o&&(o=1)),s>=0&&o>=0?this.centerCrop(t,s,o,this.height,this.width,r,i,n):this.upsize(e,this.height,this.width,n)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=_A(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};eO.className="CenterCrop",dI.registerClass(eO);var tO=class extends WA{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=_A(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return Ug(()=>{let n;if("int32"!==(e=EA(e)).dtype&&(e=U_(e,"int32")),"undefined"!=typeof t.countWeights){if("count"!==this.outputMode)throw new KE("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=EA(t.countWeights)}let a=jv(e),r=Gv(e),i=sx(this.numTokens,a).bufferSync().get(0),s=ox(r,0).bufferSync().get(0);if(!i||!s)throw new KE("Input values must be between 0 < values <= numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,a){let r=EA(e);if("int32"!==r.dtype&&(r=U_(r,"int32")),"int"===t)return r;let i=r.shape;if(0===r.rank&&(r=ex(r,-1)),"oneHot"===t&&1!==r.shape[r.shape.length-1]&&(r=ex(r,-1)),r.rank>2)throw new KE("When outputMode is not int, maximum output rank is 2 Received outputMode ".concat(t," and input shape ").concat(i," which would result in output rank ").concat(r.rank,"."));let s,o=["multiHot","oneHot"].includes(t),l=r;if(s=yv(l,"undefined"!=typeof a&&"count"===t?a:[],n,o),"tfIdf"!==t)return s;if(a)return ib(s,a);throw new KE("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)})}};tO.className="CategoryEncoding",dI.registerClass(tO);var nO=new Set(["bilinear","nearest"]),aO=class extends WA{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!nO.has(e.interpolation))throw new KE("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){let t=(e=_A(e))[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ug(()=>{let t=[this.height,this.width];if("bilinear"===this.interpolation)return sI.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return sI.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...nO]," are supported"))})}};aO.className="Resizing",dI.registerClass(aO);var rO=class{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}};rO.className="RandomSeed";var iO=class extends WA{constructor(e){super(e),this.randomGenerator=new rO(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};iO.className="BaseRandomLayer";var sO=new Set(["bilinear","nearest"]),oO=class extends iO{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new KE("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new KE("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new KE("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!sO.has(n))throw new KE("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){let t=(e=_A(e))[2];return[this.imgHeight,-1,t]}call(e,t){return Ug(()=>{let t=EA(e);this.imgHeight=t.shape[t.shape.length-3];let n=t.shape[t.shape.length-2];this.widthFactor=zw([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);let r=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return sI.resizeBilinear(e,r);case"nearest":return sI.resizeNearestNeighbor(e,r);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...sO]," are supported"))}})}};function lO(e){return new UA(e)}function uO(e){return new kD(e)}function cO(e){return new vD(e)}function dO(e){return new xD(e)}function hO(e){return new wD(e)}function pO(e){return new ID(e)}function fO(e){return new SD(e)}function mO(e){return new BD(e)}function gO(e){return new DD(e)}function yO(e){return new OD(e)}function bO(e){return new MD(e)}function vO(e){return new PD(e)}function xO(e){return new zD(e)}function wO(e){return new WD(e)}function kO(e){return new VD(e)}function SO(e){return new UD(e)}function IO(e){return new lM(e)}function NO(e){return new sM(e)}function TO(e){return new rM(e)}function CO(e){return new iM(e)}function EO(e){return new oM(e)}function _O(e){return new uM(e)}function AO(e){return new cM(e)}function FO(e){return new dM(e)}function RO(e){return new pM(e)}function DO(e){return new mM(e)}function MO(e){return new yM(e)}function OO(e){return new xM(e)}function PO(e){return new bM(e)}function LO(e){return new vM(e)}function zO(e){return new gM(e)}function BO(e){return new kM(e)}function WO(e){return new EM(e)}function VO(e){return new _M(e)}function UO(e){return new AM(e)}function jO(e){return new OM(e)}function GO(e){return jO(e)}function HO(e){return jO(e)}function qO(e){return new zM(e)}function KO(e){return qO(e)}function XO(e){return qO(e)}function YO(e){return new VM(e)}function QO(e){return YO(e)}function JO(e){return YO(e)}function ZO(e){return new jM(e)}function $O(e){return new qM(e)}function eP(e){return new GM(e)}function tP(e){return new KM(e)}function nP(e){return new MM(e)}function aP(e){return new LM(e)}function rP(e){return new WM(e)}function iP(e){return new QD(e)}function sP(e){return new YD(e)}function oP(e){return new ZD(e)}function lP(e){return new JD(e)}function uP(e){return new XD(e)}function cP(e){return new KD(e)}function dP(e){return new aM(e)}function hP(e){return new nM(e)}function pP(e){return new HD(e)}function fP(e){return new $D(e)}function mP(e){return new QM(e)}function gP(e){return new YM(e)}oO.className="RandomWidth",dI.registerClass(oO);var yP=eP,bP=tP,vP=nP,xP=aP;function wP(e){return new SM(e)}function kP(e){return new IM(e)}function SP(e){return new NM(e)}function IP(e){return new hM(e)}function NP(e){return new JM(e)}function TP(e){return new eO(e)}function CP(e){return new aO(e)}function EP(e){return new tO(e)}function _P(e){return new oO(e)}var AP={};function FP(e,t){return JF(e,t)}function RP(e,t){return nR(e,t)}function DP(e,t){return aR(e,t)}function MP(e,t){return ZF(e,t)}function OP(e,t){return rR(e,t)}function PP(e,t){return eR(e,t)}function LP(e,t){return tR(e,t)}function zP(e,t){return XF(e,t)}function BP(e,t){return jF(e,t)}function WP(e,t){return GF(e,t)}function VP(e,t){return GF(e,t)}function UP(e,t){return GF(e,t)}function jP(e,t){return UF(e,t)}function GP(e,t){return UF(e,t)}function HP(e,t){return UF(e,t)}function qP(e,t){return function(e,t){return Ug(()=>{let n=e.sub(t).square().sum(),a=e.sub(e.mean()).square().sum();return qv(1).sub(n.div(a))})}(e,t)}ac(AP,{MAPE:()=>VP,MSE:()=>GP,binaryAccuracy:()=>FP,binaryCrossentropy:()=>RP,categoricalAccuracy:()=>MP,categoricalCrossentropy:()=>OP,cosineProximity:()=>zP,mape:()=>UP,meanAbsoluteError:()=>BP,meanAbsolutePercentageError:()=>WP,meanSquaredError:()=>jP,mse:()=>HP,precision:()=>PP,r2Score:()=>qP,recall:()=>LP,sparseCategoricalAccuracy:()=>DP});var KP={};ac(KP,{modelFromJSON:()=>BR});var XP={};function YP(e){return new fD(e)}function QP(e){return function(e){return hD(e),new fD({l1:null!=e?e.l1:null,l2:0})}(e)}function JP(e){return function(e){return hD(e),new fD({l2:null!=e?e.l2:null,l1:0})}(e)}ac(XP,{l1:()=>QP,l1l2:()=>YP,l2:()=>JP});var ZP=class extends RF{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof LR))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function $P(e,t){return e<t}function eL(e,t){return e>t}var tL=class extends ZP{constructor(e){if(super(),null==e&&(e={}),e.restoreBestWeights)throw new XE("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn("EarlyStopping mode '".concat(this.mode,"' is invalid. Falling back to mode 'auto'.")),this.mode="auto"),"min"===this.mode?this.monitorFunc=$P:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=eL:this.monitorFunc=$P,this.monitorFunc===$P&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===$P?1/0:-1/0}async onEpochEnd(e,t){await AF(t);let n=this.getMonitorValue(t);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log("Epoch ".concat(this.stoppedEpoch,": early stopping."))}getMonitorValue(e){null==e&&(e={});let t=e[this.monitor];return null==t&&console.warn("Metric for EarlyStopping ".concat(this.monitor," is not available. Available metrics are: ").concat(Object.keys(e))),t}};var nL,aL,rL={earlyStopping:function(e){return new tL(e)}};Td().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(nL||(nL={})),function(e){let t;var n;(n=t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"}(aL||(aL={}));var iL={};function sL(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};iL[e]=n}function oL(e){return iL[e]}function lL(e){delete iL[e]}function uL(e,t,n,a,r){let i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){let e=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?e+1:i.inputIndexEnd,o=e<0?t.inputNames.length+e:e;if("tensor"===i.type)return cL(t.inputNames[o],n,a,r);if("tensors"===i.type){let i=t.inputs.slice(e,s);return t.inputNames.slice(e,s).filter((e,t)=>{var n;return"NoOp"!==(null===(n=i[t])||void 0===n?void 0:n.op)}).map(e=>cL(e,n,a,r))}let l=cL(t.inputNames[o],n,a,r),u=l.dataSync();return"number"===i.type?u[0]:um.toNestedArray(l.shape,u)}let s=t.attrParams[e];return s&&s.value}function cL(e,t,n,a){let[r,i]=fL(e,n);if(null!=a){let e=a.getHashTableHandleByName(r);if(null!=e)return e}let s=n.currentContextIds.find(e=>!!t[pL(r,e)]);return void 0!==s?t[pL(r,s)][i]:void 0}function dL(e,t,n){return t[pL(e,n.currentContextId)]}function hL(e,t){let[n,a,r]=fL(e,t);return[pL(n,t&&t.currentContextId),a,r]}function pL(e,t){return t?"".concat(e,"-").concat(t):e}function fL(e,t){if(""===e)return["",0,void 0];let n=null!=t&&null!=t.parseNodeNameCache;if(n){let n=t.parseNodeNameCache.get(e);if(null!=n)return n}let a,r=e.split(":");if(1===r.length)a=[e,0,void 0];else{let e=r[0],t=3===r.length?r[1]:void 0;a=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,a),a}function mL(e,t,n){let a=uL("pad",e,t,n);if("explicit"===a){a=uL("explicitPaddings",e,t,n);let r=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)r[e][0]=a[2*e],r[e][1]=a[2*e+1];return r}return a}function gL(e){return e.kept?e:eb(e)}var yL={};ac(yL,{json:()=>bL});var bL=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],vL={};ac(vL,{json:()=>xL});var xL=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],wL={};ac(wL,{json:()=>kL});var kL=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],SL={};ac(SL,{json:()=>IL});var IL=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],NL={};ac(NL,{json:()=>TL});var TL=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],CL={};ac(CL,{json:()=>EL});var EL=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_L={};ac(_L,{json:()=>AL});var AL=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],FL={};ac(FL,{json:()=>RL});var RL=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],DL={};ac(DL,{json:()=>ML});var ML=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],OL={};ac(OL,{json:()=>PL});var PL=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],LL={};ac(LL,{json:()=>zL});var zL=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],BL={};ac(BL,{json:()=>WL});var WL=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],VL={};ac(VL,{json:()=>UL});var UL=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],jL={};ac(jL,{json:()=>GL});var GL=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],HL={};ac(HL,{json:()=>qL});var qL=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],KL={};ac(KL,{json:()=>XL});var XL=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],YL={};ac(YL,{json:()=>QL});var QL=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],JL={};ac(JL,{json:()=>ZL});var ZL=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],$L={};ac($L,{json:()=>ez});var ez=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],tz=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[].concat(...[yL,vL,wL,SL,NL,CL,_L,FL,DL,OL,LL,BL,VL,jL,HL,KL,YL,JL,$L].map(e=>e.json));this.opMappers=e.reduce((e,t)=>(e[t.tfOpName]=t,e),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.node,a=[],r=[],i=[],s=n.reduce((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?a.push(e[t.name]):"Const"===t.op?r.push(e[t.name]):(null==t.input||0===t.input.length)&&i.push(e[t.name]),e),{}),o=[],l=[],u={},c={};null!=t&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));let d=Object.keys(s);d.forEach(e=>{let t=s[e];t.inputNames.forEach((e,n)=>{let[a,,r]=hL(e),i=s[a];if(null!=i.outputs){let e=i.outputs.indexOf(r);if(-1!==e){let r="".concat(a,":").concat(e);t.inputNames[n]=r}}t.inputs.push(i),i.children.push(t)})}),0===Object.keys(c).length?d.forEach(e=>{let t=s[e];0===t.children.length&&l.push(t)}):Object.keys(c).forEach(e=>{let[t]=hL(e),n=s[t];null!=n&&(n.signatureKey=c[e],l.push(n))}),Object.keys(u).length>0?Object.keys(u).forEach(e=>{let[t]=hL(e),n=s[t];n&&(n.signatureKey=u[e],o.push(n))}):o=a;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((e,t)=>(e[t.signature.name]=this.mapFunction(t),e),{}));let p={nodes:s,inputs:o,outputs:l,weights:r,placeholders:a,signature:t,functions:h};return i.length>0&&(p.initNodes=i),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=oL(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(e=>e.startsWith("^")?e.slice(1):e),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((t,n)=>{let a,r=n.type;switch(n.type){case"string":a=az(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=az(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=pz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=pz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=iz(e.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=iz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=hz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=hz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=rz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=rz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=mz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=mz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=dz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=dz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=fz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=fz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=lz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=lz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=uz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=uz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=oz(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=oz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t},{})),n}mapFunction(e){let t=e.nodeDef,n=[],a={};null!=t&&(a=t.reduce((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e),{}));let r=[],i=[];e.signature.inputArg.forEach(e=>{let[t]=hL(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:sz(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,r.push(n),a[t]=n}),Object.keys(a).forEach(e=>{let t=a[e];t.inputNames.forEach((e,n)=>{let[r,,i]=hL(e),s=a[r];if(null!=s.outputs){let e=s.outputs.indexOf(i);if(-1!==e){let a="".concat(r,":").concat(e);t.inputNames[n]=a}}t.inputs.push(s),s.children.push(t)})});let s=e.ret;e.signature.outputArg.forEach(e=>{let[t,n]=hL(s[e.name]),r=a[t];null!=r&&(r.defaultOutput=n,i.push(r))});let o=this.mapArgsToSignature(e);return{nodes:a,inputs:r,outputs:i,weights:n,placeholders:[],signature:o}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}};function nz(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){let t=Td().global;if("undefined"!=typeof t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function az(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e[t];return null!=r?nz(r.s,a):n}function rz(e,t,n){let a=e[t];return a?a.b:n}function iz(e,t,n){let a=e[t]||{},r=null!=a.i?a.i:null!=a.f?a.f:n;return"number"==typeof r?r:parseInt(r,10)}function sz(e){switch("string"==typeof e&&(e=nL[e]),e){case nL.DT_FLOAT:case nL.DT_HALF:return"float32";case nL.DT_INT32:case nL.DT_INT64:case nL.DT_INT8:case nL.DT_UINT8:return"int32";case nL.DT_BOOL:return"bool";case nL.DT_DOUBLE:return"float32";case nL.DT_STRING:return"string";case nL.DT_COMPLEX64:case nL.DT_COMPLEX128:return"complex64";default:return null}}function oz(e,t,n){let a=e[t];return a&&a.func?a.func.name:n}function lz(e,t,n){let a=e[t];return a&&a.type?sz(a.type):n}function uz(e,t,n){let a=e[t];return a&&a.list&&a.list.type?a.list.type.map(e=>sz(e)):n}function cz(e){if(!e.unknownRank)return null!=e.dim?e.dim.map(e=>"number"==typeof e.size?e.size:parseInt(e.size,10)):[]}function dz(e,t,n){let a=e[t];return a&&a.shape?cz(a.shape):n}function hz(e,t,n){let a=e[t];return a?((a.list.f&&a.list.f.length?a.list.f:a.list.i)||[]).map(e=>"number"==typeof e?e:parseInt(e,10)):n}function pz(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e[t];return r&&r.list&&r.list.s?r.list.s.map(e=>nz(e,a)):n}function fz(e,t,n){let a=e[t];return a&&a.list&&a.list.shape?a.list.shape.map(e=>cz(e)):n}function mz(e,t,n){let a=e[t];return a&&a.list&&a.list.b?a.list.b:n}var gz=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(e=>this.getInput(e)),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((e,t)=>(e[t]=this.getAttr(t),e),{}))}getInput(e){return cL(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(null!=n.tensor)return cL(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return iz(this.node.rawAttrs,e,t);if(null!=n.s)return az(this.node.rawAttrs,e,t);if(null!=n.b)return rz(this.node.rawAttrs,e,t);if(null!=n.shape)return dz(this.node.rawAttrs,e,t);if(null!=n.type)return lz(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return hz(this.node.rawAttrs,e,t);if(null!=n.list.s)return pz(this.node.rawAttrs,e,t);if(null!=n.list.shape)return fz(this.node.rawAttrs,e,t);if(null!=n.list.b)return mz(this.node.rawAttrs,e,t);if(null!=n.list.type)return uz(this.node.rawAttrs,e,t)}return t}},yz={};ac(yz,{OP_SCOPE_SUFFIX:()=>Cg,abs:()=>sb,acos:()=>ob,acosh:()=>lb,add:()=>nb,addN:()=>ub,all:()=>cb,any:()=>db,argMax:()=>hb,argMin:()=>pb,asin:()=>fb,asinh:()=>mb,atan:()=>gb,atan2:()=>yb,atanh:()=>bb,avgPool:()=>Ob,avgPool3d:()=>Pb,basicLSTMCell:()=>Ub,batchNorm:()=>Hb,batchNorm2d:()=>qb,batchNorm3d:()=>Kb,batchNorm4d:()=>Xb,batchToSpaceND:()=>jb,bincount:()=>Yb,bitwiseAnd:()=>Qb,booleanMaskAsync:()=>Wk,broadcastArgs:()=>Jb,broadcastTo:()=>Zb,buffer:()=>Zy,cast:()=>$y,ceil:()=>$b,clipByValue:()=>tv,clone:()=>eb,complex:()=>_g,concat:()=>Lb,concat1d:()=>nv,concat2d:()=>av,concat3d:()=>rv,concat4d:()=>iv,conv1d:()=>ov,conv2d:()=>sv,conv2dTranspose:()=>uv,conv3d:()=>cv,conv3dTranspose:()=>hv,cos:()=>pv,cosh:()=>fv,cosineWindow:()=>Xk,cumprod:()=>mv,cumsum:()=>gv,denseBincount:()=>yv,depthToSpace:()=>bv,depthwiseConv2d:()=>vv,diag:()=>xv,dilation2d:()=>wv,div:()=>rb,divNoNan:()=>_v,dot:()=>Av,dropout:()=>qk,einsum:()=>Fv,elu:()=>Rv,enclosingPowerOfTwo:()=>Kk,ensureShape:()=>Dv,equal:()=>Tv,erf:()=>Mv,euclideanNorm:()=>Zv,exp:()=>$v,expandDims:()=>ex,expm1:()=>tx,eye:()=>ax,fft:()=>uk,fill:()=>ev,floor:()=>rx,floorDiv:()=>ab,fused:()=>Qk,gather:()=>ix,gatherND:()=>Hk,greater:()=>sx,greaterEqual:()=>ox,ifft:()=>ck,imag:()=>lx,image:()=>sI,inTopKAsync:()=>Yk,irfft:()=>dk,isFinite:()=>ux,isInf:()=>cx,isNaN:()=>dx,leakyRelu:()=>hx,less:()=>px,lessEqual:()=>fx,linalg:()=>oI,linspace:()=>mx,localResponseNormalization:()=>gx,log:()=>yx,log1p:()=>bx,logSigmoid:()=>Ex,logSoftmax:()=>Ax,logSumExp:()=>Fx,logicalAnd:()=>Rx,logicalNot:()=>Dx,logicalOr:()=>Mx,logicalXor:()=>Ox,losses:()=>lI,lowerBound:()=>zx,matMul:()=>zb,max:()=>jv,maxPool:()=>Bx,maxPool3d:()=>Wx,maxPoolWithArgmax:()=>Vx,maximum:()=>Ux,mean:()=>jx,meshgrid:()=>qx,min:()=>Gv,minimum:()=>Kx,mirrorPad:()=>Xx,mod:()=>Yx,moments:()=>Qx,movingAverage:()=>Uk,mul:()=>ib,multiRNNCell:()=>Jx,multinomial:()=>Zx,neg:()=>Tx,norm:()=>Jv,notEqual:()=>$x,oneHot:()=>ew,ones:()=>Hx,onesLike:()=>tw,op:()=>Eg,outerProduct:()=>nw,pad:()=>aw,pad1d:()=>rw,pad2d:()=>iw,pad3d:()=>sw,pad4d:()=>ow,pool:()=>uw,pow:()=>Hv,prelu:()=>cw,print:()=>tb,prod:()=>dw,raggedGather:()=>hw,raggedRange:()=>pw,raggedTensorToTensor:()=>fw,rand:()=>mw,randomGamma:()=>Ow,randomNormal:()=>Pw,randomStandardNormal:()=>Lw,randomUniform:()=>zw,randomUniformInt:()=>Bw,range:()=>Ww,real:()=>Vw,reciprocal:()=>Uw,relu:()=>jw,relu6:()=>Gw,reshape:()=>Mb,reverse:()=>Hw,reverse1d:()=>qw,reverse2d:()=>Kw,reverse3d:()=>Xw,reverse4d:()=>Yw,rfft:()=>pk,round:()=>Qw,rsqrt:()=>Jw,scalar:()=>qv,scatterND:()=>jk,searchSorted:()=>Lx,selu:()=>Zw,separableConv2d:()=>$w,setdiff1dAsync:()=>ek,sigmoid:()=>Bb,sign:()=>tk,signal:()=>iI,sin:()=>nk,sinh:()=>ak,slice:()=>Wb,slice1d:()=>rk,slice2d:()=>ik,slice3d:()=>sk,slice4d:()=>ok,softmax:()=>lk,softplus:()=>Cx,spaceToBatchND:()=>lw,sparse:()=>uI,sparseToDense:()=>Gk,spectral:()=>rI,split:()=>hk,sqrt:()=>Kv,square:()=>Xv,squaredDifference:()=>fk,squeeze:()=>mk,stack:()=>gk,step:()=>yk,stridedSlice:()=>bk,string:()=>cI,sub:()=>_x,sum:()=>Yv,tan:()=>vk,tanh:()=>Vb,tensor:()=>Fg,tensor1d:()=>xk,tensor2d:()=>wk,tensor3d:()=>kk,tensor4d:()=>Sk,tensor5d:()=>Ik,tensor6d:()=>Nk,tensorScatterUpdate:()=>Ak,tile:()=>nx,topk:()=>Fk,transpose:()=>Vk,truncatedNormal:()=>Rk,unique:()=>Dk,unsortedSegmentSum:()=>Mk,unstack:()=>Ok,upperBound:()=>Pk,variable:()=>Lk,where:()=>Cv,whereAsync:()=>Bk,zeros:()=>Gx,zerosLike:()=>Ev});function bz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!=typeof e&&"number"!=typeof t){um.assert(e.length===t.length,()=>n+" Shapes ".concat(e," and ").concat(t," must match"));for(let a=0;a<e.length;a++){let r=e[a],i=t[a];um.assert(r<0||i<0||r===i,()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}}}function vz(e){return!("number"==typeof e||e.some(e=>e<0))}function xz(e,t,n){let a=wz(e,n),r=!vz(a);if(r&&0===t.length)throw new Error("Tried to calculate elements of an empty list with non-fully-defined elementShape: ".concat(a));if(r&&t.forEach(e=>{a=wz(e.shape,a)}),!vz(a))throw new Error("Non-fully-defined elementShape: ".concat(a));return a}function wz(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));let n=[];for(let a=0;a<e.length;++a){let r=e[a],i=t[a];if(r>=0&&i>=0&&r!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[a]=r>=0?r:i}return n}var kz=class{constructor(e,t,n,a,r,i,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=r,this.dynamicSize=i,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=qv(0),Gg(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(null==e||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));let t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?)."));return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(e=>this.read(e))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0===this.size()&&(null==this.elementShape||0===this.elementShape.length)&&(this.elementShape=t.shape),bz(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Gg(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,because the index size: ").concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((e,n)=>this.write(e,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return Fg([],[0].concat(this.elementShape));let n=this.readMany(e);return bz(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),gk(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Fg([],[0].concat(this.elementShape));let t=[];for(let a=0;a<this.size();a++)t.push(a);let n=this.readMany(t);return bz(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),Lb(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Ok(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0,a=e.map(e=>(n+=e,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), and the TensorArray is not marked as dynamically resizeable"));let r=0===n?0:t.size/n,i=[];Ug(()=>{t=Mb(t,[1,n,r]);for(let n=0;n<e.length;++n){let s=[0,0===n?0:a[n-1],0],o=[1,e[n],r];i[n]=Mb(Wb(t,s,o),this.elementShape)}return i});let s=[];for(let o=0;o<e.length;o++)s[o]=o;this.writeMany(s,i)}},Sz=class e{get id(){return this.idTensor.id}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach(e=>{if(n!==e.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(e.dtype));bz(t,e.shape,"TensorList shape mismatch: "),Gg(e)}),this.idTensor=qv(0),this.maxNumElements=a,Gg(this.idTensor)}copy(){return new e([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(null==e||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));bz(e,this.elementShape,"TensorList shape mismatch: ");let a=xz(this.elementShape,this.tensors,e);return Ug(()=>{let e=this.tensors.map(e=>Mb(e,a));return gk(e,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");let n=xz(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,bz(a.shape,e,"TensorList shape mismatch: "),Mb(a,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(bz(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Gg(e),this.tensors.push(e)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));let n=new e([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let e=0;e<Math.min(this.tensors.length,t);++e)n.tensors[e]=this.tensors[e];return n}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));bz(this.tensors[e].shape,t,"TensorList shape mismatch: ");let a=xz(this.elementShape,this.tensors,t);return Mb(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));bz(this.elementShape,t.shape,"TensorList shape mismatch: "),Gg(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));bz(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());let a=xz(this.elementShape,this.tensors,n);return 0===e.length?Fg([],[0].concat(a)):Ug(()=>{let t=e.map(e=>Mb(this.tensors[e],a));return gk(t,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));bz(this.elementShape,t,"TensorList shape mismatch: ");let n=xz(this.elementShape,this.tensors,t);return 0===this.size()?Fg([],[0].concat(n)):Ug(()=>{let e=this.tensors.map(e=>Mb(e,n));return Lb(e,0)})}};var Iz=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let a=uL("thenBranch",e,t,n),r=uL("elseBranch",e,t,n),i=uL("cond",e,t,n),s=uL("args",e,t,n);return(await i.data())[0]?n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let a=uL("body",e,t,n),r=uL("cond",e,t,n),i=uL("args",e,t,n),s=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),o=i.map(e=>e.id),l=await s[0].data();s.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&e.dispose()});let u=i;for(;l[0];){let e=u;u=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);let t=u.map(e=>e.id);e.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()});let i=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await i[0].data(),i.forEach(e=>{!e.kept&&-1===o.indexOf(e.id)&&-1===t.indexOf(e.id)&&e.dispose()})}return u}case"LoopCond":return[gL(uL("pred",e,t,n))];case"Switch":{let a=uL("pred",e,t,n),r=uL("data",e,t,n);return r.kept||(r=gL(r)),(await a.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{let a=e.inputNames.find(e=>void 0!==cL(e,t,n));if(a){return[gL(cL(a,t,n))]}return}case"Enter":{let a=uL("frameName",e,t,n),r=uL("tensor",e,t,n);return n.enterFrame(a),[gL(r)]}case"Exit":{let a=uL("tensor",e,t,n);return n.exitFrame(),[gL(a)]}case"NextIteration":{let a=uL("tensor",e,t,n);return n.nextIteration(),[gL(a)]}case"TensorArrayV3":{let a=uL("size",e,t,n),r=uL("dtype",e,t,n),i=uL("elementShape",e,t,n),s=uL("dynamicSize",e,t,n),o=uL("clearAfterRead",e,t,n),l=uL("identicalElementShapes",e,t,n),u=uL("name",e,t,n),c=new kz(u,r,a,i,l,s,o);return n.addTensorArray(c),[c.idTensor,qv(1)]}case"TensorArrayWriteV3":{let a=uL("tensorArrayId",e,t,n),r=uL("index",e,t,n),i=uL("tensor",e,t,n),s=n.getTensorArray(a.id);return s.write(r,i),[s.idTensor]}case"TensorArrayReadV3":{let a=uL("tensorArrayId",e,t,n),r=uL("index",e,t,n);return[n.getTensorArray(a.id).read(r)]}case"TensorArrayGatherV3":{let a=uL("tensorArrayId",e,t,n),r=uL("indices",e,t,n),i=uL("dtype",e,t,n);return[n.getTensorArray(a.id).gather(r,i)]}case"TensorArrayScatterV3":{let a=uL("tensorArrayId",e,t,n),r=uL("indices",e,t,n),i=uL("tensor",e,t,n),s=n.getTensorArray(a.id);return s.scatter(r,i),[s.idTensor]}case"TensorArrayConcatV3":{let a=uL("tensorArrayId",e,t,n),r=n.getTensorArray(a.id),i=uL("dtype",e,t,n);return[r.concat(i)]}case"TensorArraySplitV3":{let a=uL("tensorArrayId",e,t,n),r=uL("tensor",e,t,n),i=uL("lengths",e,t,n),s=n.getTensorArray(a.id);return s.split(i,r),[s.idTensor]}case"TensorArraySizeV3":{let a=uL("tensorArrayId",e,t,n);return[qv(n.getTensorArray(a.id).size(),"int32")]}case"TensorArrayCloseV3":{let a=uL("tensorArrayId",e,t,n),r=n.getTensorArray(a.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{let a=uL("tensorListId",e,t,n),r=uL("index",e,t,n),i=uL("tensor",e,t,n),s=n.getTensorList(a.id);return s.setItem(r,i),[s.idTensor]}case"TensorListGetItem":{let a=uL("tensorListId",e,t,n),r=uL("index",e,t,n),i=uL("elementShape",e,t,n),s=uL("elementDType",e,t,n);return[n.getTensorList(a.id).getItem(r,i,s)]}case"TensorListScatterV2":case"TensorListScatter":{let a=uL("indices",e,t,n),r=function(e,t,n,a){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));let r=Math.max(...t);if(null!=a&&-1!==a&&r>=a)throw new Error("Max index must be < array size (".concat(r,"  vs. ").concat(a,")"));let i=new Sz([],n,e.dtype,a),s=Ok(e,0);return t.forEach((e,t)=>{i.setItem(e,s[t])}),i}(uL("tensor",e,t,n),a,uL("elementShape",e,t,n),uL("numElements",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let a,r=uL("elementShape",e,t,n),i=uL("elementDType",e,t,n);a="TensorListReserve"===e.op?"numElements":"maxNumElements";let s=uL(a,e,t,n),o=function(e,t,n,a){return new Sz([],e,t,a)}(r,i,0,"TensorListReserve"===e.op?-1:s);return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{let a=uL("tensorListId",e,t,n),r=uL("indices",e,t,n),i=uL("elementShape",e,t,n),s=uL("elementDType",e,t,n);return[n.getTensorList(a.id).gather(r,s,i)]}case"TensorListStack":{let a=uL("tensorListId",e,t,n),r=uL("elementShape",e,t,n),i=uL("elementDType",e,t,n),s=uL("numElements",e,t,n);return[n.getTensorList(a.id).stack(r,i,s)]}case"TensorListFromTensor":{let a=function(e,t,n){let a=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));bz(e.shape.slice(1),t,"TensorList shape mismatch: ");let r=Ok(e);return new Sz(r,t,a)}(uL("tensor",e,t,n),uL("elementShape",e,t,n),uL("elementDType",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let a=uL("tensorListId",e,t,n),r=n.getTensorList(a.id),i=uL("dtype",e,t,n),s=uL("elementShape",e,t,n);return[r.concat(i,s)]}case"TensorListPushBack":{let a=uL("tensorListId",e,t,n),r=uL("tensor",e,t,n),i=n.getTensorList(a.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{let a=uL("tensorListId",e,t,n),r=uL("elementShape",e,t,n),i=uL("elementDType",e,t,n);return[n.getTensorList(a.id).popBack(r,i)]}case"TensorListSplit":{let a=uL("tensor",e,t,n),r=uL("elementShape",e,t,n),i=function(e,t,n){let a=0,r=t.map(e=>(a+=e,a));if(a!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(a,", and tensor's shape is: ").concat(e.shape));let i=wz(e.shape.slice(1),n),s=0===a?0:e.size/a,o=Ug(()=>{let n=[];e=Mb(e,[1,a,s]);for(let a=0;a<t.length;++a){let o=[0,0===a?0:r[a-1],0],l=[1,t[a],s];n[a]=Mb(Wb(e,o,l),i)}return e.dispose(),n}),l=new Sz([],n,e.dtype,t.length);for(let u=0;u<o.length;u++)l.setItem(u,o[u]);return l}(a,uL("lengths",e,t,n),r);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{let a=uL("tensorListId",e,t,n);return[qv(n.getTensorList(a.id).size(),"int32")]}case"TensorListResize":{let a=uL("tensorListId",e,t,n),r=uL("size",e,t,n),i=n.getTensorList(a.id).resize(r);return n.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function Nz(e,t,n){let[a,r]=uL("fusedOps",e,t,n),i="biasadd"===a,s=!i,o="prelu"===r,l="fusedbatchnorm"===a,u=uL("numArgs",e,t,n);if(i){if(o&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let c=uL("strides",e,t,n),d=mL(e,t,n),h=uL("dataFormat",e,t,n).toUpperCase(),p=uL("dilations",e,t,n),[f,m]=uL("args",e,t,n);return s&&(m=f,f=void 0),{stride:c,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:r,leakyreluAlpha:uL("leakyreluAlpha",e,t,n)}}function Tz(e,t,n){return{boxes:uL("boxes",e,t,n),scores:uL("scores",e,t,n),maxOutputSize:uL("maxOutputSize",e,t,n),iouThreshold:uL("iouThreshold",e,t,n),scoreThreshold:uL("scoreThreshold",e,t,n),softNmsSigma:uL("softNmsSigma",e,t,n)}}var Cz=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=qv(0),this.tensorMap=new Map,Gg(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return qv(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),Ug(()=>{let e=Ok(t),a=n.length,r=e.length;um.assert(a===r,()=>"The number of elements doesn't match, keys has ".concat(a," elements, the values has ").concat(r," elements."));for(let t=0;t<a;t++){let a=n[t],r=e[t];Gg(r),this.tensorMap.set(a,r)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return Ug(()=>{let e=[];for(let a=0;a<n.length;a++){let r=n[a],i=this.findWithDefault(r,t);e.push(i)}return gk(e)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ").concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ").concat(t.dtype))}};function Ez(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ug,i=((e,t,n)=>{switch(e.category){case"arithmetic":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[a.add(uL("a",e,t,n),uL("b",e,t,n))];case"AddN":return[a.addN(uL("tensors",e,t,n))];case"FloorMod":case"Mod":return[a.mod(uL("a",e,t,n),uL("b",e,t,n))];case"Mul":return[a.mul(uL("a",e,t,n),uL("b",e,t,n))];case"RealDiv":case"Div":return[a.div(uL("a",e,t,n),uL("b",e,t,n))];case"DivNoNan":return[a.divNoNan(uL("a",e,t,n),uL("b",e,t,n))];case"FloorDiv":return[a.floorDiv(uL("a",e,t,n),uL("b",e,t,n))];case"Sub":return[a.sub(uL("a",e,t,n),uL("b",e,t,n))];case"Minimum":return[a.minimum(uL("a",e,t,n),uL("b",e,t,n))];case"Maximum":return[a.maximum(uL("a",e,t,n),uL("b",e,t,n))];case"Pow":return[a.pow(uL("a",e,t,n),uL("b",e,t,n))];case"SquaredDifference":return[a.squaredDifference(uL("a",e,t,n),uL("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"basic_math":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Abs":case"ComplexAbs":return[a.abs(uL("x",e,t,n))];case"Acos":return[a.acos(uL("x",e,t,n))];case"Acosh":return[a.acosh(uL("x",e,t,n))];case"Asin":return[a.asin(uL("x",e,t,n))];case"Asinh":return[a.asinh(uL("x",e,t,n))];case"Atan":return[a.atan(uL("x",e,t,n))];case"Atan2":return[a.atan2(uL("x",e,t,n),uL("y",e,t,n))];case"Atanh":return[a.atanh(uL("x",e,t,n))];case"Ceil":return[a.ceil(uL("x",e,t,n))];case"Complex":return[a.complex(uL("real",e,t,n),uL("imag",e,t,n))];case"Cos":return[a.cos(uL("x",e,t,n))];case"Cosh":return[a.cosh(uL("x",e,t,n))];case"Elu":return[a.elu(uL("x",e,t,n))];case"Erf":return[a.erf(uL("x",e,t,n))];case"Exp":return[a.exp(uL("x",e,t,n))];case"Expm1":return[a.expm1(uL("x",e,t,n))];case"Floor":return[a.floor(uL("x",e,t,n))];case"Log":return[a.log(uL("x",e,t,n))];case"Log1p":return[a.log1p(uL("x",e,t,n))];case"Imag":return[a.imag(uL("x",e,t,n))];case"Neg":return[a.neg(uL("x",e,t,n))];case"Reciprocal":return[a.reciprocal(uL("x",e,t,n))];case"Real":return[a.real(uL("x",e,t,n))];case"Relu":return[a.relu(uL("x",e,t,n))];case"Round":return[a.round(uL("x",e,t,n))];case"Selu":return[a.selu(uL("x",e,t,n))];case"Sigmoid":return[a.sigmoid(uL("x",e,t,n))];case"Sin":return[a.sin(uL("x",e,t,n))];case"Sign":return[a.sign(uL("x",e,t,n))];case"Sinh":return[a.sinh(uL("x",e,t,n))];case"Softplus":return[a.softplus(uL("x",e,t,n))];case"Sqrt":return[a.sqrt(uL("x",e,t,n))];case"Square":return[a.square(uL("x",e,t,n))];case"Tanh":return[a.tanh(uL("x",e,t,n))];case"Tan":return[a.tan(uL("x",e,t,n))];case"ClipByValue":return[a.clipByValue(uL("x",e,t,n),uL("clipValueMin",e,t,n),uL("clipValueMax",e,t,n))];case"Relu6":return[a.relu6(uL("x",e,t,n))];case"Rsqrt":return[a.rsqrt(cL(e.inputNames[0],t,n))];case"LeakyRelu":return[a.leakyRelu(uL("x",e,t,n),uL("alpha",e,t,n))];case"Prelu":return[a.prelu(uL("x",e,t,n),uL("alpha",e,t,n))];case"IsNan":return[a.isNaN(cL(e.inputNames[0],t,n))];case"IsInf":return[a.isInf(cL(e.inputNames[0],t,n))];case"IsFinite":return[a.isFinite(cL(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"control":return Iz(e,t,n);case"convolution":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Conv1D":{let r=uL("stride",e,t,n),i=uL("pad",e,t,n),s=uL("dataFormat",e,t,n).toUpperCase(),o=uL("dilation",e,t,n);return[a.conv1d(uL("x",e,t,n),uL("filter",e,t,n),r,i,s,o)]}case"Conv2D":{let r=uL("strides",e,t,n),i=mL(e,t,n),s=uL("dataFormat",e,t,n).toUpperCase(),o=uL("dilations",e,t,n);return[a.conv2d(uL("x",e,t,n),uL("filter",e,t,n),[r[1],r[2]],i,s,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:r,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Nz(e,t,n);return[a.fused.conv2d({x:uL("x",e,t,n),filter:uL("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{let{stride:r,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Nz(e,t,n);return[a.fused.depthwiseConv2d({x:uL("x",e,t,n),filter:uL("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let r=uL("outputShape",e,t,n),i=uL("strides",e,t,n),s=mL(e,t,n);return[a.conv2dTranspose(uL("x",e,t,n),uL("filter",e,t,n),r,[i[1],i[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let r=uL("strides",e,t,n),i=mL(e,t,n),s=uL("dilations",e,t,n),o=uL("dataFormat",e,t,n).toUpperCase();return[a.depthwiseConv2d(uL("input",e,t,n),uL("filter",e,t,n),[r[1],r[2]],i,o,[s[1],s[2]])]}case"Conv3D":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("dataFormat",e,t,n).toUpperCase(),o=uL("dilations",e,t,n);return[a.conv3d(uL("x",e,t,n),uL("filter",e,t,n),[r[1],r[2],r[3]],i,s,[o[1],o[2],o[3]])]}case"AvgPool":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("kernelSize",e,t,n);return[a.avgPool(uL("x",e,t,n),[s[1],s[2]],[r[1],r[2]],i)]}case"MaxPool":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("kernelSize",e,t,n);return[a.maxPool(uL("x",e,t,n),[s[1],s[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("kernelSize",e,t,n),o=uL("includeBatchInIndex",e,t,n),{result:l,indexes:u}=a.maxPoolWithArgmax(uL("x",e,t,n),[s[1],s[2]],[r[1],r[2]],i,o);return[l,u]}case"AvgPool3D":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("kernelSize",e,t,n);return[a.avgPool3d(uL("x",e,t,n),[s[1],s[2],s[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("kernelSize",e,t,n);return[a.maxPool3d(uL("x",e,t,n),[s[1],s[2],s[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{let r=uL("strides",e,t,n),i=uL("pad",e,t,n),s=uL("dilations",e,t,n),o=r[1],l=r[2],u=s[1],c=s[2];return[a.dilation2d(uL("x",e,t,n),uL("filter",e,t,n),[o,l],i,[u,c],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"creation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Fill":{let r=uL("shape",e,t,n),i=uL("dtype",e,t,n),s=uL("value",e,t,n);return[a.fill(r,s,i)]}case"LinSpace":{let r=uL("start",e,t,n),i=uL("stop",e,t,n),s=uL("num",e,t,n);return[a.linspace(r,i,s)]}case"Multinomial":{let r=uL("logits",e,t,n),i=uL("numSamples",e,t,n),s=uL("seed",e,t,n);return[a.multinomial(r,i,s)]}case"OneHot":{let r=uL("indices",e,t,n),i=uL("depth",e,t,n),s=uL("onValue",e,t,n),o=uL("offValue",e,t,n),l=uL("dtype",e,t,n);return[a.oneHot(r,i,s,o,l)]}case"Ones":return[a.ones(uL("shape",e,t,n),uL("dtype",e,t,n))];case"OnesLike":return[a.onesLike(uL("x",e,t,n))];case"RandomStandardNormal":return[a.randomStandardNormal(uL("shape",e,t,n),uL("dtype",e,t,n),uL("seed",e,t,n))];case"RandomUniform":return[a.randomUniform(uL("shape",e,t,n),uL("minval",e,t,n),uL("maxval",e,t,n),uL("dtype",e,t,n))];case"RandomUniformInt":return[a.randomUniformInt(uL("shape",e,t,n),uL("minval",e,t,n),uL("maxval",e,t,n),uL("seed",e,t,n))];case"Range":{let r=uL("start",e,t,n),i=uL("stop",e,t,n),s=uL("step",e,t,n);return[a.range(r,i,s,uL("dtype",e,t,n))]}case"TruncatedNormal":{let r=uL("shape",e,t,n),i=uL("mean",e,t,n),s=uL("stdDev",e,t,n),o=uL("seed",e,t,n);return[a.truncatedNormal(r,i,s,uL("dtype",e,t,n),o)]}case"Zeros":return[a.zeros(uL("shape",e,t,n),uL("dtype",e,t,n))];case"ZerosLike":return[a.zerosLike(uL("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"dynamic":return async function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yz;switch(e.op){case"NonMaxSuppressionV5":{let{boxes:a,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=Tz(e,t,n),c=await r.image.nonMaxSuppressionWithScoreAsync(a,i,s,o,l,u);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:a,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=Tz(e,t,n),u=uL("padToMaxOutputSize",e,t,n),c=await r.image.nonMaxSuppressionPaddedAsync(a,i,s,o,l,u);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:a,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=Tz(e,t,n);return[await r.image.nonMaxSuppressionAsync(a,i,s,o,l)]}case"Where":{let a=r.cast(uL("condition",e,t,n),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(uL("x",e,t,n),uL("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n);case"evaluation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"LowerBound":{let r=uL("sortedSequence",e,t,n),i=uL("values",e,t,n);return[a.lowerBound(r,i)]}case"TopKV2":{let r=uL("x",e,t,n),i=uL("k",e,t,n),s=uL("sorted",e,t,n),o=a.topk(r,i,s);return[o.values,o.indices]}case"UpperBound":{let r=uL("sortedSequence",e,t,n),i=uL("values",e,t,n);return[a.upperBound(r,i)]}case"Unique":{let r=uL("x",e,t,n),i=a.unique(r);return[i.values,i.indices]}case"UniqueV2":{let r=uL("x",e,t,n),i=uL("axis",e,t,n),s=a.unique(r,i);return[s.values,s.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"image":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"ResizeBilinear":{let r=uL("images",e,t,n),i=uL("size",e,t,n),s=uL("alignCorners",e,t,n),o=uL("halfPixelCenters",e,t,n);return[a.image.resizeBilinear(r,[i[0],i[1]],s,o)]}case"ResizeNearestNeighbor":{let r=uL("images",e,t,n),i=uL("size",e,t,n),s=uL("alignCorners",e,t,n),o=uL("halfPixelCenters",e,t,n);return[a.image.resizeNearestNeighbor(r,[i[0],i[1]],s,o)]}case"CropAndResize":{let r=uL("image",e,t,n),i=uL("boxes",e,t,n),s=uL("boxInd",e,t,n),o=uL("cropSize",e,t,n),l=uL("method",e,t,n),u=uL("extrapolationValue",e,t,n);return[a.image.cropAndResize(r,i,s,o,l,u)]}case"ImageProjectiveTransformV3":{let r=uL("images",e,t,n),i=uL("transforms",e,t,n),s=uL("outputShape",e,t,n),o=uL("fillValue",e,t,n),l=uL("interpolation",e,t,n),u=uL("fillMode",e,t,n);return[a.image.transform(r,i,l.toLowerCase(),u.toLowerCase(),o,s)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"graph":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let r=uL("default",e,t,n);return[cL(e.name,t,n)||r];case"Placeholder":return[cL(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[gL(uL("x",e,t,n))];case"IdentityN":return uL("x",e,t,n).map(e=>gL(e));case"Shape":return[a.tensor1d(uL("x",e,t,n).shape,"int32")];case"ShapeN":return uL("x",e,t,n).map(e=>a.tensor1d(e.shape));case"Size":return[a.scalar(uL("x",e,t,n).size,"int32")];case"Rank":return[a.scalar(uL("x",e,t,n).rank,"int32")];case"NoOp":return[a.scalar(1)];case"Print":let i=uL("x",e,t,n),s=uL("data",e,t,n),o=uL("message",e,t,n),l=uL("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<s.length;e++)console.log(Array.prototype.slice.call(s[e].dataSync()).slice(0,l));return[i];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"logical":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Equal":return[a.equal(uL("a",e,t,n),uL("b",e,t,n))];case"NotEqual":return[a.notEqual(uL("a",e,t,n),uL("b",e,t,n))];case"Greater":return[a.greater(uL("a",e,t,n),uL("b",e,t,n))];case"GreaterEqual":return[a.greaterEqual(uL("a",e,t,n),uL("b",e,t,n))];case"Less":return[a.less(uL("a",e,t,n),uL("b",e,t,n))];case"LessEqual":return[a.lessEqual(uL("a",e,t,n),uL("b",e,t,n))];case"LogicalAnd":return[a.logicalAnd(uL("a",e,t,n),uL("b",e,t,n))];case"LogicalNot":return[a.logicalNot(uL("a",e,t,n))];case"LogicalOr":return[a.logicalOr(uL("a",e,t,n),uL("b",e,t,n))];case"Select":case"SelectV2":return[a.where(uL("condition",e,t,n),uL("a",e,t,n),uL("b",e,t,n))];case"BitwiseAnd":return[a.bitwiseAnd(uL("a",e,t,n),uL("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"matrices":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[a.matMul(uL("a",e,t,n),uL("b",e,t,n),uL("transposeA",e,t,n),uL("transposeB",e,t,n))];case"Einsum":return[a.einsum(uL("equation",e,t,n),...uL("tensors",e,t,n))];case"Transpose":return[a.transpose(uL("x",e,t,n),uL("perm",e,t,n))];case"_FusedMatMul":let[r,i]=uL("fusedOps",e,t,n),s="biasadd"===r,o="prelu"===i,l=uL("numArgs",e,t,n),u=uL("leakyreluAlpha",e,t,n);if(s){if(o&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[c,d]=uL("args",e,t,n);return[a.fused.matMul({a:uL("a",e,t,n),b:uL("b",e,t,n),transposeA:uL("transposeA",e,t,n),transposeB:uL("transposeB",e,t,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[a.linalg.bandPart(uL("a",e,t,n),uL("numLower",e,t,n),uL("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"normalization":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"EuclideanNorm":return[a.euclideanNorm(uL("x",e,t,n),uL("axis",e,t,n),uL("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[a.batchNorm(uL("x",e,t,n),uL("mean",e,t,n),uL("variance",e,t,n),uL("offset",e,t,n),uL("scale",e,t,n),uL("epsilon",e,t,n))];case"LRN":return[a.localResponseNormalization(uL("x",e,t,n),uL("radius",e,t,n),uL("bias",e,t,n),uL("alpha",e,t,n),uL("beta",e,t,n))];case"Softmax":return[a.softmax(uL("x",e,t,n))];case"LogSoftmax":return[a.logSoftmax(uL("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"ragged":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"RaggedGather":{let{outputNestedSplits:r,outputDenseValues:i}=a.raggedGather(uL("paramsNestedSplits",e,t,n),uL("paramsDenseValues",e,t,n),uL("indices",e,t,n),uL("outputRaggedRank",e,t,n));return r.concat(i)}case"RaggedRange":{let{rtNestedSplits:r,rtDenseValues:i}=a.raggedRange(uL("starts",e,t,n),uL("limits",e,t,n),uL("splits",e,t,n));return[r,i]}case"RaggedTensorToTensor":return[a.raggedTensorToTensor(uL("shape",e,t,n),uL("values",e,t,n),uL("defaultValue",e,t,n),uL("rowPartitionTensors",e,t,n),uL("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"reduction":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Max":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.max(uL("x",e,t,n),r,i)]}case"Mean":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.mean(uL("x",e,t,n),r,i)]}case"Min":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.min(uL("x",e,t,n),r,i)]}case"Sum":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.sum(uL("x",e,t,n),r,i)]}case"All":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.all(uL("x",e,t,n),r,i)]}case"Any":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.any(uL("x",e,t,n),r,i)]}case"ArgMax":{let r=uL("axis",e,t,n);return[a.argMax(uL("x",e,t,n),r)]}case"ArgMin":{let r=uL("axis",e,t,n);return[a.argMin(uL("x",e,t,n),r)]}case"Prod":{let r=uL("axis",e,t,n),i=uL("keepDims",e,t,n);return[a.prod(uL("x",e,t,n),r,i)]}case"Cumprod":{let r=uL("axis",e,t,n),i=uL("exclusive",e,t,n),s=uL("reverse",e,t,n);return[a.cumprod(uL("x",e,t,n),r,i,s)]}case"Cumsum":{let r=uL("axis",e,t,n),i=uL("exclusive",e,t,n),s=uL("reverse",e,t,n);return[a.cumsum(uL("x",e,t,n),r,i,s)]}case"Bincount":let r=uL("x",e,t,n),i=uL("weights",e,t,n),s=uL("size",e,t,n);return[a.bincount(r,i,s)];case"DenseBincount":{let r=uL("x",e,t,n),i=uL("weights",e,t,n),s=uL("size",e,t,n),o=uL("binaryOutput",e,t,n);return[a.denseBincount(r,i,s,o)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"slice_join":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"ConcatV2":case"Concat":{let r=uL("n",e,t,n),i=uL("axis",e,t,n),s=uL("tensors",e,t,n);return s=s.slice(0,r),[a.concat(s,i)]}case"Gather":{let r=uL("x",e,t,n),i=uL("indices",e,t,n);return[a.gather(r,a.cast(i,"int32"),0)]}case"GatherV2":{let r=uL("axis",e,t,n),i=uL("batchDims",e,t,n),s=uL("x",e,t,n),o=uL("indices",e,t,n);return[a.gather(s,a.cast(o,"int32"),r,i)]}case"Reverse":{let r=uL("dims",e,t,n),i=[];for(let e=0;e<r.length;e++)r[e]&&i.push(e);let s=uL("x",e,t,n);return[a.reverse(s,i)]}case"ReverseV2":{let r=uL("axis",e,t,n),i=uL("x",e,t,n);return[a.reverse(i,r)]}case"Slice":{let r=uL("begin",e,t,n),i=uL("size",e,t,n);return[a.slice(uL("x",e,t,n),r,i)]}case"StridedSlice":{let r=uL("begin",e,t,n),i=uL("end",e,t,n),s=uL("strides",e,t,n),o=uL("beginMask",e,t,n),l=uL("endMask",e,t,n),u=uL("ellipsisMask",e,t,n),c=uL("newAxisMask",e,t,n),d=uL("shrinkAxisMask",e,t,n),h=uL("x",e,t,n);return[a.stridedSlice(h,r,i,s,o,l,u,c,d)]}case"Pack":return Ug(()=>{let r=uL("axis",e,t,n),i=uL("tensors",e,t,n),s=i[0].shape,o=a.squeeze(i[0]).shape,l=i.map(e=>{let t=um.arraysEqual(e.shape,s);if(!t&&!um.arraysEqual(a.squeeze(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:a.reshape(e,s)});return[a.stack(l,r)]});case"Unpack":{let r=uL("axis",e,t,n),i=uL("tensor",e,t,n);return a.unstack(i,r)}case"Tile":{let r=uL("reps",e,t,n);return[a.tile(uL("x",e,t,n),r)]}case"Split":case"SplitV":{let r=uL("axis",e,t,n),i=uL("numOrSizeSplits",e,t,n),s=uL("x",e,t,n);return a.split(s,i,r)}case"ScatterNd":{let r=uL("indices",e,t,n),i=uL("values",e,t,n),s=uL("shape",e,t,n);return[a.scatterND(r,i,s)]}case"GatherNd":{let r=uL("x",e,t,n),i=uL("indices",e,t,n);return[a.gatherND(r,i)]}case"SparseToDense":{let r=uL("sparseIndices",e,t,n),i=uL("outputShape",e,t,n),s=uL("sparseValues",e,t,n),o=uL("defaultValue",e,t,n);return[a.sparseToDense(r,s,i,s.dtype===o.dtype?o:a.cast(o,s.dtype))]}case"TensorScatterUpdate":{let r=uL("indices",e,t,n),i=uL("values",e,t,n),s=uL("tensor",e,t,n);return[a.tensorScatterUpdate(s,r,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"sparse":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:r,outputValues:i,emptyRowIndicator:s,reverseIndexMap:o}=a.sparse.sparseFillEmptyRows(uL("indices",e,t,n),uL("values",e,t,n),uL("denseShape",e,t,n),uL("defaultValue",e,t,n));return[r,i,s,o]}case"SparseReshape":{let{outputIndices:r,outputShape:i}=a.sparse.sparseReshape(uL("inputIndices",e,t,n),uL("inputShape",e,t,n),uL("newShape",e,t,n));return[r,i]}case"SparseSegmentMean":return[a.sparse.sparseSegmentMean(uL("data",e,t,n),uL("indices",e,t,n),uL("segmentIds",e,t,n))];case"SparseSegmentSum":return[a.sparse.sparseSegmentSum(uL("data",e,t,n),uL("indices",e,t,n),uL("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"spectral":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"FFT":return[a.fft(uL("x",e,t,n))];case"IFFT":return[a.ifft(uL("x",e,t,n))];case"RFFT":return[a.rfft(uL("x",e,t,n))];case"IRFFT":return[a.irfft(uL("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"string":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"StaticRegexReplace":return[a.string.staticRegexReplace(uL("input",e,t,n),uL("pattern",e,t,n),uL("rewrite",e,t,n),uL("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:r,nGramsSplits:i}=a.string.stringNGrams(uL("data",e,t,n),uL("dataSplits",e,t,n),uL("separator",e,t,n),uL("nGramWidths",e,t,n),uL("leftPad",e,t,n),uL("rightPad",e,t,n),uL("padWidth",e,t,n),uL("preserveShortSequences",e,t,n));return[r,i]}case"StringSplit":{let{indices:r,values:i,shape:s}=a.string.stringSplit(uL("input",e,t,n),uL("delimiter",e,t,n),uL("skipEmpty",e,t,n));return[r,i,s]}case"StringToHashBucketFast":return[a.string.stringToHashBucketFast(uL("input",e,t,n),uL("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"transformation":return r(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yz;switch(e.op){case"Cast":return[a.cast(uL("x",e,t,n),uL("dtype",e,t,n))];case"ExpandDims":{let r=uL("axis",e,t,n);return[a.expandDims(uL("x",e,t,n),r)]}case"Squeeze":{let r=uL("axis",e,t,n);return[a.squeeze(uL("x",e,t,n),r)]}case"Reshape":return[a.reshape(uL("x",e,t,n),uL("shape",e,t,n))];case"EnsureShape":return[a.ensureShape(uL("x",e,t,n),uL("shape",e,t,n))];case"MirrorPad":return[a.mirrorPad(uL("x",e,t,n),uL("padding",e,t,n),uL("mode",e,t,n))];case"PadV2":case"Pad":return[a.pad(uL("x",e,t,n),uL("padding",e,t,n),uL("constantValue",e,t,n))];case"SpaceToBatchND":{let r=uL("blockShape",e,t,n),i=uL("paddings",e,t,n);return[a.spaceToBatchND(uL("x",e,t,n),r,i)]}case"BatchToSpaceND":{let r=uL("blockShape",e,t,n),i=uL("crops",e,t,n);return[a.batchToSpaceND(uL("x",e,t,n),r,i)]}case"DepthToSpace":{let r=uL("blockSize",e,t,n),i=uL("dataFormat",e,t,n).toUpperCase();return[a.depthToSpace(uL("x",e,t,n),r,i)]}case"BroadcastTo":return[a.broadcastTo(uL("x",e,t,n),uL("shape",e,t,n))];case"BroadcastArgs":return[a.broadcastArgs(uL("s0",e,t,n),uL("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"hash_table":return(async(e,t,n,a)=>{switch(e.op){case"HashTable":case"HashTableV2":{let r=a.getHashTableHandleByName(e.name);if(null!=r)return[r];{let r=uL("keyDType",e,t,n),i=uL("valueDType",e,t,n),s=new Cz(r,i);return a.addHashTable(e.name,s),[s.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let r=uL("tableHandle",e,t,n,a),i=uL("keys",e,t,n),s=uL("values",e,t,n);return[await a.getHashTableById(r.id).import(i,s)]}case"LookupTableFind":case"LookupTableFindV2":{let r=uL("tableHandle",e,t,n,a),i=uL("keys",e,t,n),s=uL("defaultValue",e,t,n);return[await a.getHashTableById(r.id).find(i,s)]}case"LookupTableSize":case"LookupTableSizeV2":{let r=uL("tableHandle",e,t,n,a);return[a.getHashTableById(r.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}})(e,t,n,a);case"custom":let i=oL(e.op);if(i&&i.customExecutor)return i.customExecutor(new gz(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()"))}})(e,t,n);return um.isPromise(i)?i.then(e=>[].concat(e)):[].concat(i)}var _z=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=a,this.parseNodeNameCache=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(e=>0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function Az(e,t,n,a){let r=new Set,i=[],s=null,o=null,l=new Set,u=new Set(Object.keys(e).map(e=>fL(e)[0]));a=a||[];let c=new Set(a.map(e=>fL(e.name)[0])),d=[...t];for(;d.length>0;){let e=d.pop();if((Pz(e)||Lz(e)||zz(e))&&null==s&&(s=e,o=s.children.map(e=>e.name).filter(e=>r.has(e))),r.add(e.name),null==n[e.name]&&!u.has(e.name)&&!c.has(e.name)){if(0===e.inputs.length){i.push(e.name);continue}e.inputs.forEach(e=>{l.has(e.name)||(l.add(e.name),d.push(e))})}}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:s,syncInputs:o}}function Fz(e,t){let{usedNodes:n,inputs:a}=t,r=Object.keys(a).map(e=>fL(e)[0]).map(t=>e.nodes[t]),i=e.initNodes||[],s=e=>n.has("string"==typeof e?e:e.name);function o(e){return[...new Map(e.map(e=>[e.name,e])).values()]}let l=o([...r,...e.weights,...i]).filter(s),u=o([...l,...Object.values(e.nodes)]).filter(s),c=new Map(u.map(e=>[e.name,e])),d={};for(let m of u){d[m.name]=d[m.name]||0;for(let e of m.children)s(e)||(d[e.name]=Number.POSITIVE_INFINITY),d[e.name]=(d[e.name]||0)+1}let h=Object.entries(d).filter(e=>{let[,t]=e;return 0===t}).map(e=>{let[t]=e;return t}),p=[...h];for(;h.length>0;){let e=h.pop(),t=c.get(e);for(let n of t.children.filter(s))0===--d[n.name]&&(p.push(n.name),h.push(n.name))}let f=function(e,t){let n=new Map(e.map(e=>[e.name,e])),a=t.map(e=>e.name),r=new Set(a);for(;a.length>0;){let e=a.pop(),t=n.get(e);for(let i of t.children)!n.has(i.name)||r.has(i.name)||(r.add(i.name),a.push(i.name))}return e.filter(e=>r.has(e.name))}(p.map(e=>c.get(e)),l);return function(e,t){let n=new Map(e.map((e,t)=>[e.name,t])),a=new Set(t.map(e=>e.name)),r=e=>a.has("string"==typeof e?e:e.name),i=new Set(e.map(e=>e.name)),s=e=>i.has("string"==typeof e?e:e.name);for(let o of e){for(let e of o.children.filter(s)){if(!n.has(e.name))throw new Rz("Child ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(o.name)>n.get(e.name))throw new Rz("Node ".concat(o.name," is scheduled to run after its child ").concat(e.name,"."))}if(!r(o))for(let e of o.inputs){if(!n.has(e.name))throw new Rz("Input ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(e.name)>n.get(o.name))throw new Rz("Node ".concat(o.name," is scheduled to run before its input ").concat(e.name,"."))}}}(f,l),f}var Rz=class extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}};var Dz=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Mz=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Oz=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Pz(e){return Dz.has(e.op)}function Lz(e){return Mz.has(e.op)}function zz(e){return Oz.has(e.op)}var Bz=class e{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){let t=Object.keys(e).map(t=>e[t].map(e=>e.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{let t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(n=>{this._functionExecutorMap[n]=new e(t.functions[n],this)})}getCompilationKey(e,t){let n=e.map(e=>e.name).sort(),a=t.map(e=>e.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){let n=Az(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:r,syncInputs:i}=n;if(null!=r)throw new Error("This execution contains the node '".concat(r.name,"', which has the dynamic op '").concat(r.op,"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [").concat(i,"]"));if(a.length>0){let n=t.map(e=>e.name),r=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs [").concat(r,"]. Missing the following inputs: [").concat(a,"]"))}let s=Fz(this.graph,n),o=function(e){let t=new Map(e.map((e,t)=>[e.name,t])),n=Number.MAX_SAFE_INTEGER,a=e.map((e,t)=>Pz(e)?n:t),r=e=>{let n=a[t.get(e.name)];return null==n?-1:n},i=e.map((e,t)=>e.children.map(r).reduce((e,t)=>Math.max(e,t),a[t])),s=new Map;for(let o=0;o<e.length;++o){let t=i[o];if(t===n)continue;let a=e[o],r=e[t];s.has(r.name)||s.set(r.name,[]),s.get(r.name).push(a)}return s}(s);return{orderedNodes:s,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(null==e)return null;let t=e.clone();return Gg(t),t}cloneTensorList(e){return e?e.map(e=>this.cloneAndKeepTensor(e)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]}))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);let n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);let a=n.map(e=>this.graph.nodes[fL(e)[0]]),r=t.map(e=>fL(e)[0]),i=new Set(r),s=r.map(e=>this.graph.nodes[e]);0===s.length&&(s=this._outputs);let o=this.getCompilationKey(a,s),l=this.compiledMap.get(o);null==l&&(l=this.compile(e,s),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=Td().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let u={},c={};return Ug(()=>{let n=new _z(this.weightMap,u,c,this.functionExecutorMap,this.parseNodeNameCache),a=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(t=>{let[r,i]=fL(t,n),s=[];s[i]=e[t],a[r]=s,this.keepIntermediateTensors&&(this.clonedTensorsMap[r]=this.cloneTensorList(s))});let r=this.getFrozenTensorIds(a),{orderedNodes:s,nodeLiveUntilMap:o}=l;for(let e of s){if(a[e.name])continue;let t=Ez(e,a,n,this._resourceManager);if(um.isPromise(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. Please use model.executeAsync() instead."));a[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,a,n,r,i,o.get(e.name))}return null==this.parent&&n.dispose(r),t.map(e=>cL(e,a,n))})}getFrozenTensorIds(e){let t=[].concat.apply([],Object.keys(e).map(t=>e[t]).map(e=>e.map(e=>e.id)));return new Set(t)}checkTensorForDisposal(e,t,n,a,r,i,s){if(!Pz(t)&&!i.has(e)){for(let a of n[e])null!=a&&(s[a.id]=(s[a.id]||0)+t.children.length);for(let e of t.inputs){if(Pz(e))continue;let t=dL(e.name,n,a);if(null!=t)for(let e of t){if(!e||e.kept||r.has(e.id))continue;let t=s[e.id];1===t?(e.dispose(),delete s[e.id]):null!=t&&s[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,a,r,i){function s(e){return Pz(e)||r.has(e.name)}if(!Pz(e)&&null!=i)for(let o of i){if(s(o))continue;let e=dL(o.name,t,n);for(let t of e)!t||t.kept||a.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(let t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Td().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let i=new _z(this.weightMap,a,r,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let s=await this.executeWithControlFlow(e,i,t,n),o=t.map(e=>cL(e,s,i)),l=o.map(e=>e.id),u=Object.keys(e).map(t=>e[t].id),c=new Set([...l,...u,...this.weightIds]);return Object.values(s).forEach(e=>{e.forEach(e=>{e&&!e.isDisposed&&!c.has(e.id)&&e.dispose()})}),null==this.parent&&i.dispose(c),o}async executeFunctionAsync(e,t,n){let a=e.reduce((e,t,n)=>(e[this.inputs[n].name]=t,e),{});return this._executeAsync(a,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,a){let r=Object.keys(e),i=r.map(e=>this.graph.nodes[fL(e)[0]]),s=n.map(e=>fL(e)[0]),o=new Set(s),l=s.map(e=>this.graph.nodes[e]);0===l.length&&(l=this._outputs);let{usedNodes:u,missingInputs:c,dynamicNode:d,syncInputs:h}=Az(e,l,this.weightMap,this._initNodes),p=[...i,...this.graph.weights,...this._initNodes||[]].map(e=>({node:e,contexts:t.currentContext})),f=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{let[n,a]=fL(t),r=[];r[a]=e[t],f[n]=r});let m={},g=this.getFrozenTensorIds(f),y={};for(;p.length>0;){let e=this.processStack(i,p,t,f,y,g,o,m,u);await Promise.all(e)}null==d&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=l.filter(e=>!Pz(e)&&!cL(e.name,f,t)).map(e=>e.name);if(b.length>0){let e="";throw null!=d&&(e="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(b,"] from the provided inputs [").concat(r,"]. Consider providing the following inputs: [").concat(c,"]. ").concat(e))}return f}processStack(e,t,n,a,r,i,s,o,l){let u=[];for(;t.length>0;){let e=t.pop();n.currentContext=e.contexts;let c="";if("Enter"===e.node.op&&uL("isConstant",e.node,a,n)&&([c]=hL(e.node.name,n)),null==a[e.node.name]){let d=Ez(e.node,a,n,this._resourceManager);c||([c]=hL(e.node.name,n));let h=n.currentContext;um.isPromise(d)?u.push(d.then(u=>(a[c]=u,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(u)),n.currentContext=h,this.checkTensorForDisposal(c,e.node,a,n,i,s,o),this.processChildNodes(e.node,t,n,a,r,l),u))):(a[c]=d,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(d)),this.checkTensorForDisposal(c,e.node,a,n,i,s,o),this.processChildNodes(e.node,t,n,a,r,l))}else this.processChildNodes(e.node,t,n,a,r,l)}return u}processChildNodes(e,t,n,a,r,i){e.children.forEach(e=>{let[s]=hL(e.name,n);r[s]||!i.has(e.name)||("Merge"===e.op?e.inputNames.some(e=>!!cL(e,a,n))&&(r[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every(e=>!!cL(e,a,n))&&(r[s]=!0,t.push({contexts:n.currentContext,node:e})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(e=>e.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{let n=e[t],[a]=fL(t),r=this.graph.nodes[a];if(r.attrParams.shape&&r.attrParams.shape.value){let e=r.attrParams.shape.value,t=e.length===n.shape.length&&n.shape.every((t,n)=>-1===e[n]||e[n]===t);um.assert(t,()=>"The shape of dict['".concat(r.name,"'] provided in model.execute(dict) must be [").concat(e,"], but was [").concat(n.shape,"]"))}r.attrParams.dtype&&r.attrParams.dtype.value&&um.assert(n.dtype===r.attrParams.dtype.value,()=>"The dtype of dict['".concat(r.name,"'] provided in model.execute(dict) must be ").concat(r.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;let a={};for(let r in e){let i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[r];null!=i?a[i.name]=e[r]:a[r]=e[r]}return a}checkInputs(e){let t=Object.keys(e).filter(e=>{let[t]=fL(e);return null==this.graph.nodes[t]});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(e=>{var t,n;let a=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=a?a.name:e},{})}checkOutputs(e){e.forEach(e=>{let[t]=fL(e);if(!this.graph.nodes[t])throw new Error("The output '".concat(e,"' is not found in the graph"))})}},Wz=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},Vz="?tfjs-format=file",Uz="model.json",jz=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CI;this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,null==t&&(this.loadOptions={}),this.resourceManager=new Wz}findIOHandler(){let e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for URL '").concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return um.isPromise(e)?e.then(e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e)):this.loadSync(e)}loadSync(e){let t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");let t=await oy(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;let n=this.artifacts.modelTopology,a=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){let e=this.artifacts.userDefinedMetadata;null!=e.signature&&(a=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=a,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new Bz(tz.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){let t=tz.Instance.transformGraph(e.modelInitializer);this.initializer=new Bz(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"==typeof e){let t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new Error("Found more than one (".concat(t.length,") save handlers for URL '").concat(e,"'"));e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t={};return(e instanceof Gm?[e]:e).forEach((e,n)=>t[this.structuredOutputKeys[n]]=e),t}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof Gm)&&!Array.isArray(e)){let n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(let t in n){let a=n[t];null!=a.resourceId&&(e[t]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let a=0;return this.inputNodes.reduce((t,n)=>{var r,i,s;let o=null===(s=null===(i=null===(r=this.signature)||void 0===r?void 0:r.inputs)||void 0===i?void 0:i[n])||void 0===s?void 0:s.resourceId;return t[n]=null!=o?this.resourceIdToCapturedInput[o]:e[a++],t},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let a=0;a<n.length;a++){let r=t[n[a]];this.resourceIdToCapturedInput[r.resourceId]=e[a]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&jg(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function Gz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CI;if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof e&&(e=function(e){return e.endsWith("/")||(e+="/"),"".concat(e).concat(Uz).concat(Vz)}(e));let a=new jz(e,t,n);return await a.load(),a}function Hz(e){if(null==e)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[n,a]=e;if(!n)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");let r=CI.getWeightSpecs(n.weightsManifest),i=CI.getModelArtifactsForJSONSync(n,r,a);t=CI.fromMemorySync(i)}else if("load"in e)t=e;else{if(!("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e))throw new Error("Unknown model format");t=CI.fromMemorySync(e)}let n=new jz(t);return n.load(),n}var qz="4.22.0",Kz={};ac(Kz,{CSVDataset:()=>BB,Dataset:()=>TB,FileDataSource:()=>ZB,TextLineDataset:()=>RB,URLDataSource:()=>$B,array:()=>EB,csv:()=>eW,func:()=>tW,generator:()=>nW,microphone:()=>rW,version_data:()=>iW,webcam:()=>aW,zip:()=>_B});var Xz=rc(gc()),Yz=rc(gc());function Qz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(a.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let r=t(e);if(r.recurse&&null!==r.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse){if(tB(e)){let r=Array.isArray(e)?[]:{};a.add(e);for(let i in e){let s=Qz(e[i],t,n,a);r[i]=s}return a.delete(e),e.__proto__&&(r.__proto__=e.__proto__),r}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,r.value),r.value}function Jz(e){return Zz(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:$z)}function Zz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,a=e[0];if(n.has(a))throw new Error("Circular references are not supported.");let r=t(e);if(r.recurse&&null!==r.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse){if(tB(a)){let r=Array.isArray(a)?[]:{};n.add(a);for(let i in a){let a=Zz(e.map(e=>e[i]),t,n);r[i]=a}return n.delete(a),r}throw new Error("Can't recurse into non-iterable type: ".concat(a))}return r.value}function $z(e){return null===e?null:tB(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function eB(e,t){let n=new Map;Qz(e,t,n);for(let a of Array.from(n.keys())){let e=n.get(a);if(um.isPromise(e)){let t=await e;n.set(a,t)}}return Qz(e,t,n)}function tB(e){let t=!1;if(Td().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=yc();t=e instanceof n}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof Gm)&&!(e instanceof Promise)&&!t)}function nB(e){return function(e,t){return Qz(e,t)}(e,aB)}function aB(e){return e instanceof Gm?{value:e.clone(),recurse:!1}:tB(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var rB=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},iB=class e extends rB{constructor(){super(e.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=2*this.capacity,t=new Array(e),n=this.length();for(let a=0;a<n;a++)t[a]=this.get(this.wrap(this.begin+a));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};function sB(e){return new cB(e)}function oB(e){return new dB(e)}iB.INITIAL_CAPACITY=32;var lB,uB=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new bB(this,e)}filter(e){return new gB(this,e)}map(e){return new yB(this,e)}mapAsync(e){return new vB(this,e)}serialMapAsync(e){return new vB(this,e).serial()}flatmap(e){return new wB(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e){return new mB(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$z;return this.rowMajorBatch(e,t).map(e=>Jz(e,n))}concatenate(e,t){return new kB(sB([this,e]),t)}take(e){return e<0||null==e?this:new fB(this,e)}skip(e){return e<0||null==e?this:new pB(this,e)}prefetch(e){return new IB(this,e)}shuffle(e,t){return new NB(this,e,t)}serial(){return new hB(this)}},cB=class extends uB{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:nB(e),done:!1}}},dB=class extends uB{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(Xm){throw Xm.message="Error thrown while iterating through a dataset: ".concat(Xm.message),Xm}}},hB=class extends uB{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},pB=class extends uB{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;jg(e.value)}return this.upstream.next()}},fB=class extends uB{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},mB=class extends uB{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},gB=class extends uB{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;jg(e.value)}}},yB=class extends uB{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=$m.getTensorsInContainer(e.value),n=this.transform(e.value),a=$m.getTensorsInContainer(n);for(let r of t)$m.isTensorInList(r,a)||r.dispose();return{value:n,done:!1}}},bB=class extends uB{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(Xm){if(!this.handler(Xm))return{value:null,done:!0}}}},vB=class extends uB{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=$m.getTensorsInContainer(e.value),n=await this.transform(e.value),a=$m.getTensorsInContainer(n);for(let r of t)$m.isTensorInList(r,a)||r.dispose();return{value:n,done:!1}}},xB=class extends uB{constructor(){super(),this.outputQueue=new iB,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},wB=class extends xB{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=$m.getTensorsInContainer(e.value),n=this.transform(e.value),a=$m.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let r of t)$m.isTensorInList(r,a)||r.dispose();return!0}},kB=class extends uB{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){let e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}};!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(lB||(lB={}));var SB=class extends uB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lB.FAIL;super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;let a=await eB(this.iterators,function(e){return e instanceof uB?{value:e.next().then(e=>(t++,e.done&&n++,e.value)),recurse:!1}:{value:null,recurse:!0}});if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case lB.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element ".concat(this.count,"."));case lB.SHORTEST:return{value:null,done:!0};case lB.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},IB=class extends uB{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new rB(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},NB=class extends IB{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=Yz.alea(n||um.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}},TB=class{constructor(){this.size=null}batch(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;return um.assert(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e)),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),CB(async()=>(await a.iterator()).columnMajorBatch(e,n,AB),t)}concatenate(e){let t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,CB(async()=>(await n.iterator()).concatenate(await e.iterator()),t)}filter(e){let t,n=this;return t=this.size===1/0?1/0:null,CB(async()=>(await n.iterator()).filter(t=>Ug(()=>e(t))),t)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return CB(async()=>(await t.iterator()).map(t=>Ug(()=>e(t))),this.size)}mapAsync(e){let t=this;return CB(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return CB(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,CB(async()=>function(e,t){return new kB(e,t)}(oB(async()=>({value:await n.iterator(),done:!1})).take(e)),t)}skip(e){let t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,CB(async()=>(await n.iterator()).skip(e),t)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size (".concat(this.size," elements)"));let a=this,r=Xz.alea(t||um.now().toString());return CB(async()=>{let t=r.int32();return n&&(t+=r.int32()),(await a.iterator()).shuffle(e,t.toString())},this.size)}take(e){let t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,CB(async()=>(await n.iterator()).take(e),t)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};function CB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends TB{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function EB(e){return CB(async()=>sB(e),e.length)}function _B(e){if(!tB(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=null==t?e[n].size:Math.min(t,e[n].size);return CB(async()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lB.FAIL;return new SB(e,t)}(await eB(e,e=>{if(e instanceof TB)return{value:e.iterator(),recurse:!1};if(tB(e))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}),lB.SHORTEST),t)}function AB(e){if(null===e)return null;return function(e){return null==e||function(e){return null===e||"object"!=typeof e&&"function"!=typeof e}(e)||Array.isArray(e)||"object"==typeof e&&e instanceof Gm||um.isTypedArray(e)}(e[0])?{value:FB(e),recurse:!1}:{value:null,recurse:!0}}function FB(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Gm?gk(e):Fg(e)}TB.MAX_BUFFER_SIZE=1e4;var RB=class extends TB{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},DB='"',MB=Symbol("out"),OB=Symbol("field"),PB=Symbol("quote"),LB=Symbol("quoteafterquote"),zB=Symbol("quoteinquote"),BB=class extends TB{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&um.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((e,t)=>(e[t]=e[t]+1||1,e),{}),n=Object.keys(t).filter(e=>t[e]>1);if(um.assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs)for(let a of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(a))throw new Error('The key "'+a+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new RB(e),t||(t={}),this.hasHeader=!1!==t.hasHeader,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(um.assert(null==t.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(e=>this.makeDataElement(e))}makeDataElement(e){let t=this.parseRow(e),n={},a={};for(let r=0;r<this.fullColumnNames.length;r++){let i=this.fullColumnNames[r],s=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||s){let o=t[r],l=null;if(""===o)if(s&&void 0!==s.default)l=s.default;else{if(s&&(s.required||s.isLabel))throw new Error("Required column ".concat(i," is empty in this line: ").concat(e));l=void 0}else{let e=Number(o);if(isNaN(e))l=s&&"bool"===s.dtype?this.getBoolean(o):o;else if(s&&s.dtype)switch(s.dtype){case"float32":default:l=e;break;case"int32":l=Math.floor(e);break;case"bool":l=this.getBoolean(o)}else l=e}s&&s.isLabel?a[i]=l:n[i]=l}}return 0===Object.keys(a).length?n:{xs:n,ys:a}}getBoolean(e){return"1"===e||"true"===e.toLowerCase()?1:0}parseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],a=0,r=e.length,i=MB;for(let s=0;s<r;s++)switch(i){case MB:switch(e.charAt(s)){case DB:a=s+1,i=PB;break;case this.delimiter:if(a=s+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),i=MB;break;default:i=OB,a=s}break;case OB:if(e.charAt(s)===this.delimiter)n.push(e.substring(a,s)),i=MB,a=s+1;break;case PB:if(e.charAt(s)===DB)i=LB;break;case LB:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(a,s-1)),i=MB,a=s+1;break;case DB:i=PB;break;default:i=zB}break;case zB:if(e.charAt(s)===DB)i=PB}if(i===LB?n.push(e.substring(a,r-1)):n.push(e.substring(a)),t&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n}},WB=class e extends uB{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ".concat(this.fftSize));if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=!1!==e.includeSpectrogram,this.includeWaveform=!0===e.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Td().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let n=new e(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: ".concat(n.message))}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: ".concat(this.sampleRateHz,"; Actual: ").concat(this.audioContext.sampleRate))}else this.sampleRateHz=this.audioContext.sampleRate;let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t,n=await this.getAudioData();if(this.includeSpectrogram){let t=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let e=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise(a=>{let r=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&a({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(r),a({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((e,a)=>n.set(e,a*t)),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(um.sizeFromShape(t));return n.set(e,n.length-e.length),Fg(n,t)}},VB=class e extends uB{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=xk([0],"int32"),this.webcamConfig.centerCrop){let e=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,t=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-e)/2,a=(1-t)/2,r=n+e,i=t+a;this.cropBox=wk([a,n,i,r],[1,4])}else this.cropBox=wk([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Td().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}let a=new e(t,n);return await a.start(),a}async start(){this.webcamConfig.facingMode&&um.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>"Invalid webcam facing mode: ".concat(this.webcamConfig.facingMode,". Please provide 'user' or 'environment'"));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message="Error thrown while initializing video stream: ".concat(e.message),e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=QI.fromPixels(this.webcamVideoElement)}catch(ree){throw new Error("Error thrown converting video to pixels: ".concat(JSON.stringify(ree)))}if(!this.resize)return{value:e,done:!1};try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(ree){throw new Error("Error thrown cropping the video: ".concat(ree.message))}finally{e.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(e){return Ug(()=>{let t,n=ex($y(e,"float32"),0);t=sI.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let a=t.shape;return Mb(t,a.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},UB=class{},jB=class extends uB{split(e){return new GB(this,e)}},GB=class extends jB{constructor(e,t){super(),this.upstream=e,this.impl=new HB(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},HB=class extends xB{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){let e=await this.upstream.next();if(e.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},qB=class extends uB{decodeUTF8(){return new KB(this)}},KB=class extends jB{constructor(e){super(),this.upstream=e,this.impl=new XB(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},XB=class extends xB{constructor(e){if(super(),this.upstream=e,Td().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:e}=yc();this.decoder=new e("utf8")}}summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){let e,t,n=await this.upstream.next();return!n.done&&(e=n.value,t=Td().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(t),!0)}},YB=class extends qB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.file=e,this.options=t,um.assert(e instanceof Uint8Array||!!Td().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576}summary(){return"FileChunks ".concat(this.file)}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let a=new FileReader;a.onload=n=>{let r=a.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(r)},a.onabort=e=>t(new Error("Aborted")),a.onerror=e=>t(new Error(e.type));let r=this.file.slice(this.offset,n);a.readAsArrayBuffer(r)}this.offset=n}),done:!1}}};var QB=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function JB(e){return"string"==typeof e&&"file://"===e.slice(0,7)}var ZB=class extends UB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.input=e,this.options=t}async iterator(){if(JB(this.input)&&Td().get("IS_NODE")){let e=bc();this.input=e.readFileSync(this.input.slice(7))}return new YB(this.input,this.options)}},$B=class extends UB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.url=e,this.fileOptions=t}async iterator(){return JB(this.url)?new ZB(this.url,this.fileOptions).iterator():async function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;"string"==typeof e?t=e:(t=e.url,n=QB(e));let i=await(r||um.fetch)(t,n);if(i.ok){let e=new Uint8Array(await i.arrayBuffer());return new YB(e,a)}throw new Error(i.statusText)}(this.url,this.fileOptions)}};function eW(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new BB(new $B(e),t)}function tW(e){let t=oB(e);return CB(async()=>t)}function nW(e){return CB(async()=>{let t=await e();return oB(()=>t.next())})}async function aW(e,t){return VB.create(e,t)}async function rW(e){return WB.create(e)}var iW="4.22.0";function sW(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&um.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}var oW=WT.whereImpl,lW=class e extends Cc{nextDataId(){return e.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Tc(this,Bg())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Td().get("IS_NODE")&&MN.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&um.isString(n[0])){let r=n.map(e=>um.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,a,r){this.data.set(e,{values:t,dtype:a,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){let e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return MN.mergeRealAndImagArrays(e,t)}return um.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>um.decodeString(e));return Zy(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Zy(e.shape,e.dtype,t)}makeOutput(e,t,n){return Bg().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=um.now();return e(),{kernelMs:um.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){sW([e],"where");let t=this.readSync(e.dataId);return oW(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};lW.nextDataId=0;var uW={};function cW(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}ac(uW,{addImpl:()=>NW,bincountImpl:()=>_W,bincountReduceImpl:()=>AW,bitwiseAndImpl:()=>FW,castImpl:()=>xW,ceilImpl:()=>LW,concatImpl:()=>WW,equalImpl:()=>VW,expImpl:()=>GW,expm1Impl:()=>KW,floorDivImpl:()=>$W,floorImpl:()=>QW,gatherNdImpl:()=>nV,gatherV2Impl:()=>aV,greaterEqualImpl:()=>oV,greaterImpl:()=>rV,lessEqualImpl:()=>pV,lessImpl:()=>cV,linSpaceImpl:()=>gV,logImpl:()=>yV,maxImpl:()=>xV,maximumImpl:()=>wV,minimumImpl:()=>IV,multiplyImpl:()=>CV,negImpl:()=>FV,notEqualImpl:()=>DV,prodImpl:()=>BV,raggedGatherImpl:()=>GV,raggedRangeImpl:()=>qV,raggedTensorToTensorImpl:()=>JV,rangeImpl:()=>ZV,rsqrtImpl:()=>$V,scatterImpl:()=>nU,sigmoidImpl:()=>aU,simpleAbsImpl:()=>cW,sliceImpl:()=>sU,sparseFillEmptyRowsImpl:()=>uU,sparseReshapeImpl:()=>cU,sparseSegmentReductionImpl:()=>dU,sqrtImpl:()=>hU,squaredDifferenceImpl:()=>mU,staticRegexReplaceImpl:()=>bU,stridedSliceImpl:()=>wU,stringNGramsImpl:()=>SU,stringSplitImpl:()=>NU,stringToHashBucketFastImpl:()=>TU,subImpl:()=>CU,tileImpl:()=>FU,topKImpl:()=>MU,transposeImpl:()=>PV,uniqueImpl:()=>OU});var dW={kernelName:Fd,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;sW(t,"abs");let a=new Float32Array(um.sizeFromShape(t.shape));return a=cW(n.data.get(t.dataId).values),n.makeOutput(a,t.shape,t.dtype)}};function hW(e){return(t,n,a,r,i)=>{let s=MN.assertAndGetBroadcastShape(t,n),o=s.length,l=um.computeStrides(s),u=um.sizeFromShape(s),c=um.getTypedArrayFromDType(i,u),d=t.length,h=n.length,p=um.computeStrides(t),f=um.computeStrides(n),m=MN.getBroadcastDims(t,s),g=MN.getBroadcastDims(n,s);if(m.length+g.length===0)for(let y=0;y<c.length;++y)c[y]=e(a[y%a.length],r[y%r.length]);else for(let y=0;y<c.length;++y){let t=um.indexToLoc(y,o,l),n=t.slice(-d);m.forEach(e=>n[e]=0);let i=um.locToIndex(n,d,p),s=t.slice(-h);g.forEach(e=>s[e]=0);let u=um.locToIndex(s,h,f);c[y]=e(a[i],r[u])}return[c,s]}}function pW(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,o=n.makeTensorInfo(a.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(a.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",s)},o}var fW={kernelName:rh,backendName:"cpu",kernelFunc:pW};function mW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return pW({inputs:{real:mW(e,t,"float32"),imag:mW(e,t,"float32")},backend:e})}let a=um.makeZerosTypedArray(um.sizeFromShape(t),n);return e.makeTensorInfo(t,n,a)}function gW(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}var yW={kernelName:Kh,backendName:"cpu",kernelFunc:gW};function bW(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}var vW={kernelName:Hp,backendName:"cpu",kernelFunc:bW};function xW(e,t,n,a){if("int32"===a){return[t,"int32",Int32Array.from(e)]}if("bool"===a){let a=um.toTypedArray([0],n),[r,i]=hW((e,t)=>e!==t?1:0)(t,[],e,a,"bool");return[i,"bool",r]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(a))}function wW(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dtype:i}=a;if("complex64"===i){if("complex64"===r.dtype)return gW({inputs:{x:r},backend:n});let e=mW(n,r.shape,r.dtype),t=wW({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),a=pW({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),a}if("complex64"===r.dtype){let e=bW({inputs:{input:r},backend:n}),t=wW({inputs:{x:e},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(e),t}if(!um.hasEncodingLoss(r.dtype,i)){let e=gW({inputs:{x:r},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:i}}let s=n.data.get(r.dataId).values,[o,l,u]=xW(s,r.shape,r.dtype,i);return n.makeTensorInfo(o,l,u)}var kW={kernelName:th,backendName:"cpu",kernelFunc:wW};function SW(e,t,n,a){return null==n?n=>{let{inputs:r,backend:i}=n,{a:s,b:o}=r,l=i;sW([s,o],e);let u=l.data.get(s.dataId).values,c=l.data.get(o.dataId).values,d="string"===s.dtype?MN.fromUint8ToStringArray(u):u,h="string"===s.dtype?MN.fromUint8ToStringArray(c):c,p=a||s.dtype,[f,m]=t(s.shape,o.shape,d,h,p);return l.makeTensorInfo(m,p,f)}:e=>{let{inputs:r,backend:i}=e,{a:s,b:o}=r,l=i;if("complex64"===s.dtype||"complex64"===o.dtype){let e=wW({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),a=t.complexTensorInfos.real,r=t.complexTensorInfos.imag,i=l.data.get(a.dataId).values,u=l.data.get(r.dataId).values,c=wW({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(c.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=l.data.get(h.dataId).values,m=l.data.get(p.dataId).values,[g,y,b]=n(s.shape,o.shape,i,u,f,m),v=l.makeTensorInfo(b,"float32",g),x=l.makeTensorInfo(b,"float32",y),w=pW({inputs:{real:v,imag:x},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(x),w}{let e=l.data.get(s.dataId).values,n=l.data.get(o.dataId).values,r=a||s.dtype,[i,u]=t(s.shape,o.shape,e,n,r);return l.makeTensorInfo(u,r,i)}}}function IW(e){return(t,n,a,r,i,s)=>{let o=MN.assertAndGetBroadcastShape(t,n),l=um.sizeFromShape(o),u=o.length,c=um.computeStrides(o),d=um.getTypedArrayFromDType("float32",l),h=um.getTypedArrayFromDType("float32",l),p=MN.getBroadcastDims(t,o),f=MN.getBroadcastDims(n,o),m=MN.mergeRealAndImagArrays(a,r),g=MN.mergeRealAndImagArrays(i,s),y=t.length,b=um.computeStrides(t),v=n.length,x=um.computeStrides(n);if(p.length+f.length===0)for(let w=0;w<d.length;w++){let t=w%m.length,n=w%g.length,a=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);d[w]=a.real,h[w]=a.imag}else for(let w=0;w<d.length;w++){let t=um.indexToLoc(w,u,c),n=t.slice(-y);p.forEach(e=>n[e]=0);let a=um.locToIndex(n,y,b),r=t.slice(-v);f.forEach(e=>r[e]=0);let i=um.locToIndex(r,v,x),s=e(m[2*a],m[2*a+1],g[2*i],g[2*i+1]);d[w]=s.real,h[w]=s.imag}return[d,h,o]}}var NW=hW((e,t)=>e+t),TW=IW((e,t,n,a)=>({real:e+n,imag:t+a})),CW=SW(Md,NW,TW),EW={kernelName:Md,backendName:"cpu",kernelFunc:CW};function _W(e,t,n,a,r){let i=um.sizeFromShape(a),s=um.makeZerosTypedArray(r,n);for(let o=0;o<e.length;o++){let n=e[o];if(n<0)throw new Error("Input x must be non-negative!");n>=r||(s[n]+=i>0?t[o]:1)}return s}function AW(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.shape[0],i=e.shape[1],s=Zy([r,n],t.dtype);for(let o=0;o<r;o++)for(let r=0;r<i;r++){let i=e.get(o,r);if(i<0)throw new Error("Input x must be non-negative!");i>=n||(a?s.set(1,o,i):t.size>0?s.set(s.get(o,i)+t.get(o,r),o,i):s.set(s.get(o,i)+1,o,i))}return s}var FW=hW((e,t)=>e&t),RW=SW(Zd,FW),DW={kernelName:Zd,backendName:"cpu",kernelFunc:RW};function MW(e){return(t,n,a)=>{let r=um.getArrayFromDType(n,t.length);for(let i=0;i<t.length;++i)r[i]=e(t[i],a);return r}}function OW(e,t,n){return PW(e,MW(t),n)}function PW(e,t,n){return a=>{let{inputs:r,attrs:i,backend:s}=a,{x:o}=r;sW(o,e);let l,u=s,c=u.data.get(o.dataId).values;if("string"===o.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");l=MN.fromUint8ToStringArray(c)}else l=c;let d=n||o.dtype,h=t(l,d,i);return u.makeTensorInfo(o.shape,d,h)}}var LW=MW(e=>Math.ceil(e)),zW=PW(nh,LW),BW={kernelName:nh,backendName:"cpu",kernelFunc:zW};function WW(e,t,n,a){let r=um.getArrayFromDType(n,um.sizeFromShape(t));if(a&&"string"!==n){let t=0;e.forEach(e=>{let n=um.sizeFromShape(e.shape);r.set(e.vals,t),t+=n})}else{let a=0;e.forEach(e=>{let i="string"===n?MN.fromUint8ToStringArray(e.vals):e.vals,s=0;for(let n=0;n<e.shape[0];++n){let o=n*t[1]+a;for(let t=0;t<e.shape[1];++t)r[o+t]=i[s++]}a+=e.shape[1]})}return r}var VW=hW((e,t)=>e===t?1:0),UW=SW(Dh,VW,null,"bool"),jW={kernelName:Dh,backendName:"cpu",kernelFunc:UW},GW=MW(e=>Math.exp(e)),HW=PW(Mh,GW,"float32"),qW={kernelName:Mh,backendName:"cpu",kernelFunc:HW},KW=MW(e=>Math.expm1(e)),XW=PW(Ph,KW),YW={kernelName:Ph,backendName:"cpu",kernelFunc:XW},QW=MW(e=>Math.floor(e)),JW=PW(Wh,QW),ZW={kernelName:Wh,backendName:"cpu",kernelFunc:JW},$W=hW((e,t)=>Math.floor(e/t)),eV=SW(Vh,$W,null,"int32"),tV={kernelName:Vh,backendName:"cpu",kernelFunc:eV};function nV(e,t,n,a,r,i,s,o,l){let u=Zy([a,i],n);for(let c=0;c<a;c++){let n=[],a=0;for(let t=0;t<r;t++){let i=e[c*r+t];a+=i*s[t],n.push(i)}if(a<0||a>=l/i)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(o));for(let e=0;e<i;e++)u.values[c*i+e]=t.get(...t.indexToLoc(a*i+e))}return u}function aV(e,t,n){let a=Zy(n,e.dtype);for(let r=0;r<a.size;++r){let n=a.indexToLoc(r).slice(),i=n[0],s=n[2],o=t.locToIndex([i,s]);n[2]=t.values[o];let l=e.locToIndex(n);0<=l&&l<e.values.length&&(a.values[r]=e.values[l])}return a}var rV=hW((e,t)=>e>t?1:0),iV=SW(Hh,rV,null,"bool"),sV={kernelName:Hh,backendName:"cpu",kernelFunc:iV},oV=hW((e,t)=>e>=t?1:0),lV=SW(qh,oV,null,"bool"),uV={kernelName:qh,backendName:"cpu",kernelFunc:lV},cV=hW((e,t)=>e<t?1:0),dV=SW(ep,cV,null,"bool"),hV={kernelName:ep,backendName:"cpu",kernelFunc:dV},pV=hW((e,t)=>e<=t?1:0),fV=SW(tp,pV,null,"bool"),mV={kernelName:tp,backendName:"cpu",kernelFunc:fV};function gV(e,t,n){let a=(t-e)/(n-1),r=um.makeZerosTypedArray(n,"float32");r[0]=e;for(let i=1;i<r.length;i++)r[i]=r[i-1]+a;return r}var yV=MW(e=>Math.log(e)),bV=PW(ap,yV),vV={kernelName:ap,backendName:"cpu",kernelFunc:bV};function xV(e,t,n,a){let r=um.getTypedArrayFromDType(a,um.sizeFromShape(n));for(let i=0;i<r.length;++i){let n=i*t,a=e[n];for(let r=0;r<t;++r){let t=e[n+r];(Number.isNaN(t)||t>a)&&(a=t)}r[i]=a}return r}var wV=hW((e,t)=>Math.max(e,t)),kV=SW(mp,wV),SV={kernelName:mp,backendName:"cpu",kernelFunc:kV},IV=hW((e,t)=>Math.min(e,t)),NV=SW(Sp,IV),TV={kernelName:Sp,backendName:"cpu",kernelFunc:NV},CV=hW((e,t)=>e*t),EV=IW((e,t,n,a)=>({real:e*n-t*a,imag:e*a+t*n})),_V=SW(Cp,CV,EV),AV={kernelName:Cp,backendName:"cpu",kernelFunc:_V};function FV(e,t,n){let a=um.createScalarValue(-1,n);return CV([],t,a,e,n)}var RV={kernelName:Ep,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t;sW(a,"neg");let r=n.data.get(a.dataId).values,[i,s]=FV(r,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,i)}},DV=hW((e,t)=>e!==t?1:0),MV=SW(_p,DV,null,"bool"),OV={kernelName:_p,backendName:"cpu",kernelFunc:MV};function PV(e,t,n,a,r){let i=t.length,s=um.sizeFromShape(t),o=um.computeStrides(t),l=um.computeStrides(r),u=um.getTypedArrayFromDType(n,um.sizeFromShape(r));for(let c=0;c<s;++c){let t=um.indexToLoc(c,i,o),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[a[e]];u[um.locToIndex(n,i,l)]=e[c]}return u}function LV(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{perm:i}=n;sW(r,"transpose");let s=r.shape.length,o=new Array(s);for(let u=0;u<o.length;u++)o[u]=r.shape[i[u]];let l=PV(a.data.get(r.dataId).values,r.shape,r.dtype,i,o);return{dataId:a.write(l,o,r.dtype),shape:o,dtype:r.dtype}}var zV={kernelName:zf,backendName:"cpu",kernelFunc:LV};function BV(e,t,n,a){let[r,i]=MN.computeOutAndReduceShapes(e,a),s=tg(t,"int32"),o=um.makeZerosTypedArray(um.sizeFromShape(r),s),l=um.sizeFromShape(i);for(let u=0;u<o.length;++u){let e=u*l,t=1;for(let a=0;a<l;++a)t*=n[e+a];o[u]=t}return{outVals:o,outShape:r,outDtype:s}}var WV={kernelName:Wp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;sW(r,"prod");let o=r.shape.length,l=um.parseAxisParam(i,r.shape),u=MN.getAxesPermutation(l,o),c=l,d=r,h=[];null!=u&&(d=LV({inputs:{x:r},backend:n,attrs:{perm:u}}),h.push(d),c=MN.getInnerMostAxes(c.length,o));let p=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=BV(d.shape,d.dtype,p,c),y=m;return s&&(y=MN.expandShapeToKeepDim(m,l)),h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(y,g,f)}};function VV(e,t,n,a){let r=[],i=0,s=t.length-1+n.length,o=new Array(s).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){let a=e[n],r=n===e.length-1?t:e[n+1].length;if(0===a.length)throw new Error("Ragged splits may not be empty");if(a[0]<0)throw new Error("Ragged splits must be non-negative");if(a[a.length-1]>r)throw new Error("Ragged splits must not point past values");for(let e=1;e<a.length;++e)if(a[e-1]>a[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,a);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];let e=t[u+1];for(let t=1;t<l+1;++t)o[u].push(t*e)}for(let u=0;u<e.length;++u){let a=e[u],s=e[u]+1;for(let e=0;e<n.length;++e){let r=n[e],i=e+t.length-1;if(i>=0){let e=o[i],t=e[e.length-1]-r[a];for(let n=a;n<s;++n)o[i].push(r[n+1]+t)}a=r[a],s=r[s]}s!==a&&(r.push([a,s]),i+=s-a)}return{outSplits:o,valueSlices:r,numValues:i}}function UV(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let a=t;a<e.length;a++)n[t-1]*=e[a];return n}function jV(e,t,n,a,r){let i=t.slice();i[0]=r;let s=um.getArrayFromDType(n,um.sizeFromShape(i)),o=e.length;return function(e,t,n,a,r,i){let s=UV(t,2)[1],o=UV(i,2)[1],l=0;for(let u of n)for(let t=u[0];t<u[1];++t){for(let n=0;n<a;++n)r[l*o+n]=e[t*s+n];++l}}(e,t,a,0===o?0:o/t[0],s,i),[s,i]}function GV(e,t,n,a,r,i,s,o){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((e,a)=>{if(e<0||e>=n){let r=um.indexToLoc(a,t.length,um.computeStrides(t)).join(",");throw new Error("indices[".concat(r,"] = ").concat(e," is not in [0, ").concat(n,")"))}})}(i,s,t[0][0]-1),0===a.length)throw new Error("params.rank must be nonzero");let l=a[0],{outSplits:u,valueSlices:c,numValues:d}=VV(i,s,e,l),h=function(e){let t=[];for(let n=0;n<e.length;++n){let a=e[n].length,r=um.getArrayFromDType("int32",a);t.push(r),e[n].forEach((e,t)=>r[t]=e)}return t}(u),p=jV(n,a,r,c,d);return[h,p[0],p[1]]}var HV=2147483647;function qV(e,t,n,a,r,i,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let o=0===t.length,l=0===r.length,u=0===s.length,c=[];o||c.push(t[0]),l||c.push(r[0]),u||c.push(s[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");let d=0===c.length?1:c[0],h=um.getArrayFromDType("int32",d+1);h[0]=0;for(let g=0;g<d;++g){let t,n=o?e[0]:e[g],r=l?a[0]:a[g],s=u?i[0]:i[g];if(0===s)throw new Error("Requires delta != 0");if(s>0&&r<n||s<0&&r>n)t=0;else if(t=Math.ceil(Math.abs((r-n)/s)),t>HV)throw new Error("Requires ((limit - start) / delta) <= ".concat(HV));h[g+1]=h[g]+t}let p=h[d],f=um.getArrayFromDType(n,p),m=0;for(let g=0;g<d;++g){let t=h[g+1]-h[g],n=o?e[0]:e[g],a=u?i[0]:i[g];for(let e=0;e<t;++e)f[m++]=n,n+=a}return[h,f]}var KV=MN.RowPartitionType,XV=class e{constructor(e,t,n,a,r,i,s,o,l,u){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=MN.getRowPartitionTypesHelper(u),this.raggedRank=MN.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===KV.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===KV.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case KV.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case KV.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(KV[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let a=0;a<t-1;++a){let t=e[a+1]-e[a];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,a=e[0],r=0;for(let i=1;i<t;++i){let t=e[i];t!==a&&(a=t,r=Math.max(i-n,r),n=i)}return Math.max(t-n,r)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return QV(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;MN.validateDefaultValueShape(n,t);let a=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=MN.combineRaggedTensorToTensorShapes(this.raggedRank,a,t);r[0]<0&&(r[0]=e);for(let i=1;i<=this.raggedRank;++i)r[i]<0&&(r[i]=this.getMaxWidth(i));return r}calculateFirstParentOutputIndex(e,t,n){let a=Math.min(e,n),r=[],i=0;for(let s=0;s<a;++s,i+=t)r.push(i);for(let s=a;s<e;++s)r.push(-1);return um.assert(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,t,n,a){let r=e.length,i=[];for(let s=0;s<r-1;++s){let r=e[s+1]-e[s],o=Math.min(a,r),l=t[s];-1===l&&(o=0);for(let e=0;e<o;++e)i.push(l),l+=n;for(let e=0;e<r-o;++e)i.push(-1)}if(r>0&&i.length!==e[r-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,a){let r=e.length,i=[];if(0===r)return[];let s=0,o=e[0];if(o>=t.length)throw new Error("Got currentValueRowId=".concat(o,", which is not less than ").concat(t.length));let l=t[o];i.push(l);for(let u=1;u<r;++u){let r=e[u];if(r===o)l>=0&&(++s,s<a?l+=n:l=-1);else{if(s=0,o=r,r>=t.length)throw new Error("Got nextValueRowId=".concat(r," which is not less than ").concat(t.length));l=t[r]}i.push(l)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,a){let r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case KV.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,t,n,a);case KV.ROW_SPLITS:if(r.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(r.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(r,t,n,a);default:throw new Error("Unsupported partition type: ".concat(KV[i]))}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case KV.FIRST_DIM_SIZE:return e[0];case KV.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case KV.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(KV[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];let a=QV(t,!1),r=um.getArrayFromDType(this.valuesDType,um.sizeFromShape(a));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)i=this.calculateOutputIndex(e-1,i,n[e],t[e]);this.setOutput(this.raggedRank,i,r,a)}return[a,r]}setOutput(e,t,n,a){if(0===n.length)return;let r=this.values,i=n,s=a.slice();s=s.slice(e+1);let o=um.sizeFromShape(s),l=t.length,u=this.defaultValue;if(u.length!==o&&1!==u.length){let e=this.defaultValueShape;Ug(()=>{let t=Mb(u,e);u=Zb(t,s).dataSync()})}let c=0,d=0,h=0;for(let p=0;p<=l;++p){let e=p<l?t[p]:-1;if(e!==h){if(d<h){let e=r.subarray(c*o);YV(i.subarray(d*o),e,(h-d)*o)}if(p>=l){let t=n.length;e=Math.floor(t/o)}if(e>h)if(1===this.defaultValue.length)i.subarray(h*o,e*o).fill(this.defaultValue[0]),h=e;else for(;e>h;){YV(i.slice(h*o),u,o),++h}e<0?(c=p+1,d=h):(c=p,d=h,h=d+1)}else++h}}};function YV(e,t,n){for(let a=0;a<n;a++)e[a]=t[a]}function QV(e,t){let n=[];for(let a of e){if(a<0){if(!t)throw new Error("Dimension ".concat(a," must be >= 0"));if(a<-1)throw new Error("Dimension ".concat(a," must be >= -1"));a=-1}n.push(a)}return n}function JV(e,t,n,a,r,i,s,o,l,u){return new XV(e,t,n,a,r,i,s,o,l,u).compute()}function ZV(e,t,n,a){if(e===t||e<t&&n<0||t<e&&n>1)return um.makeZerosTypedArray(0,a);let r=Math.abs(Math.ceil((t-e)/n)),i=um.makeZerosTypedArray(r,a);t<e&&1===n&&(n=-1),i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+n;return i}var $V=MW(e=>1/Math.sqrt(e)),eU=PW(nf,$V),tU={kernelName:nf,backendName:"cpu",kernelFunc:eU};function nU(e,t,n,a,r,i,s,o,l,u){let c=[a/r,r],d=e.values,h=t.values;if(0===a)return Zy(n,t.dtype);let p=l instanceof Vm?l:Zy(c,t.dtype);"string"==typeof l||"number"==typeof l?p.values.fill(l):"boolean"==typeof l&&p.values.fill(+l);for(let f=0;f<i;f++){let e=[],i=0;for(let t=0;t<s;t++){let n=d[f*s+t];e.push(n),i+=n*o[t]}if(i<0||i>=a/r)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<r;n++)u?p.values[i*r+n]+=h[f*r+n]:p.values[i*r+n]=0===t.rank?h[0]:h[f*r+n]}return p}var aU=MW(e=>1/(1+Math.exp(-e))),rU=OW(pf,e=>1/(1+Math.exp(-e))),iU={kernelName:pf,backendName:"cpu",kernelFunc:rU};function sU(e,t,n,a,r){let i=lN.isSliceContinous(a,t,n),s=um.sizeFromShape(n),o=um.computeStrides(a);if(i){let n=lN.computeFlatOffset(t,o);return"string"===r?e.slice(n,n+s):e.subarray(n,n+s)}let l=Zy(a,r,"string"===r?MN.fromUint8ToStringArray(e):e),u=Zy(n,r);for(let c=0;c<u.size;++c){let e=u.indexToLoc(c),n=e.map((e,n)=>e+t[n]);u.set(l.get(...n),...e)}return"string"===r?MN.fromStringArrayToUint8(u.values):u.values}function oU(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:i,size:s}=a;sW(r,"slice");let[o,l]=lN.parseSliceParams(r,i,s);lN.assertParamsValid(r,o,l);let u=sU(n.data.get(r.dataId).values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}var lU={kernelName:uf,backendName:"cpu",kernelFunc:oU};function uU(e,t,n,a,r,i,s){let o=t[0],l=i[0],u=new Array(l),c=new Array(o),d=t[1];if(0===l){if(0!==o)throw new Error(MN.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));return[um.getArrayFromDType(n,0),[0,d],um.getArrayFromDType(r,0),u,c]}let h=!0,p=0,f=new Array(l).fill(0);for(let g=0;g<o;++g){let t=e[g*d];if(t<0)throw new Error(MN.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,t));if(t>=l)throw new Error(MN.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,t,l));++f[t],h=h&&t>=p,p=t}let m=!0;for(let g=0;g<l;++g){let e=0===f[g];u[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&h){let t=e,n=a;for(let e=0;e<o;++e)c[e]=e;return[t,[o,d],n,u,c]}{let t=f[l-1],i=um.getArrayFromDType(n,t*d),h=um.getArrayFromDType(r,t),p=new Array(l).fill(0);for(let n=0;n<o;++n){let t=e[n*d],r=p[t],s=(0===t?0:f[t-1])+r;p[t]++;for(let a=0;a<d;++a)i[s*d+a]=e[n*d+a];h[s]=a[n],c[n]=s}for(let e=0;e<l;++e)if(0===p[e]){let t=0===e?0:f[e-1];i[t*d+0]=e;for(let e=1;e<d;++e)i[t*d+e]=0;h[t]=s}return[i,[t,d],h,u,c]}}function cU(e,t,n,a,r){let i=um.sizeFromShape(a),s=t[0],o=r.length,l=[],u=1,c=-1;for(let m=0;m<o;++m){let e=r[m];if(-1===e){if(-1!==c)throw new Error(MN.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,m));c=m,l.push(1)}else{if(e<0)throw new Error(MN.getSparseReshapeNegativeOutputDimErrorMessage(m,e));u*=e,l.push(e)}}if(-1!==c){if(u<=0)throw new Error(MN.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let e=Math.trunc(i/u);if(u*e!==i)throw new Error(MN.getSparseReshapeInputOutputMultipleErrorMessage(a,l));l[c]=e}if(um.sizeFromShape(l)!==i)throw new Error(MN.getSparseReshapeInputOutputMismatchErrorMessage(a,l));let d=a.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*a[e+1]}let p=[];if(o>0){p[o-1]=1;for(let e=o-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}let f=um.getArrayFromDType(n,s*o);for(let m=0;m<s;++m){let t=0;for(let n=0;n<d;++n)t+=e[m*d+n]*h[n];for(let e=0;e<o;++e)f[m*o+e]=Math.trunc(t/p[e]),t%=p[e]}return[f,[s,o],l]}function dU(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=a.length,l=[t[0],e.length/t[0]],u=l[1],c=o>0?r[o-1]+1:0;if(c<0)throw new Error(MN.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=c;let h=d.reduce((e,t)=>e*t,1),p=um.getArrayFromDType(n,h);if(0===o)return c>0&&p.fill(s),[p,d];if(c<=0)throw new Error(MN.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,y=r[f];for(;;){let t=0;if(m<o){if(t=r[m],y===t){++m;continue}if(y>=t)throw new Error(MN.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=c)throw new Error(MN.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,c));y>g&&p.fill(s,g*u,y*u);for(let n=f;n<m;++n){let t=a[n];if(t<0||t>=l[0])throw new Error(MN.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,a[n],l[0]));for(let n=0;n<u;n++)p[y*u+n]+=e[t*u+n]}if(i)for(let e=0;e<u;e++)p[y*u+e]/=m-f;if(f=m,++m,g=y+1,y=t,m>o)break}return g<c&&p.fill(s,g*u,c*u),[p,d]}var hU=MW(e=>Math.sqrt(e)),pU=OW(mf,e=>Math.sqrt(e)),fU={kernelName:mf,backendName:"cpu",kernelFunc:pU},mU=hW((e,t)=>{let n=e-t;return n*n}),gU=SW(Nf,mU),yU={kernelName:Nf,backendName:"cpu",kernelFunc:gU},bU=MW((e,t)=>{let{pattern:n,replaceGlobal:a,rewrite:r}=t;return e.replace(new RegExp(n,a?"g":""),r)}),vU=PW(Cf,bU),xU={kernelName:Cf,backendName:"cpu",kernelFunc:vU};function wU(e,t,n,a){let r=Zy(e,t.dtype);for(let i=0;i<r.size;i++){let e=r.indexToLoc(i),s=new Array(e.length);for(let t=0;t<s.length;t++)s[t]=e[t]*n[t]+a[t];r.set(t.get(...s),...e)}return r}var kU=class{constructor(e,t,n,a,r,i){this.separator=um.encodeString(e),this.nGramWidths=t,this.leftPad=um.encodeString(n),this.rightPad=um.encodeString(a),this.padWidth=r,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,r,i){for(let s=0;s<r;++s){let o=this.getPadWidth(i),l=Math.max(0,o-s),u=Math.max(0,o-(r-(s+1))),c=i-(l+u),d=t+(l>0?0:s-o),h=0;h+=l*this.leftPad.length;for(let t=0;t<c;++t)h+=e[d+t].length;h+=u*this.rightPad.length,h+=(l+u+c-1)*this.separator.length,n[a+s]=new Uint8Array(h);let p=n[a+s],f=0,m=e=>e.forEach(e=>p[f++]=e);for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<c-1;++t)m(e[d+t]),m(this.separator);if(c>0){m(e[d+c-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){let n=e.length,a=t.length;if(a>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let r=1;r<a;++r){let a=t[r]>=e;if(a=a&&t[r]<=n,!a)throw new Error("Invalid split value ".concat(t[r],", must be in [").concat(e,", ").concat(n,"]"));e=t[r]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}let r=a-1,i=um.getArrayFromDType("int32",a);if(0===n||0===a){let e=new Array(n);for(let t=0;t<=r;++t)i[t]=0;return[e,i]}i[0]=0;for(let o=1;o<=r;++o){let e=t[o]-t[o-1],n=0;this.nGramWidths.forEach(t=>{n+=this.getNumNGrams(e,t)}),this.preserveShort&&e>0&&0===n&&(n=1),i[o]=i[o-1]+n}let s=new Array(i[r]);for(let o=0;o<r;++o){let n=t[o],a=i[o];if(this.nGramWidths.forEach(r=>{let i=t[o+1]-t[o],l=this.getNumNGrams(i,r);this.createNGrams(e,n,s,a,l,r),a+=l}),this.preserveShort&&a===i[o]){let r=t[o+1]-t[o];if(0===r)continue;let i=r+2*this.padWidth;this.createNGrams(e,n,s,a,1,i)}}return[s,i]}};function SU(e,t,n,a,r,i,s,o){return new kU(n,a,r,i,s,o).compute(e,t)}function IU(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){let r=t[0],i=e.indexOf(r);for(;-1!==i;){let t=e.subarray(0,i);(!n||0!==t.length)&&a.push(t),i=(e=e.subarray(i+1)).indexOf(r)}return void((!n||0!==e.length)&&a.push(e))}let r=0;for(let i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){let t=e.subarray(r,i);(!n||0!==t.length)&&a.push(t),r=i+1}}function NU(e,t,n){let a=e.length,r=[],i=0,s=0,o=new Array(a);for(let h=0;h<a;++h){let a=r.length;IU(e[h],t,n,r);let l=r.length-a;o[h]=l,i+=l,s=Math.max(s,l)}let l=um.getArrayFromDType("int32",2*i),u=new Array(i),c=[a,s],d=0;for(let h=0;h<a;++h)for(let e=0;e<o[h];++e)l[2*d]=h,l[2*d+1]=e,u[d]=r[d],++d;return[l,u,c]}function TU(e,t){let n=um.getArrayFromDType("int32",e.length);for(let a=0;a<e.length;++a)n[a]=um.fingerPrint64(e[a]).modulo(t).getLowBitsUnsigned();return n}var CU=hW((e,t)=>e-t),EU=IW((e,t,n,a)=>({real:e-n,imag:t-a})),_U=SW(Rf,CU,EU),AU={kernelName:Rf,backendName:"cpu",kernelFunc:_U};function FU(e,t){let n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];let a=Zy(n,e.dtype);for(let r=0;r<a.values.length;++r){let t=a.indexToLoc(r),n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=t[a]%e.shape[a];let i=e.locToIndex(n);a.values[r]=e.values[i]}return a}var RU=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function DU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;a>n;){if(a-n>600){let r=a-n+1,i=t-n+1,s=Math.log(r),o=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*o*(r-o)/r)*Math.sign(i-r/2);DU(e,t,Math.max(n,Math.floor(t-i*o/r+l)),Math.min(a,Math.floor(t+(r-i)*o/r+l)))}let r=e[t],i=n,s=a;for(um.swap(e,n,t),RU(e[a],r)>0&&um.swap(e,n,a);i<s;){for(um.swap(e,i,s),i++,s--;RU(e[i],r)<0;)i+=1;for(;RU(e[s],r)>0;)s-=1}0===RU(e[n],r)?um.swap(e,n,s):(s+=1,um.swap(e,s,a)),s<=t&&(n=s+1),t<=s&&(a=s-1)}}function MU(e,t,n,a,r){let i=t[t.length-1],[s,o]=[e.length/i,i],l=um.getTypedArrayFromDType(n,s*a),u=um.getTypedArrayFromDType("int32",s*a);for(let d=0;d<s;d++){let t=d*o,n=e.subarray(t,t+o),i=new Array(n.length);n.forEach((e,t)=>i[t]={value:e,index:t}),a<i.length&&(DU(i,a),i=i.slice(0,a)),r&&i.sort(RU);let s=d*a,c=l.subarray(s,s+a),h=u.subarray(s,s+a);for(let e=0;e<a;e++)c[e]=i[e].value,h[e]=i[e].index}let c=t.slice();return c[c.length-1]=a,[Zy(c,n,l),Zy(c,"int32",u)]}function OU(e,t,n,a){let r=um.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let f=0;f<r;f++)i[0]*=n[f];i[1]=n[r];for(let f=r+1;f<n.length;f++)i[2]*=n[f];let s=new Map,o=new Int32Array(n[r]),l=new Vm(i,a,e),u=[],c=1===i[0]&&1===i[2];for(let f=0;f<n[r];f++){let t;if(c)t=e[f].toString();else{let e=[];for(let t=0;t<i[0];t++)for(let n=0;n<i[2];n++)e.push(l.get(t,f,n));t=e.join(",")}let n=s.get(t);if(null!=n)o[f]=n;else{let e=s.size;s.set(t,e),o[f]=e,u.push(f)}}let d=i.slice();d[1]=s.size;let h=new Vm(d,a);u.forEach((e,t)=>{for(let n=0;n<i[0];n++)for(let a=0;a<i[2];a++)h.set(l.get(n,e,a),n,t,a)});let p=n.slice();return p[r]=d[1],{outputValues:h.values,outputShape:p,indices:o}}var PU="4.22.0";Zg("cpu",()=>new lW,1);var LU=OW(Ah,e=>e>=0?e:Math.exp(e)-1),zU={kernelName:Ah,backendName:"cpu",kernelFunc:LU};function BU(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:i}=a;sW([r],"leakyRelu");let s=um.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,l=um.getTypedArrayFromDType("float32",s);for(let u=0;u<o.length;u++)l[u]=o[u]<0?i*o[u]:o[u];return n.makeTensorInfo(r.shape,"float32",l)}var WU={kernelName:$h,backendName:"cpu",kernelFunc:BU},VU=hW((e,t)=>e<0?t*e:e);function UU(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t;sW([a,r],"prelu");let i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,[o,l]=VU(a.shape,r.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}var jU={kernelName:Bp,backendName:"cpu",kernelFunc:UU},GU=OW(Kp,e=>Math.max(0,e)),HU={kernelName:Kp,backendName:"cpu",kernelFunc:GU},qU=OW($p,e=>Math.min(Math.max(0,e),6)),KU={kernelName:$p,backendName:"cpu",kernelFunc:qU};function XU(e,t,n,a,r){if("linear"===n)return gW({inputs:{x:t},backend:e});if("relu"===n)return GU({inputs:{x:t},backend:e});if("elu"===n)return LU({inputs:{x:t},backend:e});if("relu6"===n)return qU({inputs:{x:t},backend:e});if("prelu"===n)return UU({inputs:{x:t,alpha:a},backend:e});if("leakyrelu"===n)return BU({inputs:{x:t},backend:e,attrs:{alpha:r}});if("sigmoid"===n)return rU({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function YU(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:i}=a,s=um.sizeFromShape(r.shape),o=um.inferFromImplicitShape(i,s),l=um.sizeFromShape(o);um.assert(s===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old shape (").concat(r.shape,") has ").concat(s," elements. The new shape and old shape must have the same number of elements.")),n.incRef(r.dataId);let u=n.data.get(r.dataId);if(null!=u.complexTensorInfos){let e=u.complexTensorInfos.real,t=u.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}var QU={kernelName:Xp,backendName:"cpu",kernelFunc:YU};function JU(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i}=t,{transposeA:s,transposeB:o}=a;sW([r,i],"matMul");let l=r.shape.length,u=i.shape.length,c=s?r.shape[l-2]:r.shape[l-1],d=o?i.shape[u-1]:i.shape[u-2],h=s?r.shape[l-1]:r.shape[l-2],p=o?i.shape[u-2]:i.shape[u-1],f=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=um.sizeFromShape(f),y=um.sizeFromShape(m),b=kv.assertAndGetBroadcastShape(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,p]);um.assert(c===d,()=>"Error in matMul: inner shapes (".concat(c,") and (").concat(d,") of Tensors with shapes ").concat(r.shape," and ").concat(i.shape," and transposeA=").concat(s," and transposeB=").concat(o," must match."));let v=o?[y,p,d]:[y,d,p],x=YU({inputs:{x:r},backend:n,attrs:{shape:s?[g,c,h]:[g,h,c]}}),w=YU({inputs:{x:i},backend:n,attrs:{shape:v}}),k=s?x.shape[1]:x.shape[2],S=s?x.shape[2]:x.shape[1],I=o?w.shape[1]:w.shape[2],N=Math.max(g,y),T=n.data.get(x.dataId).values,C=n.data.get(w.dataId).values,E=um.computeStrides(x.shape),_=um.computeStrides(w.shape),[A,F,R]=s?[E[0],1,E[1]]:[E[0],E[1],1],[D,M,O]=o?[1,_[1],_[0]]:[_[1],1,_[0]],P=S*I,L=Zy([N,S,I],x.dtype),z=L.values,B=n.blockSize;for(let W=0;W<N;W++){let e=W%g,t=W%y;for(let n=0;n<S;n+=B){let a=Math.min(n+B,S);for(let r=0;r<I;r+=B){let i=Math.min(r+B,I);for(let s=0;s<k;s+=B){let o=Math.min(s+B,k);for(let l=n;l<a;l++)for(let n=r;n<i;n++){let a=0;for(let r=s;r<o;r++){a+=T[e*A+l*F+r*R]*C[r*D+n*M+t*O]}z[W*P+(l*I+n)]+=a}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(b,L.dtype,L.values)}var ZU={kernelName:Yd,backendName:"cpu",kernelFunc:JU};var $U={kernelName:Kf,backendName:"cpu",kernelFunc:function(e){let t,n,a,{inputs:r,backend:i,attrs:s}=e,{a:o,b:l,bias:u,preluActivationWeights:c}=r,{transposeA:d,transposeB:h,activation:p,leakyreluAlpha:f}=s,m=[];t=JU({inputs:{a:o,b:l},attrs:{transposeA:d,transposeB:h},backend:i}),u&&(n=CW({inputs:{a:t,b:u},backend:i}),m.push(t),t=n),p&&(a=XU(i,t,p,c,f),m.push(t),t=a);for(let g of m)i.disposeIntermediateTensorInfo(g);return t}},ej=OW(Rd,e=>Math.acos(e)),tj={kernelName:Rd,backendName:"cpu",kernelFunc:ej},nj=OW(Dd,e=>Math.acosh(e)),aj={kernelName:Dd,backendName:"cpu",kernelFunc:nj};var rj={kernelName:Od,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,a=t;sW(t,"addN");let r=a.map(e=>n.data.get(e.dataId).values),i=Zy(a[0].shape,a[0].dtype),s=i.values;for(let o=0;o<a.length;o++){let e=r[o];for(let t=0;t<s.length;t++)s[t]+=e[t]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}};var ij={kernelName:Pd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;sW(r,"all");let o=um.parseAxisParam(i,r.shape),l=o,u=MN.getAxesPermutation(l,r.shape.length),c=r;null!=u&&(c=LV({inputs:{x:r},backend:n,attrs:{perm:u}}),l=MN.getInnerMostAxes(l.length,r.shape.length)),MN.assertAxesAreInnerMostDims("all",l,c.shape.length);let[d,h]=MN.computeOutAndReduceShapes(c.shape,l),p=um.sizeFromShape(h),f=um.makeZerosTypedArray(um.sizeFromShape(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){let e=y*p,t=m[e];for(let n=0;n<p;++n){let a=m[e+n];t=t&&a}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(d,c.dtype,f);if(s){let e=YU({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var sj={kernelName:Ld,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;sW(r,"any");let o=um.parseAxisParam(i,r.shape),l=o,u=MN.getAxesPermutation(l,r.shape.length),c=r;null!=u&&(c=LV({inputs:{x:r},backend:n,attrs:{perm:u}}),l=MN.getInnerMostAxes(l.length,r.shape.length)),MN.assertAxesAreInnerMostDims("any",l,c.shape.length);let[d,h]=MN.computeOutAndReduceShapes(c.shape,l),p=um.sizeFromShape(h),f=um.makeZerosTypedArray(um.sizeFromShape(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){let e=y*p,t=m[e];for(let n=0;n<p;++n){let a=m[e+n];t=t||a}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(d,c.dtype,f);if(s){let e=YU({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var oj={kernelName:zd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a;sW(r,"argMax");let s=um.parseAxisParam(i,r.shape),o=MN.getAxesPermutation(s,r.shape.length),l=r,u=[];null!=o&&(l=LV({inputs:{x:r},backend:n,attrs:{perm:o}}),u.push(l),s=MN.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],MN.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[c,d]=MN.computeOutAndReduceShapes(l.shape,s),h=um.sizeFromShape(c),p=um.makeZerosTypedArray(h,"int32"),f=um.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let e=g*f,t=m[e],n=0;for(let a=0;a<f;++a){let r=m[e+a];r>t&&(t=r,n=a)}p[g]=n}return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c,"int32",p)}};var lj={kernelName:Bd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a;sW(r,"argMin");let s=um.parseAxisParam(i,r.shape),o=MN.getAxesPermutation(s,r.shape.length),l=r,u=[];null!=o&&(l=LV({inputs:{x:r},backend:n,attrs:{perm:o}}),u.push(l),s=MN.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],MN.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[c,d]=MN.computeOutAndReduceShapes(l.shape,s),h=um.sizeFromShape(c),p=um.makeZerosTypedArray(h,"int32"),f=um.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let e=g*f,t=m[e],n=0;for(let a=0;a<f;++a){let r=m[e+a];r<t&&(t=r,n=a)}p[g]=n}return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c,"int32",p)}},uj=OW(Wd,e=>Math.asin(e)),cj={kernelName:Wd,backendName:"cpu",kernelFunc:uj},dj=OW(Vd,e=>Math.asinh(e)),hj={kernelName:Vd,backendName:"cpu",kernelFunc:dj},pj=OW(Ud,e=>Math.atan(e)),fj={kernelName:Ud,backendName:"cpu",kernelFunc:pj},mj=hW((e,t)=>Math.atan2(e,t)),gj=SW(Gd,mj),yj={kernelName:Gd,backendName:"cpu",kernelFunc:gj},bj=OW(jd,e=>Math.atanh(e)),vj={kernelName:jd,backendName:"cpu",kernelFunc:bj};function xj(e,t,n,a,r,i){let s=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Zy(r.outShape,n),g=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let x=0;x<r.batchSize;++x){let t=x*y,n=x*a[0];for(let m=0;m<r.inChannels;++m)for(let y=0;y<r.outHeight;++y){let x=y*s-h,w=Math.max(0,x),k=Math.min(r.inHeight,c+x),S=t+y*b;for(let t=0;t<r.outWidth;++t){let s=t*o-p,c=Math.max(0,s),h=Math.min(r.inWidth,d+s),y=f,b=0,x=0;for(let t=w;t<k;t+=l){let r=n+t*a[1];for(let t=c;t<h;t+=u){let n=e[r+t*a[2]+m];"max"===i&&n>y?y=n:"avg"===i&&(b+=n,x++)}if(isNaN(y))break}g[S+t*v+m]="avg"===i?b/x:y}}}return m}function wj(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=Zy(a.outShape,"int32"),o=a.strideHeight,l=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,m=Zy(t,n,e);for(let g=0;g<a.batchSize;++g)for(let e=0;e<a.inChannels;++e)for(let t=0;t<a.outHeight;++t){let n=t*o-p,y=n;for(;y<0;)y+=u;let b=Math.min(a.inHeight,d+n);for(let o=0;o<a.outWidth;++o){let d=o*l-f,p=d;for(;p<0;)p+=c;let v=Math.min(a.inWidth,h+d),x=Number.NEGATIVE_INFINITY,w=-1;for(let t=y;t<b;t+=u){let s=t-n;for(let n=p;n<v;n+=c){let o=n-d,l=m.get(g,t,n,e);l>x&&(x=l,w=r?i?((g*a.inHeight+t)*a.inWidth+n)*a.inChannels+e:(t*a.inWidth+n)*a.inChannels+e:s*h+o)}}s.set(w,g,t,o,e)}}return s}function kj(e,t,n,a,r,i){let s=r.strideDepth,o=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,b="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Zy(r.outShape,n),x=v.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let N=0;N<r.batchSize;++N){let t=N*w,n=N*a[0];for(let v=0;v<r.inChannels;++v)for(let w=0;w<r.outDepth;++w){let N=w*s-m,T=N;for(;T<0;)T+=u;let C=Math.min(r.inDepth,h+N),E=t+w*k;for(let t=0;t<r.outHeight;++t){let s=t*o-g,h=s;for(;h<0;)h+=c;let m=Math.min(r.inHeight,p+s),w=E+t*S;for(let t=0;t<r.outWidth;++t){let s=t*l-y,o=s;for(;o<0;)o+=d;let p=Math.min(r.inWidth,f+s),g=w+t*I,k=b,S=0,N=0;for(let t=T;t<C;t+=u){let r=n+t*a[1];for(let t=h;t<m;t+=c){let n=r+t*a[2];for(let t=o;t<p;t+=d){let r=e[n+t*a[3]+v];if("max"===i&&r>k?k=r:"avg"===i&&(S+=r,N++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+v]="avg"===i?S/Math.max(N,1):k}}}}return v}var Sj={kernelName:Hd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;sW(r,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;um.assert(MN.eitherStridesOrDilationsAreOne(s,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(1,"'"));let u,c=MN.computePool2DInfo(r.shape,i,s,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&um.arraysEqual(c.inShape,c.outShape))u=gW({inputs:{x:r},backend:n});else{let e=n.data.get(r.dataId).values,t=um.computeStrides(r.shape),a=xj(e,r.shape,r.dtype,t,c,"avg");u=n.makeTensorInfo(c.outShape,r.dtype,a.values)}return u}};var Ij={kernelName:Kd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=a;sW(r,"avgPool3d");let c=MN.computePool3DInfo(r.shape,i,s,1,o,l,u),d=kj(n.data.get(r.dataId).values,r.shape,r.dtype,um.computeStrides(r.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};var Nj={kernelName:Xd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a;sW([r,i],"avgPool3DGrad");let c=MN.computePool3DInfo(i.shape,s,o,1,l,u),d=c.strideDepth,h=c.strideHeight,p=c.strideWidth,f=c.filterDepth,m=c.filterHeight,g=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,k=c.effectiveFilterWidth,S=x-1-c.padInfo.front,I=k-1-c.padInfo.left,N=w-1-c.padInfo.top,T=Zy(i.shape,"float32"),C=1/(f*m*g),E=n.bufferSync(r);for(let _=0;_<c.batchSize;++_)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let a=0;a<c.inWidth;++a){let r=t-S,i=n-N,s=a-I,o=0;for(let t=0;t<x;t+=y){let n=(r+t)/d;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=b){let a=(i+t)/h;if(!(a<0||a>=c.outHeight||Math.floor(a)!==a))for(let t=0;t<k;t+=v){let r=(s+t)/p;r<0||r>=c.outWidth||Math.floor(r)!==r||(o+=E.get(_,n,a,r,e))}}}T.set(o*C,_,t,n,a,e)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}};var Tj={kernelName:qd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,s=i;sW([r,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=a,c=MN.computePool2DInfo(s.shape,o,l,1,u),d=c.strideHeight,h=c.strideWidth,p=c.filterHeight,f=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,v=b-1-c.padInfo.left,x=y-1-c.padInfo.top,w=Zy(s.shape,"float32"),k=1/(p*f),S=n.data.get(r.dataId).values,I=Zy(r.shape,"float32",S);for(let N=0;N<c.batchSize;++N)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inHeight;++t)for(let n=0;n<c.inWidth;++n){let a=t-x,r=n-v,i=0;for(let t=0;t<y;t+=m){let n=(a+t)/d;if(!(n<0||n>=c.outHeight||Math.floor(n)!==n))for(let t=0;t<b;t+=g){let a=(r+t)/h;a<0||a>=c.outWidth||Math.floor(a)!==a||(i+=I.get(N,n,a,e))}}w.set(i*k,N,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var Cj={kernelName:Uh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,scale:i,offset:s,mean:o,variance:l}=t;um.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),um.assert(null==s||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),um.assert(null==i||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),sW([r,o,l,i,s],"batchNorm");let{varianceEpsilon:u}=a;null==u&&(u=.001);let c=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=f.length,y=p.length,b=h.length,v=d.length,x=0,w=0,k=0,S=0;for(let I=0;I<c.length;++I)m[I]=f[x++]+(c[I]-d[w++])*p[k++]/Math.sqrt(h[S++]+u),x>=g&&(x=0),w>=v&&(w=0),k>=y&&(k=0),S>=b&&(S=0);return n.makeTensorInfo(r.shape,r.dtype,m)}};var Ej={kernelName:Qd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,crops:s}=a;sW([r],"batchToSpaceND");let o=i.reduce((e,t)=>e*t),l=MN.getReshaped(r.shape,i,o),u=MN.getPermuted(l.length,i.length),c=MN.getReshapedPermuted(r.shape,i,o),d=MN.getSliceBeginCoords(s,i.length),h=MN.getSliceSize(c,s,i.length),p=YU({inputs:{x:r},backend:n,attrs:{shape:l}}),f=LV({inputs:{x:p},backend:n,attrs:{perm:u}}),m=YU({inputs:{x:f},backend:n,attrs:{shape:c}}),g=oU({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};var _j={kernelName:Jd,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s}=a,o=_W(n.data.get(r.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,o)}};var Aj={kernelName:eh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,o=MN.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},Fj=OW(ah,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Rj={kernelName:ah,backendName:"cpu",kernelFunc:Fj},Dj={kernelName:ih,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend,a=new Float32Array(um.sizeFromShape(t.shape)),r=n.data.get(t.dataId),i=r.complexTensorInfos.real,s=r.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<o.length;u++){let e=o[u],t=l[u];a[u]=Math.hypot(e,t)}return n.makeOutput(a,t.shape,"float32")}};function Mj(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}var Oj={kernelName:Yh,backendName:"cpu",kernelFunc:Mj};function Pj(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,i=um.parseAxisParam(r,t[0].shape)[0],s=t.map(e=>e.shape);MN.assertParamsConsistent(s,i);let o=MN.computeOutShape(t.map(e=>e.shape),i);if(0===um.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>um.sizeFromShape(e.shape)>0);if(1===l.length)return gW({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){let e=l.map(e=>bW({inputs:{input:e},backend:n})),t=l.map(e=>Mj({inputs:{input:e},backend:n})),a=Pj({inputs:e,backend:n,attrs:{axis:i}}),r=Pj({inputs:t,backend:n,attrs:{axis:i}}),s=pW({inputs:{real:a,imag:r},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),s}let u=l.map(e=>{let t=[-1,um.sizeFromShape(e.shape.slice(i))];return YU({inputs:{x:e},backend:n,attrs:{shape:t}})}),c=u.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));o=MN.computeOutShape(u.map(e=>e.shape),1);let d=1===u[0].shape[0],h=WW(c,o,t[0].dtype,d),p=MN.computeOutShape(l.map(e=>e.shape),i),f=n.makeTensorInfo(p,t[0].dtype,h);return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}var Lj={kernelName:sh,backendName:"cpu",kernelFunc:Pj};function zj(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=a;sW([r,i],"conv2d");let d=MN.convertConv2DDataFormat(l),h=MN.computeConv2DInfo(r.shape,i.shape,s,u,o,c,!1,d),p=h.filterHeight,f=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,b=h.padInfo.top,v="channelsLast"===h.dataFormat,x=new Vm(h.outShape,r.dtype),w=um.computeStrides(r.shape),k=um.computeStrides(i.shape),S=w[0],I=v?w[1]:w[2],N=v?w[2]:1,T=v?1:w[1],C=x.strides[0],E=v?x.strides[1]:x.strides[2],_=v?x.strides[2]:1,A=v?1:x.strides[1],F=n.data.get(r.dataId).values,R=n.data.get(i.dataId).values,D=x.values;for(let M=0;M<h.batchSize;++M){let e=M*S,t=M*C;for(let n=0;n<h.outHeight;++n){let a=t+n*E,r=n*h.strideHeight-b;for(let t=0;t<p;++t){let n=r+t*m;if(n<0||n>=h.inHeight)continue;let i=t*k[0],s=e+n*I;for(let e=0;e<h.outWidth;++e){let t=a+e*_,n=e*h.strideWidth-y;for(let e=0;e<f;++e){let a=n+e*g;if(a<0||a>=h.inWidth)continue;let r=s+a*N,o=i+e*k[1];for(let e=0;e<h.inChannels;++e){let n=F[r+e*T];for(let e=0;e<h.outChannels;++e)D[t+e*A]+=n*R[o+e];o+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,D)}var Bj={kernelName:oh,backendName:"cpu",kernelFunc:zj};var Wj={kernelName:lh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=a;sW([r,i],"conv2dBackpropFilter");let d=MN.convertConv2DDataFormat(l),h=MN.computeConv2DInfo(r.shape,c,s,1,o,u,!1,d),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=h,y="channelsLast"===h.dataFormat,b=new Vm(h.filterShape,"float32"),v=h.padInfo.left,x=h.padInfo.top,w=n.data.get(r.dataId).values,k=n.data.get(i.dataId).values,S=new Vm(r.shape,r.dtype,w),I=new Vm(i.shape,i.dtype,k);for(let N=0;N<m;++N){let e=Math.max(0,Math.ceil((x-N)/p)),t=Math.min(h.outHeight,(h.inHeight+x-N)/p);for(let n=0;n<g;++n){let a=Math.max(0,Math.ceil((v-n)/f)),r=Math.min(h.outWidth,(h.inWidth+v-n)/f);for(let i=0;i<h.inChannels;++i)for(let s=0;s<h.outChannels;++s){let o=0;for(let l=0;l<h.batchSize;++l)for(let u=e;u<t;++u){let e=N+u*p-x;for(let t=a;t<r;++t){let a=n+t*f-v;o+=y?S.get(l,e,a,i)*I.get(l,u,t,s):S.get(l,i,e,a)*I.get(l,s,u,t)}}b.set(o,N,n,i,s)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var Vj={kernelName:uh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=a;sW([r,i],"conv2dBackpropInput");let d=um.computeStrides(i.shape),h=um.computeStrides(r.shape),p=MN.convertConv2DDataFormat(u),f=MN.computeConv2DInfo(s,i.shape,o,1,l,c,!1,p),m=new Vm(f.inShape,"float32"),g=m.values,y=n.data.get(r.dataId).values,b=n.data.get(i.dataId).values,[v,x,w]=d,{batchSize:k,filterHeight:S,filterWidth:I,inChannels:N,inHeight:T,inWidth:C,outChannels:E,outHeight:_,outWidth:A,strideHeight:F,strideWidth:R}=f;p=f.dataFormat;let D=S-1-f.padInfo.top,M=I-1-f.padInfo.left,O="channelsLast"===p,P=m.strides[0],L=O?m.strides[1]:m.strides[2],z=O?m.strides[2]:1,B=O?1:m.strides[1],W=h[0],V=O?h[1]:h[2],U=O?h[2]:1,j=O?1:h[1];for(let G=0;G<k;++G)for(let e=0;e<N;++e)for(let t=0;t<T;++t){let n=t-D,a=Math.max(0,Math.ceil(n/F)),r=Math.min(_,(S+n)/F);for(let i=0;i<C;++i){let s=i-M,o=Math.max(0,Math.ceil(s/R)),l=Math.min(A,(I+s)/R),u=0;for(let t=a;t<r;++t){let a=t*F-n;for(let n=o;n<l;++n){let r=W*G+V*t+U*n,i=v*(S-1-a)+x*(I-1-(n*R-s))+w*e;for(let e=0;e<E;++e){u+=y[r+j*e]*b[i+e]}}}g[P*G+L*t+z*i+B*e]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var Uj={kernelName:ch,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a;sW([r,i],"conv3d");let u=MN.computeConv3DInfo(r.shape,i.shape,s,l,o),{filterDepth:c,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=u,y=g.front,b=g.left,v=g.top,x=new Vm(u.outShape,r.dtype),w=n.data.get(r.dataId).values,k=n.data.get(i.dataId).values,S=x.values,I=um.computeStrides(r.shape),N=um.computeStrides(i.shape);for(let T=0;T<u.batchSize;++T){let e=T*I[0],t=T*x.strides[0];for(let n=0;n<u.outDepth;++n){let a=t+n*x.strides[1],r=n*u.strideDepth-y;for(let t=0;t<c;++t){let n=r+t*p;if(n<0||n>=u.inDepth)continue;let i=t*N[0],s=e+n*I[1];for(let e=0;e<u.outHeight;++e){let t=a+e*x.strides[2],n=e*u.strideHeight-v;for(let e=0;e<d;++e){let a=n+e*f;if(a<0||a>=u.inHeight)continue;let r=i+e*N[1],o=s+a*I[2];for(let e=0;e<u.outWidth;++e){let n=t+e*u.outChannels,a=e*u.strideWidth-b;for(let e=0;e<h;++e){let t=a+e*m;if(t<0||t>=u.inWidth)continue;let i=r+e*N[2],s=o+t*u.inChannels,l=i;for(let e=0;e<u.inChannels;++e){let t=w[s+e];for(let e=0;e<u.outChannels;++e)S[n+e]+=t*k[l+e];l+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var jj={kernelName:dh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,filterShape:l}=a;sW([r,i],"conv3dBackpropFilterV2");let u=um.computeStrides(r.shape),c=um.computeStrides(i.shape),d=MN.computeConv3DInfo(r.shape,l,s,1,o),h=d.strideDepth,p=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,b=new Vm(d.filterShape,"float32"),v=b.values,[x,w,k,S]=b.strides,I=n.data.get(i.dataId).values,[N,T,C,E]=c,_=n.data.get(r.dataId).values,[A,F,R,D]=u,M=d.padInfo.front,O=d.padInfo.left,P=d.padInfo.top;for(let L=0;L<m;++L){let e=Math.max(0,Math.ceil((M-L)/h)),t=Math.min(d.outDepth,(d.inDepth+M-L)/h),n=L*x;for(let a=0;a<g;++a){let r=Math.max(0,Math.ceil((P-a)/p)),i=Math.min(d.outHeight,(d.inHeight+P-a)/p),s=a*w+n;for(let n=0;n<y;++n){let o=Math.max(0,Math.ceil((O-n)/f)),l=Math.min(d.outWidth,(d.inWidth+O-n)/f),u=n*k+s;for(let s=0;s<d.inChannels;++s){let c=s*S+u;for(let u=0;u<d.outChannels;++u){let m=0;for(let c=0;c<d.batchSize;++c){let d=c*A,g=c*N;for(let c=e;c<t;++c){let e=(L+c*h-M)*F+d,t=c*T+g;for(let c=r;c<i;++c){let r=(a+c*p-P)*R+e,i=c*C+t;for(let e=o;e<l;++e){let t=e*E+i;m+=_[(n+e*f-O)*D+r+s]*I[t+u]}}}}v[c+u]=m}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var Gj={kernelName:hh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{pad:s,strides:o,inputShape:l}=a;sW([r],"conv3dBackpropInputV2");let u=um.computeStrides(r.shape),c=um.computeStrides(i.shape),d=MN.computeConv3DInfo(l,i.shape,o,1,s),h=new Vm(d.inShape,"float32"),p=h.values,[f,m,g,y]=h.strides,b=n.data.get(r.dataId).values,[v,x,w,k]=u,S=n.data.get(i.dataId).values,[I,N,T,C]=c,{batchSize:E,filterDepth:_,filterHeight:A,filterWidth:F,inChannels:R,inDepth:D,inHeight:M,inWidth:O,outChannels:P,outDepth:L,outHeight:z,outWidth:B,strideDepth:W,strideHeight:V,strideWidth:U}=d,j=_-1-d.padInfo.front,G=A-1-d.padInfo.top,H=F-1-d.padInfo.left;for(let q=0;q<E;++q)for(let e=0;e<R;++e)for(let t=0;t<D;++t){let n=t-j,a=Math.max(0,Math.ceil(n/W)),r=Math.min(L,(_+n)/W);for(let i=0;i<M;++i){let s=i-G,o=Math.max(0,Math.ceil(s/V)),l=Math.min(z,(A+s)/V);for(let u=0;u<O;++u){let c=u-H,d=Math.max(0,Math.ceil(c/U)),h=Math.min(B,(F+c)/U),E=0;for(let t=a;t<r;++t){let a=t*W-n;for(let n=o;n<l;++n){let r=n*V-s;for(let i=d;i<h;++i){let s=v*q+x*t+w*n+k*i,o=I*(_-1-a)+N*(A-1-r)+T*(F-1-(i*U-c))+C*e;for(let e=0;e<P;++e){E+=b[s+e]*S[o+e]}}}}p[f*q+m*t+g*i+y*u+e]=E}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},Hj=OW(ph,e=>Math.cos(e)),qj={kernelName:ph,backendName:"cpu",kernelFunc:Hj},Kj=OW(fh,e=>Math.cosh(e)),Xj={kernelName:fh,backendName:"cpu",kernelFunc:Kj};var Yj={kernelName:yh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=a,[c,d,h,p]=r.shape,f=i.shape[0],[m,g]=o,y=Zy([f,m,g,p],"float32"),b=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,x=n.data.get(r.dataId).values,w=um.computeStrides(r.shape),k=um.computeStrides(y.shape);for(let S=0;S<f;S++){let e=4*S,t=b[e],n=b[e+1],a=b[e+2],r=b[e+3],i=v[S];if(i>=c)continue;let s=m>1?(a-t)*(d-1)/(m-1):0,o=g>1?(r-n)*(h-1)/(g-1):0;for(let c=0;c<m;c++){let e=m>1?t*(d-1)+c*s:.5*(t+a)*(d-1);if(e<0||e>d-1)for(let t=0;t<g;t++)for(let e=0;e<p;e++){let n=e+t*k[2]+c*k[1]+S*k[0];y.values[n]=u}else if("bilinear"===l){let t=Math.floor(e),a=Math.ceil(e),s=e-t;for(let e=0;e<g;e++){let l=g>1?n*(h-1)+e*o:.5*(n+r)*(h-1);if(l<0||l>h-1){for(let t=0;t<p;t++){let n=t+e*k[2]+c*k[1]+S*k[0];y.values[n]=u}continue}let d=Math.floor(l),f=Math.ceil(l),m=l-d;for(let n=0;n<p;n++){let r=n+d*w[2]+t*w[1]+i*w[0],o=x[r];r=n+f*w[2]+t*w[1]+i*w[0];let l=x[r];r=n+d*w[2]+a*w[1]+i*w[0];let u=x[r];r=n+f*w[2]+a*w[1]+i*w[0];let h=o+(l-o)*m,p=u+(x[r]-u)*m;r=n+e*k[2]+c*k[1]+S*k[0],y.values[r]=h+(p-h)*s}}}else for(let t=0;t<g;++t){let a=g>1?n*(h-1)+t*o:.5*(n+r)*(h-1);if(a<0||a>h-1){for(let e=0;e<p;e++){let n=e+t*k[2]+c*k[1]+S*k[0];y.values[n]=u}continue}let s=Math.round(a),l=Math.round(e);for(let e=0;e<p;e++){let n=e+s*w[2]+l*w[1]+i*w[0],a=e+t*k[2]+c*k[1]+S*k[0];y.values[a]=x[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var Qj={kernelName:mh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;sW(r,"cumprod");let l=MN.getAxesPermutation([i],r.shape.length),u=r;null!=l&&(u=LV({inputs:{x:r},backend:n,attrs:{perm:l}}));let c=MN.getInnerMostAxes(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most axis=".concat(u.shape.length-1," but got axis=").concat(c));let d=tg(u.dtype,"int32"),h=um.makeOnesTypedArray(um.sizeFromShape(u.shape),d),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<p.length;y+=f)for(let e=0;e<f;e++){let t=m(y,e);if(0===e)h[t]=s?1:p[t];else{let n=m(y,e-1);h[t]=s?p[n]*h[n]:p[t]*h[n]}}let g=n.makeTensorInfo(u.shape,d,h);if(null!=l){let e=LV({inputs:{x:g},backend:n,attrs:{perm:MN.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};var Jj={kernelName:gh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;sW(r,"cumsum");let l=MN.getAxesPermutation([i],r.shape.length),u=r;null!=l&&(u=LV({inputs:{x:r},backend:n,attrs:{perm:l}}));let c=MN.getInnerMostAxes(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(u.shape.length-1," but got axis=").concat(c));let d=tg(u.dtype,"int32"),h=um.makeZerosTypedArray(um.sizeFromShape(u.shape),d),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<p.length;y+=f)for(let e=0;e<f;e++){let t=m(y,e);if(0===e)h[t]=s?0:p[t];else{let n=m(y,e-1);h[t]=s?p[n]+h[n]:p[t]+h[n]}}let g=n.makeTensorInfo(u.shape,d,h);if(null!=l){let e=LV({inputs:{x:g},backend:n,attrs:{perm:MN.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};var Zj={kernelName:bh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s,binaryOutput:o}=a;if(1===r.shape.length){let e=_W(n.data.get(r.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,e)}if(2===r.shape.length){let e=AW(n.bufferSync(r),n.bufferSync(i),s,o);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(r.shape.length,"."))}};var $j={kernelName:vh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:i,dataFormat:s}=a;um.assert("NHWC"===s,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s));let o=r.shape[0],l=r.shape[1],u=r.shape[2],c=r.shape[3],d=l*i,h=u*i,p=c/(i*i),f=n.data.get(r.dataId).values,m=new Float32Array(o*d*h*p),g=0;for(let y=0;y<o;++y)for(let e=0;e<d;++e){let t=Math.floor(e/i),n=e%i;for(let e=0;e<h;++e){let a=Math.floor(e/i),r=(n*i+e%i)*p;for(let e=0;e<p;++e){let n=e+r+c*(a+u*(t+l*y));m[g++]=f[n]}}}return n.makeTensorInfo([o,d,h,p],r.dtype,m)}};function eG(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=a;sW([r,i],"depthwiseConv2DNative");let c=um.computeStrides(r.shape),d=um.computeStrides(i.shape),h=l;null==h&&(h=[1,1]),um.assert(MN.eitherStridesOrDilationsAreOne(s,h),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(h,"'"));let p=MN.computeConv2DInfo(r.shape,i.shape,s,h,o,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=p,v=b.left,x=b.top,w=p.outChannels/p.inChannels,k=new Vm(p.outShape,r.dtype),S=n.data.get(r.dataId).values,I=n.data.get(i.dataId).values,N=k.values;for(let T=0;T<p.batchSize;++T){let e=T*c[0],t=T*k.strides[0];for(let n=0;n<p.outHeight;++n){let a=t+n*k.strides[1],r=n*p.strideHeight-x;for(let t=0;t<f;++t){let n=r+t*g;if(n<0||n>=p.inHeight)continue;let i=t*d[0],s=e+n*c[1];for(let e=0;e<p.outWidth;++e){let t=a+e*k.strides[2],n=e*p.strideWidth-v;for(let e=0;e<m;++e){let a=n+e*y;if(a<0||a>=p.inWidth)continue;let r=i+e*d[1],o=s+a*p.inChannels,l=t,u=r;for(let e=0;e<p.inChannels;++e){let t=S[o+e];for(let e=0;e<w;++e)N[l+e]+=t*I[u+e];l+=w,u+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var tG={kernelName:xh,backendName:"cpu",kernelFunc:eG};var nG={kernelName:wh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=a;sW([r,i],"depthwiseConv2dNativeBackpropFilter");let d=MN.computeConv2DInfo(r.shape,c,s,o,l,u,!0),{strideHeight:h,strideWidth:p,filterHeight:f,filterWidth:m}=d,g=new Vm(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,x=n.data.get(r.dataId).values,w=new Vm(r.shape,r.dtype,x),k=n.data.get(i.dataId).values,S=new Vm(i.shape,i.dtype,k);for(let I=0;I<f;++I){let e=Math.max(0,Math.ceil((b-I)/h)),t=Math.min(d.outHeight,(d.inHeight+b-I)/h);for(let n=0;n<m;++n){let a=Math.max(0,Math.ceil((y-n)/p)),r=Math.min(d.outWidth,(d.inWidth+y-n)/p);for(let i=0;i<d.outChannels;++i){let s=Math.trunc(i/v),o=i%v,l=0;for(let u=0;u<d.batchSize;++u)for(let o=e;o<t;++o){let e=I+o*h-b;for(let t=a;t<r;++t){let a=n+t*p-y;l+=w.get(u,e,a,s)*S.get(u,o,t,i)}}g.set(l,I,n,s,o)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var aG={kernelName:kh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=a;sW([r,i],"depthwiseConv2DNativeBackpropInput");let d=um.computeStrides(r.shape),h=um.computeStrides(i.shape),p=MN.computeConv2DInfo(c,i.shape,s,o,l,u,!0),f=new Vm(p.inShape,"float32"),m=f.values,[g,y,b]=f.strides,v=n.data.get(r.dataId).values,[x,w,k]=d,S=n.data.get(i.dataId).values,[I,N,T]=h,{batchSize:C,filterHeight:E,filterWidth:_,inChannels:A,inHeight:F,inWidth:R,outChannels:D,outHeight:M,outWidth:O,strideHeight:P,strideWidth:L}=p,z=E-1-p.padInfo.top,B=_-1-p.padInfo.left,W=D/A;for(let V=0;V<C;++V)for(let e=0;e<A;++e)for(let t=0;t<F;++t){let n=t-z,a=Math.max(0,Math.ceil(n/P)),r=Math.min(M,(E+n)/P);for(let i=0;i<R;++i){let s=i-B,o=Math.max(0,Math.ceil(s/L)),l=Math.min(O,(_+s)/L),u=0;for(let t=a;t<r;++t){let a=t*P-n;for(let n=o;n<l;++n){let r=x*V+w*t+k*n,i=I*(E-1-a)+N*(_-1-(n*L-s))+T*e;for(let t=0;t<W;++t){u+=v[r+(e*W+t)]*S[i+t]}}}m[g*V+y*t+b*i+e]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};var rG={kernelName:Sh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=um.sizeFromShape(a.shape),i=n.data.get(a.dataId).values,s=Zy([r,r],a.dtype),o=s.values;for(let u=0;u<i.length;u++)o[u*r+u]=i[u];let l=[...a.shape,...a.shape];return n.makeTensorInfo(l,s.dtype,s.values)}},iG={kernelName:Ih,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a,u=n,c=u.data.get(r.dataId).values,d=r.shape.length,h=u.data.get(i.dataId).values,p=i.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:b,outWidth:v,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:I,dilationHeight:N,dilationWidth:T,outShape:C}=MN.computeDilation2DInfo(r.shape,i.shape,s,o,"NHWC",l),E=um.sizeFromShape(C),_=C.length,A=um.getArrayFromDType(r.dtype,E);for(let F=0;F<f;++F)for(let e=0;e<b;++e){let t=e*w-x.top;for(let n=0;n<v;++n){let a=n*k-x.left;for(let s=0;s<y;++s){let o=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){let n=t+e*N;if(n>=0&&n<m)for(let t=0;t<I;++t){let l=a+t*T;if(l>=0&&l<g){let a=um.locToIndex([F,n,l,s],d,um.computeStrides(r.shape)),u=um.locToIndex([e,t,s],p,um.computeStrides(i.shape)),f=c[a]+h[u];f>o&&(o=f)}}}A[um.locToIndex([F,e,n,s],_,um.computeStrides(C))]=o}}}return{dataId:u.write(um.toTypedArray(A,r.dtype),C,r.dtype),shape:C,dtype:r.dtype}}},sG={kernelName:Th,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=a,c=n,d=um.toNestedArray(r.shape,c.data.get(r.dataId).values),h=um.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:N,outShape:T}=MN.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",u);um.assert(s.rank===T.length,()=>"Error in ".concat(Th,", dy must have the same rank as output ").concat(T.length,", but got ").concat(s.rank));let C=um.toNestedArray(T,c.data.get(s.dataId).values),E=um.makeZerosNestedTypedArray(i.shape,i.dtype);for(let _=0;_<p;++_)for(let e=0;e<y;++e){let t=e*x-v.top;for(let n=0;n<b;++n){let a=n*w-v.left;for(let r=0;r<g;++r){let i=Number.MIN_SAFE_INTEGER,s=0,o=0;for(let e=0;e<k;++e){let n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){let l=a+t*N;if(l>=0&&l<m){let a=d[_][n][l][r]+h[e][t][r];a>i&&(i=a,s=e,o=t)}}}E[s][o][r]+=C[_][e][n][r]}}}return{dataId:c.write(um.toTypedArray(E,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},oG={kernelName:Nh,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=a,c=n,d=um.toNestedArray(r.shape,c.data.get(r.dataId).values),h=um.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:N,outShape:T}=MN.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",u);um.assert(s.rank===T.length,()=>"Error in ".concat(Nh,", dy must have the same rank as output ").concat(T.length,", but got ").concat(s.rank));let C=um.toNestedArray(T,c.data.get(s.dataId).values),E=um.makeZerosNestedTypedArray(r.shape,r.dtype);for(let _=0;_<p;++_)for(let e=0;e<y;++e){let t=e*x-v.top;for(let n=0;n<b;++n){let a=n*w-v.left;for(let r=0;r<g;++r){let i=Number.MIN_SAFE_INTEGER,s=t<0?0:t,o=a<0?0:a;for(let e=0;e<k;++e){let n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){let l=a+t*N;if(l>=0&&l<m){let a=d[_][n][l][r]+h[e][t][r];a>i&&(i=a,s=n,o=l)}}}E[_][s][o][r]+=C[_][e][n][r]}}}return{dataId:c.write(um.toTypedArray(E,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var lG={kernelName:Ch,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r}=t,{canvas:i,options:s}=a,{contextOptions:o,imageOptions:l}=s||{},u=(null==l?void 0:l.alpha)||1,c=(null==o?void 0:o.contextType)||"2d";if("2d"!==c)throw new Error("Context type ".concat(o.contextType," is not supported by the CPU backend."));let d=i.getContext(c,(null==o?void 0:o.contextAttributes)||{});if(null==d)throw new Error("Could not get the context with ".concat(c," type."));let[h,p]=r.shape.slice(0,2),f=2===r.shape.length?1:r.shape[2],m=n.data.get(r.dataId).values,g="float32"===r.dtype?255:1,y=new Uint8ClampedArray(p*h*4);for(let v=0;v<h*p;++v){let e=[0,0,0,255*u];for(let n=0;n<f;n++){let t=m[v*f+n];if("float32"===r.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===r.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(t,"."));1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}let t=4*v;y[t+0]=Math.round(e[0]),y[t+1]=Math.round(e[1]),y[t+2]=Math.round(e[2]),y[t+3]=Math.round(e[3])}i.width=p,i.height=h;let b=new ImageData(y,p,h);return d.putImageData(b,0,0),r}};function uG(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r;sW(i,"sum"),t="bool"===i.dtype?wW({inputs:{x:i},backend:a,attrs:{dtype:"int32"}}):gW({inputs:{x:i},backend:a});let l=t.shape.length,u=um.parseAxisParam(s,t.shape),c=MN.getAxesPermutation(u,l),d=u,h=t;null!=c&&(h=LV({inputs:{x:t},backend:a,attrs:{perm:c}}),d=MN.getInnerMostAxes(d.length,l)),MN.assertAxesAreInnerMostDims("sum",d,h.shape.length);let[p,f]=MN.computeOutAndReduceShapes(h.shape,d),m=mW(a,p,MN.upcastType(h.dtype,"int32")),g=um.sizeFromShape(f),y=a.data.get(m.dataId).values,b=a.data.get(h.dataId).values;for(let v=0;v<y.length;++v){let e=v*g,t=0;for(let n=0;n<g;++n)t+=b[e+n];y[v]=t}if(o){let e=m;m=YU({inputs:{x:m},backend:a,attrs:{shape:MN.expandShapeToKeepDim(m.shape,u)}}),a.disposeIntermediateTensorInfo(e)}return a.disposeIntermediateTensorInfo(t),null!=c&&a.disposeIntermediateTensorInfo(h),m}var cG={kernelName:gf,backendName:"cpu",kernelFunc:uG};var dG={kernelName:_h,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,i=t,{allDims:s,summedDims:o,idDims:l}=MN.decodeEinsumEquation(r,i.length);MN.checkEinsumDimSizes(s.length,l,i);let{path:u,steps:c}=MN.getEinsumComputePath(o,l),d=c.length,h=null,p=s.length,f=[];for(let m=0;m<d;++m){for(let e of c[m]){let t,{permutationIndices:a,expandDims:r}=MN.getEinsumPermutation(p,l[e]);MN.isIdentityPermutation(a)?t=i[e]:(t=LV({inputs:{x:i[e]},backend:n,attrs:{perm:a}}),f.push(t));let s=t.shape.slice();for(let e=0;e<r.length;++e)s.splice(r[e],0,1);um.arraysEqual(t.shape,s)||(t=YU({inputs:{x:t},backend:n,attrs:{shape:s}}),f.push(t)),null===h?h=t:(h=_V({inputs:{a:t,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=uG({inputs:{x:h},backend:n,attrs:{axis:u[m]-(s.length-p),keepDims:!1}}),f.push(h)),p--)}for(let m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}};var hG={kernelName:Fh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:a,y:r}=t;sW([a,r],"eluGrad");let i=new Float32Array(um.sizeFromShape(r.shape)),s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values;for(let l=0;l<s.length;++l){let e=s[l];i[l]=e>=0?o[l]:o[l]*(e+1)}return n.makeTensorInfo(r.shape,"float32",i)}},pG=MN.ERF_P,fG=MN.ERF_A1,mG=MN.ERF_A2,gG=MN.ERF_A3,yG=MN.ERF_A4,bG=MN.ERF_A5,vG=OW(Rh,e=>{let t=Math.sign(e),n=Math.abs(e),a=1/(1+pG*n);return t*(1-((((bG*a+yG)*a+gG)*a+mG)*a+fG)*a*Math.exp(-n*n))}),xG={kernelName:Rh,backendName:"cpu",kernelFunc:vG};function wG(e){let{inputs:t,backend:n,attrs:a}=e,{input:r}=t,{dim:i}=a,s=r.shape.length,o=r.shape.slice(),l=i;return i<0&&(um.assert(-(s+1)<=i,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+i+1),o.splice(l,0,1),YU({inputs:{x:r},backend:n,attrs:{shape:o}})}var kG={kernelName:Oh,backendName:"cpu",kernelFunc:wG},SG=hW((e,t)=>e/t),IG=SW(Eh,SG),NG={kernelName:Eh,backendName:"cpu",kernelFunc:IG};function TG(e,t,n){let a=e.shape,r=a[0],i=a[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[r,i],c=um.sizeFromShape(u),d=um.getTypedArrayFromDType("float32",c),h=um.getTypedArrayFromDType("float32",c);for(let g=0;g<r;g++){let e=oU({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,i]}}),a=oU({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),r=pW({inputs:{real:e,imag:a},backend:n}),{real:s,imag:u}=CG(r,t,n),c=MN.mergeRealAndImagArrays(s,u);for(let t=0;t<i;t++){let e=MN.getComplexWithIndex(c,t);d[g*i+t]=e.real,h[g*i+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r)}let p=n.makeTensorInfo(u,"float32",d),f=n.makeTensorInfo(u,"float32",h),m=pW({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}function CG(e,t,n){let a=um.sizeFromShape(e.shape),r=n.data.get(e.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,s=n.data.get(r.complexTensorInfos.imag.dataId).values;if(function(e){return 0===(e&e-1)}(a)){let r=EG(i,s,a,t,n),o=[e.shape[0],e.shape[1]];if(t){let e=n.makeTensorInfo(o,"float32",r.real),t=n.makeTensorInfo(o,"float32",r.imag),i=n.makeTensorInfo([],"float32",um.createScalarValue(a,"float32")),s=gW({inputs:{x:i},backend:n}),l=NG.kernelFunc({inputs:{a:e,b:i},backend:n}),u=NG.kernelFunc({inputs:{a:t,b:s},backend:n}),c=n.data.get(l.dataId).values,d=n.data.get(u.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),{real:c,imag:d}}return r}{let e=function(e,t,n){let a=new Float32Array(2*t);for(let r=0;r<t;r++){let i=0,s=0;for(let a=0;a<t;a++){let o=MN.exponent(r*a,t,n),l=MN.getComplexWithIndex(e,a);i+=l.real*o.real-l.imag*o.imag,s+=l.real*o.imag+l.imag*o.real}n&&(i/=t,s/=t),MN.assignToTypedArray(a,i,s,r)}return a}(MN.mergeRealAndImagArrays(i,s),a,t);return MN.splitRealAndImagArrays(e)}}function EG(e,t,n,a,r){if(1===n)return{real:e,imag:t};let i=MN.mergeRealAndImagArrays(e,t),s=n/2,o=MN.complexWithEvenIndex(i),l=o.real,u=o.imag,c=[l.length],d=r.makeTensorInfo(c,"float32",l),h=r.makeTensorInfo(c,"float32",u),p=pW({inputs:{real:d,imag:h},backend:r}),f=MN.complexWithOddIndex(i),m=f.real,g=f.imag,y=[m.length],b=r.makeTensorInfo(y,"float32",m),v=r.makeTensorInfo(y,"float32",g),x=pW({inputs:{real:b,imag:v},backend:r}),w=EG(l,u,s,a,r),k=w.real,S=w.imag,I=[k.length],N=r.makeTensorInfo(I,"float32",k),T=r.makeTensorInfo(I,"float32",S),C=pW({inputs:{real:N,imag:T},backend:r}),E=EG(m,g,s,a,r),_=E.real,A=E.imag,F=[_.length],R=r.makeTensorInfo(F,"float32",_),D=r.makeTensorInfo(F,"float32",A),M=pW({inputs:{real:R,imag:D},backend:r}),O=MN.exponents(n,a),P=[O.real.length],L=r.makeTensorInfo(P,"float32",O.real),z=r.makeTensorInfo(P,"float32",O.imag),B=pW({inputs:{real:L,imag:z},backend:r}),W=_V({inputs:{a:B,b:M},backend:r}),V=CW({inputs:{a:C,b:W},backend:r}),U=_U({inputs:{a:C,b:W},backend:r}),j=bW({inputs:{input:V},backend:r}),G=bW({inputs:{input:U},backend:r}),H=Mj({inputs:{input:V},backend:r}),q=Mj({inputs:{input:U},backend:r}),K=Pj({inputs:[j,G],backend:r,attrs:{axis:0}}),X=Pj({inputs:[H,q],backend:r,attrs:{axis:0}}),Y=r.data.get(K.dataId).values,Q=r.data.get(X.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(V),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(X),{real:Y,imag:Q}}var _G={kernelName:Lh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=um.sizeFromShape(a.shape),i=a.shape[a.shape.length-1],s=YU({inputs:{x:a},backend:n,attrs:{shape:[r/i,i]}}),o=TG(s,!1,n),l=YU({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}};function AG(e){let{backend:t,attrs:n}=e,{shape:a,value:r,dtype:i}=n,s=i||um.inferDtype(r),o=um.getArrayFromDType(s,um.sizeFromShape(a));return function(e,t){e.fill(t)}(o,r),t.makeTensorInfo(a,s,o)}var FG={kernelName:zh,backendName:"cpu",kernelFunc:AG};var RG={kernelName:Bh,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,i=a,s=um.getTypedArrayFromDType(r.dtype,um.sizeFromShape(r.shape)),[o,l,u,c]=r.shape,d=i.data.get(r.dataId).values;for(let h=0;h<o;h++){let e=h*u*l*c;for(let t=0;t<l;t++){let n=t*(u*c);for(let t=0;t<u;t++){let a=t*c;for(let r=0;r<c;r++){let i=Math.round(u-t-1),o=e+n+a+r,l=d[o];if(i>=0&&i<u){l=d[e+n+i*c+r]}s[o]=l}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var DG={kernelName:Xf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=a,m=zj({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(s){let e=m;if("NCHW"===c&&1===s.shape.length&&1!==s.shape[0]){let e=YU({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=CW({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=CW({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){let e=m;if("NCHW"===c&&"prelu"===p&&1===o.shape.length&&1!==o.shape[0]){let e=YU({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=XU(n,m,p,e,f),n.disposeIntermediateTensorInfo(e)}else m=XU(n,m,p,o,f);n.disposeIntermediateTensorInfo(e)}return m}};var MG={kernelName:Yf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=a,m=eG({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(s){let e=m;m=CW({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){let e=m;m=XU(n,m,p,o,f),n.disposeIntermediateTensorInfo(e)}return m}};var OG={kernelName:Gh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,i=um.sizeFromShape(a.shape),s=r.shape,o=s[s.length-1],[l,u,c,d]=MN.prepareAndValidate(a,r);if(0===u)return n.makeTensorInfo(l,a.dtype,[]);let h=nV(n.data.get(r.dataId).values,n.bufferSync(a),a.dtype,u,o,c,d,a.shape,i);return n.makeTensorInfo(l,a.dtype,h.values)}};var PG={kernelName:jh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:i}=t,{axis:s,batchDims:o}=a;sW([r,i],"gatherV2");let l=um.parseAxisParam(s,r.shape)[0],u=n.data.get(i.dataId).values,c=r.shape[l];for(let v=0;v<u.length;++v){let e=u[v];um.assert(e<=c-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(c-1,"]"))}let d=o;null==o&&(d=0);let h=um.sizeFromShape(i.shape),p=MN.segment_util.collectGatherOpShapeInfo(r,i,l,d),f=YU({inputs:{x:r},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=YU({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),g=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],y=n.bufferSync(m),b=aV(n.bufferSync(f),y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,b.dtype,b.values)}};var LG={kernelName:Xh,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=um.sizeFromShape(a.shape),i=a.shape[a.shape.length-1],s=YU({inputs:{x:a},backend:n,attrs:{shape:[r/i,i]}}),o=TG(s,!0,n),l=YU({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}},zG=OW(Qh,e=>Number.isFinite(e)?1:0,"bool"),BG={kernelName:Qh,backendName:"cpu",kernelFunc:zG},WG=OW(Jh,e=>Math.abs(e)===1/0?1:0,"bool"),VG={kernelName:Jh,backendName:"cpu",kernelFunc:WG},UG=OW(Zh,e=>Number.isNaN(e)?1:0,"bool"),jG={kernelName:Zh,backendName:"cpu",kernelFunc:UG};var GG={kernelName:np,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:i}=n,s=gV(a,r,i);return t.makeTensorInfo([s.length],"float32",s)}},HG=OW(rp,e=>Math.log1p(e)),qG={kernelName:rp,backendName:"cpu",kernelFunc:HG},KG=hW((e,t)=>e&&t),XG=SW(ip,KG,null,"bool"),YG={kernelName:ip,backendName:"cpu",kernelFunc:XG},QG=OW(sp,e=>e?0:1,"bool"),JG={kernelName:sp,backendName:"cpu",kernelFunc:QG},ZG=hW((e,t)=>e||t),$G=SW(op,ZG,null,"bool"),eH={kernelName:op,backendName:"cpu",kernelFunc:$G};var tH={kernelName:dp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=a;sW(r,"LRN");let u=r.shape[3],c=u-1,d=n.data.get(r.dataId).values,h=um.sizeFromShape(r.shape),p=new Float32Array(h);function f(e){let t=e%u,n=e-t+Math.max(0,t-i),a=e-t+Math.min(t+i,c),r=0;for(;n<=a;n++){let e=d[n];r+=e*e}return r}for(let m=0;m<h;m++){let e=f(m),t=d[m]*Math.pow(s+o*e,-l);p[m]=t}return n.makeTensorInfo(r.shape,r.dtype,p)}};var nH={kernelName:hp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=a;sW(s,"LRNGrad");let d=um.sizeFromShape(s.shape),h=s.shape[3],p=n.data.get(s.dataId).values,f=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),y=d;for(let b=0;b<y;b++){let e=b%h,t=b-e+Math.max(0,e-o),n=b-e+Math.min(h,e+o+1),a=0;for(let r=t;r<n;r++)a+=Math.pow(f[r],2);a=u*a+l;for(let r=t;r<n;r++){let e=-2*u*c*f[r]*m[b]/a;b===r&&(e+=Math.pow(a,-c)),e*=p[b],g[r]+=e}}return n.makeTensorInfo(s.shape,r.dtype,g)}};function aH(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reductionIndices:i,keepDims:s}=a,o=n,l=r.shape,u=l.length,c=um.parseAxisParam(i,l),d=c,h=MN.getAxesPermutation(d,u),p=o.data.get(r.dataId).values;if(null!=h){let e=new Array(u);for(let t=0;t<e.length;t++)e[t]=l[h[t]];p=PV(p,l,r.dtype,h,e),d=MN.getInnerMostAxes(d.length,u),l=e}sW(r,"max"),MN.assertAxesAreInnerMostDims("max",d,u);let[f,m]=MN.computeOutAndReduceShapes(l,d),g=xV(p,um.sizeFromShape(m),f,r.dtype),y=o.write(g,f,r.dtype),b=f;return s&&(b=MN.expandShapeToKeepDim(f,c)),{dataId:y,shape:b,dtype:r.dtype}}var rH={kernelName:fp,backendName:"cpu",kernelFunc:aH};var iH={kernelName:gp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;sW(r,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;um.assert(MN.eitherStridesOrDilationsAreOne(s,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(1,"'"));let u,c=MN.computePool2DInfo(r.shape,i,s,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&um.arraysEqual(c.inShape,c.outShape))u=gW({inputs:{x:r},backend:n});else{let e=n.data.get(r.dataId).values,t=um.computeStrides(r.shape),a=xj(e,r.shape,r.dtype,t,c,"max");u=n.makeTensorInfo(c.outShape,r.dtype,a.values)}return u}};var sH={kernelName:bp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=a;sW(r,"maxPool3d");let c=MN.computePool3DInfo(r.shape,i,s,1,o,l,u),d=kj(n.data.get(r.dataId).values,r.shape,r.dtype,um.computeStrides(r.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};var oH={kernelName:vp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a;sW([r,i],"maxPool3DGrad");let c=MN.computePool3DInfo(i.shape,s,o,1,l,u),d=function(e,t){let n=Zy(t.outShape,"int32"),a=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){let b=y*a-h,v=b;for(;v<0;)v+=s;let x=Math.min(t.inDepth,u+b);for(let a=0;a<t.outHeight;++a){let u=a*r-p,h=u;for(;h<0;)h+=o;let w=Math.min(t.inHeight,c+u);for(let r=0;r<t.outWidth;++r){let p=r*i-f,k=p;for(;k<0;)k+=l;let S=Math.min(t.inWidth,d+p),I=Number.NEGATIVE_INFINITY,N=-1;for(let t=v;t<x;t+=s){let n=t-b;for(let a=h;a<w;a+=o){let r=a-u;for(let i=k;i<S;i+=l){let s=i-p,o=e.get(m,t,a,i,g);o>=I&&(I=o,N=n*c*d+r*c+s)}}}n.set(N,m,y,a,r,g)}}}return n}(n.bufferSync(i),c),h=c.strideDepth,p=c.strideHeight,f=c.strideWidth,m=c.dilationDepth,g=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,v=c.effectiveFilterHeight,x=c.effectiveFilterWidth,w=b-1-c.padInfo.front,k=x-1-c.padInfo.left,S=v-1-c.padInfo.top,I=Zy(i.shape,"float32"),N=n.bufferSync(r);for(let T=0;T<c.batchSize;++T)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let a=0;a<c.inWidth;++a){let r=t-w,i=n-S,s=a-k,o=0;for(let t=0;t<b;t+=m){let n=(r+t)/h;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let a=0;a<v;a+=g){let r=(i+a)/p;if(!(r<0||r>=c.outHeight||Math.floor(r)!==r))for(let i=0;i<x;i+=y){let l=(s+i)/f;if(l<0||l>=c.outWidth||Math.floor(l)!==l)continue;let u=b*v*x-1-d.get(T,n,r,l,e)===t*v*x+a*x+i?1:0;0!==u&&(o+=N.get(T,n,r,l,e)*u)}}}I.set(o,T,t,n,a,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};var lH={kernelName:yp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i,output:s}=t,o=i;sW([i,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=a,h=MN.computePool2DInfo(o.shape,l,u,1,c,d),p=n.data.get(o.dataId).values,f=Zy(h.outShape,o.dtype,wj(p,o.shape,o.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,b=h.dilationWidth,v=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,k=v-1-h.padInfo.top,S=Zy(o.shape,"float32"),I=n.data.get(r.dataId).values,N=Zy(r.shape,"float32",I);for(let T=0;T<h.batchSize;++T)for(let e=0;e<h.inChannels;++e)for(let t=0;t<h.inHeight;++t)for(let n=0;n<h.inWidth;++n){let a=t-k,r=n-w,i=0;for(let t=0;t<v;t+=y){let n=(a+t)/m;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let a=0;a<x;a+=b){let s=(r+a)/g;if(s<0||s>=h.outWidth||Math.floor(s)!==s)continue;let o=v*x-1-f.get(T,n,s,e)===t*x+a?1:0;0!==o&&(i+=N.get(T,n,s,e)*o)}}S.set(i,T,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var uH={kernelName:xp,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=n,u=a;sW(r,"MaxPoolWithArgmax");let c=u.data.get(r.dataId).values,d=MN.computePool2DInfo(r.shape,i,s,[1,1],o),[h,p]=function(e,t,n,a,r){let i=xj(e,0,n,um.computeStrides(t),r,"max"),s=wj(e,t,n,r,!0,a);return[i.values,s.values]}(c,r.shape,r.dtype,l,d),f=u.write(h,d.outShape,r.dtype),m=u.write(p,d.outShape,r.dtype);return[{dataId:f,shape:d.outShape,dtype:r.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};var cH={kernelName:wp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a,o=um.parseAxisParam(i,r.shape),l=MN.computeOutAndReduceShapes(r.shape,o)[1],u=um.sizeFromShape(l),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(d);let h=wW({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});c.push(h);let p=IG({inputs:{a:h,b:d},backend:n});c.push(p);let f=uG({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:s}});return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};var dH={kernelName:kp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;sW(r,"min");let o=um.parseAxisParam(i,r.shape),l=o,u=MN.getAxesPermutation(l,r.shape.length),c=r;null!=u&&(c=LV({inputs:{x:r},backend:n,attrs:{perm:u}}),l=MN.getInnerMostAxes(l.length,r.shape.length)),MN.assertAxesAreInnerMostDims("min",l,c.shape.length);let[d,h]=MN.computeOutAndReduceShapes(c.shape,l),p=um.sizeFromShape(h),f=um.makeZerosTypedArray(um.sizeFromShape(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){let e=y*p,t=m[e];for(let n=0;n<p;++n){let a=m[e+n];(Number.isNaN(a)||a<t)&&(t=a)}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(d,c.dtype,f);if(s){let e=YU({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};var hH={kernelName:Ip,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,mode:s}=a;sW(r,"mirrorPad");let o=i.map((e,t)=>e[0]+r.shape[t]+e[1]),l=i.map(e=>e[0]),u=i.map((e,t)=>e[0]+r.shape[t]),c="reflect"===s?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,p=um.computeStrides(r.shape),f=um.sizeFromShape(o),m=o.length,g=um.computeStrides(o),y=um.getTypedArrayFromDType(r.dtype,f);for(let b=0;b<f;b++){let e=um.indexToLoc(b,m,g);for(let n=0;n<m;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-c:e[n]>=u[n]&&(e[n]=2*(u[n]-1)-e[n]+c);e=e.map((e,t)=>e-l[t]);let t=um.locToIndex(e,h,p);y[b]=d[t]}return{dataId:n.write(y,o,r.dtype),shape:o,dtype:r.dtype}}},pH=hW((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),fH=SW(Np,pH),mH={kernelName:Np,backendName:"cpu",kernelFunc:fH},gH=rc(gc());function yH(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:i}=a,s=r.shape.length,o=i;if(-1===o&&(o=s-1),o!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(s," and dim was ").concat(o));let l=um.parseAxisParam([o],r.shape),u=aH({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=MN.expandShapeToKeepDim(u.shape,l),d=YU({inputs:{x:u},backend:n,attrs:{shape:c}}),h=_U({inputs:{a:r,b:d},backend:n}),p=HW({inputs:{x:h},backend:n}),f=uG({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),m=YU({inputs:{x:f},backend:n,attrs:{shape:c}}),g=IG({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var bH={kernelName:vf,backendName:"cpu",kernelFunc:yH};var vH={kernelName:Tp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:i,seed:s,normalized:o}=a;sW(r,"multinomial");let l=o?r:yH({inputs:{logits:r},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,h=[u,i],p=um.makeZerosTypedArray(um.sizeFromShape(h),"int32");for(let f=0;f<u;++f){let e=f*c,t=new Float32Array(c-1);t[0]=d[e];for(let r=1;r<t.length;++r)t[r]=t[r-1]+d[e+r];let n=gH.alea(s.toString()),a=f*i;for(let r=0;r<i;++r){let e=n();p[a+r]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){p[a+r]=n;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",p)}},xH=WT.nonMaxSuppressionV3Impl;var wH={kernelName:Ap,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=a;sW(r,"NonMaxSuppression");let u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d}=xH(u,c,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},kH=WT.nonMaxSuppressionV4Impl;var SH={kernelName:Fp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=a;sW(r,"NonMaxSuppressionPadded");let c=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:p}=kH(c,d,s,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},IH=WT.nonMaxSuppressionV5Impl;var NH={kernelName:Rp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=a;sW(r,"NonMaxSuppressionWithScore");let c=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=s,p=o,f=l,m=u,{selectedIndices:g,selectedScores:y}=IH(c,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};var TH={kernelName:Mp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:i,depth:s,onValue:o,offValue:l}=a;sW(r,"oneHot");let u=um.sizeFromShape(r.shape),c=new Float32Array(u*s);c.fill(l);let d=n.data.get(r.dataId).values;for(let h=0;h<u;++h)d[h]>=0&&d[h]<s&&(c[h*s+d[h]]=o);return n.makeTensorInfo([...r.shape,s],i,c)}};function CH(e){let{inputs:t,backend:n}=e,{x:a}=t;if("string"===a.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===a.dtype){let e=bW({inputs:{input:a},backend:n}),t=CH({inputs:{x:e},backend:n}),r=Mj({inputs:{input:a},backend:n}),i=CH({inputs:{x:r},backend:n}),s=pW({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}return AG({backend:n,attrs:{shape:a.shape,value:0,dtype:a.dtype}})}var EH={kernelName:jf,backendName:"cpu",kernelFunc:CH};var _H={kernelName:Dp,backendName:"cpu",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){let t=bW({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),i=Mj({inputs:{input:r},backend:a}),s=CH({inputs:{x:i},backend:a}),o=pW({inputs:{real:n,imag:s},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}return AG({backend:a,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}};function AH(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return wG({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{um.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),um.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=Pj({inputs:t.map(e=>{let t=wG({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}var FH={kernelName:Op,backendName:"cpu",kernelFunc:AH};var RH={kernelName:Pp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,constantValue:s}=a;sW(r,"pad");let o=i.map((e,t)=>e[0]+r.shape[t]+e[1]),l=i.map(e=>e[0]),u=n.data.get(r.dataId).values,c=um.sizeFromShape(r.shape),d=r.shape.length,h=um.computeStrides(r.shape),p=um.sizeFromShape(o),f=o.length,m=um.computeStrides(o),g=um.getTypedArrayFromDType(r.dtype,p);0!==s&&g.fill(s);for(let y=0;y<c;y++){let e=um.indexToLoc(y,d,h).map((e,t)=>e+l[t]);g[um.locToIndex(e,f,m)]=u[y]}return{dataId:n.write(g,o,r.dtype),shape:o,dtype:r.dtype}}},DH=hW((e,t)=>Math.pow(e,t)),MH=SW(zp,DH),OH={kernelName:zp,backendName:"cpu",kernelFunc:MH};var PH={kernelName:Vp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.data.get(e.dataId).values),u=r.map(e=>e.shape),c=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,[h,p,f]=GV(l,u,c,i.shape,i.dtype,d,s.shape),m=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}};var LH={kernelName:Up,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:i}=t,s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[u,c]=qV(s,a.shape,a.dtype,o,r.shape,l,i.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],a.dtype,c)]}};var zH={kernelName:jp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,h=o.map(e=>n.data.get(e.dataId).values),p=o.map(e=>e.shape),[f,m]=JV(u,r.shape,c,i.shape,i.dtype,d,s.shape,h,p,l);return n.makeTensorInfo(f,i.dtype,m)}};var BH={kernelName:Gp,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,dtype:i,step:s}=n,o=ZV(a,r,s,i);return t.makeTensorInfo([o.length],i,o)}},WH=OW(qp,e=>1/e),VH={kernelName:qp,backendName:"cpu",kernelFunc:WH};var UH={kernelName:Jp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a;sW(r,"resizeBilinear");let l=um.computeStrides(r.shape),[u,c]=o,[d,h,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(um.sizeFromShape([d,u,c,f])),y=[i&&u>1?h-1:h,i&&c>1?p-1:p],b=[i&&u>1?u-1:u,i&&c>1?c-1:c],v=0,x=y[0]/b[0],w=y[1]/b[1];for(let k=0;k<d;k++)for(let e=0;e<u;e++){let t;t=s?x*(e+.5)-.5:x*e;let n=Math.max(0,Math.floor(t)),a=t-n,r=Math.min(h-1,Math.ceil(t)),i=k*l[0]+n*l[1],o=k*l[0]+r*l[1];for(let e=0;e<c;e++){let t;t=s?w*(e+.5)-.5:w*e;let n=Math.max(0,Math.floor(t)),r=t-n,u=Math.min(p-1,Math.ceil(t)),c=i+n*l[2],d=o+n*l[2],h=i+u*l[2],y=o+u*l[2];for(let e=0;e<f;e++){let t=m[c+e],n=m[d+e],i=t+(m[h+e]-t)*r,s=i+(n+(m[y+e]-n)*r-i)*a;g[v++]=s}}}return n.makeTensorInfo([d,u,c,f],"float32",g)}};var jH={kernelName:Zp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a;sW([i,r],"resizeBilinearGrad");let o=um.computeStrides(r.shape),[l,u,c,d]=r.shape,[,h,p]=i.shape,f=new Float32Array(l*u*c*d),m=[s&&h>1?u-1:u,s&&p>1?c-1:c],g=[s&&h>1?h-1:h,s&&p>1?p-1:p],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(i.dataId).values,x=0;for(let w=0;w<l;w++){let e=w*o[0];for(let t=0;t<h;t++){let n=t*y,a=Math.floor(n),r=Math.min(Math.ceil(n),u-1),i=e+a*o[1],s=e+r*o[1],l=n-a,h=1-l;for(let e=0;e<p;e++){let t=e*b,n=Math.floor(t),a=Math.min(Math.ceil(t),c-1),r=t-n,u=1-r,p=i+n*o[2],m=i+a*o[2],g=s+n*o[2],y=s+a*o[2],w=h*u,k=h*r,S=l*u,I=l*r;for(let e=0;e<d;e++){let t=v[x++];f[p+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[y+e]+=t*I}}}}return n.makeTensorInfo([l,c,u,d],"float32",f)}};var GH={kernelName:Yp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a;sW(r,"resizeNearestNeighbor");let l=um.computeStrides(r.shape),[u,c]=o,[d,h,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*u*c*f),y=[i&&u>1?h-1:h,i&&c>1?p-1:p],b=[i&&u>1?u-1:u,i&&c>1?c-1:c],v=y[0]/b[0],x=y[1]/b[1],w=0;for(let k=0;k<d;k++){let e=k*l[0];for(let t=0;t<u;t++){let n=s?v*(t+.5):v*t,a=Math.min(h-1,i?Math.round(n):Math.floor(n));s&&(a=Math.max(0,a));let r=e+a*l[1];for(let e=0;e<c;e++){let t=s?x*(e+.5):x*e,n=Math.min(p-1,i?Math.round(t):Math.floor(t));s&&(n=Math.max(0,n));let a=r+n*l[2];for(let e=0;e<f;e++){let t=m[a+e];g[w++]=t}}}}return n.makeTensorInfo([d,u,c,f],r.dtype,g)}};var HH={kernelName:Qp,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a;sW([i,r],"resizeNearestNeighborGrad");let o=um.computeStrides(r.shape),l=um.computeStrides(i.shape),[u,c,d,h]=r.shape,[,p,f]=i.shape,m=new Float32Array(u*c*d*h),g=n.data.get(i.dataId).values,y=[s&&p>1?c-1:c,s&&f>1?d-1:d],b=[s&&p>1?p-1:p,s&&f>1?f-1:f],v=y[0]/b[0],x=y[1]/b[1],w=1/v,k=1/x,S=2*Math.ceil(w)+2,I=2*Math.ceil(k)+2;for(let N=0;N<u;N++){let e=N*o[0];for(let t=0;t<c;t++){let n=e+t*o[1],a=Math.floor(t*w),r=Math.floor(a-S/2);for(let i=0;i<d;i++){let a=n+i*o[2],u=Math.floor(i*k),y=Math.floor(u-I/2);for(let n=0;n<h;n++){let o=0;for(let a=0;a<S;a++){let u=a+r;if(u<0||u>=p)continue;let h=e+u*l[1],m=u*v;if(t===Math.min(c-1,s?Math.round(m):Math.floor(m)))for(let e=0;e<I;e++){let t=e+y;if(t<0||t>=f)continue;let a=h+t*l[2],r=t*x;i===Math.min(d-1,s?Math.round(r):Math.floor(r))&&(o+=g[a+n])}}m[a+n]=o}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}};var qH={kernelName:ef,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:i}=a;sW(r,"reverse");let s=r.shape.length,o=um.parseAxisParam(i,r.shape);if(0===s)return gW({inputs:{x:r},backend:n});let l=new Vm(r.shape,r.dtype),u=n.bufferSync(r);for(let c=0;c<l.size;c++){let e=l.indexToLoc(c),t=e.slice();o.forEach(e=>t[e]=r.shape[e]-1-t[e]),l.set(u.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},KH={kernelName:qf,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:i,fillValue:s,center:o}=n,l=a,u=um.getTypedArrayFromDType(r.dtype,um.sizeFromShape(r.shape)),[c,d,h,p]=r.shape,[f,m]=MN.getImageCenter(o,d,h),g=Math.sin(i),y=Math.cos(i),b=l.data.get(r.dataId).values;for(let v=0;v<c;v++){let e=v*h*d*p;for(let t=0;t<d;t++){let n=t*(h*p);for(let a=0;a<h;a++){let r=a*p;for(let i=0;i<p;i++){let o=[c,t,a,i],l=o[2],v=o[1],x=(l-f)*y-(v-m)*g,w=(l-f)*g+(v-m)*y;x=Math.round(x+f),w=Math.round(w+m);let k=s;if("number"!=typeof s&&(k=3===i?255:s[i]),x>=0&&x<h&&w>=0&&w<d){k=b[e+w*(h*p)+x*p+i]}u[e+n+r+i]=k}}}}return{dataId:l.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},XH=OW(tf,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),YH={kernelName:tf,backendName:"cpu",kernelFunc:XH};var QH={kernelName:af,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r,updates:i}=t,{shape:s}=a,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=MN.calculateShapes(i,r,s),h=nU(n.bufferSync(r),n.bufferSync(i),s,d,u,l,o,c,0,!0);return n.makeTensorInfo(s,h.dtype,h.values)}};function JH(e,t){let n=0,a=e.length,r=0;for(;n<a;)r=Math.floor((n+a)/2),e[r]<t?n=r+1:a=r;return a}function ZH(e,t){let n=0,a=e.length,r=0;for(;n<a;)r=Math.floor((n+a)/2),e[r]<=t?n=r+1:a=r;return a}var $H={kernelName:sf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:i}=t,{side:s}=a,o=function(e,t,n,a,r,i){let s=um.getArrayFromDType("int32",n*r);for(let o=0;o<n;++o){let n=e.slice(o*a,(o+1)*a),l=o*r;for(let e=0;e<r;++e)s[l+e]="left"===i?JH(n,t[e+l]):ZH(n,t[e+l])}return s}(n.data.get(r.dataId).values,n.data.get(i.dataId).values,r.shape[0],r.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",o)}};var eq={kernelName:of,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:i}=t;sW([a,r,i],"select");let s=a.shape.length,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,c=tg(r.dtype,i.dtype),d=um.makeZerosTypedArray(um.sizeFromShape(r.shape),c),h=0,p=0===s||s>1||1===r.shape.length?1:um.sizeFromShape(r.shape.slice(1));for(let f=0;f<o.length;f++)for(let e=0;e<p;e++)1===o[f]?d[h++]=l[f]:d[h++]=u[f];return n.makeTensorInfo(r.shape,c,d)}},tq=MN.SELU_SCALEALPHA,nq=MN.SELU_SCALE,aq=OW(lf,e=>e>=0?nq*e:tq*(Math.exp(e)-1)),rq={kernelName:lf,backendName:"cpu",kernelFunc:aq},iq=OW(hf,e=>e<0?-1:e>0?1:0),sq={kernelName:hf,backendName:"cpu",kernelFunc:iq},oq=OW(cf,e=>Math.sin(e)),lq={kernelName:cf,backendName:"cpu",kernelFunc:oq},uq=OW(df,e=>Math.sinh(e)),cq={kernelName:df,backendName:"cpu",kernelFunc:uq},dq=Math.log(1.1920928955078125e-7)+2,hq=OW(ff,e=>{let t,n=e>-dq,a=e<dq,r=Math.exp(e);return t=a?r:n?e:Math.log(1+r),t}),pq={kernelName:ff,backendName:"cpu",kernelFunc:hq};var fq={kernelName:yf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,paddings:s}=a;sW([r],"spaceToBatchND");let o=um.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<r.shape.length;++g)l.push([0,0]);let u=RH.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),c=MN.getReshaped(u.shape,i,o,!1),d=MN.getPermuted(c.length,i.length,!1),h=MN.getReshapedPermuted(u.shape,i,o,!1),p=YU({inputs:{x:u},backend:n,attrs:{shape:c}}),f=LV({inputs:{x:p},backend:n,attrs:{perm:d}}),m=YU({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}};var mq={kernelName:xf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(r.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values[0],[d,h,p,f,m]=uU(o,a.shape,a.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(h,a.dtype,d),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}};var gq={kernelName:wf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:i}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.data.get(r.dataId).values),o=n.data.get(a.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,d]=cU(o,a.shape,a.dtype,s,l);return[n.makeTensorInfo(c,a.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}};var yq={kernelName:kf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(r.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[u,c]=dU(s,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(c,a.dtype,u)}};var bq={kernelName:Sf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(r.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[u,c]=dU(s,a.shape,a.dtype,o,l);return n.makeTensorInfo(c,a.dtype,u)}};var vq={kernelName:If,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=n,{outputShape:l}=r,{sliceRank:u,numUpdates:c,sliceSize:d,strides:h,outputSize:p}=MN.calculateShapes(s,i,l),f=!1,m=a.bufferSync(i);switch(s.dtype){case"bool":t=nU(m,a.bufferSync(s),l,p,d,c,u,h,!!a.data.get(o.dataId).values[0],f);break;case"float32":case"int32":t=nU(m,a.bufferSync(s),l,p,d,c,u,h,a.data.get(o.dataId).values[0],f);break;case"string":t=nU(m,a.bufferSync(s),l,p,d,c,u,h,um.decodeString(a.data.get(o.dataId).values[0]),f);break;default:throw new Error("Unsupported type ".concat(s.dtype))}return a.makeTensorInfo(l,t.dtype,t.values)}};var xq={kernelName:bf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:i,axis:s}=a,o=um.parseAxisParam(s,r.shape)[0],l=MN.prepareSplitSize(r,i,o),u=new Array(r.shape.length).fill(0),c=r.shape.slice();return l.map(e=>{let t=[...c];t[o]=e;let a=oU({inputs:{x:r},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,a})}},wq={kernelName:Tf,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e,{x:a}=t,r=n;sW(a,"square");let i=r.data.get(a.dataId).values,s=new Float32Array(i.length);for(let o=0;o<i.length;++o){let e=i[o];s[o]=e*e}return{dataId:r.write(s,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},kq=OW(Gf,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),Sq={kernelName:Gf,backendName:"cpu",kernelFunc:kq};var Iq={kernelName:Ef,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=a;sW(r,"stridedSlice");let p,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=lN.sliceInfo(r.shape,i,s,o,l,u,c,d,h);if(g)p=YU({inputs:{x:r},backend:n,attrs:{shape:m}});else if(y||b){um.assert(r.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(r.shape.length));let e=lN.computeOutShape(v,x,w),t=oU({inputs:{x:r},backend:n,attrs:{begin:v,size:e}});p=YU({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{let e=wU(f,n.bufferSync(r),w,v);p=n.makeTensorInfo(m,e.dtype,e.values)}return p}};var Nq={kernelName:_f,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=a,{data:c,dataSplits:d}=t,h=n.data.get(c.dataId).values,p=n.data.get(d.dataId).values,[f,m]=SU(h,p,r,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};var Tq={kernelName:Af,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==s.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[u,c,d]=NU(o,l,r),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var Cq={kernelName:Ff,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");let s=TU(n.data.get(i.dataId).values,r);return n.makeTensorInfo(i.shape,"int32",s)}},Eq=OW(Df,e=>Math.tan(e)),_q={kernelName:Df,backendName:"cpu",kernelFunc:Eq},Aq=OW(Mf,e=>Math.tanh(e));var Fq={kernelName:rf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{tensor:a,indices:r,updates:i}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=MN.calculateShapes(i,r,a.shape),d=n.bufferSync(r),h=n.bufferSync(i),p=n.bufferSync(a),f=nU(d,h,a.shape,c,l,o,s,u,p,!1);return n.makeTensorInfo(a.shape,f.dtype,f.values)}};var Rq={kernelName:Of,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:i}=a;sW(r,"tile");let s=FU(n.bufferSync(r),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}};var Dq={kernelName:Pf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:i,sorted:s}=a;sW(r,"topk");let o=n.data.get(r.dataId).values,[l,u]=MU(o,r.shape,r.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}};var Mq={kernelName:Lf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{image:r,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=n,[c,d,h,p]=r.shape,[f,m]=null!=u?u:[d,h],g=[c,f,m,p],y=um.computeStrides(r.shape),b=y[0],v=y[1],x=y[2],w=um.computeStrides(g),k=w[0],S=w[1],I=w[2],N=um.getTypedArrayFromDType(r.dtype,um.sizeFromShape(g));N.fill(l);let T=a.data.get(r.dataId).values,C=a.data.get(i.dataId).values;for(let E=0;E<c;++E){let e=1===i.shape[0]?C:C.subarray(8*E,8*E+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let a=0;a<p;++a){let r,i=e[6]*n+e[7]*t+1;if(0===i)continue;let u=(e[0]*n+e[1]*t+e[2])/i,c=(e[3]*n+e[4]*t+e[5])/i,p=Oq(u,h,o),f=Oq(c,d,o);switch(s){case"nearest":r=Lq(T,d,h,b,v,x,E,f,p,a,l);break;case"bilinear":r=zq(T,d,h,b,v,x,E,f,p,a,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or 'bilinear', but got ".concat(s))}N[E*k+t*S+n*I+a]=r}return a.makeTensorInfo(g,r.dtype,N)}return{dataId:a.write(N,g,r.dtype),shape:r.shape,dtype:r.dtype}}};function Oq(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{let e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return um.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{let e=t-1;n-=t*Math.trunc(n/e)}return um.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return um.clamp(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function Pq(e,t,n,a,r,i,s,o,l,u,c){return 0<=o&&o<t&&0<=l&&l<n?e[s*a+o*r+l*i+u]:c}function Lq(e,t,n,a,r,i,s,o,l,u,c){return Pq(e,t,n,a,r,i,s,Math.round(o),Math.round(l),u,c)}function zq(e,t,n,a,r,i,s,o,l,u,c){let d=Math.floor(o),h=Math.floor(l),p=d+1,f=h+1;return(p-o)*((f-l)*Pq(e,t,n,a,r,i,s,d,h,u,c)+(l-h)*Pq(e,t,n,a,r,i,s,d,f,u,c))+(o-d)*((f-l)*Pq(e,t,n,a,r,i,s,p,h,u,c)+(l-h)*Pq(e,t,n,a,r,i,s,p,f,u,c))}var Bq={kernelName:Bf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:i}=t;sW(i,"unique");let s=a.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:u}=OU(s,r,i.shape,i.dtype);return[a.makeTensorInfo(l,i.dtype,o),a.makeTensorInfo([u.length],"int32",u)]}};var Wq={kernelName:Wf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:i}=a;i<0&&(i+=r.shape.length);let s=r.shape.length,o=r.shape[i],l=new Array(s-1),u=0;for(let p=0;p<s;p++)p!==i&&(l[u++]=r.shape[p]);let c=new Array(s).fill(0),d=r.shape.slice();d[i]=1;let h=new Array(o);for(let p=0;p<h.length;p++){c[i]=p;let e=oU({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});h[p]=YU({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return h}};var Vq={kernelName:Vf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:i}=t,{numSegments:s}=a;sW(r,"unsortedSegmentSum");let o=[],l=[],u=r.shape.length-i.shape.length,c=i;for(let h=0;h<u;++h){let e=wG({inputs:{input:c},backend:n,attrs:{dim:h+1}});c=e,l.push(e)}for(let h=0;h<s;++h){let e=um.createScalarValue(h,"int32"),t=n.makeTensorInfo([],"int32",e),a=UW({inputs:{a:t,b:c},backend:n}),i=wW({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),s=_V({inputs:{a:i,b:r},backend:n}),u=uG({inputs:{x:s},backend:n,attrs:{axis:0,keepDims:!1}});o.push(u),l.push(t),l.push(a),l.push(i),l.push(s),l.push(u)}let d=AH({inputs:o,backend:n,attrs:{axis:0}});return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}},Uq=[$U,dW,tj,aj,EW,rj,ij,sj,oj,lj,cj,hj,fj,yj,vj,Sj,Ij,Nj,Tj,ZU,Cj,Ej,_j,DW,Aj,kW,BW,Rj,fW,Dj,Lj,Bj,Wj,Vj,Uj,jj,Gj,qj,Xj,Yj,Qj,Jj,Zj,$j,tG,nG,aG,rG,iG,sG,oG,lG,dG,zU,hG,jW,xG,qW,kG,YW,_G,FG,RG,ZW,tV,DG,MG,OG,PG,sV,uV,yW,LG,Oj,BG,VG,jG,WU,hV,mV,GG,vV,qG,YG,JG,eH,tH,nH,rH,SV,iH,sH,oH,lH,uH,cH,dH,TV,hH,mH,vH,AV,RV,wH,SH,NH,OV,TH,_H,FH,RH,OH,jU,WV,PH,LH,zH,BH,vW,NG,VH,HU,KU,QU,UH,jH,GH,HH,qH,KH,YH,tU,QH,$H,eq,rq,iU,sq,lq,cq,lU,bH,pq,fq,mq,gq,yq,bq,vq,xq,fU,wq,yU,xU,Sq,Iq,Nq,Tq,Cq,AU,cG,_q,{kernelName:Mf,backendName:"cpu",kernelFunc:Aq},Fq,Rq,Dq,Mq,zV,Bq,Wq,Vq,EH];for(let n of Uq)am(n);var jq={};ac(jq,{assertNotComplex:()=>ZK,bindCanvasToFramebuffer:()=>EK,bindColorTextureToFramebuffer:()=>_K,bindTextureToProgramUniformSampler:()=>CK,bindTextureUnit:()=>SK,bindVertexBufferToProgramAttribute:()=>kK,callAndCheck:()=>tK,canBeRepresented:()=>rK,createFragmentShader:()=>lK,createFramebuffer:()=>wK,createProgram:()=>pK,createStaticIndexBuffer:()=>yK,createStaticVertexBuffer:()=>gK,createTexture:()=>vK,createVertexShader:()=>oK,getBatchDim:()=>OK,getExtensionOrThrow:()=>sK,getFramebufferErrorMessage:()=>RK,getMaxTexturesInShader:()=>GK,getNumChannels:()=>bK,getProgramUniformLocation:()=>TK,getProgramUniformLocationOrThrow:()=>NK,getRowsCols:()=>PK,getShapeAs3D:()=>LK,getTextureShapeFromLogicalShape:()=>zK,getWebGLDisjointQueryTimerVersion:()=>HK,getWebGLErrorMessage:()=>iK,getWebGLMaxTextureSize:()=>VK,hasExtension:()=>qK,isCapableOfRenderingToFloatTexture:()=>XK,isDownloadFloatTextureEnabled:()=>YK,isReshapeFree:()=>WK,isWebGLFenceEnabled:()=>JK,isWebGLVersionEnabled:()=>KK,linkProgram:()=>fK,logShaderSourceAndInfoLog:()=>hK,resetMaxTextureSize:()=>UK,resetMaxTexturesInShader:()=>jK,unbindColorTextureFromFramebuffer:()=>AK,unbindTextureUnit:()=>IK,validateFramebuffer:()=>FK,validateProgram:()=>mK,validateTextureSize:()=>xK});var Gq,Hq,qq,Kq={},Xq={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Yq(e,t){Kq[e]=t}function Qq(e,t){if(!(e in Kq)||null!=t){let n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if(!Td().getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;return n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete Kq[e]},!1),Td().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xq.failIfMajorPerformanceCaveat=!1),1===e?n.getContext("webgl",Xq)||n.getContext("experimental-webgl",Xq):n.getContext("webgl2",Xq)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;Kq[e]=n}let n=Kq[e];return null==n||n.isContextLost()?(delete Kq[e],Qq(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Kq[e])}function Jq(e,t){return[t,e]}function Zq(e){let t=um.sizeFromShape(e),n=Math.ceil(t/4);return um.sizeToSquarishShape(n)}function $q(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function eK(e,t){let n,a,r,i,s,o,l,u,c,d,h=e;return 2===Td().getNumber("WEBGL_VERSION")?(n=h.R32F,a=h.R16F,r=h.RGBA16F,i=h.RGBA32F,s=h.RED,l=4,u=1,c=h.HALF_FLOAT,d=h.FLOAT,o=h.RGBA8):(n=e.RGBA,a=e.RGBA,r=e.RGBA,i=h.RGBA,s=e.RGBA,l=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,o=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:o,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:d}}function tK(e,t){let n=t();return Td().getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+iK(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Gq||(Gq={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Hq||(Hq={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(qq||(qq={}));var nK=5.96e-8,aK=65504;function rK(e){return!!(Td().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||nK<Math.abs(e)&&Math.abs(e)<aK)}function iK(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}function sK(e,t){return DK(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function oK(e,t){let n=DK(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(tK(e,()=>e.shaderSource(n,t)),tK(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function lK(e,t){let n=DK(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(tK(e,()=>e.shaderSource(n,t)),tK(e,()=>e.compileShader(n)),Td().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw hK(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var uK,cK,dK=/ERROR: [0-9]+:([0-9]+):/g;function hK(e,t){let n=dK.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);let a=+n[1],r=e.split("\n"),i=r.length.toString().length+2,s=r.map((e,t)=>um.rightPad((t+1).toString(),i)+e),o=0;for(let d=0;d<s.length;d++)o=Math.max(s[d].length,o);let l=s.slice(0,a-1),u=s.slice(a-1,a),c=s.slice(a);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(um.rightPad(u[0],o)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function pK(e){return DK(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function fK(e,t){if(tK(e,()=>e.linkProgram(t)),!Td().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function mK(e,t){if(tK(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function gK(e,t){let n=DK(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return tK(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),tK(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function yK(e,t){let n=DK(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return tK(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),tK(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function bK(){return 2===Td().getNumber("WEBGL_VERSION")?1:4}function vK(e){return DK(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function xK(e,t){let n=Td().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){let a="[".concat(e,"x").concat(t,"]"),r="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+r+".")}}function wK(e){return DK(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function kK(e,t,n,a,r,i,s){let o=e.getAttribLocation(t,n);return-1!==o&&(tK(e,()=>e.bindBuffer(e.ARRAY_BUFFER,a)),tK(e,()=>e.vertexAttribPointer(o,r,e.FLOAT,!1,i,s)),tK(e,()=>e.enableVertexAttribArray(o)),!0)}function SK(e,t,n){MK(e,n),tK(e,()=>e.activeTexture(e.TEXTURE0+n)),tK(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function IK(e,t){MK(e,t),tK(e,()=>e.activeTexture(e.TEXTURE0+t)),tK(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function NK(e,t,n){return DK(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function TK(e,t,n){return e.getUniformLocation(t,n)}function CK(e,t,n,a){tK(e,()=>SK(e,t,a)),tK(e,()=>e.uniform1i(n,a))}function EK(e){tK(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),tK(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),tK(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function _K(e,t,n){tK(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),tK(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function AK(e,t){tK(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),tK(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function FK(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+RK(e,t))}function RK(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}function DK(e,t,n){let a=tK(e,()=>t());if(null==a)throw new Error(n);return a}function MK(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n){let e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function OK(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return um.sizeFromShape(e.slice(0,e.length-t))}function PK(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function LK(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[OK(e),...PK(e)]),t}function zK(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Td().getNumber("WEBGL_MAX_TEXTURE_SIZE"),a=Td().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");a===1/0&&Td().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(a=n/2),t&&(n*=2,a*=2,1===(e=e.map((t,n)=>n>=e.length-2?um.nearestLargerEven(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length&&(e=um.squeezeShape(e).newShape);let r=um.sizeFromShape(e),i=null;e.length<=1&&r<=n?i=[1,r]:2===e.length&&e[0]<=n&&e[1]<=n?i=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);let s=null!=i&&Math.max(...i)>a&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(null==i||s)if(t){let t=OK(e),n=2,a=2;e.length&&([n,a]=PK(e)),r=t*(n/2)*(a/2),i=um.sizeToSquarishShape(r).map(e=>2*e)}else i=um.sizeToSquarishShape(r);return i}function BK(e){return e%2===0}function WK(e,t){if(e=e.slice(-2),t=t.slice(-2),um.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e[e.length-1],a=t[t.length-1];if(n===a||BK(n)&&BK(a)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&BK(e[0])&&BK(t[0])}function VK(e){if(null==uK){let t=Qq(e);uK=t.getParameter(t.MAX_TEXTURE_SIZE)}return uK}function UK(){uK=null}function jK(){cK=null}function GK(e){if(null==cK){let t=Qq(e);cK=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,cK)}function HK(e){if(0===e)return 0;let t,n=Qq(e);return t=qK(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:qK(n,"EXT_disjoint_timer_query")?1:0,t}function qK(e,t){return null!=e.getExtension(t)}function KK(e){try{if(null!=Qq(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function XK(e){if(0===e)return!1;let t=Qq(e);if(1===e){if(!qK(t,"OES_texture_float"))return!1}else if(!qK(t,"EXT_color_buffer_float"))return!1;return QK(t)}function YK(e){if(0===e)return!1;let t=Qq(e);if(1!==e){if(qK(t,"EXT_color_buffer_float"))return QK(t);let e="EXT_color_buffer_half_float";if(qK(t,e)){let n=t.getExtension(e);return function(e,t){let n=eK(e,t),a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(a),e.deleteFramebuffer(r),i}(t,n)}return!1}return!(!qK(t,"OES_texture_float")||!qK(t,"WEBGL_color_buffer_float"))&&QK(t)}function QK(e){let t=eK(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),r}function JK(e){return 2===e&&null!=Qq(e).fenceSync}function ZK(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&um.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the WebGL backend."))})}var $K=Td();function eX(){let e,t,n,a,r,i,s,o,l,u;return 2===Td().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",a="in",r="texture",i="outputColor",s="out vec4 outputColor;",o=Td().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",a="varying",r="texture2D",i="gl_FragColor",s="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:r,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function tX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=um.computeStrides(t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / ").concat(t),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(t):"index -= ".concat(e[r]," * ").concat(t);return"".concat(i,"; ").concat(s,";")}).join("")}function nX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=um.computeStrides(t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / outShapeStrides[").concat(r,"]"),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * outShapeStrides[").concat(r,"]"):"index -= ".concat(e[r]," * outShapeStrides[").concat(r,"]");return"".concat(i,"; ").concat(s,";")}).join("")}function aX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=function(e,t){let n=e.length,a=e.map(e=>"".concat(t,"[").concat(e,"]")),r=new Array(n-1);r[n-2]=a[n-1];for(let i=n-3;i>=0;--i)r[i]="(".concat(r[i+1]," * ").concat(a[i+1],")");return r}(e.map((e,t)=>t),t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(s,";")}).join("")}function rX(e){let t=um.computeStrides(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}$K.registerFlag("HAS_WEBGL",()=>$K.getNumber("WEBGL_VERSION")>0),$K.registerFlag("WEBGL_VERSION",()=>KK(2)?2:KK(1)?1:0),$K.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),$K.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===$K.get("WEBGL_VERSION")),$K.registerFlag("WEBGL_CPU_FORWARD",()=>!0),$K.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),$K.registerFlag("WEBGL_PACK",()=>$K.getBool("HAS_WEBGL")),$K.registerFlag("WEBGL_PACK_NORMALIZATION",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_CLIP",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_REDUCE",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_LAZILY_UNPACK",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_CONV_IM2COL",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>$K.getBool("WEBGL_PACK")),$K.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>VK($K.getNumber("WEBGL_VERSION"))),$K.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>GK($K.getNumber("WEBGL_VERSION"))),$K.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=$K.getNumber("WEBGL_VERSION");return 0===e?0:HK(e)}),$K.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>$K.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!yg.isMobile()),$K.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>XK($K.getNumber("WEBGL_VERSION"))),$K.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!$K.getBool("WEBGL_FORCE_F16_TEXTURES")&&$K.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),$K.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>YK($K.getNumber("WEBGL_VERSION"))),$K.registerFlag("WEBGL_FENCE_API_ENABLED",()=>JK($K.getNumber("WEBGL_VERSION"))),$K.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>$K.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),$K.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!=typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ".concat(e,"."))}),$K.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>yg.isMobile()?1:-1,e=>{if("number"!=typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ".concat(e,"."))}),$K.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),$K.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),$K.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),$K.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),$K.registerFlag("WEBGL_EXP_CONV",()=>!1),$K.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>$K.getBool("IS_TEST")),$K.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),$K.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),$K.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),$K.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);var iX="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:sX}=MN;function oX(e,t,n){let a=[];if(e.forEach(e=>{let t=um.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){let{uniformShape:t}=yX(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:a.push("uniform int ".concat(e.name,"Shape;"));break;case 2:a.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:a.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:a.push("uniform ivec4 ".concat(e.name,"Shape;"))}a.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:a.push("uniform int outShape;");break;case 2:a.push("uniform ivec2 outShape;"),a.push("uniform int outShapeStrides;");break;case 3:a.push("uniform ivec3 outShape;"),a.push("uniform ivec2 outShapeStrides;");break;case 4:a.push("uniform ivec4 outShape;"),a.push("uniform ivec3 outShapeStrides;")}a.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{a.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});let r,i,s=a.join("\n"),o=e.map(e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r="";r+=n?uX(e,a):lX(e,a);let i=e.shapeInfo.logicalShape,s=t.logicalShape;return i.length<=s.length&&(r+=n?function(e,t){let n,a=e.name,r=a.charAt(0).toUpperCase()+a.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,l=sX(e.shapeInfo.logicalShape,t.logicalShape),u=gX(o),c=o-s,d=["x","y","z","w","u","v"];n=0===s?"":o<2&&l.length>=1?"coords = 0;":l.map(e=>"coords.".concat(d[e+c]," = 0;")).join("\n");let h="";h=o<2&&s>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(d[t+c])).join(", ");let p="return outputValue;",f=1===um.sizeFromShape(e.shapeInfo.logicalShape),m=1===um.sizeFromShape(t.logicalShape);if(1!==s||f||m){if(f&&!m)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){let e=s-2,t=s-1;l.indexOf(e)>-1&&l.indexOf(t)>-1?p="return vec4(outputValue.x);":l.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(r,"(").concat(h,");\n      ").concat(p,"\n    }\n  ")}(e,t):function(e,t){let n=e.name,a=n.charAt(0).toUpperCase()+n.slice(1),r="get"+a+"AtOutCoords",i=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&null==e.shapeInfo.flatOffset&&um.arraysEqual(s,i))return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");let u,c=gX(l),d=sX(e.shapeInfo.logicalShape,t.logicalShape),h=l-o,p=["x","y","z","w","u","v"];u=0===o?"":l<2&&d.length>=1?"coords = 0;":d.map(e=>"coords.".concat(p[e+h]," = 0;")).join("\n");let f="";return f=l<2&&o>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(p[t+h])).join(", "),"\n    float ".concat(r,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      return get").concat(a,"(").concat(f,");\n    }\n  ")}(e,t)),r}(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),l=t.texShape,u=eX(),c=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(u),d=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(cX,"\n    ").concat(dX,"\n    ").concat(hX,"\n  ")}(u);return t.isPacked?(r=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===a[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(a[1],".0);\n      }\n    "):1===a[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(a[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      return 2 * (resTexRC.x * ").concat(a[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(um.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(a[0],", ").concat(a[1],"));\n      }\n    ");let r=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),i=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2),s=i,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)s*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(s,";\n      index -= b").concat(u," * ").concat(s,";\n    ")+o,l="b".concat(u,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,l,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(u)):(r=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){return 1===t[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    "):1===t[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    "):n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){return um.arraysEqual(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):1===e[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===e[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(nX(["r","c","d"],e),"\n    return ivec3(r, c, d);\n  }\n");let a=tX(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(nX(["r","c","d","d2"],e),"\n      return ivec4(r, c, d, d2);\n    }\n  ");let a=tX(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){let n=tX(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){let n=tX(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(u)),n.packedInputs&&(d+=pX),[d,c,i,s,r,o,n.userCode].join("\n")}function lX(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(a,"() {return ").concat(n,";}");let[r,i]=e.shapeInfo.texShape;if(1===r&&1===i)return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let s=fX(n);if(t)return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");let[o,l]=e.shapeInfo.texShape;return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int index) {\n        ").concat(mX(e),"\n      }\n    ");let r=e.shapeInfo.texShape,i=r[0],s=r[1];if(1===s&&1===i)return"\n      float ".concat(a,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let o=fX(n);return 1===s?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===i?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(s,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(s,", index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=e.shapeInfo.texShape;if(null!=i&&um.arraysEqual(n,i)){if(t)return"\n      float ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let e=i[0],n=i[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}let{newShape:s,keptDims:o}=um.squeezeShape(n),l=s;if(l.length<n.length){let n=bX(e,l),a=["row","col"];return"\n      ".concat(lX(n,t),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(vX(a,o),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(mX(e),"\n      }\n    ");let u=i[0],c=i[1],d=fX(a);return 1===c?t?"\n      float ".concat(r,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(a,"TexShape[0]));\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(u,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):1===u?t?"\n      float ".concat(r,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(a,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(c,".0, 0.5);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):t?"\n      float ".concat(r,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(u,", ").concat(c,", index);\n    return sampleTexture(").concat(a,", uv);\n  }\n")}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=um.squeezeShape(n),u=o;if(u.length<n.length){let n=bX(e,u),a=["row","col","depth"];return"\n        ".concat(lX(n,t),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(vX(a,l),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(s,", 1)));\n        ").concat(mX(e),"\n      }\n    ");let c=e.shapeInfo.texShape,d=c[0],h=c[1],p=e.shapeInfo.flatOffset;if(h===i&&null==p)return t?"\n      float ".concat(r,"(int row, int col, int depth) {\n        int stride1 = ").concat(a,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(d,".0);\n          return sampleTexture(").concat(a,", uv);\n        }\n      ");if(h===s&&null==p)return t?"\n      float ".concat(r,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(a,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(d,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");let f=fX(a);return t?"\n    float ".concat(r,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(a,"Shape[1] * ").concat(a,"Shape[2];\n      int stride1 = ").concat(a,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n      return sampleTexture(").concat(a,", uv);\n    }\n    "):"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(s," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n        return sampleTexture(").concat(a,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=n[3],s=n[2]*i,o=n[1]*s,{newShape:l,keptDims:u}=um.squeezeShape(n);if(l.length<n.length){let n=bX(e,l),a=["row","col","depth","depth2"];return"\n      ".concat(lX(n,t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(vX(a,u),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(s,", ").concat(i,", 1)));\n        ").concat(mX(e),"\n      }\n    ");let c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f="int stride2 = ".concat(a,"Shape[3];"),m="int stride1 = ".concat(a,"Shape[2] * stride2;"),g="int stride0 = ".concat(a,"Shape[1] * stride1;");if(p===o&&null==c)return t?"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");if(p===i&&null==c)return t?"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(a,"Shape[1] * ").concat(a,"Shape[2], ").concat(a,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let y=fX(a);return t?"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(s," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index + ").concat(y,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(e,t);case 5:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t[4],i=t[3]*r,s=t[2]*i,o=t[1]*s,{newShape:l,keptDims:u}=um.squeezeShape(t);if(l.length<t.length){let t=bX(e,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(lX(t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(a,"(").concat(vX(n,u),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(o,", ").concat(s,", ").concat(i,", ").concat(r,")) +\n          depth3;\n        ").concat(mX(e),"\n      }\n    ");let c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===o&&null==c)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(i,", ").concat(r,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===r&&null==c)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let f=fX(n);return"\n    float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(s," + depth * ").concat(i," +\n          depth2 * ").concat(r," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){let t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=um.squeezeShape(t);if(r.length<t.length){let t=bX(e,r),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(lX(t),"\n      float ").concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(a,"(").concat(vX(n,i),");\n      }\n    ")}let s=t[5],o=t[4]*s,l=t[3]*o,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(u,", ").concat(l,", ").concat(o,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(mX(e),"\n      }\n    ");let d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===c&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(u,", ").concat(l,", ").concat(o,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===s&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");let m=fX(n);return"\n    float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(u," + depth * ").concat(l," +\n          depth2 * ").concat(o," + depth3 * ").concat(s," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling is not yet supported"))}}function uX(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=eX();return"\n    vec4 ".concat(n,"() {\n      return ").concat(a.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e.shapeInfo.texShape,i=eX();if(t)return"\n    vec4 ".concat(a,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");let s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return"\n    vec4 ".concat(a,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(s[0],", ").concat(s[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=e.shapeInfo.texShape,s=i[0],o=i[1],l=eX();if(null!=i&&um.arraysEqual(n,i))return t?"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    "):"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(s,".0);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(r,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ");let u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(c,", ").concat(u[0],", ").concat(u[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=e.shapeInfo.texShape,s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){let a=[1,2],i=bX(e,n.slice(1)),s=["b","row","col"];return"\n        ".concat(uX(i,t),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(vX(s,a),");\n        }\n      ")}let o=eX();if(t)return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ");let l=s[0],u=s[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(u,", ").concat(d,", ").concat(c,", b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);default:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=eX();if(t)return"\n    vec4 ".concat(a,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ");let i=e.shapeInfo.logicalShape,s=i.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],d=Math.ceil(i[s-1]/2),h=d*Math.ceil(i[s-2]/2),p="int b, int row, int col",f="b * ".concat(h," + (row / 2) * ").concat(d," + (col / 2)");for(let m=2;m<s-1;m++)p="int b".concat(m,", ")+p,h*=i[s-m-1],f="b".concat(m," * ").concat(h," + ")+f;return"\n    vec4 ".concat(a,"(").concat(p,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(u,");\n      return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var cX="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",dX="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",hX="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",pX="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function fX(e){return"offset".concat(e)}function mX(e){let t=e.name,n=um.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function gX(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function yX(e,t,n){let{newShape:a,keptDims:r}=um.squeezeShape(t),i=t.length,s=e&&3===i&&1===t[0],o=s?t.slice(1):a,l=!e&&i>1&&!um.arraysEqual(t,n)&&a.length<i||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:r}}function bX(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function vX(e,t){return t.map(t=>e[t]).join(", ")}function xX(e,t,n){let a,r,i,s=[],o=[],l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),1===Td().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));let c=!1;for(let d of t.variableNames){let a={name:d,uniform:e.getUniformLocation(n,d,c),offset:e.getUniformLocation(n,"offset".concat(d),c)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,"".concat(d,"Shape"),c),a.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),c)),s.push(a)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",c),i=e.getUniformLocation(n,"outShapeStrides",c),r=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(let d of t.customUniforms)o.push(e.getUniformLocation(n,d.name,c));return{variablesLocations:s,customUniformLocations:o,infLoc:l,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:i,outTexShapeLocation:r}}function wX(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but was executed with ").concat(t.length," inputs"));e.forEach((e,n)=>{let a=e.logicalShape,r=t[n],i=r.shape;if(!um.arraysEqual(a,i))throw Error("Binary was compiled with different shapes than the current args. Shapes ".concat(a," and ").concat(i," must match"));if(e.isUniform&&r.isUniform)return;let s=e.texShape,o=r.isUniform?null:r.texData.texShape;if(!um.arraysEqual(s,o))throw Error("Binary was compiled with different texture shapes than the current args. Shape ".concat(s," and ").concat(o," must match"))})}function kX(e){return Td().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var SX=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Gq.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=eX();this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?nX(["r","c","d"],e):tX(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},IX=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Gq.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=eX();this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?nX(["r","c","d"],e):tX(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},NX=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Hq.DOWNLOAD;let t=eX();this.outputShape=e,this.userCode="\n      ".concat(iX,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},TX=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Hq.DOWNLOAD;let t=eX();this.outputShape=e,this.userCode="\n      ".concat(iX,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}},CX={R:0,G:1,B:2,A:3},EX=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let a=eX();this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)");let i="";for(let s=0;s<n.length;s++){let e=n[s];i+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(CX[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rX(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(a.output," = vec4(").concat(r,", 0., 0., 0.);\n      }\n    ")}},_X=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=eX();this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length);let a="",r="result";t&&(r="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let t=0;t<=1;t++){let r=2*i+t;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(r,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(r,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(r,"] = values[2];\n            } else {\n              result[").concat(r,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rX(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(r,";\n        }\n    ")}},AX={};function FX(e){let t=eX();return oK(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function RX(e){return gK(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function DX(e){return yK(e,new Uint16Array([0,1,2,2,1,3]))}function MX(e,t,n,a,r,i){xK(t,n);let s=vK(e),o=e.TEXTURE_2D;return tK(e,()=>e.bindTexture(o,s)),tK(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),tK(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),tK(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),tK(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===Td().getNumber("WEBGL_VERSION")?tK(e,()=>e.texImage2D(o,0,a,t,n,0,r,i,null)):tK(e,()=>e.texStorage2D(o,1,a,t,n)),tK(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function OX(e){return e.internalFormatFloat}function PX(e,t,n,a){let[r,i]=Jq(t,n);return MX(e,r,i,OX(a),a.textureFormatFloat,e.FLOAT)}function LX(e){return e.internalFormatHalfFloat}function zX(e,t,n,a){let[r,i]=Jq(t,n);return MX(e,r,i,LX(a),a.textureFormatFloat,a.textureTypeHalfFloat)}function BX(e){return e.downloadTextureFormat}function WX(e,t,n,a){let[r,i]=Jq(t,n);return MX(e,r,i,BX(a),e.RGBA,e.UNSIGNED_BYTE)}function VX(e){return e.internalFormatPackedFloat}function UX(e,t,n,a){let[r,i]=$q(t,n);return MX(e,r,i,VX(a),e.RGBA,e.FLOAT)}function jX(e){return e.internalFormatPackedHalfFloat}function GX(e,t,n,a){let[r,i]=$q(t,n);return MX(e,r,i,jX(a),e.RGBA,a.textureTypeHalfFloat)}function HX(e,t,n){return tK(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),kK(e,t,"clipSpacePos",n,3,20,0)&&kK(e,t,"uv",n,2,20,12)}function qX(e,t,n,a,r,i){let s,o,l;tK(e,()=>e.bindTexture(e.TEXTURE_2D,t)),r instanceof Uint8Array?(s=new Uint8Array(n*a*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*a*4),o=e.FLOAT,l=i.internalFormatPackedFloat),s.set(r),2===Td().getNumber("WEBGL_VERSION")?tK(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,a,e.RGBA,o,s)):tK(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,a,0,e.RGBA,o,s)),tK(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function KX(e,t,n){tK(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===Td().getNumber("WEBGL_VERSION")?tK(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):tK(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===Td().getNumber("WEBGL_VERSION")?tK(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):tK(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),tK(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function XX(e,t,n,a){let r=e.createBuffer();tK(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));let i=16*t*n;return tK(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)),tK(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),tK(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}function YX(e,t,n){let a=e,r=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,r),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),r}function QX(e,t,n,a){let[r,i]=Jq(t,n),s=new Uint8Array(function(e,t){return e*t}(t*n,4));return tK(e,()=>e.readPixels(0,0,r,i,a.downloadTextureFormat,e.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function JX(e,t,n,a,r,i,s,o){let l=e,u=new Float32Array(function(e,t){let[n,a]=$q(e,t);return n*a*4}(i,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function ZX(e,t,n){let a=new Float32Array(t*n*4);return tK(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,a)),a}ac(AX,{bindVertexProgramAttributeStreams:()=>HX,createBufferFromOutputTexture:()=>XX,createFloat16MatrixTexture:()=>zX,createFloat16PackedMatrixTexture:()=>GX,createFloat32MatrixTexture:()=>PX,createIndexBuffer:()=>DX,createPackedMatrixTexture:()=>UX,createUnsignedBytesMatrixTexture:()=>WX,createVertexBuffer:()=>RX,createVertexShader:()=>FX,downloadByteEncodedFloatMatrixFromOutputTexture:()=>QX,downloadFloat32MatrixFromBuffer:()=>YX,downloadMatrixFromPackedOutputTexture:()=>ZX,downloadPackedMatrixFromBuffer:()=>JX,getInternalFormatForFloat16MatrixTexture:()=>LX,getInternalFormatForFloat16PackedMatrixTexture:()=>jX,getInternalFormatForFloat32MatrixTexture:()=>OX,getInternalFormatForPackedMatrixTexture:()=>VX,getInternalFormatForUnsignedBytesMatrixTexture:()=>BX,uploadDenseMatrixToTexture:()=>qX,uploadPixelDataToTexture:()=>KX});var $X=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=Td().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,Yq(t,e)):this.gl=Qq(t),e=this.gl,2===Td().getNumber("WEBGL_VERSION")){let t=e;this.createVertexArray=()=>tK(t,()=>t.createVertexArray()),this.bindVertexArray=e=>tK(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>tK(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>tK(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){let t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>tK(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>tK(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>tK(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>tK(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Td().getNumber("WEBGL_VERSION")){let e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=sK(this.gl,e),qK(this.gl,t))this.textureHalfFloatExtension=sK(this.gl,t);else if(Td().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),qK(this.gl,a))this.colorBufferHalfFloatExtension=sK(this.gl,a);else if(Td().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",qK(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!qK(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=RX(this.gl),this.indexBuffer=DX(this.gl),this.framebuffer=wK(this.gl),this.textureConfig=eK(this.gl,this.textureHalfFloatExtension)}get debug(){return Td().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;tK(e,()=>e.finish()),tK(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),tK(e,()=>e.deleteFramebuffer(this.framebuffer)),tK(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),tK(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),tK(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),PX(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),zX(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),WX(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),KX(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),qX(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),GX(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),UX(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(AK(this.gl,this.framebuffer),this.outputTexture=null),tK(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>QX(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,r,i){return JX(this.gl,e,0,0,0,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return YX(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let a=XX(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Td().getBool("WEBGL_FENCE_API_ENABLED")){let a=e,r=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let e=a.clientWaitSync(r,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=r}else Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>ZX(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=FX(t));let n=pK(t);tK(t,()=>t.attachShader(n,this.vertexShader)),tK(t,()=>t.attachShader(n,e)),fK(t,n);let a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&mK(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;tK(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),HX(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(tK(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&mK(this.gl,this.program),tK(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?NK(this.gl,e,t):TK(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),tK(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),CK(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[a,r]=$q(t,n);this.setOutputMatrixTextureDriver(e,a,r)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&mK(this.gl,this.program),FK(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}tK(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),tK(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=sK(this.gl,2===Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await um.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Td().platform&&(n=Td().platform.setTimeoutCustom.bind(Td().platform)),um.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),_K(this.gl,e,this.framebuffer),this.debug&&FK(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(_K(this.gl,this.outputTexture,this.framebuffer),this.debug&&FK(this.gl)):AK(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let a=this.gl;_K(a,e,this.framebuffer),this.debug&&FK(a),this.outputTexture=e,tK(a,()=>a.viewport(0,0,t,n)),tK(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),tK(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}};var{addImpl:eY,bincountImpl:tY,bincountReduceImpl:nY,bitwiseAndImpl:aY,castImpl:rY,ceilImpl:iY,concatImpl:sY,equalImpl:oY,expImpl:lY,expm1Impl:uY,floorImpl:cY,gatherNdImpl:dY,gatherV2Impl:hY,greaterImpl:pY,greaterEqualImpl:fY,lessImpl:mY,lessEqualImpl:gY,linSpaceImpl:yY,logImpl:bY,maxImpl:vY,maximumImpl:xY,minimumImpl:wY,multiplyImpl:kY,negImpl:SY,notEqualImpl:IY,prodImpl:NY,raggedGatherImpl:TY,raggedRangeImpl:CY,raggedTensorToTensorImpl:EY,rangeImpl:_Y,rsqrtImpl:AY,scatterImpl:FY,sigmoidImpl:RY,simpleAbsImpl:DY,sliceImpl:MY,sparseFillEmptyRowsImpl:OY,sparseReshapeImpl:PY,sparseSegmentReductionImpl:LY,sqrtImpl:zY,staticRegexReplaceImpl:BY,stridedSliceImpl:WY,stringNGramsImpl:VY,stringSplitImpl:UY,stringToHashBucketFastImpl:jY,subImpl:GY,tileImpl:HY,topKImpl:qY,transposeImpl:KY,uniqueImpl:XY}=uW;function YY(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function QY(e,t){return 1===t?[e]:YY(e,t)}var JY=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=kX(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{let e=QY("rc",this.rank),t=gX(this.rank),n=this.getOutOfBoundsCondition(e),a=this.getSetup(e),r=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(a,"\n\n            setOutput(vec4(").concat(r,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let r="".concat(0===n?"r":"rp1",", ").concat(0===a?"c":"cp1");for(let t=2;t<this.rank;t++)r="".concat(e[e.length-1-t],",")+r;t.push(r)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){let t=this.getSourceCoordsArr(e);return 1===this.rank?"getA(rc), (rc + 1 >= ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]," ? 0. : getA(rc + 1)), 0, 0"):"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}},ZY=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length);let n="";for(let a=0;a<4;a++){let e="thisRC = rc;";a%2===1&&(e+="thisRC.z += 1;"),a>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t?aX(["r","c","d"],"inputShape"):tX(["r","c","d"],e),"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rX(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}};var $Y=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let a=tQ(t,n),r=nQ(e,a,n);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);let i,s=eQ(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let e=this.freeTextures[r].pop();return this.usedTextures[r].push(e),e}return a===qq.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===qq.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===qq.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===qq.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===qq.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(i),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),i}releaseTexture(e,t,n,a){if(null==this.freeTextures)return;let r=tQ(n,a),i=nQ(t,r,a);i in this.freeTextures||(this.freeTextures[i]=[]);let s=eQ(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,a),o=Td().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],u=l&&l.indexOf(e);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));let t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function eQ(e,t,n,a,r){let i,s=function(e,t){switch(e){case qq.PACKED_2X2_FLOAT32:return VX(t);case qq.PACKED_2X2_FLOAT16:return jX(t);case qq.UNPACKED_FLOAT32:return OX(t);case qq.UNPACKED_FLOAT16:return LX(t);case qq.PACKED_4X1_UNSIGNED_BYTE:return BX(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,a);if(r){let[t,n]=$q(e[0],e[1]);i=t*n}else{let[t,n]=Jq(e[0],e[1]);i=t*n}let o=function(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,s);return i*o}function tQ(e,t){if(e===Hq.UPLOAD)return qq.PACKED_2X2_FLOAT32;if(e===Hq.RENDER||null==e)return function(e){return Td().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?qq.PACKED_2X2_FLOAT32:qq.UNPACKED_FLOAT32:e?qq.PACKED_2X2_FLOAT16:qq.UNPACKED_FLOAT16}(t);if(e===Hq.DOWNLOAD||e===Hq.PIXELS)return qq.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function nQ(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var aQ=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},rQ="if (isnan(x)) return x;",iQ="return abs(x);",sQ=rQ+"\n  return (x < 0.0) ? 0.0 : x;\n",oQ=rQ+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",lQ="return x;",uQ=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}},cQ=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length);let t=e.length,n=QY("rc",t),a=gX(t),r=function(e,t){if(1===e)return"rc";let n="";for(let a=0;a<e;a++)n+=t[a],a<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),s=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(r,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")}},dQ=WT.whereImpl,hQ={};var pQ=Td().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var fQ=class e extends Cc{nextDataId(){return e.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Td().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof $X)t=e;else{let n=Qq(Td().getNumber("WEBGL_VERSION"),e);t=new $X(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let e=Qq(Td().getNumber("WEBGL_VERSION"));t=new $X(e),this.binaryCache=function(e){return e in hQ||(hQ[e]={}),hQ[e]}(Td().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $Y(this.gpgpu),this.numMBBeforeWarning=null==Td().global.screen?1024:Td().global.screen.height*Td().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new Tc(this,Bg())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,r,i){let s=this.makeTensorInfo(t,n),o=this.texData.get(s.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[a,r]},o.texShape=[a,r];let l=LK(t),u=new EX(l,!1,i),c=this.runWebGLProgram(u,[s],n,[[a,r]]);return c.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(s),c.dataId}write(e,t,n){if((Td().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Td().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:Hq.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,a,r){if(Td().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===a)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:Hq.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:a,complexTensorInfos:r,slice:i,shape:s,isPacked:o}=t;if(null!=i){let t;t=o?new uQ(s,lQ):new aQ(s,lQ);let n=this.runWebGLProgram(t,[{dataId:e,shape:s,dtype:a}],a),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===a)return n;let l,u,c=null!=this.activeTimers;if(c&&(l=um.now()),"complex64"===a){let e=this.readSync(r.real.dataId),t=this.readSync(r.imag.dataId);u=MN.mergeRealAndImagArrays(e,t)}else u=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=um.now()-l),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){let t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}let t=this.texData.get(e),{values:n,shape:a,slice:r,dtype:i,complexTensorInfos:s,isPacked:o}=t;if(null!=r){let t;t=o?new uQ(a,lQ):new aQ(a,lQ);let n=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:i}],i),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(e);if(Td().getBool("DEBUG")&&!Td().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Td().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,c=null;if("complex64"!==i&&Td().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);let t=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(t.texture.texture,...Zq(a))}if(this.pendingRead.set(e,[]),"complex64"!==i&&await this.gpgpu.createAndWaitForFence(),"complex64"===i){let e=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),t=e[0],n=e[1];u=MN.mergeRealAndImagArrays(t,n)}else if(null==c)u=this.getValuesFromTexture(e);else{let e=um.sizeFromShape(a);u=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=c){let e=this.gpgpu.gl;tK(e,()=>e.deleteBuffer(c))}let d=this.convertAndCacheOnCPU(e,u),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(e=>e(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Bg().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),{values:a,shape:r,slice:i,dtype:s,isPacked:o,texture:l}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){let n;n=o?new uQ(r,lQ):new aQ(r,lQ);let a=this.runWebGLProgram(n,[{dataId:e,shape:r,dtype:s}],s),i=this.readToGPU(a,t);return this.disposeIntermediateTensorInfo(a),i}if(null==l)throw null!=a?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let u=this.decode(e,t.customTexShape),c=Bg().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:c},d.texture)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>um.decodeString(e));return Zy(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Zy(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){let n=e[t];if(!rK(n))throw Td().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value ".concat(n," cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'")):Error("The value ".concat(n," cannot be represented on this device."))}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:a}=this.texData.get(e),r=um.sizeFromShape(t);if(Td().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let n=this.decode(e),a=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(a.texture.texture,...Zq(t)).subarray(0,r);return this.disposeIntermediateTensorInfo(n),i}let i=Td().getBool("WEBGL_PACK")&&!0===a,s=i?LK(t):t,o=i?new TX(s):new NX(s),l=this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:e}],"float32"),u=this.texData.get(l.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(l),c}timerAvailable(){return Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],a=!1;null==this.programTimersStack?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();let r=um.flatten(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),i=um.flatten(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,a&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let e=await Promise.all(r);s.kernelMs=um.sum(e),s.getExtraProfileInfo=()=>e.map((e,t)=>({name:i[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:um.now(),endMs:null}}endTimer(e){return Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=um.now(),e)}async getQueryTime(e){if(Td().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:a,usage:r,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,r,i)));let u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pQ;return Td().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&um.sizeFromShape(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){MN.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return dQ(e.shape,t)}packedUnaryOp(e,t,n){let a=new uQ(e.shape,t),r=this.compileAndRun(a,[e],n);return Bg().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){let t=DY(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Td().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,iQ,e.dtype);let t=new aQ(e.shape,iQ),n=this.compileAndRun(t,[e]);return Bg().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&um.isString(n[0])){let r=n.map(e=>um.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return Bg().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new cQ(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new JY(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[OK(e.shape),...PK(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},r=[OK(t),...PK(t)],i=new ZY(r,n),s=[n],o=this.runWebGLProgram(i,[a],e.dtype,s,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}decode(e,t){let n=this.texData.get(e),{isPacked:a,shape:r,dtype:i}=n;if(null!=t){let e=um.sizeFromShape(r),n=t[0]*t[1]*4;um.assert(e<=n,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let s,o=LK(r);s=a?new IX(o):new SX(o);let l=[null!=t?t:Zq(o)];return{dtype:i,shape:r,dataId:this.runWebGLProgram(s,[{shape:o,dtype:i,dataId:e}],i,l,!0,t).dataId}}runWebGLProgram(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0,s=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(s.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===Gq.DENSE){let t=null!=i?i:Zq(e.outputShape);o.texShape=t.map(e=>2*e)}if(null!=e.outTexUsage&&(o.usage=e.outTexUsage),0===um.sizeFromShape(s.shape))return o.values=um.getTypedArrayFromDType(s.dtype,0),s;let l=[],u=t.map(t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&um.sizeFromShape(t.shape)<=Td().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!WK(n.shape,t.shape)){let e=t,a=t.shape;t.shape=n.shape,t=this.packedReshape(t,a),l.push(t),n=this.texData.get(t.dataId),e.shape=a}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(s.dataId);let c,d={shape:s.shape,texData:o,isUniform:!1},h=function(e,t,n){let a="";t.concat(n).forEach(t=>{let r=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let i=t.texData.texShape,{useSqueezeShape:s,uniformShape:o,keptDims:l}=yX(e.packedInputs,t.shape,i),u="",c="",d="";if(1===o.length&&e.packedInputs){let e=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];u="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){let e=um.computeStrides(o);d="".concat(e[0]===i[1],"_").concat(e[e.length-1]===i[1])}}else c="".concat(o[0]>1,"_").concat(o[1]>1);let h=t.shape.length,p=2===o.length&&um.arraysEqual(t.shape,i),f=1===um.sizeFromShape(t.shape),m=MN.getBroadcastDims(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&um.arraysEqual(i,n.texData.texShape),y=e.packedInputs||o.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);a+="".concat(h,"_").concat(g,"_").concat(s?l:"","_").concat(o.length,"_").concat(f,"_").concat(m,"_").concat(p,"_").concat(u,"_").concat(c,"_").concat(d,"_").concat(y,"_").concat(r)}else{let e=t.isUniform?"uniform":t.texData.texShape;a+="".concat(t.shape,"_").concat(e,"_").concat(r)}});let r=e.userCode,i=e.constructor.name;return i+="_"+a+"_"+r+"".concat(Td().getNumber("WEBGL_VERSION")),i}(e,u,d),p=this.getAndSaveBinary(h,()=>function(e,t,n,a){let r=n.map((e,n)=>{let a={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(a.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:a}}),i=r.map(e=>e.shapeInfo),s={logicalShape:a.shape,texShape:a.texData.texShape,isUniform:!1,isPacked:a.texData.isPacked,flatOffset:null},o=oX(r,s,t),l=lK(e.gl,o),u=e.createProgram(l);return Td().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s},xX(e,t,u)))}(this.gpgpu,e,u,d)),f=null!=this.activeTimers;f&&(c=this.startTimer()),Td().get("ENGINE_COMPILE_ONLY")||function(e,t,n,a,r){t.program.enableShapeUniforms||(wX(t.inShapeInfos,n),wX([t.outShapeInfo],[a]));let i=a.texData.texture,s=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===Td().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let a=n[l],{uniform:r,offset:i,shape:s,texShape:o}=t.variablesLocations[l];if(s){let{uniformShape:n}=yX(t.program.packedInputs,a.shape,a.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(s,new Int32Array(n));break;case 2:e.gl.uniform2iv(s,new Int32Array(n));break;case 3:e.gl.uniform3iv(s,new Int32Array(n));break;case 4:e.gl.uniform4iv(s,new Int32Array(n))}}if(o&&e.gl.uniform2i(o,a.texData.texShape[0],a.texData.texShape[1]),null!=r){if(a.isUniform){if(um.sizeFromShape(a.shape)<2)e.gl.uniform1f(r,a.uniformValues[0]);else{let t=a.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(r,t)}continue}null!=a.texData.slice&&null!=i&&e.gl.uniform1i(i,a.texData.slice.flatOffset),e.setInputMatrixTexture(a.texData.texture.texture,r,l)}}let o=t.outShapeLocation;if(o)switch(a.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(a.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(a.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(a.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(a.shape))}if(t.outShapeStridesLocation){let n=um.computeStrides(a.shape);switch(a.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),t.program.customUniforms&&r)for(let l=0;l<t.program.customUniforms.length;++l){let n=t.program.customUniforms[l],a=t.customUniformLocations[l],i=r[l];if("float"===n.type)e.gl.uniform1fv(a,i);else if("vec2"===n.type)e.gl.uniform2fv(a,i);else if("vec3"===n.type)e.gl.uniform3fv(a,i);else if("vec4"===n.type)e.gl.uniform4fv(a,i);else if("int"===n.type)e.gl.uniform1iv(a,i);else if("ivec2"===n.type)e.gl.uniform2iv(a,i);else if("ivec3"===n.type)e.gl.uniform3iv(a,i);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(a,i)}}e.executeProgram()}(this.gpgpu,p,u,d,a),l.forEach(e=>this.disposeIntermediateTensorInfo(e)),f&&(c=this.endTimer(c),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(c)}));let m=Td().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){let e=um.now();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!Td().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===r){let e=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),e}return s}compileAndRun(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,a,r)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Td().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ug(()=>{if(!Td().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=Td().getBool("DEBUG");Td().set("DEBUG",!1);let t=this.abs(qv(1e-8)).dataSync()[0];if(Td().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:a,values:r,texture:i,usage:s,isPacked:o}=t;if(null!=i)return;let l,u=null!=this.activeTimers;u&&(l=um.now());let c=t.texShape;if(null==c&&(c=zK(n,o),t.texShape=c),null!=r){let e,i=LK(n),s=c[1],d=c[0],h=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(o||!h)&&([s,d]=$q(c[0],c[1])),e=o?new _X(i,h):new EX(i,h);let p=h?[d,s]:c,f=this.makeTensorInfo(p,a),m=this.texData.get(f.dataId);m.usage=h?Hq.PIXELS:Hq.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),s,d,r);let g=[[d,s]],y=this.runWebGLProgram(e,[f],a,g,!0),b=this.texData.get(y.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,Td().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(f),u&&(this.uploadWaitMs+=um.now()-l)}else{let e=this.acquireTexture(c,s,a,o);t.texture=e}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:a}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){let n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){let e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, most likely due to a memory leak"))}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*um.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await RN(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(hK(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:r,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}=xX(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=r,e.outShapeLocation=i,e.outShapeStridesLocation=s,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:a,height:r,width:i,channels:s}=e,o=Bg().backend;if(!o.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(a,t,n,r,i,s);return Bg().makeTensorFromDataId(l,t,n,o)}};fQ.nextDataId=0;var mQ="4.22.0";function gQ(){Td().set("WEBGL_FORCE_F16_TEXTURES",!0)}yg.isBrowser()&&Zg("webgl",()=>new fQ,2);var yQ={forceHalfFloat:gQ},bQ="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",vQ=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=MN.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=kX(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}},xQ="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",wQ=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=MN.assertAndGetBroadcastShape(t,n);let r=this.outputShape.length;this.enableShapeUniforms=kX(r);let i="";if(a)if(0===r||1===um.sizeFromShape(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          ".concat(gX(r)," coords = getOutputCoords();\n        "),1===r)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{let e=QY("coords",r);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= outShape[").concat(r," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= outShape[").concat(r," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= ").concat(this.outputShape[r-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= ").concat(this.outputShape[r-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}};function kQ(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}var SQ={kernelName:Kh,backendName:"webgl",kernelFunc:kQ};function IQ(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,i=n.makeTensorInfo(a.shape,"complex64"),s=n.texData.get(i.dataId),o=kQ({inputs:{x:a},backend:n}),l=kQ({inputs:{x:r},backend:n});return s.complexTensorInfos={real:o,imag:l},i}var NQ={kernelName:rh,backendName:"webgl",kernelFunc:IQ},TQ="return (a < 0.) ? b * a : a;",CQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var EQ={kernelName:$h,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:i}=a,s=n.makeTensorInfo([],"float32",um.createScalarValue(i,"float32")),o=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wQ(CQ,r.shape,s.shape):new vQ(TQ,r.shape,s.shape),l=n.runWebGLProgram(o,[r,s],"float32");return n.disposeIntermediateTensorInfo(s),l}},_Q="return (a < 0.) ? b * a : a;",AQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var FQ={kernelName:Bp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t,i=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wQ(AQ,a.shape,r.shape):new vQ(_Q,a.shape,r.shape);return n.runWebGLProgram(i,[a,r],"float32")}},RQ="if (isnan(x)) return x;";function DQ(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:a,dtype:r}=e;return e=>{let i,{inputs:s,backend:o}=e,{x:l}=s,u=o,c=r||l.dtype;if(u.shouldExecuteOnCPU([l])&&null!=a){let e=u.texData.get(l.dataId),t=a(e.values,c);return u.makeTensorInfo(l.shape,c,t)}return i=Td().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new uQ(l.shape,n):new aQ(l.shape,t),u.runWebGLProgram(i,[l],c)}}function MQ(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:a=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}=e;return e=>{let{inputs:o,backend:l}=e,{a:u,b:c}=o,d=l;if(r&&"complex64"===u.dtype){let e=d.texData.get(u.dataId),n=d.texData.get(c.dataId),[a,r]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{let[n,a]=e,r={dataId:n.dataId,dtype:n.dtype,shape:u.shape},i={dataId:a.dataId,dtype:a.dtype,shape:c.shape},s=new vQ(t,u.shape,c.shape);return d.runWebGLProgram(s,[r,i],tg(n.dtype,a.dtype))}),i=IQ({inputs:{real:a,imag:r},backend:d});return d.disposeIntermediateTensorInfo(a),d.disposeIntermediateTensorInfo(r),i}let h,p=s||tg(u.dtype,c.dtype);if(("string"===u.dtype||"string"===c.dtype||d.shouldExecuteOnCPU([u,c]))&&null!=i){let e=d.texData.get(u.dataId).values,t=d.texData.get(c.dataId).values,n="string"===u.dtype?MN.fromUint8ToStringArray(e):e,a="string"===u.dtype?MN.fromUint8ToStringArray(t):t,[r,s]=i(u.shape,c.shape,n,a,p),o=d.makeTensorInfo(s,p);return d.texData.get(o.dataId).values=r,o}return h=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new wQ(n,u.shape,c.shape,a):new vQ(t,u.shape,c.shape),d.runWebGLProgram(h,[u,c],p)}}function OQ(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":sQ;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":oQ;if("prelu"===e)return t?AQ:_Q;if("leakyrelu"===e)return t?CQ:TQ;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var PQ=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=kX(this.outputShape.length);let u=a?e[1]:e[2],c=Math.ceil(u/2),d=a?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(m=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),g="result = activation(result);");let y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<t[0]?b="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(v="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(c,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(v,";\n        for (int i = 0; i < ").concat(c,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(f[0],");\n          result += (").concat(p[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}},LQ="return areal * breal - aimag * bimag;",zQ="return areal * bimag + aimag * breal;",BQ=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=MN.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}},WQ="return a * b;";function VQ(e){let t,{inputs:n,backend:a}=e,{a:r,b:i}=n,s=MN.upcastType(r.dtype,i.dtype);if("complex64"===r.dtype){let e=a.texData.get(r.dataId),t=a.texData.get(i.dataId),n=new BQ(LQ,r.shape,i.shape),s=new BQ(zQ,r.shape,i.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],l=a.runWebGLProgram(n,o,"float32"),u=a.runWebGLProgram(s,o,"float32"),c=IQ({inputs:{real:l,imag:u},backend:a});return a.disposeIntermediateTensorInfo(l),a.disposeIntermediateTensorInfo(u),c}if(a.shouldExecuteOnCPU([r,i])){let e=a.texData.get(r.dataId),t=a.texData.get(i.dataId),[n,o]=kY(r.shape,i.shape,e.values,t.values,s),l=a.makeTensorInfo(o,s);return a.texData.get(l.dataId).values=n,l}return t=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wQ(WQ,r.shape,i.shape):new vQ(WQ,r.shape,i.shape),a.runWebGLProgram(t,[r,i],s)}var UQ={kernelName:Cp,backendName:"webgl",kernelFunc:VQ};function jQ(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:i}=a,s=n,o=um.sizeFromShape(r.shape),l=um.inferFromImplicitShape(i,o),u=um.sizeFromShape(l);um.assert(o===u,()=>"The new shape (".concat(l,") has ").concat(u," elements and the old shape (").concat(r.shape,") has ").concat(o," elements. The new shape and old shape must have the same number of elements."));let c=s.texData.get(r.dataId);return!c.isPacked||WK(r.shape,l)||null!==c.texture&&WK(c.shape,l)?(s.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype}):function(e,t,n){let a=[OK(e.shape),...PK(e.shape)],r={dtype:e.dtype,shape:a,dataId:e.dataId},i=[OK(t),...PK(t)],s=new ZY(i,a),o=[a],l=n.runWebGLProgram(s,[r],e.dtype,o,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(r,l,s)}var GQ={kernelName:Xp,backendName:"webgl",kernelFunc:jQ},HQ=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let s=4*Math.floor(n/4),o=n%4,l="sumValue += dot(values, ones);";if(null!=t){let e=1/t;l="sumValue += dot(values * ".concat(um.isInt(e)?e.toPrecision(2):e,", ones);")}let u="";r%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===o,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}},qQ=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let s="0.0",o="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",o="min"):"max"===t&&(s="-1.0 / 1e-20",o="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");let u=4*Math.floor(n/4),c=n%4,d="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(o,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(o,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===t?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";r%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===c,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===c,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}};function KQ(e,t,n,a){let r=function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],a=MN.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:a,outSize:Math.ceil(n/a)})}return t}(e.shape),i=e;for(let s=0;s<r.length;s++){let o,l,{inSize:u,windowSize:c,outSize:d}=r[s];o="mean"===n?0===s?new HQ({windowSize:c,inSize:u,batchSize:e.shape[0],outSize:d},u):new HQ({windowSize:c,inSize:u,batchSize:e.shape[0],outSize:d}):new qQ({windowSize:c,inSize:u,batchSize:e.shape[0],outSize:d},n),l=i,i=a.runWebGLProgram(o,[i],t),l.dataId!==e.dataId&&a.disposeIntermediateTensorInfo(l)}return i}var XQ=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;let a=gX(this.rank),r=function(e){let t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],a=new Array(t);for(let r=0;r<e.length;r++)a[e[r]]=n[r];return a.join()}(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(r,"));\n    }\n    ")}};var YQ=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let u=0;u<n.length;u++)n[u]=e[t[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));let a=gX(this.rank),r=YY("rc",this.rank),i=new Array(this.rank);for(let u=0;u<t.length;u++)i[t[u]]=r[u];let s="vec2(".concat(i.slice(-2).join(),")"),o="++".concat(r[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(i.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(o,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(r[this.rank-1],";\n      if(++").concat(r[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(o,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}};function QQ(e,t,n){let a=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new YQ(e.shape,t):new XQ(e.shape,t);return n.runWebGLProgram(a,[e],e.dtype)}function JQ(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;return function(e,t,n,a){let r=t,i=e.shape.length,s=um.parseAxisParam(r,e.shape),o=s,l=MN.getAxesPermutation(o,i),u=null!=l,c=e;u&&(c=QQ(e,l,a),o=MN.getInnerMostAxes(o.length,i)),MN.assertAxesAreInnerMostDims("sum",o,i);let[d,h]=MN.computeOutAndReduceShapes(c.shape,o),p=d;n&&(p=MN.expandShapeToKeepDim(d,s));let f=um.sizeFromShape(h),m=jQ({inputs:{x:c},attrs:{shape:[um.sizeFromShape(e.shape)/f,f]},backend:a}),g=KQ(m,ng(e.dtype),"sum",a),y=jQ({inputs:{x:g},attrs:{shape:p},backend:a});return a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(g),u&&a.disposeIntermediateTensorInfo(c),y}(r,i,s,n)}var ZQ={kernelName:gf,backendName:"webgl",kernelFunc:JQ};function $Q(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{perm:s}=r,o=a,l=i.shape.length,u=new Array(l);for(let c=0;c<u.length;c++)u[c]=i.shape[s[c]];if(o.shouldExecuteOnCPU([i])){let e=o.texData.get(i.dataId).values,n=KY(e,i.shape,i.dtype,s,u);t=o.makeTensorInfo(u,i.dtype),o.texData.get(t.dataId).values=n}else t=QQ(i,s,o);return t}var eJ={kernelName:zf,backendName:"webgl",kernelFunc:$Q};function tJ(e){let{a:t,b:n,transposeA:a,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:u=null}=e,c=t.shape.length,d=n.shape.length,h=a?t.shape[c-2]:t.shape[c-1],p=r?n.shape[d-1]:n.shape[d-2],f=a?t.shape[c-1]:t.shape[c-2],m=r?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),b=um.sizeFromShape(g),v=um.sizeFromShape(y),x=kv.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);um.assert(h===p,()=>"Error in matMul: inner shapes (".concat(h,") and (").concat(p,") of Tensors with shapes ").concat(t.shape," and ").concat(n.shape," and transposeA=").concat(a," and transposeB=").concat(r," must match."));let w,k=a?[b,h,f]:[b,f,h],S=r?[v,m,p]:[v,p,m],I=jQ({inputs:{x:t},backend:i,attrs:{shape:k}}),N=jQ({inputs:{x:n},backend:i,attrs:{shape:S}}),T=[I,N],C=Math.max(b,v),E=a?I.shape[1]:I.shape[2],_=null!=s,A=null!=o,F="leakyrelu"===u,R=null!=u?OQ(u,!0):null;if((1===f||1===m)&&E>1e3&&!1===(_||A||F||null!=R)){let e=I,t=N;a&&(e=$Q({inputs:{x:I},backend:i,attrs:{perm:[0,2,1]}}),T.push(e)),r&&(t=$Q({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),T.push(t));let n=1===m,s=e;1!==m&&(s=jQ({inputs:{x:e},backend:i,attrs:{shape:[C,E,1]}}),T.push(s));let o=1===m?2:1,l=t;n&&(l=jQ({inputs:{x:t},backend:i,attrs:{shape:[C,1,E]}}),T.push(l));let u=VQ({inputs:{a:s,b:l},backend:i});w=JQ({inputs:{x:u},backend:i,attrs:{axis:o,keepDims:!0}}),T.push(u)}else{let e=tg(t.dtype,n.dtype),u=new PQ(k,S,[C,f,m],a,r,_,R,A,F),c=[I,N];if(null!=s&&c.push(s),A&&c.push(o),F){let e=i.makeTensorInfo([],"float32",um.createScalarValue(l,"float32"));c.push(e),T.push(e)}w=i.runWebGLProgram(u,c,e)}let D=jQ({inputs:{x:w},backend:i,attrs:{shape:x}});T.push(w);for(let M of T)i.disposeIntermediateTensorInfo(M);return D}var nJ={kernelName:Kf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=a;return tJ({a:r,b:i,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:d,activation:c})}},aJ="return abs(x);";var rJ={kernelName:Fd,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){let e=a.texData.get(r.dataId),t=DY(e.values);return a.makeTensorInfo(r.shape,r.dtype,t)}return t=Td().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new uQ(r.shape,aJ):new aQ(r.shape,aJ),a.runWebGLProgram(t,[r],r.dtype)}},iJ=DQ({opSnippet:rQ+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),sJ={kernelName:Rd,backendName:"webgl",kernelFunc:iJ},oJ=DQ({opSnippet:rQ+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),lJ={kernelName:Dd,backendName:"webgl",kernelFunc:oJ},uJ="return a + b;",cJ=MQ({opSnippet:uJ,packedOpSnippet:uJ,supportsComplex:!0,cpuKernelImpl:eY}),dJ={kernelName:Md,backendName:"webgl",kernelFunc:cJ},hJ=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}},pJ=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}};var fJ={kernelName:Od,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t,r=n;if(1===r.length)return kQ({inputs:{x:r[0]},backend:a});if(r.length>Td().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let t=Math.floor(r.length/2),n=e({inputs:r.slice(0,t),backend:a}),i=e({inputs:r.slice(t),backend:a});return e({inputs:[n,i],backend:a})}let i=r.map(e=>e.dtype).reduce((e,t)=>tg(e,t)),s=r.map(e=>e.shape),o=Td().getBool("WEBGL_PACK")?new pJ(r[0].shape,s):new hJ(r[0].shape,s);return a.runWebGLProgram(o,r,i)}};var mJ={kernelName:Pd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a,o=r.shape.length,l=um.parseAxisParam(i,r.shape),u=l,c=MN.getAxesPermutation(u,o),d=r;null!=c&&(d=$Q({inputs:{x:r},backend:n,attrs:{perm:c}}),u=MN.getInnerMostAxes(u.length,o)),MN.assertAxesAreInnerMostDims("all",u,o);let h,[p,f]=MN.computeOutAndReduceShapes(d.shape,u),m=jQ({inputs:{x:d},backend:n,attrs:{shape:[-1,um.sizeFromShape(f)]}}),g=KQ(m,m.dtype,"all",n);if(s){h=jQ({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(p,l)}})}else h=jQ({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(d),h}};var gJ={kernelName:Ld,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a,o=r.shape.length,l=um.parseAxisParam(i,r.shape),u=l,c=MN.getAxesPermutation(u,o),d=r;null!=c&&(d=$Q({inputs:{x:r},backend:n,attrs:{perm:c}}),u=MN.getInnerMostAxes(u.length,o)),MN.assertAxesAreInnerMostDims("any",u,o);let h,[p,f]=MN.computeOutAndReduceShapes(d.shape,u),m=jQ({inputs:{x:d},backend:n,attrs:{shape:[-1,um.sizeFromShape(f)]}}),g=KQ(m,m.dtype,"any",n);if(s){h=jQ({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(p,l)}})}else h=jQ({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(d),h}},yJ=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:a,batchSize:r,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i];let s="max"===t?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(o,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}},bJ=class{constructor(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,um.assert(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));let r=e[e.length-1],i=Math.ceil(r/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");let s,o,l=this.outputShape,u=l.length,c=gX(u),d=QY("coords",u);if(1===i){o=u+1;let e=gX(o);s="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(d.join(),", 0);\n        ++").concat(d[u-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(d.join(),", 0);\n        ++").concat(d[u-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(d.join(),", 0);\n        --").concat(d[u-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(d.join(),", 0);\n        --").concat(d[u-2],";")}else o=u,s="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(d[u-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(d[u-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(d[u-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(d[u-2],";");let h=["x","y","z","w","u","v"].slice(0,o),p="."+h[o-1],f=h.map(e=>"int "+e),m=QY("sourceLocR",o-1).concat("inIdx.r"),g=QY("sourceLocG",o-1).concat("inIdx.g"),y=QY("sourceLocB",o-1).concat("inIdx.b"),b=QY("sourceLocA",o-1).concat("inIdx.a"),v="max"===n?"greaterThan":"lessThan",x=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),k=a?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(d[u-1]," < ").concat(l[u-1]-1,";\n        bool hasNextRow = ").concat(d[u-2]," < ").concat(l[u-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(v,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}};function vJ(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.shape[0],i=t.shape[1];null!=a&&(r=a.shape[0],i=a.shape[1]);let s=MN.computeOptimalWindowSize(i),o={windowSize:s,inSize:i,batchSize:r,outSize:Math.ceil(i/s)},l=new yJ(o,n,null==a),u=[t];null!=a&&u.push(a);let c=e.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;let d=vJ(e,t,n,c);return e.disposeIntermediateTensorInfo(c),d}function xJ(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=null!=a?a.shape:t.shape,i=r[r.length-1],s=MN.computeOptimalWindowSize(i),o=new bJ(r,s,n,null==a),l=null==a?[t]:[t,a],u=e.runWebGLProgram(o,l,"int32");if(u.shape.length===t.shape.length){let a=xJ(e,t,n,u);return e.disposeIntermediateTensorInfo(u),a}return u}function wJ(e,t,n,a){let r=[n];if(MN.assertAxesAreInnerMostDims("arg"+a.charAt(0).toUpperCase()+a.slice(1),r,t.shape.length),!Td().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let n=[],i=e.texData.get(t.dataId),s=t;null!==i&&i.isPacked&&(s=e.unpackTensor(t),n.push(s));let[o,l]=MN.computeOutAndReduceShapes(s.shape,r),u=um.sizeFromShape(l),c=jQ({inputs:{x:s},backend:e,attrs:{shape:[-1,u]}});n.push(c);let d=vJ(e,c,a);n.push(d);let h=jQ({inputs:{x:d},backend:e,attrs:{shape:o}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),h}return xJ(e,t,a)}var kJ={kernelName:zd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a,s=um.parseAxisParam(i,r.shape),o=MN.getAxesPermutation(s,r.shape.length),l=r,u=[];null!=o&&(l=$Q({inputs:{x:r},backend:n,attrs:{perm:o}}),u.push(l),s=MN.getInnerMostAxes(s.length,l.shape.length)),MN.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let c=wJ(n,l,s[0],"max");return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}};var SJ={kernelName:Bd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a,s=um.parseAxisParam(i,r.shape),o=MN.getAxesPermutation(s,r.shape.length),l=r,u=[];null!=o&&(l=$Q({inputs:{x:r},backend:n,attrs:{perm:o}}),u.push(l),s=MN.getInnerMostAxes(s.length,l.shape.length)),MN.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let c=wJ(n,l,s[0],"min");return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}},IJ=DQ({opSnippet:rQ+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),NJ={kernelName:Wd,backendName:"webgl",kernelFunc:IJ},TJ=DQ({opSnippet:rQ+"return log(x + sqrt(x * x + 1.0));"}),CJ={kernelName:Vd,backendName:"webgl",kernelFunc:TJ},EJ=DQ({opSnippet:rQ+"\n  return atan(x);\n"}),_J={kernelName:Ud,backendName:"webgl",kernelFunc:EJ},AJ=MQ({opSnippet:bQ+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+xQ+"\n  return result;\n"}),FJ={kernelName:Gd,backendName:"webgl",kernelFunc:AJ},RJ=DQ({opSnippet:rQ+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),DJ={kernelName:jd,backendName:"webgl",kernelFunc:RJ},MJ=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;let f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),y="0.0";if(f||(y="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(u,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?r?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let b="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===t&&(b="avgValue / max(count, 1.0)");let v=4*Math.floor(i/4),x=i%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(c,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              getValue(batch, xR, xC + 3 * ").concat(u,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(v,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}},OJ=class{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b="avg"===t,v="0.0";if(b||(v="-1.0 / 1e-20"),n){let t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(u,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(c,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?r?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(t,"(").concat(t,"(").concat(t,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===t&&(x="avgValue / max(count, 1.0)");let w=4*Math.floor(i/4),k=i%4,S="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(u,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}};var PJ={kernelName:Hd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;ZK(r,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;um.assert(MN.eitherStridesOrDilationsAreOne(s,1),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(1,"'"));let u=MN.computePool2DInfo(r.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&um.arraysEqual(u.inShape,u.outShape))return kQ({inputs:{x:r},backend:n});let c=new MJ(u,"avg",!1);return n.runWebGLProgram(c,[r],"float32")}};var LJ={kernelName:Kd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=a,c=MN.computePool3DInfo(r.shape,i,s,[1,1,1],o,l,u),d=new OJ(c,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}},zJ=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=o-1-e.padInfo.top,c=l-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(c,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},BJ=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=c-1-e.padInfo.front,f=d-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(c,";\n            wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(r,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var WJ={kernelName:Xd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,s=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=a,d=MN.computePool3DInfo(s.shape,o,l,[1,1,1],u,c),h=new BJ(d);return n.runWebGLProgram(h,[r],s.dtype)}};var VJ={kernelName:qd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,s=i;ZK([r,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=a,c=MN.computePool2DInfo(s.shape,o,l,1,u),d=new zJ(c);return n.runWebGLProgram(d,[r],s.dtype)}};var UJ={kernelName:Yd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i}=t,{transposeA:s,transposeB:o}=a;return tJ({a:r,b:i,transposeA:s,transposeB:o,backend:n})}},jJ=class{constructor(e,t,n,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],MN.assertAndGetBroadcastShape(e,t),MN.assertAndGetBroadcastShape(e,n);let s="0.0";null!=a&&(MN.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";null!=r&&(MN.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(o,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}},GJ=class{constructor(e,t,n,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],MN.assertAndGetBroadcastShape(e,t),MN.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";null!=a&&(MN.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=r&&(MN.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(o,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}},HJ={kernelName:Uh,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,mean:i,variance:s,offset:o,scale:l}=t;um.assert(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),um.assert(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),um.assert(null==l||i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=a;null==u&&(u=.001);let c=[r,i,s],d=null;null!=o&&(d=o.shape,c.push(o));let h=null;null!=l&&(h=l.shape,c.push(l));let p=Td().getBool("WEBGL_PACK_NORMALIZATION")?new GJ(r.shape,i.shape,s.shape,d,h,u):new jJ(r.shape,i.shape,s.shape,d,h,u);return n.runWebGLProgram(p,c,c[0].dtype)}},qJ=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=gX(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return KJ.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),r=e.map((e,t)=>"sourceLoc.".concat(KJ[t]," = start[").concat(t,"] + coords.").concat(KJ[t],";"));n="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(r.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(n,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")}},KJ=["x","y","z","w","u","v"];var XJ=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=gX(this.rank),n=QY("coords",this.rank),a=QY("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(r,")"),s="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),o=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(a[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(o,"\n        setOutput(result);\n      }\n    ")}};function YJ(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:i,size:s}=a,[o,l]=lN.parseSliceParams(r,i,s);if(lN.assertParamsValid(r,o,l),0===um.sizeFromShape(l))return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||"string"===r.dtype){let e=n.texData.get(r.dataId),t=MY(e.values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,t)}let{isPacked:u}=n.texData.get(r.dataId),c=lN.isSliceContinous(r.shape,o,l);if(u||!c){let e=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XJ(l):new qJ(l),t=[o];return n.runWebGLProgram(e,[r],r.dtype,t)}return n.uploadToGPU(r.dataId),function(e,t,n,a){let r=a.texData.get(e.dataId),i=a.makeTensorInfo(n,e.dtype),s=a.texData.get(i.dataId);Object.assign(s,r),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=lN.computeFlatOffset(t,um.computeStrides(e.shape));r.slice&&(o+=r.slice.flatOffset),s.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};let l=a.dataRefCount.get(s.slice.origDataId)||1;return a.dataRefCount.set(s.slice.origDataId,l+1),i}(r,o,l,n)}var QJ={kernelName:uf,backendName:"webgl",kernelFunc:YJ},JJ={kernelName:Qd,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,crops:s}=a;um.assert(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=MN.getReshaped(r.shape,i,o),u=MN.getPermuted(l.length,i.length),c=MN.getReshapedPermuted(r.shape,i,o),d=MN.getSliceBeginCoords(s,i.length),h=MN.getSliceSize(c,s,i.length),p=[],f=jQ({inputs:{x:r},backend:n,attrs:{shape:l}}),m=$Q({inputs:{x:f},backend:n,attrs:{perm:u}}),g=jQ({inputs:{x:m},backend:n,attrs:{shape:c}}),y=YJ({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}};var ZJ={kernelName:Jd,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s}=a,o=n.readSync(r.dataId),l=n.readSync(i.dataId),u=tY(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}};var $J={kernelName:Zd,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{a:r,b:i}=n,s=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Td().getNumber("WEBGL_VERSION");if(a.shouldExecuteOnCPU([r,i])||1===o){let e=a.texData.get(r.dataId).values,t=a.texData.get(i.dataId).values,[n,s]=aY(r.shape,i.shape,e,t,r.dtype),o=a.makeTensorInfo(s,r.dtype);return a.texData.get(o.dataId).values=n,o}return t=s?new wQ("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new vQ("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),a.runWebGLProgram(t,[r,i],r.dtype)}};var eZ={kernelName:eh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,i=n.readSync(a.dataId),s=n.readSync(r.dataId),o=MN.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},tZ=MQ({opSnippet:"return float(a != b);",cpuKernelImpl:IY,dtype:"bool"}),nZ={kernelName:_p,backendName:"webgl",kernelFunc:tZ};function aZ(e){let{inputs:t,backend:n}=e,{input:a}=t;return kQ({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.real},backend:n})}var rZ={kernelName:Hp,backendName:"webgl",kernelFunc:aZ};var iZ={kernelName:th,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a,attrs:r}=t,{x:i}=n,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return kQ({inputs:{x:i},backend:a});let t=Gx(i.shape),n=e({inputs:{x:i},backend:a,attrs:{dtype:"float32"}}),r=IQ({inputs:{real:n,imag:t},backend:a});return t.dispose(),a.disposeIntermediateTensorInfo(n),r}if("complex64"===i.dtype){let t=aZ({inputs:{input:i},backend:a}),n=e({inputs:{x:t},backend:a,attrs:{dtype:s}});return a.disposeIntermediateTensorInfo(t),n}if(!um.hasEncodingLoss(i.dtype,s)){let e=kQ({inputs:{x:i},backend:a});return{dataId:e.dataId,shape:e.shape,dtype:s}}if(a.shouldExecuteOnCPU([i])){let e=a.texData.get(i.dataId).values,[t,n,r]=rY(e,i.shape,i.dtype,s);return a.makeTensorInfo(t,n,r)}if("int32"===s)return function(e,t){let n=new aQ(e.shape,"return float(int(x));"),a=t.runWebGLProgram(n,[e],"int32");return{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}(i,a);if("bool"===s){let e=a.makeTensorInfo([],"bool",um.getTypedArrayFromDType("bool",1)),t=tZ({inputs:{a:i,b:e},backend:a});return a.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(s))}},sZ="return ceil(x);",oZ=DQ({opSnippet:sZ,packedOpSnippet:sZ,cpuKernelImpl:iY}),lZ={kernelName:nh,backendName:"webgl",kernelFunc:oZ},uZ=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}},cZ=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}};var dZ={kernelName:ah,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{clipValueMin:s,clipValueMax:o}=r;t=Td().getBool("WEBGL_PACK_CLIP")?new cZ(i.shape):new uZ(i.shape);let l=[[s],[o]];return a.runWebGLProgram(t,[i],i.dtype,l)}},hZ=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}};function pZ(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var fZ={kernelName:ih,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=n.texData.get(a.dataId),i=new hZ(a.shape),s=[pZ(a,r.complexTensorInfos.real),pZ(a,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}},mZ=class{constructor(e){this.outputShape=[],this.outputShape=MN.computeOutShape(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));let t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];let n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){let e=t[i-1];n.push("else if (yC < ".concat(t[i],") setOutput(getT").concat(i,"(yR, yC-").concat(e,"));"))}let a=t.length,r=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(r,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}},gZ=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=MN.computeOutShape(e,t);let n=this.outputShape,a=n.length,r=gX(a),i=QY("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((e,t)=>"T".concat(t));let o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];let l=s[t],u=s.slice(-2),c=s.join(),d="if (".concat(l," < ").concat(o[0],") {\n        return getChannel(\n            getT0(").concat(c,"), vec2(").concat(u.join(),"));\n        }");for(let f=1;f<o.length;f++){let e=o[f-1];d+="\n        if (".concat(l," < ").concat(o[f],"  && ").concat(l," >= ").concat(o[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(yZ(s,l,e),"),\n            vec2(").concat(yZ(u,l,e),"));\n        }")}let h=o.length,p=o[o.length-1];d+="\n        return getChannel(\n          getT".concat(h,"(").concat(yZ(s,l,p),"),\n          vec2(").concat(yZ(u,l,p),"));"),this.userCode="\n      float getValue(".concat(s.map(e=>"int "+e),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(r," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2]," &&\n            ").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}};function yZ(e,t,n){let a=e.indexOf(t);return e.map((e,t)=>t===a?"".concat(e," - ").concat(n):e).join()}function bZ(e){let{inputs:t,backend:n}=e,{input:a}=t;return kQ({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.imag},backend:n})}var vZ={kernelName:Yh,backendName:"webgl",kernelFunc:bZ};function xZ(e,t,n){let a=e[0].dtype;if("complex64"===a){let a=e.map(e=>aZ({inputs:{input:e},backend:n})),r=e.map(e=>bZ({inputs:{input:e},backend:n})),i=xZ(a,t,n),s=xZ(r,t,n),o=IQ({inputs:{real:i,imag:s},backend:n});return a.forEach(e=>n.disposeIntermediateTensorInfo(e)),r.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),o}let r=n.shouldExecuteOnCPU(e);if("string"===a&&(r=!0),r){let r=e.map(e=>{let a=[-1,um.sizeFromShape(e.shape.slice(t))];return jQ({inputs:{x:e},backend:n,attrs:{shape:a}})}),i=r.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),s=MN.computeOutShape(r.map(e=>e.shape),1),o=1===r[0].shape[0],l=sY(i,s,a,o),u=MN.computeOutShape(e.map(e=>e.shape),t),c=n.makeTensorInfo(u,a,l);return r.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}let i=e.filter(e=>um.sizeFromShape(e.shape)>0),s=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(1===i.length){let t=s?new aQ(e[0].shape,lQ):new uQ(e[0].shape,lQ);return n.runWebGLProgram(t,e,a)}let o=Td().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){let e=[];for(let r=0;r<i.length;r+=o){let a=i.slice(r,r+o);e.push(xZ(a,t,n))}let a=xZ(e,t,n);for(let t of e)n.disposeIntermediateTensorInfo(t);return a}if(s){let e=new gZ(i.map(e=>e.shape),t);return n.runWebGLProgram(e,i,a)}let{tensors2D:l,outShape:u}=function(e,t,n){let a=MN.computeOutShape(e.map(e=>e.shape),t);return{tensors2D:e.map(e=>jQ({inputs:{x:e},attrs:{shape:[-1,um.sizeFromShape(e.shape.slice(t))]},backend:n})),outShape:a}}(i,t,n),c=new mZ(l.map(e=>e.shape)),d=n.runWebGLProgram(c,l,a);l.forEach(e=>n.disposeIntermediateTensorInfo(e));let h=jQ({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function wZ(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,i=um.parseAxisParam(r,t[0].shape)[0],s=t.map(e=>e.shape);MN.assertParamsConsistent(s,i);let o=MN.computeOutShape(t.map(e=>e.shape),i);if(0===um.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>um.sizeFromShape(e.shape)>0);return 1===l.length?kQ({inputs:{x:l[0]},backend:n}):xZ(l,i,n)}var kZ={kernelName:sh,backendName:"webgl",kernelFunc:wZ},SZ=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1,v="",x="";n&&(v=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");let w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(u,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}},IZ=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(r,", ").concat(i,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(c,"; wF++) {\n          int xF = xFCorner + wF * ").concat(o,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(u,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},NZ=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=kX(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,c=u,d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)d+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");d+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<u;m++)d+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(c+1)/2;m++){let t=2*m;if(d+="\n           xC = xCCorner + ".concat(t*o,";\n           "),1===s){if(t<u&&(i%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),d+=1===o&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<u)){let e=i%2===0?um.nearestLargerEven(o):o;o%2===0&&i%2===1||o%2!==0&&i%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),d+=o>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):d+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<u&&(i%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<u&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<u&&(d+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<u&&(d+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<u&&(d+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";n&&(h=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):r?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");let f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}},TZ=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=kX(this.outputShape.length);let{dataFormat:n}=t,a=eX(),r="channelsLast"===n,i=r?1:2,s=r?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {"),l="";for(let u=0;u<=1;u++)for(let e=0;e<=1;e++)l+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(u,";\n\n          ").concat(o,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(r,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*u+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*u+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}};function CZ(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function EZ(e){let t,{x:n,filter:a,convInfo:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:u=null}=e,c=n.shape,d=i.texData.get(n.dataId),h=r.inChannels,p=c[0]*c[1]*c[2],f=r.outChannels,m="channelsLast"===r.dataFormat,g=!1,y=[];if(null!=o){let e=CZ(o.shape,m);null!=e&&(o=jQ({inputs:{x:o},backend:i,attrs:{shape:e}}),y.push(o))}if(null!=s){let e=CZ(s.shape,m);null!=e&&(s=jQ({inputs:{x:s},backend:i,attrs:{shape:e}}),y.push(s))}if((1!==p&&1!==f||!(h>1e3))&&d.isPacked&&m&&null!=d.texture&&c[2]%2!==0&&um.arraysEqual(d.shape.slice(-3),c.slice(-3))){let e=c[0]*c[1]*(c[2]+1),h={dataId:n.dataId,shape:[1,e,r.inChannels],dtype:n.dtype},p=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,um.assert(WK(d.shape,h.shape),()=>"packed reshape ".concat(d.shape," to ").concat(h.shape," isn't free"));let f=jQ({inputs:{x:a},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(f);let m=tJ({a:h,b:f,backend:i,transposeA:false,transposeB:g,bias:s,activation:u,preluActivationWeights:o,leakyreluAlpha:l}),b=i.texData.get(m.dataId);um.assert(b.isPacked,()=>"batchMatMul result is expected to be packed"),d.shape=p,b.shape=r.outShape,t=kQ({inputs:{x:m},backend:i}),t.shape=r.outShape,y.push(m)}else{let e=r.outHeight*r.outWidth,c=jQ({inputs:{x:n},backend:i,attrs:{shape:m?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),d=jQ({inputs:{x:a},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=tJ({a:m?c:d,b:m?d:c,transposeA:!m,transposeB:g,backend:i,bias:s,activation:u,preluActivationWeights:o,leakyreluAlpha:l});t=jQ({inputs:{x:h},backend:i,attrs:{shape:r.outShape}}),y.push(c),y.push(d),y.push(h)}for(let b of y)i.disposeIntermediateTensorInfo(b);return t}function _Z(e){let{x:t,filter:n,convInfo:a,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}=e,{filterWidth:u,filterHeight:c,inChannels:d,outWidth:h,outHeight:p,dataFormat:f}=a,m="channelsLast"===f,g=u*c*d,y=p*h,b=[a.batchSize,g,y],v=[];if(null!=s){let e=CZ(s.shape,m);null!=e&&(s=jQ({inputs:{x:s},backend:r,attrs:{shape:e}}),v.push(s))}if(null!=i){let e=CZ(i.shape,m);null!=e&&(i=jQ({inputs:{x:i},backend:r,attrs:{shape:e}}),v.push(i))}let x=jQ({inputs:{x:n},backend:r,attrs:{shape:[1,g,um.sizeFromShape(n.shape)/g]}});v.push(x);let w=new TZ(b,a),k=[t.shape,[a.padInfo.top,a.padInfo.left],[a.strideHeight,a.strideWidth],[a.dilationHeight,a.dilationWidth],[a.inChannels],[a.filterWidth*a.inChannels],[a.outWidth]],S=r.runWebGLProgram(w,[t],"float32",k),I=jQ({inputs:{x:S},backend:r,attrs:{shape:b}});v.push(S),v.push(I);let N=null!=i,T=null!=s,C="leakyrelu"===l,E=l?OQ(l,!0):null,_=new PQ(m?I.shape:x.shape,m?x.shape:I.shape,m?[a.batchSize,y,a.outChannels]:[a.batchSize,a.outChannels,y],!0,!1,N,E,T,C),A=m?[I,x]:[x,I];if(i&&A.push(i),T&&A.push(s),C){let e=r.makeTensorInfo([],"float32",um.createScalarValue(o,"float32"));A.push(e),v.push(e)}let F=r.runWebGLProgram(_,A,"float32"),R=jQ({inputs:{x:F},backend:r,attrs:{shape:a.outShape}});v.push(F);for(let D of v)r.disposeIntermediateTensorInfo(D);return R}var AZ={kernelName:oh,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s}=n,{strides:o,pad:l,dataFormat:u,dilations:c,dimRoundingMode:d}=r,h=MN.convertConv2DDataFormat(u),p=MN.computeConv2DInfo(i.shape,s.shape,o,c,l,d,!1,h);if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(p.strideWidth<=2&&"channelsLast"===h&&Td().getBool("WEBGL_EXP_CONV")){let e=new NZ(p),n=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];t=a.runWebGLProgram(e,[i,s],"float32",n)}else if(Td().getBool("WEBGL_CONV_IM2COL"))t=_Z({x:i,filter:s,convInfo:p,backend:a});else{let e=new SZ(p);t=a.runWebGLProgram(e,[i,s],"float32")}else t=EZ({x:i,filter:s,convInfo:p,backend:a});let f=jQ({inputs:{x:t},backend:a,attrs:{shape:p.outShape}});return a.disposeIntermediateTensorInfo(t),f}},FZ=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},RZ=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i="channelsLast"===e.dataFormat,s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=i?1:2,u=i?2:3,c=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(c,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(u,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},DZ=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(r,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},MZ=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(o,", ").concat(l,", ").concat(u,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(r,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var OZ={kernelName:lh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=a,d=MN.convertConv2DDataFormat(l),h=MN.computeConv2DInfo(r.shape,c,s,1,o,u,!1,d),p=new FZ(h);return n.runWebGLProgram(p,[r,i],"float32")}},PZ=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=kX(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,r=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(r,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}};var LZ={kernelName:uh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=a,d=MN.convertConv2DDataFormat(u),h=MN.computeConv2DInfo(s,i.shape,o,1,l,c,!1,d);if(Td().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){let e=[[h.strideHeight,h.strideWidth]],t=new PZ(h);return n.runWebGLProgram(t,[r,i],"float32",e)}{let e=new RZ(h);return n.runWebGLProgram(e,[r,i],"float32")}}};var zZ={kernelName:ch,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a,u=MN.computeConv3DInfo(r.shape,i.shape,s,l,o),c=new IZ(u);return n.runWebGLProgram(c,[r,i],"float32")}};var BZ={kernelName:dh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,filterShape:l}=a,u=MN.computeConv3DInfo(r.shape,l,s,1,o),c=new DZ(u);return n.runWebGLProgram(c,[r,i],"float32")}};var WZ,VZ={kernelName:hh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{pad:s,strides:o,inputShape:l}=a,u=MN.computeConv3DInfo(l,i.shape,o,1,s),c=new MZ(u);return n.runWebGLProgram(c,[r,i],"float32")}},UZ=DQ({opSnippet:RQ+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(xQ,"\n  return result;\n")}),jZ={kernelName:ph,backendName:"webgl",kernelFunc:UZ},GZ=DQ({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),HZ={kernelName:fh,backendName:"webgl",kernelFunc:GZ},qZ=class{constructor(e,t,n,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[u]=t,[c,d]=n;this.outputShape=[u,c,d,l];let h="bilinear"===a?1:0,[p,f]=["".concat(s-1,".0"),"".concat(o-1,".0")],[m,g,y]=c>1?["".concat((s-1)/(c-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[b,v,x]=d>1?["".concat((o-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(b,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(v,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(h," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}},KZ={kernelName:yh,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=a,c=new qZ(r.shape,i.shape,o,l,u);return n.runWebGLProgram(c,[r,i,s],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(WZ||(WZ={}));var XZ=class{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let r=this.outputShape.length,i=this.op===WZ.Prod?"1.0":"0.0",s=n?i:"getX(".concat(YZ(r,"coords",this.op),")"),o=this.outputShape[this.outputShape.length-1],l="",u="";n?(l=a?"end != ".concat(o-1):"end != 0",u=a?"end + 1":"end - 1"):(l=a?"end + pow2 < ".concat(o):"end >= pow2",u=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(gX(r)," coords = getOutputCoords();\n        int end = ").concat(QZ(r,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(u,";\n          ").concat(QZ(r,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(YZ(r,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}};function YZ(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function QZ(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function JZ(e,t,n,a,r,i){let s=t.shape.length,o=MN.getAxesPermutation([a],s),l=t;null!=o&&(l=$Q({inputs:{x:t},backend:n,attrs:{perm:o}}));let u=MN.getInnerMostAxes(1,s)[0];if(u!==s-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," but got axis=").concat(a));let c=l.shape[u],d=kQ({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){let t=new XZ(e,l.shape,!1,i),a=[[h]],r=d;d=n.runWebGLProgram(t,[d],d.dtype,a),n.disposeIntermediateTensorInfo(r)}if(r){let t=new XZ(e,l.shape,r,i),a=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(a)}if(null!=o){let e=$Q({inputs:{x:d},backend:n,attrs:{perm:MN.getUndoAxesPermutation(o)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),e}return d}var ZZ={kernelName:mh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;return JZ(WZ.Prod,r,n,i,s,o)}};var $Z={kernelName:gh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;return JZ(WZ.Sum,r,n,i,s,o)}};var e$={kernelName:bh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s,binaryOutput:o}=a;if(1===r.shape.length){let e=n.readSync(r.dataId),t=n.readSync(i.dataId),a=tY(e,t,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,a)}if(2===r.shape.length){let e=n.bufferSync(r),t=n.bufferSync(i),a=nY(e,t,s,o);return n.makeTensorInfo(a.shape,i.dtype,a.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank".concat(r.shape.length,"."))}},t$=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};var n$={kernelName:vh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:i,dataFormat:s}=a,o=r.shape[0],l=("NHWC"===s?r.shape[1]:r.shape[2])*i,u=("NHWC"===s?r.shape[2]:r.shape[3])*i,c=("NHWC"===s?r.shape[3]:r.shape[1])/(i*i),d=new t$("NHWC"===s?[o,l,u,c]:[o,c,l,u],i,s);return n.runWebGLProgram(d,[r],r.dtype)}},a$=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=kX(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",u="";n&&(l=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),u="result = activation(result);");let c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(c,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}},r$=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=kX(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c,h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<c;g++)h+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");h+="\n    for (int r = 0; r < ".concat(u,"; r++) {\n      ");for(let g=0;g<c;g++)h+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){let e=2*g;if(h+="\n          xC = xCCorner + ".concat(e*l,";\n          "),1===o){if(e<c&&(s%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),h+=1===l&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<c)){let t=s%2===0?um.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),h+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):h+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<c&&(s%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<c&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<c&&(h+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<c&&(h+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<c&&(h+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";n&&(p=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}};var i$={kernelName:xh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=a,c=l;null==c&&(c=[1,1]),um.assert(MN.eitherStridesOrDilationsAreOne(s,c),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let d,h=MN.computeConv2DInfo(r.shape,i.shape,s,c,o,u,!0);d=Td().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new r$(h):new a$(h);let p=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[r,i],"float32",p)}},s$=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},o$=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(o,"; dm++) {\n              int d2 = d1 * ").concat(o," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var l$={kernelName:wh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=a,d=MN.computeConv2DInfo(r.shape,c,s,o,l,u,!0),h=new s$(d);return n.runWebGLProgram(h,[r,i],"float32")}};var u$={kernelName:kh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=a,d=MN.computeConv2DInfo(c,i.shape,s,o,l,u,!0),h=new o$(d);return n.runWebGLProgram(h,[r,i],"float32")}},c$=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}};var d$={kernelName:Sh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=[...a.shape,...a.shape],i=um.sizeFromShape(a.shape),s=jQ({inputs:{x:a},backend:n,attrs:{shape:[i]}}),o=new c$(i),l=n.runWebGLProgram(o,[s],s.dtype),u=jQ({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}},h$=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:a,strideHeight:r,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:u}=e,{top:c,left:d}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(r,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(c,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(o,"; w++) {\n              int wIn = wBeg + w * ").concat(u,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}};var p$={kernelName:Ih,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:u}=r,c=MN.computeDilation2DInfo(i.shape,s.shape,o,l,"NHWC",u),d=new h$(c);t=a.runWebGLProgram(d,[i,s],"float32");let h=jQ({inputs:{x:t},backend:a,attrs:{shape:c.outShape}});return a.disposeIntermediateTensorInfo(t),h}};var f$={kernelName:_h,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,i=t,{allDims:s,summedDims:o,idDims:l}=MN.decodeEinsumEquation(r,i.length);MN.checkEinsumDimSizes(s.length,l,i);let{path:u,steps:c}=MN.getEinsumComputePath(o,l),d=c.length,h=null,p=s.length,f=[];for(let m=0;m<d;++m){for(let e of c[m]){let t,{permutationIndices:a,expandDims:r}=MN.getEinsumPermutation(p,l[e]);MN.isIdentityPermutation(a)?t=i[e]:(t=$Q({inputs:{x:i[e]},backend:n,attrs:{perm:a}}),f.push(t));let s=t.shape.slice();for(let e=0;e<r.length;++e)s.splice(r[e],0,1);um.arraysEqual(t.shape,s)||(t=jQ({inputs:{x:t},backend:n,attrs:{shape:s}}),f.push(t)),null===h?h=t:(h=VQ({inputs:{a:t,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=JQ({inputs:{x:h},backend:n,attrs:{axis:u[m]-(s.length-p),keepDims:!1}}),f.push(h)),p--)}for(let m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}},m$=DQ({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),g$={kernelName:Ah,backendName:"webgl",kernelFunc:m$},y$={kernelName:Fh,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:a,y:r}=t,i=Td().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wQ("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",a.shape,r.shape):new vQ("return (b >= 0.0) ? a : a * (b + 1.0);",a.shape,r.shape);return n.runWebGLProgram(i,[a,r],a.dtype)}},b$=MQ({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:oY}),v$={kernelName:Dh,backendName:"webgl",kernelFunc:b$},x$=DQ({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(MN.ERF_P,";\n  float a1 = ").concat(MN.ERF_A1,";\n  float a2 = ").concat(MN.ERF_A2,";\n  float a3 = ").concat(MN.ERF_A3,";\n  float a4 = ").concat(MN.ERF_A4,";\n  float a5 = ").concat(MN.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),w$={kernelName:Rh,backendName:"webgl",kernelFunc:x$},k$=DQ({opSnippet:RQ+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:lY,dtype:"float32"}),S$={kernelName:Mh,backendName:"webgl",kernelFunc:k$};function I$(e){let{inputs:t,attrs:n,backend:a}=e,{dim:r}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=r;return r<0&&(um.assert(-(s+1)<=r,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+r+1),o.splice(l,0,1),jQ({inputs:{x:i},backend:a,attrs:{shape:o}})}var N$={kernelName:Oh,backendName:"webgl",kernelFunc:I$},T$="return exp(x) - 1.0;",C$=DQ({opSnippet:T$,packedOpSnippet:T$,cpuKernelImpl:uY}),E$={kernelName:Ph,backendName:"webgl",kernelFunc:C$},_$=class{constructor(e,t,n){this.variableNames=["real","imag"];let a=t[1];this.outputShape=t;let r,i=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=n?"".concat(a,".0"):"1.0";if("real"===e)r="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));r="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(r,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}};function A$(e,t,n){let a=n.texData.get(e.dataId),r=um.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=jQ({inputs:{x:e},backend:n,attrs:{shape:[r/i,i]}}),o=s.shape,l=new _$("real",o,t),u=new _$("imag",o,t),c=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:o},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:o}],d=n.runWebGLProgram(l,c,"float32"),h=n.runWebGLProgram(u,c,"float32"),p=IQ({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);let f=jQ({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),f}var F$={kernelName:Lh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return A$(a,!1,n)}},R$=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}};function D$(e){let{backend:t,attrs:n}=e,{shape:a,value:r}=n,{dtype:i}=n;if(i=i||um.inferDtype(r),"string"===i){let e=um.getArrayFromDType(i,um.sizeFromShape(a));return e.fill(r),t.makeTensorInfo(a,i,e)}{let e=new R$(a,r),n=[[r]];return t.runWebGLProgram(e,[],i,n)}}var M$,O$={kernelName:zh,backendName:"webgl",kernelFunc:D$},P$=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},L$={kernelName:Bh,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{image:a}=t,r=n,i=new P$(a.shape);return r.runWebGLProgram(i,[a],a.dtype)}},z$="return floor(x);",B$=DQ({opSnippet:z$,packedOpSnippet:z$,cpuKernelImpl:cY}),W$={kernelName:Wh,backendName:"webgl",kernelFunc:B$},V$=MQ({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),U$={kernelName:Vh,backendName:"webgl",kernelFunc:V$},j$=class{constructor(e){this.variableNames=["A"];let t=eX(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}},G$=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=eX(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}},H$={kernelName:Hf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{pixels:r}=t,{numChannels:i}=a,s="undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement,[l,u]=s?[r.videoWidth,r.videoHeight]:[r.width,r.height],c=[u,l],d=[u,l,i];if(o||s){let e=Td().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==M$||e!==q$)&&(q$=e,M$=document.createElement("canvas").getContext("2d",{willReadFrequently:q$})),M$.canvas.width=l,M$.canvas.height=u,M$.drawImage(r,0,0,l,u),r=M$.canvas}let h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Hq.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);let p=Td().getBool("WEBGL_PACK")?new G$(d):new j$(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}},q$=Td().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var K$={kernelName:Xf,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:u,pad:c,dataFormat:d,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r,g=MN.convertConv2DDataFormat(d),y=MN.computeConv2DInfo(i.shape,s.shape,u,h,c,p,!1,g),b=[],v=null!=o,x=null!=l,w="leakyrelu"===f,k=()=>{let e=[i,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let t=jQ({inputs:{x:e},backend:a,attrs:{shape:[e.shape[0],1,1]}});return b.push(t),t}return e};if(v&&e.push(t(o,d)),x&&e.push(t(l,d)),w){let t=a.makeTensorInfo([],"float32",um.createScalarValue(m,"float32"));e.push(t),b.push(t)}return e};if(1!==y.filterHeight||1!==y.filterWidth||1!==y.dilationHeight||1!==y.dilationWidth||1!==y.strideHeight||1!==y.strideWidth||"SAME"!==y.padInfo.type&&"VALID"!==y.padInfo.type)if(y.strideWidth<=2&&"channelsLast"===g&&Td().getBool("WEBGL_EXP_CONV")){let e=f?OQ(f,!0):null,n=new NZ(y,v,e,x,w),r=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],i=k();t=a.runWebGLProgram(n,i,"float32",r)}else if(Td().getBool("WEBGL_CONV_IM2COL"))t=_Z({x:i,filter:s,convInfo:y,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else{let e=f?OQ(f,!1):null,n=new SZ(y,v,e,x,w),r=k();t=a.runWebGLProgram(n,r,"float32")}else t=EZ({x:i,filter:s,convInfo:y,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});let S=jQ({inputs:{x:t},backend:a,attrs:{shape:y.outShape}});return b.push(t),b.forEach(e=>a.disposeIntermediateTensorInfo(e)),S}};var X$={kernelName:Yf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=a,f=[],m=c;null==m&&(m=[1,1]),um.assert(MN.eitherStridesOrDilationsAreOne(l,m),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(l," and dilations '").concat(m,"'"));let g,y=MN.computeConv2DInfo(r.shape,i.shape,l,m,u,d,!0),b=Td().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=h?OQ(h,b):null,x=[r,i],w=null!=s,k=null!=o,S="leakyrelu"===h;if(w&&x.push(s),k&&x.push(o),S){let e=n.makeTensorInfo([],"float32",um.createScalarValue(p,"float32"));x.push(e),f.push(e)}g=b?new r$(y,w,v,k,S):new a$(y,w,v,k,S);let I=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],N=n.runWebGLProgram(g,x,"float32",I);return f.forEach(e=>n.disposeIntermediateTensorInfo(e)),N}},Y$=class{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;let r=gX(n.length),i="\n    int index;";for(let s=0;s<this.sliceDim;s++)i+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(r," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}};var Q$={kernelName:Gh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,i=r.shape,s=i[i.length-1],o=um.sizeFromShape(a.shape),[l,u,c,d]=MN.prepareAndValidate(a,r),h=jQ({inputs:{x:r},backend:n,attrs:{shape:[u,s]}}),p=jQ({inputs:{x:a},backend:n,attrs:{shape:[um.sizeFromShape(a.shape)/c,c]}});if(n.shouldExecuteOnCPU([a,r])||"string"===a.dtype){let e=n.readSync(r.dataId),t=n.bufferSync(a),i=dY(e,t,a.dtype,u,s,c,d,a.shape,o);return n.makeTensorInfo(l,a.dtype,i.values)}let f=new Y$(s,d,[u,c],a.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),g=jQ({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}},J$=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=gX(this.rank),a=function(e){let t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<e.length;a++)2===a?n.push("index"):n.push("".concat(t[a]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}};function Z$(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:i}=t,{axis:s,batchDims:o}=a,l=um.parseAxisParam(s,r.shape)[0];if(Td().get("DEBUG")){let e=n.readSync(i.dataId),t=r.shape[l];for(let n=0;n<e.length;++n){let a=e[n];um.assert(a<=t-1&&a>=0,()=>"GatherV2: the index value ".concat(a," is not in [0, ").concat(t-1,"]"))}}let u=MN.segment_util.collectGatherOpShapeInfo(r,i,l,o),c=um.sizeFromShape(i.shape),d=[],h=jQ({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=jQ({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);let f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){let e=n.bufferSync(p),t=n.bufferSync(h),a=hY(t,e,f);return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u.outputShape,a.dtype,a.values)}let m=new J$(h.shape,f),g=n.runWebGLProgram(m,[h,p],h.dtype);d.push(g);let y=jQ({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}var $$={kernelName:jh,backendName:"webgl",kernelFunc:Z$},e0=MQ({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:pY,dtype:"bool"}),t0={kernelName:Hh,backendName:"webgl",kernelFunc:e0},n0=MQ({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:fY}),a0={kernelName:qh,backendName:"webgl",kernelFunc:n0};var r0={kernelName:Xh,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return A$(a,!0,n)}},i0=DQ({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),s0={kernelName:Qh,backendName:"webgl",kernelFunc:i0},o0=DQ({opSnippet:"return float(isinf(x));",dtype:"bool"}),l0={kernelName:Jh,backendName:"webgl",kernelFunc:o0},u0=DQ({opSnippet:"return float(isnan(x));",dtype:"bool"}),c0={kernelName:Zh,backendName:"webgl",kernelFunc:u0},d0=MQ({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:mY,dtype:"bool"}),h0={kernelName:ep,backendName:"webgl",kernelFunc:d0},p0=MQ({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:gY,dtype:"bool"}),f0={kernelName:tp,backendName:"webgl",kernelFunc:p0};var m0={kernelName:np,backendName:"webgl",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:i}=n,s=yY(a,r,i);return t.makeTensorInfo([s.length],"float32",s)}},g0=DQ({opSnippet:RQ+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:bY}),y0={kernelName:ap,backendName:"webgl",kernelFunc:g0},b0=DQ({opSnippet:RQ+"\n  return log(1.0 + x);\n"}),v0={kernelName:rp,backendName:"webgl",kernelFunc:b0},x0=MQ({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),w0={kernelName:ip,backendName:"webgl",kernelFunc:x0},k0=DQ({opSnippet:"return float(!(x >= 1.0));"}),S0={kernelName:sp,backendName:"webgl",kernelFunc:k0},I0=MQ({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),N0={kernelName:op,backendName:"webgl",kernelFunc:I0},T0=class{constructor(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[];let i=t,s=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===r?"inversesqrt(".concat(l,")"):1===r?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")}},C0=class{constructor(e,t,n,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=t,s=e[3]-1;this.outputShape=e;let o,l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===r?"inversesqrt(".concat(l,")"):1===r?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")}},E0={kernelName:dp,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=a,u=Td().getBool("WEBGL_PACK_NORMALIZATION")?new C0(r.shape,i,s,o,l):new T0(r.shape,i,s,o,l);return n.runWebGLProgram(u,[r],r.dtype)}},_0=class{constructor(e,t,n,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=r,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(r,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(r,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}},A0={kernelName:hp,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=a,d=new _0(r.shape,o,l,u,c);return n.runWebGLProgram(d,[r,i,s],r.dtype)}};function F0(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reductionIndices:i,keepDims:s}=a,o=r.shape.length,l=um.parseAxisParam(i,r.shape),u=l,c=MN.getAxesPermutation(u,o),d=null!=c,h=n.shouldExecuteOnCPU([r]),p=r;if(d){if(h){let e=n.texData.get(p.dataId).values,t=new Array(o);for(let n=0;n<t.length;n++)t[n]=r.shape[c[n]];let a=KY(e,r.shape,r.dtype,c,t);p=n.makeTensorInfo(t,r.dtype),n.texData.get(p.dataId).values=a}else p=QQ(r,c,n);u=MN.getInnerMostAxes(u.length,o)}MN.assertAxesAreInnerMostDims("max",u,o);let f,[m,g]=MN.computeOutAndReduceShapes(p.shape,u),y=m;if(s&&(y=MN.expandShapeToKeepDim(m,l)),h){let e=n.texData.get(p.dataId).values,t=vY(e,um.sizeFromShape(g),y,r.dtype);f=n.makeTensorInfo(y,r.dtype),n.texData.get(f.dataId).values=t}else f=function(e,t,n,a){let r=um.sizeFromShape(t),i=jQ({inputs:{x:e},attrs:{shape:[um.sizeFromShape(e.shape)/r,r]},backend:a}),s=KQ(i,e.dtype,"max",a),o=jQ({inputs:{x:s},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}(p,g,y,n);return d&&n.disposeIntermediateTensorInfo(p),f}var R0={kernelName:fp,backendName:"webgl",kernelFunc:F0},D0=MQ({opSnippet:bQ+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+xQ+"\n  return result;\n",cpuKernelImpl:xY}),M0={kernelName:mp,backendName:"webgl",kernelFunc:D0};var O0={kernelName:gp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;ZK(r,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;um.assert(MN.eitherStridesOrDilationsAreOne(s,1),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(1,"'"));let u=MN.computePool2DInfo(r.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&um.arraysEqual(u.inShape,u.outShape))return kQ({inputs:{x:r},backend:n});let c=new MJ(u,"max",!1);return n.runWebGLProgram(c,[r],r.dtype)}};var P0={kernelName:bp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:u}=a,c=MN.computePool3DInfo(r.shape,i,s,[1,1,1],o,u,l),d=new OJ(c,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}},L0=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=r-1-e.padInfo.top,o=i-1-e.padInfo.left,l=r*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(r,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}},z0=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=o-1-e.padInfo.front,d=l-1-e.padInfo.top,h=u-1-e.padInfo.left,p=o*l*u-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(c,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(o,";\n           wD += ").concat(r,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(u,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(u," +\n                  wR * ").concat(u," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}};var B0={kernelName:vp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,s=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=a,d=MN.computePool3DInfo(s.shape,o,l,[1,1,1],u,c),h=new OJ(d,"max",!0),p=n.runWebGLProgram(h,[s],s.dtype),f=new z0(d),m=n.runWebGLProgram(f,[r,p],s.dtype);return n.disposeIntermediateTensorInfo(p),m}};var W0={kernelName:yp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i,output:s}=t,o=i;ZK([i,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=a,h=MN.computePool2DInfo(o.shape,l,u,1,c,d),p=new MJ(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),m=new L0(h),g=n.runWebGLProgram(m,[r,f],o.dtype);return n.disposeIntermediateTensorInfo(f),g}};var V0={kernelName:xp,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=n,u=a;um.assert(4===r.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let c=[1,1];um.assert(MN.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(c,"'"));let d=MN.computePool2DInfo(r.shape,i,s,c,o),[h,p]=function(e,t,n,a){let r=new MJ(n,"max",!1),i=a.runWebGLProgram(r,[e],"float32");return r=new MJ(n,"max",!0,!0,t),[i,a.runWebGLProgram(r,[e],"float32")]}(r,l,d,u);return[h,p]}};var U0={kernelName:wp,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{keepDims:i,axis:s}=n,o=a,l=r.shape.length,u=um.parseAxisParam(s,r.shape),c=u,d=MN.getAxesPermutation(c,l),h=null!=d,p=o.shouldExecuteOnCPU([r]),f=[],m=r;if(h){if(p){let e=o.texData.get(m.dataId).values,t=new Array(l);for(let a=0;a<t.length;a++)t[a]=r.shape[d[a]];let n=KY(e,r.shape,r.dtype,d,t);m=o.makeTensorInfo(t,r.dtype),o.texData.get(m.dataId).values=n}else m=QQ(r,d,o);f.push(m),c=MN.getInnerMostAxes(c.length,l)}MN.assertAxesAreInnerMostDims("sum",c,l);let[g,y]=MN.computeOutAndReduceShapes(m.shape,c),b=g;i&&(b=MN.expandShapeToKeepDim(g,u));let v=function(e,t,n,a){let r=um.sizeFromShape(t),i=jQ({inputs:{x:e},attrs:{shape:[um.sizeFromShape(e.shape)/r,r]},backend:a}),s=KQ(i,"float32","mean",a),o=jQ({inputs:{x:s},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}(m,y,b,o);for(let x of f)o.disposeIntermediateTensorInfo(x);return v}};var j0={kernelName:kp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a,o=r.shape.length,l=um.parseAxisParam(i,r.shape),u=l,c=MN.getAxesPermutation(u,o),d=r;null!=c&&(d=$Q({inputs:{x:r},backend:n,attrs:{perm:c}}),u=MN.getInnerMostAxes(u.length,r.shape.length)),MN.assertAxesAreInnerMostDims("min",u,o);let h,[p,f]=MN.computeOutAndReduceShapes(d.shape,u),m=jQ({inputs:{x:d},backend:n,attrs:{shape:[-1,um.sizeFromShape(f)]}}),g=KQ(m,m.dtype,"min",n);if(s){h=jQ({inputs:{x:g},backend:n,attrs:{shape:MN.expandShapeToKeepDim(p,l)}})}else h=jQ({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(d),h}},G0=MQ({opSnippet:bQ+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+xQ+"\n  return result;\n",cpuKernelImpl:wY}),H0={kernelName:Sp,backendName:"webgl",kernelFunc:G0},q0=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=gX(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===n?0:1;this.userCode=1!==a?"\n      ".concat(r," start = ").concat(r,"(").concat(i,");\n      ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(r," coords = outC - start;\n        setOutput(getX(").concat(o,"));\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}},K0=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=gX(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=QY("rc",a),l=QY("source",a),u="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),c=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d="reflect"===n?0:1,h="";if(1===a){let e="\n        ".concat(r," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(u,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n        }\n      ")}else{let e="\n        ".concat(r," source = rc;\n        ").concat(r," lt = ").concat(r,"(lessThan(source, start));\n        ").concat(r," gte = ").concat(r,"(greaterThanEqual(source, end));\n        ").concat(r," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(u,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n        }\n        rc = outputLoc;\n        ").concat(o[a-2]," += 1;\n        if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n          ").concat(o[a-1]," += 1;\n          if(").concat(u,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(i,");\n      const ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}},X0={kernelName:Ip,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,mode:s}=a,o=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new K0(r.shape,i,s):new q0(r.shape,i,s);return n.runWebGLProgram(o,[r],r.dtype)}},Y0=MQ({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+xQ+"\n  return result;\n"}),Q0={kernelName:Np,backendName:"webgl",kernelFunc:Y0},J0=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}},Z0=MQ({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),$0={kernelName:Eh,backendName:"webgl",kernelFunc:Z0},e1="return a - b;",t1=MQ({opSnippet:e1,packedOpSnippet:e1,supportsComplex:!0,cpuKernelImpl:GY}),n1={kernelName:Rf,backendName:"webgl",kernelFunc:t1};function a1(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:i}=a,s=um.parseAxisParam([i],r.shape),o=F0({inputs:{x:r},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=MN.expandShapeToKeepDim(o.shape,s),u=jQ({inputs:{x:o},backend:n,attrs:{shape:l}}),c=t1({inputs:{a:r,b:u},backend:n}),d=k$({inputs:{x:c},backend:n}),h=JQ({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),p=jQ({inputs:{x:h},backend:n,attrs:{shape:l}}),f=Z0({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}var r1={kernelName:vf,backendName:"webgl",kernelFunc:a1};var i1={kernelName:Tp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:i,seed:s,normalized:o}=a,l=o?r:a1({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new J0(u,c,i),h=[[s]],p=n.runWebGLProgram(d,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),p}},s1=rQ+"\n  return -x;\n";var o1={kernelName:Ep,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])){let e=a.texData.get(r.dataId),[t,n]=SY(e.values,r.shape,r.dtype);return a.makeTensorInfo(n,r.dtype,t)}return t=Td().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new uQ(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new aQ(r.shape,s1),a.runWebGLProgram(t,[r],r.dtype)}},l1=WT.nonMaxSuppressionV3Impl;var u1={kernelName:Ap,backendName:"webgl",kernelFunc:function(e){MN.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=a,u=n.readSync(r.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=l1(u,c,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},c1=WT.nonMaxSuppressionV4Impl;var d1={kernelName:Fp,backendName:"webgl",kernelFunc:function(e){MN.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=a,c=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:p}=c1(c,d,s,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},h1=WT.nonMaxSuppressionV5Impl;var p1={kernelName:Rp,backendName:"webgl",kernelFunc:function(e){MN.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=a,c=n.readSync(r.dataId),d=n.readSync(i.dataId),h=s,p=o,f=l,m=u,{selectedIndices:g,selectedScores:y}=h1(c,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},f1=class{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}},m1={kernelName:Mp,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:i,depth:s,onValue:o,offValue:l}=a,u=um.sizeFromShape(r.shape),c=new f1(u,s,o,l),d=jQ({inputs:{x:r},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);let p=jQ({inputs:{x:h},backend:n,attrs:{shape:[...r.shape,s]}});return n.disposeIntermediateTensorInfo(h),p}};function g1(e){let{inputs:t,backend:n}=e,{x:a}=t;if("complex64"===a.dtype){let e=aZ({inputs:{input:a},backend:n}),t=g1({inputs:{x:e},backend:n}),r=bZ({inputs:{input:a},backend:n}),i=g1({inputs:{x:r},backend:n}),s=IQ({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}return D$({attrs:{shape:a.shape,dtype:a.dtype,value:"string"===a.dtype?"":0},backend:n})}var y1={kernelName:jf,backendName:"webgl",kernelFunc:g1};var b1={kernelName:Dp,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){let t=aZ({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),i=bZ({inputs:{input:r},backend:a}),s=g1({inputs:{x:i},backend:a}),o=IQ({inputs:{real:n,imag:s},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}return D$({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:a})}};var v1={kernelName:Op,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return I$({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{um.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),um.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=wZ({inputs:t.map(e=>{let t=I$({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}},x1=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=gX(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(r," start = ").concat(r,"(").concat(i,");\n      ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(r," coords = outC - start;\n          setOutput(getX(").concat(o,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}},w1=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=gX(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=QY("rc",a),l=QY("source",a),u="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),c=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d=["".concat(r," rc = outputLoc;"),"".concat(o[a-1]," += 1;\n       if(").concat(u,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(o[a-2]," += 1;\n       if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(o[a-1]," += 1;\n         if(").concat(u,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="";for(let f=0,m=1===a?2:4;f<m;f++)p+="\n        ".concat(d[f],"\n        if (").concat(h,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(r," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(l.join(),"), ").concat(c,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(i,");\n      const ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}},k1=e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,constantValue:s}=a;if(0===um.sizeFromShape(r.shape)){return D$({backend:n,attrs:{shape:i.map((e,t)=>e[0]+r.shape[t]+e[1]),value:s,dtype:r.dtype}})}let o=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new w1(r.shape,i,s):new x1(r.shape,i,s),l=[[s]];return n.runWebGLProgram(o,[r],r.dtype,l)},S1={kernelName:Pp,backendName:"webgl",kernelFunc:k1},I1=MQ({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+xQ+"\n  return result;\n"}),N1={kernelName:zp,backendName:"webgl",kernelFunc:I1};var T1={kernelName:Wp,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r,l=i.shape.length,u=[],c=um.parseAxisParam(s,i.shape),d=c,h=MN.getAxesPermutation(d,l),p=i;if(null!=h&&(p=$Q({inputs:{x:i},backend:a,attrs:{perm:h}}),d=MN.getInnerMostAxes(d.length,l),u.push(p)),MN.assertAxesAreInnerMostDims("prod",d,l),a.shouldExecuteOnCPU([p])){let e=a.texData.get(p.dataId).values,{outVals:n,outShape:r,outDtype:i}=NY(p.shape,p.dtype,e,d);t=a.makeTensorInfo(r,i,n)}else{let[e,n]=MN.computeOutAndReduceShapes(p.shape,d),r=um.sizeFromShape(n),s=jQ({inputs:{x:p},backend:a,attrs:{shape:[-1,r]}}),o=KQ(s,ng(i.dtype),"prod",a);t=jQ({inputs:{x:o},backend:a,attrs:{shape:e}}),u.push(s),u.push(o)}if(o){u.push(t);let e=MN.expandShapeToKeepDim(t.shape,c);t=jQ({inputs:{x:t},backend:a,attrs:{shape:e}})}return u.forEach(e=>a.disposeIntermediateTensorInfo(e)),t}};var C1={kernelName:Vp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.readSync(e.dataId)),u=r.map(e=>e.shape),c=n.readSync(i.dataId),d=n.readSync(s.dataId),[h,p,f]=TY(l,u,c,i.shape,i.dtype,d,s.shape,o),m=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}};var E1={kernelName:Up,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:i}=t,s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[u,c]=CY(s,a.shape,a.dtype,o,r.shape,l,i.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],a.dtype,c)]}};var _1={kernelName:jp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,u=n.readSync(r.dataId),c=n.readSync(i.dataId),d=n.readSync(s.dataId),h=o.map(e=>n.readSync(e.dataId)),p=o.map(e=>e.shape),[f,m]=EY(u,r.shape,c,i.shape,i.dtype,d,s.shape,h,p,l);return n.makeTensorInfo(f,i.dtype,m)}},A1=e=>{let{backend:t,attrs:n}=e,{start:a,stop:r,step:i,dtype:s}=n,o=_Y(a,r,i,s);return t.makeTensorInfo([o.length],s,o)},F1={kernelName:Gp,backendName:"webgl",kernelFunc:A1},R1=DQ({opSnippet:"return 1.0 / x;"}),D1={kernelName:qp,backendName:"webgl",kernelFunc:R1},M1=DQ({opSnippet:rQ+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),O1={kernelName:Kp,backendName:"webgl",kernelFunc:M1},P1=DQ({opSnippet:rQ+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),L1={kernelName:$p,backendName:"webgl",kernelFunc:P1},z1=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,c=[a&&t>1?s-1:s,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n];u=r?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/d[0],",\n          ").concat(c[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(u,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}},B1=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,c=[a&&t>1?s-1:s,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n];u=r?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/d[0],",\n          ").concat(c[1]/d[1],",\n          ").concat(c[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(u,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}};var W1={kernelName:Jp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a,[l,u]=o,c=Td().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new B1(r.shape,l,u,i,s):new z1(r.shape,l,u,i,s);return n.runWebGLProgram(c,[r],"float32")}},V1=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,i,s]=e,o=[n&&i>1?a-1:a,n&&s>1?r-1:r],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(c,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(r-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};var U1={kernelName:Zp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a,o=new V1(i.shape,r.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},j1=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,c=[a&&t>1?s-1:s,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n],h=a?"0.5":"0.0";u=r?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/d[0],",\n          ").concat(c[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(u,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}},G1=class{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u,c=[a&&t>1?s-1:s,a&&n>1?o-1:o],d=[a&&t>1?t-1:t,a&&n>1?n-1:n],h=a?"0.5":"0.0";u=r?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/d[0],",\n          ").concat(c[1]/d[1],",\n          ").concat(c[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(u,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}};var H1={kernelName:Yp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a,[l,u]=o,c=Td().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new G1(r.shape,l,u,i,s):new j1(r.shape,l,u,i,s);return n.runWebGLProgram(c,[r],r.dtype)}},q1=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,i,s]=e,o=[n&&i>1?a-1:a,n&&s>1?r-1:r],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(c,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(o[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(o[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}};var K1={kernelName:Qp,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a,o=new q1(i.shape,r.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},X1=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));let a=e.map((n,a)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(a)).join(","),r=gX(n);this.userCode="\n      void main() {\n        ".concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}},Y1=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;let a=QY("rc",n),r="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),s=gX(n);var o;function l(n){let a=e.map((a,r)=>function(n,a){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(a[n]," - 1"):"".concat(a[n])}(r,n)),r=a.join(","),i=a.slice(-2).join(",");return"getChannel(getX(".concat(r,"), vec2(").concat(i,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(r,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat((o=a.slice(),l(o)),";\n          if(").concat(r,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",l(e)}(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",l(e)}(a.slice()),";\n            if(").concat(r,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",l(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}};var Q1={kernelName:ef,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:i}=a,s=r.shape.length,o=um.parseAxisParam(i,r.shape);if(0===s)return kQ({inputs:{x:r},backend:n});let l=Td().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Y1(r.shape,o):new X1(r.shape,o);return n.runWebGLProgram(l,[r],r.dtype)}},J1=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],a=e[2];this.outputShape=e;let r="";r="number"==typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(r,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}},Z1={kernelName:qf,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:i,fillValue:s,center:o}=n,l=a,u=new J1(r.shape,s),[c,d]=MN.getImageCenter(o,r.shape[1],r.shape[2]),h=[[c,d,Math.sin(i),Math.cos(i)]];return l.runWebGLProgram(u,[r],r.dtype,h)}},$1=DQ({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),e2={kernelName:tf,backendName:"webgl",kernelFunc:$1},t2=DQ({opSnippet:"return inversesqrt(x);",cpuKernelImpl:AY}),n2={kernelName:nf,backendName:"webgl",kernelFunc:t2},a2=class{constructor(e,t,n,a,r,i){let s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let o=gX(r.length),l=gX(i.length),u="";1===n?u="i":2===n&&(u="i, j");let c="getIndices(".concat(u,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let h="getUpdates(".concat(d,")"),p="";s&&(p="coords[0], coords[1]");let f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(c,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}},r2=class{constructor(e,t,n,a,r,i){let s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let o=gX(r.length),l=gX(i.length),u="";1===n?u="i":2===n&&(u="i, j");let c="getIndices(".concat(u,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let h="getUpdates(".concat(d,")"),p="";s&&(p="coords[0], coords[1]");let f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(c,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}};var i2={kernelName:af,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r,updates:i}=t,{shape:s}=a,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=MN.calculateShapes(i,r,s),h=[d/u,u];if(0===d)return n.makeTensorInfo(s,r.dtype);let p,f=jQ({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),m=jQ({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));p=Td().getBool("WEBGL_PACK")?new r2(l,o,f.shape.length,m.shape.length,c,h):new a2(l,o,f.shape.length,m.shape.length,c,h);let y=n.runWebGLProgram(p,[m,f,g],m.dtype),b=jQ({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},s2=class{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let r="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),i=2===Td().getNumber("WEBGL_VERSION")?"while (left < right) {":r,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(i,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}};var o2={kernelName:sf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:i}=t,{side:s}=a,o=new s2(r.shape[0],r.shape[1],i.shape[1],s),l=[[r.shape[1]]];return n.runWebGLProgram(o,[r,i],"int32",l)}},l2=class{constructor(e,t,n){let a,r;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)r="resRC",a="resRC";else{let n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],s=[];for(let a=0;a<t.length;a++)s.push("".concat(n[a])),a<e&&i.push("".concat(n[a]));a=i.join(),r=s.join()}let i=gX(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(r,"));\n        } else {\n          setOutput(getB(").concat(r,"));\n        }\n      }\n    ")}};var u2={kernelName:of,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:i}=t,s=new l2(a.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(s,[a,r,i],tg(r.dtype,i.dtype))}},c2=DQ({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(MN.SELU_SCALEALPHA,";\n  float scale = ").concat(MN.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),d2={kernelName:lf,backendName:"webgl",kernelFunc:c2},h2=DQ({opSnippet:RQ+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:RY}),p2={kernelName:pf,backendName:"webgl",kernelFunc:h2},f2=DQ({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),m2={kernelName:hf,backendName:"webgl",kernelFunc:f2},g2=DQ({opSnippet:RQ+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(xQ,"\n  return result;\n")}),y2={kernelName:cf,backendName:"webgl",kernelFunc:g2},b2=DQ({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),v2={kernelName:df,backendName:"webgl",kernelFunc:b2},x2=DQ({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),w2={kernelName:ff,backendName:"webgl",kernelFunc:x2},k2={kernelName:yf,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,paddings:s}=a;um.assert(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=[[0,0]];l.push(...s);for(let y=1+i.length;y<r.shape.length;++y)l.push([0,0]);let u=[],c=k1({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=MN.getReshaped(c.shape,i,o,!1),h=MN.getPermuted(d.length,i.length,!1),p=MN.getReshapedPermuted(c.shape,i,o,!1),f=jQ({inputs:{x:c},backend:n,attrs:{shape:d}}),m=$Q({inputs:{x:f},backend:n,attrs:{perm:h}}),g=jQ({inputs:{x:m},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}};var S2={kernelName:xf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(a.shape));if(1!==r.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(r.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.readSync(a.dataId),l=n.readSync(r.dataId),u=n.readSync(i.dataId),c=n.readSync(s.dataId)[0],[d,h,p,f,m]=OY(o,a.shape,a.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(h,a.dtype,d),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}};var I2={kernelName:wf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:i}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(r.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.readSync(r.dataId)),o=n.readSync(a.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,d]=PY(o,a.shape,a.dtype,s,l);return[n.makeTensorInfo(c,a.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}};var N2={kernelName:kf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(r.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));let s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[u,c]=LY(s,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(c,a.dtype,u)}};var T2={kernelName:Sf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(r.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));let s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[u,c]=LY(s,a.shape,a.dtype,o,l);return n.makeTensorInfo(c,a.dtype,u)}};var C2={kernelName:If,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sparseIndices:r,sparseValues:i,defaultValue:s}=t,{outputShape:o}=a,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=MN.calculateShapes(i,r,o),p=!1;if("string"===i.dtype){let e=n.bufferSync(r),t=n.bufferSync(i),a=um.decodeString(n.readSync(s.dataId)[0]),f=FY(e,t,o,h,c,u,l,d,a,p);return n.makeTensorInfo(o,f.dtype,f.values)}let f=new a2(u,l,r.shape.length,i.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[i,r,s],i.dtype),g=jQ({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),g}};var E2={kernelName:bf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:i,axis:s}=a,o=um.parseAxisParam(s,r.shape)[0],l=MN.prepareSplitSize(r,i,o),u=r.shape.length,c=new Array(u).fill(0),d=r.shape.slice();return l.map(e=>{let t=[...d];t[o]=e;let a=YJ({inputs:{x:r},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,a})}},_2="return sqrt(x);",A2=DQ({opSnippet:_2,packedOpSnippet:_2,cpuKernelImpl:zY}),F2={kernelName:mf,backendName:"webgl",kernelFunc:A2},R2=DQ({opSnippet:"return x * x;"}),D2={kernelName:Tf,backendName:"webgl",kernelFunc:R2},M2="return (a - b) * (a - b);",O2=MQ({opSnippet:M2,packedOpSnippet:M2}),P2={kernelName:Nf,backendName:"webgl",kernelFunc:O2};var L2={kernelName:Cf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");let i=n.readSync(r.dataId),s=MN.fromUint8ToStringArray(i),o=BY(s,"string",a);return n.makeTensorInfo(r.shape,"string",o)}};var z2={kernelName:Gf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,i=rQ+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),s=new aQ(r.shape,i);return a.runWebGLProgram(s,[r],r.dtype)}},B2=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let a=n.length,r=gX(n.length),i=gX(n.length),s="";if(1===a)s="coords * strides + begin";else{let e=0;s=n.map((t,a)=>(e++,1===n.length?"coords * strides[".concat(a,"] + begin[").concat(a,"]"):"coords[".concat(e-1,"] * strides[").concat(a,"] + begin[").concat(a,"]"))).join(",")}this.userCode="\n      ".concat(r," begin = ").concat(r,"(").concat(e,");\n      ").concat(r," strides = ").concat(r,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}};var W2={kernelName:Ef,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:u,endMask:c,ellipsisMask:d,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=lN.sliceInfo(i.shape,s,o,l,u,c,d,h,p);if(g)t=jQ({inputs:{x:i},backend:a,attrs:{shape:m}});else if(y||b){um.assert(i.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(i.shape.length));let e=lN.computeOutShape(v,x,w),n=YJ({inputs:{x:i},backend:a,attrs:{begin:v,size:e}});t=jQ({inputs:{x:n},backend:a,attrs:{shape:m}}),a.disposeIntermediateTensorInfo(n)}else if(a.shouldExecuteOnCPU([i])){let e=a.readSync(i.dataId),n=Zy(i.shape,i.dtype,e),r=WY(f,n,w,v);t=a.makeTensorInfo(m,i.dtype,r.values)}else{let e=new B2(v,w,f);t=a.runWebGLProgram(e,[i],i.dtype)}let k=jQ({inputs:{x:t},backend:a,attrs:{shape:m}});return a.disposeIntermediateTensorInfo(t),k}};var V2={kernelName:_f,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=a,{data:c,dataSplits:d}=t,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=VY(h,p,r,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};var U2={kernelName:Af,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==s.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let o=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[u,c,d]=UY(o,l,r),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var j2={kernelName:Ff,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(i.dataId),o=jY(s,r);return n.makeTensorInfo(i.shape,"int32",o)}},G2=DQ({opSnippet:"return tan(x);"}),H2={kernelName:Df,backendName:"webgl",kernelFunc:G2},q2=DQ({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),K2={kernelName:Mf,backendName:"webgl",kernelFunc:q2};var X2={kernelName:rf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{tensor:r,indices:i,updates:s}=t,{}=a,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=MN.calculateShapes(s,i,r.shape),h=[d/u,u];if(0===d)return n.makeTensorInfo(r.shape,i.dtype);let p=jQ({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),f=jQ({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),m=jQ({inputs:{x:r},backend:n,attrs:{shape:h}}),g=new a2(l,o,p.shape.length,f.shape.length,c,h,!1,!0),y=n.runWebGLProgram(g,[f,p,m],m.dtype),b=jQ({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}},Y2=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;let a=gX(this.rank),r=function(e){let t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],a=[];for(let r=0;r<e.length;r++)a.push("imod(".concat(n[r],", ").concat(e[r],")"));return a.join()}(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(r,"));\n      }\n    ")}};function Q2(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:i}=a;if("string"===r.dtype||r.shape.length>5){let e=n.readSync(r.dataId),t="string"===r.dtype?e.map(e=>um.decodeString(e)):e,a=Zy(r.shape,r.dtype,t),s=HY(a,i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}let s=new Y2(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}var J2={kernelName:Of,backendName:"webgl",kernelFunc:Q2},Z2=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}},$2=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}};function e3(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function t3(e){let t=1;for(;t<e;)t*=2;return t}var n3={kernelName:Pf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:i,sorted:s}=a,o=Td().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Td().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([r])||c<o||i>l){let e=n.readSync(r.dataId),[t,a]=qY(e,u,r.dtype,i,s);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(a.shape,a.dtype,a.values)]}if(0===i)return u[u.length-1]=0,[n.makeTensorInfo(u,r.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===c)return[r,D$({attrs:{shape:u,dtype:"int32",value:0},backend:n})];let d=n.texData.get(r.dataId),h=null!==d&&d.isPacked,p=h?n.unpackTensor(r):r,f=um.sizeFromShape(u)/c,m=jQ({inputs:{x:p},attrs:{shape:[f,c]},backend:n});h&&e3(n,p);let g=t3(i),y=t3(c),b=null,v=()=>null===b?[m,m]:[m,b],x=(e,t,a)=>{let r=v(),i=new Z2(a),s=[[c],[null===b?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],o=b;b=n.runWebGLProgram(i,r,"int32",s),e3(n,o)};for(let N=1;N<g;N*=2){let e=2*N;for(let t=N;t>=1;t/=2)x(e,t,[f,y])}for(let N=y;N>g;N/=2){let e=v(),t=new $2([f,N/2]),a=[[c],[null===b?1:0],[g]],r=b;b=n.runWebGLProgram(t,e,"int32",a),e3(n,r);let i=g/2,s=2*i;for(let n=i;n>=1;n/=2)x(s,n,b.shape)}let w=b;b=YJ({inputs:{x:b},backend:n,attrs:{begin:0,size:[f,i]}}),e3(n,w);let k=Z$({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});e3(n,m);let S=u.slice(0,-1);S.push(i),w=b,b=jQ({inputs:{x:b},attrs:{shape:S},backend:n}),e3(n,w);let I=k;return k=jQ({inputs:{x:k},attrs:{shape:S},backend:n}),e3(n,I),[k,b]}},a3=class{constructor(e,t,n,a,r,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let s,o="nearest"===n?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(r,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(r,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}};var r3={kernelName:Lf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=a,[c,d,h,p]=r.shape,[f,m]=null!=u?u:[d,h],g=new a3(d,h,s,o,l,[c,f,m,p]);return n.runWebGLProgram(g,[r,i],"float32")}};var i3={kernelName:Bf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:i}=t;ZK(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=a.readSync(i.dataId),{outputValues:o,outputShape:l,indices:u}=XY(s,r,i.shape,i.dtype);return[a.makeTensorInfo(l,i.dtype,o),a.makeTensorInfo([u.length],"int32",u)]}};var s3={kernelName:Wf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:i}=a;i<0&&(i+=r.shape.length);let s=r,o=s.shape.length,l=r.shape[i],u=new Array(o-1),c=0;for(let m=0;m<o;m++)m!==i&&(u[c++]=s.shape[m]);let d=[],h=new Array(o).fill(0),p=s.shape.slice();p[i]=1;let f=new Array(l);for(let m=0;m<f.length;m++){h[i]=m;let e=YJ({inputs:{x:s},backend:n,attrs:{begin:h,size:p}}),t=jQ({inputs:{x:e},backend:n,attrs:{shape:u}});f[m]=t,d.push(e)}return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}},o3=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,s=i*Math.ceil(r/n);this.outputShape=[a,s];let o=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ",c="";r%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      "));let d="";r%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(u,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(u,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(u,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}};var l3,u3,c3,d3={kernelName:Vf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:i}=t,{numSegments:s}=a,o=r.shape.length,l=[],u=0,c=MN.getAxesPermutation([u],o),d=r;null!=c&&(d=$Q({inputs:{x:r},backend:n,attrs:{perm:c}}),l.push(d),u=MN.getInnerMostAxes(1,o)[0]);let h=MN.segment_util.computeOutShape(d.shape,u,s),p=um.sizeFromShape([d.shape[u]]),f=jQ({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);let m=ng(r.dtype),g=(e,t,a,r,i)=>{let s=e.shape[0],o=e.shape[1],u=MN.segment_util.segOpComputeOptimalWindowSize(o,i),c=new o3({windowSize:u,inSize:o,batchSize:s,numSegments:i},t),d=n.compileAndRun(c,[e,a],r);if(l.push(d),d.shape[1]===i)return d;let h=A1({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),p=Q2({inputs:{x:h},backend:n,attrs:{reps:[o/u]}});return l.push(h),l.push(p),g(d,t,p,r,i)},y=jQ({inputs:{x:g(f,"unsortedSegmentSum",i,m,s)},backend:n,attrs:{shape:h}}),b=y;if(null!=c){l.push(y);let e=MN.getUndoAxesPermutation(c);b=$Q({inputs:{x:b},backend:n,attrs:{perm:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),b}},h3=[nJ,rJ,sJ,lJ,dJ,fJ,mJ,gJ,kJ,SJ,NJ,CJ,_J,FJ,DJ,PJ,LJ,WJ,VJ,UJ,HJ,JJ,ZJ,$J,eZ,iZ,lZ,dZ,NQ,fZ,kZ,AZ,OZ,LZ,zZ,BZ,VZ,jZ,HZ,KZ,ZZ,$Z,e$,n$,i$,l$,u$,d$,p$,f$,g$,y$,v$,w$,S$,N$,E$,F$,O$,L$,W$,U$,H$,K$,X$,Q$,$$,t0,a0,SQ,r0,vZ,s0,l0,c0,EQ,h0,f0,m0,y0,v0,w0,S0,N0,E0,A0,R0,M0,O0,P0,B0,W0,V0,U0,j0,H0,X0,Q0,i1,UQ,o1,u1,d1,p1,nZ,m1,b1,v1,S1,N1,FQ,T1,C1,E1,_1,F1,rZ,$0,D1,O1,L1,GQ,W1,U1,H1,K1,Q1,Z1,e2,n2,i2,o2,u2,d2,p2,m2,y2,v2,QJ,r1,w2,k2,S2,I2,N2,T2,C2,E2,F2,D2,P2,L2,z2,W2,V2,U2,j2,n1,ZQ,H2,K2,X2,J2,n3,r3,eJ,i3,s3,d3,y1];for(let n of h3)am(n);!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(l3||(l3={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(u3||(u3={}));var p3={kernelName:Kf,backendName:"wasm",setupFunc:function(e){c3=e.wasm.cwrap(Kf,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i,bias:s,preluActivationWeights:o}=t;if("float32"!==r.dtype||"float32"!==i.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=a,h=n.dataIdMap.get(r.dataId).id,p=n.dataIdMap.get(i.dataId).id,f=0;if(null!=s){let e=n.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error("_FusedMatMul only supports rank-1 bias but got rank ".concat(e.shape.length,"."));f=e.id}let m=null==o?0:n.dataIdMap.get(o.dataId).id,g=u3[c];if(null==g)throw new Error("".concat(c," activation not yet supported for FusedConv2D in the wasm backend."));let y=l?r.shape[2]:r.shape[1],b=u?i.shape[1]:i.shape[2],v=kv.assertAndGetBroadcastShape(r.shape.slice(0,-2),i.shape.slice(0,-2)),x=n.makeOutput([...v,y,b],r.dtype),w=n.dataIdMap.get(x.dataId).id,k=new Uint8Array(new Int32Array(r.shape).buffer),S=new Uint8Array(new Int32Array(i.shape).buffer);return c3(h,k,r.shape.length,p,S,i.shape.length,l,u,g,f,m,d||0,w),x}};function f3(e,t){let n;return{kernelName:e,backendName:"wasm",setupFunc:function(t){n=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){let{backend:a,inputs:{x:r}}=e,i=a.dataIdMap.get(r.dataId).id,s=a.makeOutput(r.shape,t||r.dtype),o=a.dataIdMap.get(s.dataId).id;return 0===um.sizeFromShape(s.shape)||n(i,l3[r.dtype],o),s}}}var m3=f3(Fd),g3=f3(Rd),y3=f3(Dd);function b3(e,t,n){let a;return{kernelName:e,backendName:"wasm",setupFunc:function(t){a=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:r}=e,{a:i,b:s}=r,o=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(s.dataId).id,u=null!=n?n:i.dtype,c=MN.assertAndGetBroadcastShape(i.shape,s.shape),d=t.makeOutput(c,u);if(0===um.sizeFromShape(c))return d;let h=new Uint8Array(new Int32Array(i.shape).buffer),p=new Uint8Array(new Int32Array(s.shape).buffer),f=t.dataIdMap.get(d.dataId).id;return a(o,h,i.shape.length,l,p,s.shape.length,l3[i.dtype],f),d}}}var v3,x3=b3(Md);var w3={kernelName:Od,backendName:"wasm",setupFunc:function(e){v3=e.wasm.cwrap(Od,null,["array","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,a=n.makeOutput(t[0].shape,t[0].dtype);if(0===um.sizeFromShape(a.shape))return a;let r=t.map(e=>n.dataIdMap.get(e.dataId).id),i=new Uint8Array(new Int32Array(r).buffer),s=n.dataIdMap.get(a.dataId).id;return v3(i,r.length,l3[a.dtype],s),a}};function k3(e){let{inputs:{x:t},backend:n}=e;if("string"===t.dtype)return Fg(n.readSync(t.dataId),t.shape,t.dtype);let a=n.makeOutput(t.shape,t.dtype),r=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(r),a}var S3,I3={kernelName:Kh,backendName:"wasm",kernelFunc:k3};function N3(e){let{inputs:t,backend:n,attrs:a}=e,[r,i]=function(e,t){let n=[],a=[];for(let r=0;r<e.length;++r)1!==e[r]&&n.push(e[r]),1!==e[t[r]]&&a.push(t[r]);for(let r=0;r<a.length;++r){let e=-1;for(let t=0;t<a.length;++t)a[t]>=r&&(-1===e||a[e]>a[t])&&(e=t);a[e]=r}return[n,a]}(t.x.shape,a.perm),s=!0;for(let f=0;f<i.length;f++)i[f]!==f&&(s=!1);let o=function(e,t){let n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];return n}(t.x.shape,a.perm),l={dataId:t.x.dataId,shape:r,dtype:t.x.dtype};if(s){let e=k3({inputs:t,backend:n});return e.shape=o,e}let u=n.makeOutput(o,l.dtype),c=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(u.dataId).id,h=new Uint8Array(new Int32Array(i).buffer),p=new Uint8Array(new Int32Array(l.shape).buffer);return S3(c,p,l.shape.length,l3[l.dtype],d,h,i.length),u}var T3,C3={kernelName:zf,backendName:"wasm",kernelFunc:N3,setupFunc:function(e){S3=e.wasm.cwrap(zf,null,["number","array","number","number","number","array","number"])}};function E3(e,t,n){let a=e.shape,r=e.shape.length,i=um.parseAxisParam(t,a),s=i,o=MN.getAxesPermutation(s,r),l=null,u=!1;if(null!=o){let t=new Array(r);for(let e=0;e<t.length;e++)t[e]=a[o[e]];s=MN.getInnerMostAxes(s.length,r),l=N3({inputs:{x:e},attrs:{perm:o},backend:n});let i=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==i&&(u=!0)}return{transposed:l,originalAxes:i,axes:s,inputWasTransposed:u}}var _3,A3={kernelName:Pd,backendName:"wasm",setupFunc:function(e){T3=e.wasm.cwrap(Pd,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:h}=E3(s,r,t);if(h){l=u,o=t.dataIdMap.get(u.dataId).id}let p=l.shape.length;MN.assertAxesAreInnerMostDims("all",c,p);let[f,m]=MN.computeOutAndReduceShapes(l.shape,c),g=um.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(0!==um.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;T3(o,g,e)}if(h&&t.disposeData(u.dataId),i){let e=MN.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}};var F3={kernelName:Ld,backendName:"wasm",setupFunc:function(e){_3=e.wasm.cwrap(Ld,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:h}=E3(s,r,t);if(h){l=u,o=t.dataIdMap.get(u.dataId).id}let p=l.shape.length;MN.assertAxesAreInnerMostDims("any",c,p);let[f,m]=MN.computeOutAndReduceShapes(l.shape,c),g=um.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(0!==um.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;_3(o,g,e)}if(h&&t.disposeData(u.dataId),i){let e=MN.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}};function R3(e){let t;return{kernelName:e,backendName:"wasm",setupFunc:function(n){t=n.wasm.cwrap(e,null,["number","number","number","number","number"])},kernelFunc:function(e){let{backend:n,inputs:a,attrs:r}=e,{axis:i}=r,{x:s}=a,o=n.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,inputWasTransposed:h}=E3(s,i,n);if(h){let e=n.dataIdMap.get(c.dataId).id;e!==o&&(u=c,l=e)}let p=u.shape.slice(0,-1),f=n.makeOutput(p,"int32"),m=n.dataIdMap.get(f.dataId).id,g=um.sizeFromShape(f.shape),y=u.shape[d[0]];return t(l,l3[u.dtype],g,y,m),h&&n.disposeData(c.dataId),f}}}var D3,M3=R3(zd),O3=R3(Bd),P3=f3(Wd),L3=f3(Vd),z3=f3(Ud),B3=b3(Gd),W3=f3(jd);var V3,U3={kernelName:Hd,backendName:"wasm",setupFunc:function(e){D3=e.wasm.cwrap(Hd,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,r=t.x,i=a.dataIdMap.get(r.dataId).id,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,c=MN.computePool2DInfo(r.shape,s,o,1,l,u),d=c.filterHeight,h=c.filterWidth,p=c.padInfo.top,f=c.padInfo.right,m=c.padInfo.bottom,g=c.padInfo.left,y=c.strideHeight,b=c.strideWidth,v=c.inChannels;if("channelsLast"!==c.dataFormat)throw new Error("wasm backend does not support dataFormat:'".concat(c.dataFormat,"'. Please use 'channelsLast'."));if(1!==c.dilationWidth||1!==c.dilationHeight)throw new Error("was backend only supports average pooling with dilation = [1, 1], got [".concat(c.dilationHeight,", ").concat(c.dilationWidth,"]."));let x=a.makeOutput(c.outShape,"float32"),w=a.dataIdMap.get(x.dataId).id;return D3(i,r.shape[0],r.shape[1],r.shape[2],d,h,p,f,m,g,y,b,v,w),x}};var j3,G3={kernelName:Kd,backendName:"wasm",setupFunc:function(e){V3=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=a,c=MN.computePool3DInfo(r.shape,i,s,1,o,l,u),d=n.makeOutput(c.outShape,r.dtype);return V3(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}};var H3,q3={kernelName:Xd,backendName:"wasm",setupFunc:function(e){j3=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a,c=MN.computePool3DInfo(i.shape,s,o,1,l,u),d=n.makeOutput(i.shape,i.dtype);return j3(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left,c.filterDepth,c.filterHeight,c.filterWidth),d}};var K3={kernelName:qd,backendName:"wasm",setupFunc:function(e){H3=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l}=a,u=MN.computePool2DInfo(i.shape,s,o,1,l),c=n.makeOutput(i.shape,i.dtype);return H3(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left,u.filterHeight,u.filterWidth),c}};function X3(e){let{inputs:t,attrs:n}=e,{x:a}=t,{shape:r}=n,i=um.sizeFromShape(a.shape),s=um.inferFromImplicitShape(r,i);return um.assert(i===um.sizeFromShape(s),()=>"new shape: ".concat(s,", old shape: ").concat(a.shape,". New shape and old shape must have the same number of elements.")),e.backend.incRef(a.dataId),{dataId:a.dataId,shape:s,dtype:a.dtype}}var Y3,Q3={kernelName:Xp,backendName:"wasm",kernelFunc:X3};var J3={kernelName:Yd,backendName:"wasm",setupFunc:function(e){Y3=e.wasm.cwrap(Yd,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i}=t,{transposeA:s,transposeB:o}=a;if("float32"!==r.dtype||"float32"!==i.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=r.shape.length,u=i.shape.length,c=s?r.shape[l-2]:r.shape[l-1],d=o?i.shape[u-1]:i.shape[u-2],h=s?r.shape[l-1]:r.shape[l-2],p=o?i.shape[u-2]:i.shape[u-1],f=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=um.sizeFromShape(f),y=um.sizeFromShape(m),b=kv.assertAndGetBroadcastShape(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,p]);um.assert(c===d,()=>"Error in matMul: inner shapes (".concat(c,") and (").concat(d,") of Tensors with shapes ").concat(r.shape," and ").concat(i.shape," and transposeA=").concat(s," and transposeB=").concat(o," must match."));let v=o?[y,p,d]:[y,d,p],x=X3({inputs:{x:r},backend:n,attrs:{shape:s?[g,c,h]:[g,h,c]}}),w=X3({inputs:{x:i},backend:n,attrs:{shape:v}}),k=n.dataIdMap.get(x.dataId).id,S=n.dataIdMap.get(w.dataId).id,I=s?x.shape[2]:x.shape[1],N=o?w.shape[1]:w.shape[2],T=Math.max(g,y),C=n.makeOutput([T,I,N],x.dtype),E=n.dataIdMap.get(C.dataId).id,_=new Uint8Array(new Int32Array(x.shape).buffer),A=new Uint8Array(new Int32Array(w.shape).buffer);return Y3(k,_,x.shape.length,S,A,w.shape.length,s,o,E),n.disposeData(x.dataId),n.disposeData(w.dataId),C.shape=b,C}};function Z3(e){let{inputs:{x:t},attrs:{begin:n,size:a},backend:r}=e,[i,s]=lN.parseSliceParams(t,n,a),o=lN.isSliceContinous(t.shape,i,s),l=r.readSync(t.dataId),u=r.makeOutput(s,t.dtype),c=um.computeStrides(t.shape),d=r.dataIdMap.get(u.dataId);if(o){let e=lN.computeFlatOffset(i,c);return"string"===t.dtype?d.stringBytes=l.slice(e,e+um.sizeFromShape(s)):r.typedArrayFromHeap(u).set(l.subarray(e,e+um.sizeFromShape(s))),u}if("string"===t.dtype){let e=sU(l,i,s,t.shape,t.dtype);return d.stringBytes=e,u}let h=r.typedArrayFromHeap(u),p=t.shape.length;if(2===p)!function(e,t,n,a,r){let i=0,s=a[0],o=a[1],l=s+r[0];for(let u=s;u<l;u++){let a=u*t+o;n.set(e.subarray(a,a+r[1]),i),i+=r[1]}}(l,c[0],h,i,s);else if(3===p)!function(e,t,n,a,r,i){let s=0,o=r[0],l=r[1],u=r[2],c=o+i[0],d=l+i[1];for(let h=o;h<c;h++)for(let r=l;r<d;r++){let o=h*t+r*n+u;a.set(e.subarray(o,o+i[2]),s),s+=i[2]}}(l,c[0],c[1],h,i,s);else if(4===p)!function(e,t,n,a,r,i,s){let o=0,l=i[0],u=i[1],c=i[2],d=l+s[0],h=u+s[1],p=c+s[2],f=i[3];for(let m=l;m<d;m++)for(let i=u;i<h;i++)for(let l=c;l<p;l++){let u=m*t+i*n+l*a+f;r.set(e.subarray(u,u+s[3]),o),o+=s[3]}}(l,c[0],c[1],c[2],h,i,s);else{let e=sU(l,i,s,t.shape,t.dtype);h.set(e)}return u}var $3={kernelName:uf,backendName:"wasm",kernelFunc:Z3};var e4,t4={kernelName:Qd,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,crops:s}=a,o=i.reduce((e,t)=>e*t),l=MN.getReshaped(r.shape,i,o),u=MN.getPermuted(l.length,i.length),c=MN.getReshapedPermuted(r.shape,i,o),d=MN.getSliceBeginCoords(s,i.length),h=MN.getSliceSize(c,s,i.length),p=X3({inputs:{x:r},backend:n,attrs:{shape:l}}),f=N3({inputs:{x:p},backend:n,attrs:{perm:u}}),m=X3({inputs:{x:f},backend:n,attrs:{shape:c}}),g=Z3({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeData(p.dataId),n.disposeData(f.dataId),n.disposeData(m.dataId),g}};var n4={kernelName:Jd,backendName:"wasm",setupFunc:function(e){e4=e.wasm.cwrap(Jd,null,["number","number","boolean","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,weights:i}=n,{size:s}=a,o=0!==i.shape.reduce((e,t)=>e*t,1),l=1===r.shape.length?[s]:[r.shape[0],s],u=t.makeOutput(l,i.dtype);function c(e){return t.dataIdMap.get(e.dataId).id}return e4(c(r),s,o,c(i),l3[i.dtype],c(u)),u}},a4=b3(Zd);var r4={kernelName:eh,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,i=n.typedArrayFromHeap(a),s=n.typedArrayFromHeap(r),o=MN.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}};function i4(e){let{inputs:{x:t},attrs:{dtype:n},backend:a}=e,r=a.makeOutput(t.shape,n),i=a.typedArrayFromHeap(t);return a.typedArrayFromHeap(r).set(i),r}var s4,o4={kernelName:th,backendName:"wasm",kernelFunc:i4},l4=f3(nh);var u4={kernelName:ah,backendName:"wasm",setupFunc:function(e){s4=e.wasm.cwrap(ah,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{clipValueMin:i,clipValueMax:s}=a,o=n.dataIdMap.get(r.dataId).id,l=n.makeOutput(r.shape,r.dtype),u=n.dataIdMap.get(l.dataId).id;return s4(o,i,s,u),l}};function c4(e){let{inputs:t,backend:n}=e,a=um.parseAxisParam(e.attrs.axis,t[0].shape)[0],r=t.map(e=>e.shape);MN.assertParamsConsistent(r,a);let i=MN.computeOutShape(t.map(e=>e.shape),a),s=t.filter(e=>um.sizeFromShape(e.shape)>0);if(1===s.length)return k3({inputs:{x:s[0]},backend:n});let o=n.makeOutput(i,t[0].dtype);if(0===um.sizeFromShape(i))return o;if("string"===s[0].dtype){let e=s.map(e=>{let t=[-1,um.sizeFromShape(e.shape.slice(a))];return X3({inputs:{x:e},backend:n,attrs:{shape:t}})}),r=e.map(e=>({vals:n.readSync(e.dataId),shape:e.shape}));i=MN.computeOutShape(e.map(e=>e.shape),1);let l=1===e[0].shape[0],u=WW(r,i,t[0].dtype,l),c=MN.computeOutShape(s.map(e=>e.shape),a);return o.shape=c,n.dataIdMap.get(o.dataId).stringBytes=MN.fromStringArrayToUint8(u),e.forEach(e=>n.disposeData(e.dataId)),o}let l=um.sizeFromShape(s[0].shape.slice(0,a)),u=0,c=s.map(e=>{let t=um.sizeFromShape(e.shape.slice(a));return u+=t,t}),d=s.map(e=>n.typedArrayFromHeap(e)),h=n.typedArrayFromHeap(o);for(let p=0;p<l;p++){let e=p*u;for(let t=0;t<d.length;t++){let n=c[t],a=p*n,r=d[t].subarray(a,a+n);h.set(r,e),e+=n}}return o}var d4,h4={kernelName:sh,backendName:"wasm",kernelFunc:c4};var p4,f4={kernelName:oh,backendName:"wasm",setupFunc:function(e){d4=e.wasm.cwrap(oh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:i}=t,s=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(i.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d,dataFormat:h}=n,p=MN.convertConv2DDataFormat(h),f=MN.computeConv2DInfo(r.shape,i.shape,l,u,c,d,!1,p),m=f.filterHeight,g=f.filterWidth,y=f.padInfo.top,b=f.padInfo.right,v=f.padInfo.bottom,x=f.padInfo.left,w=f.dilationHeight,k=f.dilationWidth,S=f.strideHeight,I=f.strideWidth,N=f.inChannels,T=f.outChannels,C="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error("wasm backend Conv2D does not support dataFormat:'".concat(f.dataFormat,"'. Please use 'channelsLast'."));let E=a.makeOutput(f.outShape,"float32"),_=a.dataIdMap.get(E.dataId).id;return d4(s,r.shape[0],r.shape[1],r.shape[2],o,m,g,y,b,v,x,C,w,k,S,I,N,T,_),E}};var m4,g4={kernelName:uh,backendName:"wasm",setupFunc:function(e){p4=e.wasm.cwrap(uh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{dy:r,filter:i}=n,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,inputShape:c}=a,d=MN.convertConv2DDataFormat(l),h=MN.computeConv2DInfo(c,i.shape,s,1,o,u,!1,d),{batchSize:p,filterHeight:f,filterWidth:m,inChannels:g,inHeight:y,inWidth:b,outChannels:v,outHeight:x,outWidth:w,strideHeight:k,strideWidth:S}=h,I=f-1-h.padInfo.top,N=m-1-h.padInfo.left,T="channelsLast"===h.dataFormat,C=um.computeStrides(h.inShape),E=um.computeStrides(r.shape),[_,A,F]=um.computeStrides(i.shape),R=C[0],D=T?C[1]:C[2],M=T?C[2]:1,O=T?1:C[1],P=E[0],L=T?E[1]:E[2],z=T?E[2]:1,B=T?1:E[1],W=t.makeOutput(h.inShape,"float32"),V=t.dataIdMap.get(W.dataId).id,U=t.dataIdMap.get(r.dataId).id,j=t.dataIdMap.get(i.dataId).id;return p4(U,j,p,f,m,y,b,g,x,w,v,k,S,I,N,_,A,F,R,D,M,O,P,L,z,B,V),W}};var y4,b4={kernelName:ch,backendName:"wasm",setupFunc:function(e){m4=e.wasm.cwrap(ch,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a;if("float32"!==r.dtype)throw new Error("Tensor x must have dtype float32, got ".concat(r.dtype));if("float32"!==i.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let u=MN.computeConv3DInfo(r.shape,i.shape,s,l,o),c=n.makeOutput(u.outShape,r.dtype);return m4(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}};var v4,x4={kernelName:dh,backendName:"wasm",setupFunc:function(e){y4=e.wasm.cwrap(dh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,filterShape:l}=a;if("float32"!==r.dtype)throw new Error("Tensor dy must have dtype float32, got ".concat(r.dtype));if("float32"!==i.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let u=MN.computeConv3DInfo(r.shape,l,s,1,o),c=n.makeOutput(u.filterShape,i.dtype);return y4(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}};var w4,k4,S4={kernelName:hh,backendName:"wasm",setupFunc:function(e){v4=e.wasm.cwrap(hh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{pad:s,strides:o,inputShape:l}=a;if("float32"!==r.dtype)throw new Error("Tensor dy must have dtype float32, got ".concat(r.dtype));if("float32"!==i.dtype)throw new Error("Tensor filter must have dtype float32, got ".concat(i.dtype));let u=MN.computeConv3DInfo(l,i.shape,o,1,s),c=n.makeOutput(u.inShape,r.dtype);return v4(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}},I4=f3(ph),N4=f3(fh);!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(w4||(w4={}));var T4,C4={kernelName:yh,backendName:"wasm",setupFunc:function(e){k4=e.wasm.cwrap(yh,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{method:i,extrapolationValue:s,cropSize:o}=r,{image:l,boxes:u,boxInd:c}=a,d=u.shape[0],[h,p]=o,f=[d,h,p,l.shape[3]],m=n.dataIdMap.get(l.dataId);"float32"!==l.dtype&&(t=i4({backend:n,inputs:{x:l},attrs:{dtype:"float32"}}),m=n.dataIdMap.get(t.dataId));let g=m.id,y=n.dataIdMap.get(u.dataId).id,b=n.dataIdMap.get(c.dataId).id,v=n.makeOutput(f,"float32"),x=n.dataIdMap.get(v.dataId).id,w=new Uint8Array(new Int32Array(l.shape).buffer);return k4(g,y,b,d,w,h,p,w4[i],s,x),null!=t&&n.disposeData(t.dataId),v}};var E4,_4={kernelName:mh,backendName:"wasm",setupFunc:function(e){T4=e.wasm.cwrap(mh,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a,l=r.shape.length;um.assert("float32"===r.dtype||"int32"===r.dtype,()=>"cumprod does not support ".concat(r.dtype," tensors in the WASM backend"));let u=MN.getAxesPermutation([i],l),c=r;null!==u&&(c=N3({inputs:{x:r},attrs:{perm:u},backend:n}));let d=MN.getInnerMostAxes(1,l)[0];MN.assertAxesAreInnerMostDims("cumprod",[d],l);let h=n.makeOutput(c.shape,c.dtype),p=c.shape[d],f=n.dataIdMap.get(c.dataId).id,m=n.dataIdMap.get(h.dataId).id;T4(f,s?1:0,o?1:0,p,m,l3[r.dtype]);let g=h;if(null!==u){g=N3({inputs:{x:h},attrs:{perm:MN.getUndoAxesPermutation(u)},backend:n}),n.disposeData(c.dataId),n.disposeData(h.dataId)}return g}};var A4,F4={kernelName:gh,backendName:"wasm",setupFunc:function(e){E4=e.wasm.cwrap(gh,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a,l=r.shape.length;um.assert("float32"===r.dtype||"int32"===r.dtype,()=>"cumsum does not support ".concat(r.dtype," tensors in the WASM backend"));let u=MN.getAxesPermutation([i],l),c=r;null!==u&&(c=N3({inputs:{x:r},attrs:{perm:u},backend:n}));let d=MN.getInnerMostAxes(1,l)[0];MN.assertAxesAreInnerMostDims("cumsum",[d],l);let h=n.makeOutput(c.shape,c.dtype),p=c.shape[d],f=n.dataIdMap.get(c.dataId).id,m=n.dataIdMap.get(h.dataId).id;E4(f,s?1:0,o?1:0,p,m,l3[r.dtype]);let g=h;if(null!==u){g=N3({inputs:{x:h},attrs:{perm:MN.getUndoAxesPermutation(u)},backend:n}),n.disposeData(c.dataId),n.disposeData(h.dataId)}return g}};var R4,D4={kernelName:bh,backendName:"wasm",setupFunc:function(e){A4=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,weights:i}=n,{size:s,binaryOutput:o}=a,l=0!==i.shape.reduce((e,t)=>e*t,1),u=1===r.shape.length?[s]:[r.shape[0],s],c=t.makeOutput(u,i.dtype);function d(e){return t.dataIdMap.get(e.dataId).id}return A4(d(r),new Uint8Array(new Int32Array(r.shape).buffer),r.shape.length,s,l,d(i),l3[i.dtype],o,d(c)),c}};var M4,O4={kernelName:vh,backendName:"wasm",setupFunc:function(e){R4=e.wasm.cwrap(vh,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r}=n,{blockSize:i,dataFormat:s}=a,o=r.shape[0],l=("NHWC"===s?r.shape[1]:r.shape[2])*i,u=("NHWC"===s?r.shape[2]:r.shape[3])*i,c=("NHWC"===s?r.shape[3]:r.shape[1])/(i*i),d="NHWC"===s?[o,l,u,c]:[o,c,l,u],h=t.makeOutput(d,"float32"),p=t.dataIdMap.get(r.dataId).id,f=new Uint8Array(new Int32Array(um.computeStrides(r.shape)).buffer),m=new Uint8Array(new Int32Array(d).buffer),g=new Uint8Array(new Int32Array(um.computeStrides(d)).buffer),y=t.dataIdMap.get(h.dataId).id;return R4(p,i,"NHWC"===s?1:0,f,r.shape.length-1,m,g,d.length,y),h}};var P4,L4={kernelName:xh,backendName:"wasm",setupFunc:function(e){M4=e.wasm.cwrap(xh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:i}=t,s=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(i.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d}=n,h=null==u?[1,1]:u,p=MN.computeConv2DInfo(r.shape,i.shape,l,h,c,d,!0),f=p.filterHeight,m=p.filterWidth,g=p.padInfo.top,y=p.padInfo.right,b=p.padInfo.bottom,v=p.padInfo.left,x=p.dilationHeight,w=p.dilationWidth,k=p.strideHeight,S=p.strideWidth,I=p.inChannels,N=p.outChannels,T="SAME"===p.padInfo.type?1:0;if("channelsLast"!==p.dataFormat)throw new Error("wasm backend DepthwiseConv2dNative does not support dataFormat:'".concat(p.dataFormat,"'. Please use 'channelsLast'."));let C=a.makeOutput(p.outShape,"float32"),E=a.dataIdMap.get(C.dataId).id;return M4(s,r.shape[0],r.shape[1],r.shape[2],o,f,m,g,y,b,v,T,x,w,k,S,I,N,E),C}};var z4,B4={kernelName:Sh,backendName:"wasm",setupFunc:function(e){P4=e.wasm.cwrap("Diag",null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=um.sizeFromShape(a.shape),i=n.makeOutput([...a.shape,...a.shape],a.dtype);return P4(n.dataIdMap.get(a.dataId).id,l3[a.dtype],r,n.dataIdMap.get(i.dataId).id),i}};var W4,V4={kernelName:Ih,backendName:"wasm",setupFunc:function(e){z4=e.wasm.cwrap(Ih,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a;if(r.dtype!==i.dtype)throw new Error("Dilation2D error: x must have the same dtype as filter. Got ".concat(r.dtype," and ").concat(i.dtype));let u=MN.computeDilation2DInfo(r.shape,i.shape,s,o,"NHWC",l),c=n.makeOutput(u.outShape,r.dtype);return z4(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(c.dataId).id,l3[r.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),c}};var U4,j4={kernelName:Th,backendName:"wasm",setupFunc:function(e){W4=e.wasm.cwrap(Th,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=a;if(r.dtype!==i.dtype||r.dtype!==s.dtype)throw new Error("Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ".concat(r.dtype,", ").concat(i.dtype,", and ").concat(s.dtype));let c=MN.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",u),d=n.makeOutput(i.shape,i.dtype);return W4(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l3[r.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}};var G4,H4={kernelName:Nh,backendName:"wasm",setupFunc:function(e){U4=e.wasm.cwrap(Nh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:u}=a;if(r.dtype!==i.dtype||r.dtype!==s.dtype)throw new Error("Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ".concat(r.dtype,", ").concat(i.dtype,", and ").concat(s.dtype));let c=MN.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",u),d=n.makeOutput(r.shape,r.dtype);return U4(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,l3[r.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}},q4=f3(Ah);var K4={kernelName:Fh,backendName:"wasm",setupFunc:function(e){G4=e.wasm.cwrap(Fh,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:a,y:r}=t,i=n.makeOutput(r.shape,"float32"),s=e=>n.dataIdMap.get(e.dataId).id;return G4(s(r),s(a),s(i)),i}},X4=b3(Dh,0,"bool"),Y4=f3(Rh),Q4=f3(Mh,"float32");function J4(e){let{inputs:t,attrs:n,backend:a}=e,{input:r}=t,{dim:i}=n,s=r.shape.length,o=r.shape.slice(),l=i;return i<0&&(um.assert(-(s+1)<=i,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+i+1),o.splice(l,0,1),X3({inputs:{x:r},backend:a,attrs:{shape:o}})}var Z4={kernelName:Oh,backendName:"wasm",kernelFunc:J4},$4=f3(Ph,"float32");function e5(e){let{attrs:{shape:t,value:n},backend:a}=e,{attrs:{dtype:r}}=e;r=r||um.inferDtype(n);let i=a.makeOutput(t,r);return a.typedArrayFromHeap(i).fill(n),i}var t5,n5={kernelName:zh,backendName:"wasm",kernelFunc:e5};var a5,r5={kernelName:Bh,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{image:a}=t,r=n.makeOutput(a.shape,a.dtype),i=n.dataIdMap.get(a.dataId).id,s=n.dataIdMap.get(r.dataId).id,[o,l,u,c]=a.shape;return t5(i,o,l,u,c,s),r},setupFunc:function(e){t5=e.wasm.cwrap(Bh,null,["number","number","number","number","number","number"])}},i5=f3(Wh),s5=b3(Vh);var o5,l5={kernelName:Uh,backendName:"wasm",setupFunc:function(e){a5=e.wasm.cwrap(Uh,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{varianceEpsilon:r}=a,{x:i,mean:s,variance:o,offset:l,scale:u}=n,c=t.dataIdMap.get(i.dataId).id,d=t.dataIdMap.get(s.dataId).id,h=t.dataIdMap.get(o.dataId).id,p=null!=l?t.dataIdMap.get(l.dataId).id:0,f=null!=u?t.dataIdMap.get(u.dataId).id:0,m=t.makeOutput(i.shape,i.dtype);if(0===um.sizeFromShape(i.shape))return m;let g=t.dataIdMap.get(m.dataId).id;return a5(c,d,h,p,f,r,g),m}};var u5,c5={kernelName:Xf,backendName:"wasm",setupFunc:function(e){o5=e.wasm.cwrap(Xf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=n,m=MN.computeConv2DInfo(r.shape,i.shape,l,c,u,h),g=u3[p];if(null==g)throw new Error("".concat(p," activation not yet supported for FusedConv2D in the wasm backend."));let y=a.dataIdMap.get(r.dataId).id,b=a.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(null!=s){let e=a.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error("FusedConv2D only supports rank-1 bias but got rank ".concat(e.shape.length,"."));if(e.shape[0]!==v)throw new Error("FusedConv2D bias shape (".concat(e.shape,") does not match the number of output channels (").concat(v,")"));x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,I=m.padInfo.right,N=m.padInfo.bottom,T=m.padInfo.left,C=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,A=m.strideWidth,F=m.inChannels,R="SAME"===m.padInfo.type?1:0,D=m.batchSize,M=m.inHeight,O=m.inWidth;if("NHWC"!==d)throw new Error("wasm backend FusedConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let P=a.makeOutput(m.outShape,"float32"),L=a.dataIdMap.get(P.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return o5(y,D,M,O,b,w,k,x,S,I,N,T,R,C,E,_,A,F,v,g,z,f||0,L),P}};var d5,h5={kernelName:Yf,backendName:"wasm",setupFunc:function(e){u5=e.wasm.cwrap(Yf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=n,m=MN.computeConv2DInfo(r.shape,i.shape,l,c,u,h,!0),g=u3[p];if(null==g)throw new Error("".concat(p," activation not yet supported for FusedDepthwiseConv2D in the wasm backend."));let y=a.dataIdMap.get(r.dataId).id,b=a.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(null!=s){let e=a.dataIdMap.get(s.dataId);if(1!==e.shape.length)throw new Error("FusedDepthwiseConv2D only supports rank-1 bias but got rank ".concat(e.shape.length,"."));if(e.shape[0]!==v)throw new Error("FusedDepthwiseConv2D bias shape (".concat(e.shape,") does not match the number of output channels (").concat(v,")"));x=e.id}let w=m.filterHeight,k=m.filterWidth,S=m.padInfo.top,I=m.padInfo.right,N=m.padInfo.bottom,T=m.padInfo.left,C=m.dilationHeight,E=m.dilationWidth,_=m.strideHeight,A=m.strideWidth,F=m.inChannels,R="SAME"===m.padInfo.type?1:0,D=m.batchSize,M=m.inHeight,O=m.inWidth;if("NHWC"!==d)throw new Error("wasm backend FusedDepthwiseConv2D does not support dataFormat:'".concat(d,"'. Please use 'NHWC'."));let P=a.makeOutput(m.outShape,"float32"),L=a.dataIdMap.get(P.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return u5(y,D,M,O,b,w,k,x,S,I,N,T,R,C,E,_,A,F,v,g,z,f||0,L),P}};var p5,f5={kernelName:Gh,backendName:"wasm",setupFunc:function(e){d5=e.wasm.cwrap(Gh,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{params:a,indices:r}=n,[i,s,o,l]=sN.prepareAndValidate(a,r),u=t.makeOutput(i,a.dtype);if(0===s)return u;let c=r.shape,d=c[c.length-1],h=t.dataIdMap.get(a.dataId).id,p=t.dataIdMap.get(r.dataId).id,f=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(u.dataId).id;return d5(h,l3[a.dtype],p,s,d,o,f,m),u}};var m5,g5={kernelName:jh,backendName:"wasm",setupFunc:function(e){p5=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{x:r,indices:i}=n,{axis:s,batchDims:o}=a,l=um.parseAxisParam(s,r.shape)[0],u=t.readSync(i.dataId),c=r.shape[l];for(let S=0;S<u.length;++S){let e=u[S];um.assert(e<=c-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(c-1,"]"))}let d=MN.segment_util.collectGatherOpShapeInfo(r,i,l,o),h=X3({inputs:{x:r},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:t}),p=um.sizeFromShape(i.shape),f=X3({inputs:{x:i},attrs:{shape:[d.batchSize,p/d.batchSize]},backend:t}),m=[d.batchSize,d.outerSize,p/d.batchSize,d.sliceSize],g=t.makeOutput(m,r.dtype);if(0===um.sizeFromShape(r.shape))return g;let y=h.shape.length-1,b=t.dataIdMap.get(h.dataId).id,v=t.dataIdMap.get(f.dataId).id,x=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(um.computeStrides(h.shape)).buffer),k=new Uint8Array(new Int32Array(um.computeStrides(m)).buffer);return p5(b,l3[r.dtype],w,y,v,d.batchSize,k,x),t.disposeData(h.dataId),t.disposeData(f.dataId),g.shape=d.outputShape,g}},y5=b3(Hh,0,"bool"),b5=b3(qh,0,"bool"),v5=f3(Qh,"bool"),x5=f3(Jh,"bool"),w5=f3(Zh,"bool");var k5,S5={kernelName:$h,backendName:"wasm",setupFunc:function(e){m5=e.wasm.cwrap($h,null,["number","number","number","number"])},kernelFunc:function(e){let{inputs:{x:t},attrs:{alpha:n},backend:a}=e,r=a.dataIdMap.get(t.dataId).id,i=a.makeOutput(t.shape,"float32");if(0!==um.sizeFromShape(t.shape)){let e=a.dataIdMap.get(i.dataId).id;m5(r,l3[t.dtype],n,e)}return i}},I5=b3(ep,0,"bool"),N5=b3(tp,0,"bool");var T5,C5={kernelName:np,backendName:"wasm",setupFunc:function(e){k5=e.wasm.cwrap(np,null,["number","number","number","number"])},kernelFunc:function(e){let{attrs:t,backend:n}=e,{start:a,stop:r,num:i}=t,s=Math.floor(i),o=n.makeOutput([s],"float32");return k5(n.dataIdMap.get(o.dataId).id,a,r,s),o}},E5=f3(ap),_5=f3(rp),A5=b3(ip,0,"bool"),F5=f3(sp),R5=b3(op,0,"bool"),D5=b3(lp,0,"bool");var M5,O5={kernelName:dp,backendName:"wasm",setupFunc:function(e){T5=e.wasm.cwrap(dp,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=a;if("float32"!==r.dtype)throw new Error("LRN error: x must have dtype float32");let u=n.makeOutput(r.shape,r.dtype);return T5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(u.dataId).id,r.shape[3],i,s,o,l),u}};var P5,L5={kernelName:hp,backendName:"wasm",setupFunc:function(e){M5=e.wasm.cwrap(hp,null,["number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=a;if("float32"!==r.dtype||"float32"!==i.dtype||"float32"!==s.dtype)throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let d=n.makeOutput(r.shape,r.dtype);return M5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,s.shape[3],o,l,u,c),d}};var z5,B5={kernelName:fp,backendName:"wasm",setupFunc:function(e){P5=e.wasm.cwrap(fp,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{reductionIndices:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:h}=E3(s,r,t);if(h){l=u,o=t.dataIdMap.get(u.dataId).id}let p=l.shape.length;MN.assertAxesAreInnerMostDims("max",c,p);let[f,m]=MN.computeOutAndReduceShapes(l.shape,c),g=um.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(0!==um.sizeFromShape(l.shape)){let e=t.dataIdMap.get(y.dataId).id;P5(o,l3[s.dtype],g,e)}if(h&&t.disposeData(u.dataId),i){let e=MN.expandShapeToKeepDim(y.shape,d);y.shape=e}return y}},W5=b3(mp);var V5,U5={kernelName:gp,backendName:"wasm",setupFunc:function(e){z5=e.wasm.cwrap(gp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,r=t.x,i=a.dataIdMap.get(r.dataId).id;um.assert("float32"===r.dtype,()=>"Error in MaxPool: only float32 input is supported. Got ".concat(r.dtype,"."));let{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,c=MN.computePool2DInfo(r.shape,s,o,1,l,u),d=c.filterHeight,h=c.filterWidth,p=c.padInfo.top,f=c.padInfo.right,m=c.padInfo.bottom,g=c.padInfo.left,y=c.dilationHeight,b=c.dilationWidth,v=c.strideHeight,x=c.strideWidth,w=c.inChannels,k=c.outChannels;if("channelsLast"!==c.dataFormat)throw new Error("wasm backend does not support dataFormat:'".concat(c.dataFormat,"'. Please use 'channelsLast'."));let S=a.makeOutput(c.outShape,"float32"),I=a.dataIdMap.get(S.dataId).id;return z5(i,r.shape[0],r.shape[1],r.shape[2],d,h,p,f,m,g,y,b,v,x,w,k,I),S}};var j5,G5={kernelName:bp,backendName:"wasm",setupFunc:function(e){V5=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=a,c=MN.computePool3DInfo(r.shape,i,s,1,o,l,u),d=n.makeOutput(c.outShape,r.dtype);return V5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}};var H5,q5={kernelName:vp,backendName:"wasm",setupFunc:function(e){j5=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a,c=MN.computePool3DInfo(i.shape,s,o,1,l,u),d=n.makeOutput(i.shape,i.dtype);return j5(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}};var K5,X5={kernelName:yp,backendName:"wasm",setupFunc:function(e){H5=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a,c=MN.computePool2DInfo(i.shape,s,o,1,l,u),d=n.makeOutput(i.shape,i.dtype);return H5(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),d}};var Y5,Q5={kernelName:xp,backendName:"wasm",setupFunc:function(e){K5=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=a;um.assert(4===r.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let u=[1,1];um.assert(MN.eitherStridesOrDilationsAreOne(s,u),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(u,"'"));let c=MN.computePool2DInfo(r.shape,i,s,[1,1],o),d=n.makeOutput(c.outShape,r.dtype),h=n.makeOutput(c.outShape,"int32");return K5(n.dataIdMap.get(r.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(h.dataId).id,l3[r.dtype],l,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),[d,h]}};var J5,Z5={kernelName:wp,backendName:"wasm",setupFunc:function(e){Y5=e.wasm.cwrap(wp,null,["number, number, number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:h,inputWasTransposed:p}=E3(s,r,t),f=d;if(p){let e=t.dataIdMap.get(c.dataId).id;e!==o&&(u=c,l=e,f=MN.getInnerMostAxes(f.length,u.shape.length))}MN.assertAxesAreInnerMostDims("mean",f,u.shape.length);let[m,g]=MN.computeOutAndReduceShapes(u.shape,f),y=um.sizeFromShape(g),b=u;"float32"!==u.dtype&&(b=i4({backend:t,inputs:{x:u},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(b.dataId).id);let v=t.makeOutput(m,"float32");if(0!==um.sizeFromShape(u.shape)){let e=t.dataIdMap.get(v.dataId).id;Y5(l,y,e)}if(p&&t.disposeData(c.dataId),i){let e=MN.expandShapeToKeepDim(v.shape,h);v.shape=e}return"float32"!==u.dtype&&t.disposeData(b.dataId),v}};var $5,e6,t6={kernelName:kp,backendName:"wasm",setupFunc:function(e){J5=e.wasm.cwrap(kp,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:h,inputWasTransposed:p}=E3(s,r,t);if(p){let e=t.dataIdMap.get(c.dataId).id;e!==o&&(u=c,l=e)}let f=u.shape.length;MN.assertAxesAreInnerMostDims("min",d,f);let[m,g]=MN.computeOutAndReduceShapes(u.shape,d),y=um.sizeFromShape(g),b=t.makeOutput(m,u.dtype);if(0!==um.sizeFromShape(u.shape)){let e=t.dataIdMap.get(b.dataId).id;J5(l,l3[s.dtype],y,e)}if(p&&t.disposeData(c.dataId),i){let e=MN.expandShapeToKeepDim(b.shape,h);b.shape=e}return b}},n6=b3(Sp);!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}($5||($5={}));var a6,r6={kernelName:Ip,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:a,mode:r}}=e,i=a.map((e,n)=>e[0]+t.shape[n]+e[1]),s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),c=a.map(e=>e[0]),d=a.map(e=>e[1]),h=new Uint8Array(new Int32Array(c).buffer),p=new Uint8Array(new Int32Array(d).buffer);return e6(s,u,t.shape.length,l3[t.dtype],h,p,$5[r],l),o},setupFunc:function(e){e6=e.wasm.cwrap(Ip,null,["number","array","number","number","array","array","number","number"])}};function i6(e){let{backend:t,inputs:{logits:n},attrs:{dim:a}}=e,r=t.dataIdMap.get(n.dataId).id,i=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(i.dataId).id,o=n.shape[a],l=um.sizeFromShape(n.shape)/o;return 0===um.sizeFromShape(i.shape)||a6(r,s,o,l),i}var s6,o6={kernelName:vf,backendName:"wasm",setupFunc:function(e){a6=e.wasm.cwrap(vf,null,["number","number","number","number"])},kernelFunc:i6};var l6,u6={kernelName:Tp,backendName:"wasm",setupFunc:function(e){s6=e.wasm.cwrap(Tp,null,["number","number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:i,seed:s,normalized:o}=a;if("float32"!==r.dtype)throw new Error("Tensor logits must have dtype float32, got ".concat(r.dtype));let l=o?r:i6({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),[u,c]=l.shape,d=n.makeOutput([u,i],"int32");return s6(n.dataIdMap.get(l.dataId).id,u,c,i,s,n.dataIdMap.get(d.dataId).id),o||n.disposeData(l.dataId),d}},c6=b3(Np),d6=b3(Cp),h6=f3(Ep);function p6(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),a=n[0],r=n[1],i=n[2],s=n[3];return e.wasm._free(t),{pSelectedIndices:a,selectedSize:r,pSelectedScores:i,pValidOutputs:s}}var f6,m6={kernelName:Ap,backendName:"wasm",setupFunc:function(e){l6=e.wasm.cwrap(Ap,"number",["number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:i,scoreThreshold:s}=a,{boxes:o,scores:l}=n,u=t.dataIdMap.get(o.dataId).id,c=t.dataIdMap.get(l.dataId).id,d=l6(u,c,i,r,s),{pSelectedIndices:h,selectedSize:p,pSelectedScores:f,pValidOutputs:m}=p6(t,d);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([p],"int32",h)}};var g6,y6={kernelName:Fp,backendName:"wasm",setupFunc:function(e){f6=e.wasm.cwrap(Fp,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:i,scoreThreshold:s,padToMaxOutputSize:o}=a,{boxes:l,scores:u}=n,c=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(u.dataId).id,h=f6(c,d,i,r,s,o),{pSelectedIndices:p,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=p6(t,h);return t.wasm._free(m),[t.makeOutput([f],"int32",p),t.makeOutput([],"int32",g)]}};var b6,v6={kernelName:Rp,backendName:"wasm",setupFunc:function(e){g6=e.wasm.cwrap(Rp,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:i,scoreThreshold:s,softNmsSigma:o}=a,{boxes:l,scores:u}=n,c=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(u.dataId).id,h=g6(c,d,i,r,s,o),{pSelectedIndices:p,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=p6(t,h);return t.wasm._free(g),[t.makeOutput([f],"int32",p),t.makeOutput([f],"float32",m)]}},x6=b3(_p,0,"bool");var w6={kernelName:Mp,backendName:"wasm",setupFunc:function(e){b6=e.wasm.cwrap(Mp,null,["number","number","number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:i,depth:s,onValue:o,offValue:l}=a,u=n.makeOutput([...r.shape,s],i),c=n.dataIdMap.get(u.dataId).id,d=n.dataIdMap.get(r.dataId).id;return b6(d,s,o,l,c),u}};var k6={kernelName:Dp,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(1),a}};var S6,I6={kernelName:Op,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return J4({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{um.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),um.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=c4({inputs:t.map(e=>{let t=J4({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeData(e.dataId)),l}};var N6,T6={kernelName:Pp,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n,attrs:{paddings:a,constantValue:r}}=e,i=a.map((e,n)=>e[0]+t.shape[n]+e[1]);if(0===um.sizeFromShape(t.shape))return e5({backend:n,attrs:{shape:i,value:r,dtype:t.dtype}});let s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),c=a.map(e=>e[0]),d=a.map(e=>e[1]),h=new Uint8Array(new Int32Array(c).buffer),p=new Uint8Array(new Int32Array(d).buffer);return S6(s,u,t.shape.length,l3[t.dtype],h,p,r,l),o},setupFunc:function(e){S6=e.wasm.cwrap(Pp,null,["number","array","number","number","array","array","number","number"])}},C6=b3(zp);var E6,_6={kernelName:Bp,backendName:"wasm",setupFunc:function(e){N6=e.wasm.cwrap(Bp,null,["number","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t,i=n.dataIdMap.get(a.dataId).id,s=n.dataIdMap.get(r.dataId).id,o=i,l=a,u=l;"float32"!==l.dtype&&(u=i4({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(u.dataId).id);let c=n.makeOutput(a.shape,"float32"),d=n.dataIdMap.get(c.dataId).id;return N6(o,s,d),"float32"!==l.dtype&&n.disposeData(u.dataId),c}};var A6,F6={kernelName:Wp,backendName:"wasm",setupFunc:function(e){E6=e.wasm.cwrap(Wp,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:h,inputWasTransposed:p}=E3(s,r,t),f=d;if(p){let e=t.dataIdMap.get(c.dataId).id;e!==o&&(u=c,l=e,f=MN.getInnerMostAxes(f.length,u.shape.length))}MN.assertAxesAreInnerMostDims("prod",f,u.shape.length);let[m,g]=MN.computeOutAndReduceShapes(u.shape,f),y=um.sizeFromShape(g),b=t.makeOutput(m,u.dtype);if(0!==um.sizeFromShape(u.shape)){let e=t.dataIdMap.get(b.dataId).id;E6(l,y,l3[b.dtype],e)}if(p&&t.disposeData(c.dataId),i){let e=MN.expandShapeToKeepDim(b.shape,h);b.shape=e}return b}},R6={kernelName:Gp,backendName:"wasm",kernelFunc:e=>{let{backend:t,attrs:n}=e,{start:a,stop:r,step:i,dtype:s}=n,o=ZV(a,r,i,s),l=t.makeOutput([o.length],s);return t.typedArrayFromHeap(l).set(o),l}},D6=b3(Eh),M6=f3(qp),O6=f3(Kp),P6=f3($p);var L6,z6={kernelName:Jp,backendName:"wasm",setupFunc:function(e){A6=e.wasm.cwrap(Jp,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{images:i}=a,{alignCorners:s,halfPixelCenters:o,size:l}=r,[u,c]=l,[d,h,p,f]=i.shape,m=[d,u,c,f],g=n.dataIdMap.get(i.dataId);"float32"!==g.dtype&&(t=i4({backend:n,inputs:{x:i},attrs:{dtype:"float32"}}),g=n.dataIdMap.get(t.dataId));let y=g.id,b=n.makeOutput(m,"float32");if(0===um.sizeFromShape(i.shape))return b;let v=n.dataIdMap.get(b.dataId).id;return A6(y,d,h,p,f,u,c,s?1:0,o?1:0,v),null!=t&&n.disposeData(t.dataId),b}};var B6,W6={kernelName:Zp,backendName:"wasm",setupFunc:function(e){L6=e.wasm.cwrap(Zp,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{images:i,dy:s}=n,{alignCorners:o}=r,l=a.makeOutput(i.shape,"float32"),u=a.dataIdMap.get(i.dataId);return"float32"!==u.dtype&&(t=i4({backend:a,inputs:{x:i},attrs:{dtype:"float32"}}),u=a.dataIdMap.get(t.dataId)),L6(a.dataIdMap.get(i.dataId).id,a.dataIdMap.get(s.dataId).id,a.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),null!=t&&a.disposeData(t.dataId),l}};var V6,U6={kernelName:Yp,backendName:"wasm",setupFunc:function(e){B6=e.wasm.cwrap(Yp,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{images:r}=n,{alignCorners:i,halfPixelCenters:s,size:o}=a,[l,u]=o,[c,d,h,p]=r.shape,f=[c,l,u,p],m=t.makeOutput(f,"float32");if(0===um.sizeFromShape(r.shape))return m;let g,y=t.dataIdMap.get(r.dataId);"float32"!==y.dtype&&(g=i4({backend:t,inputs:{x:r},attrs:{dtype:"float32"}}),y=t.dataIdMap.get(g.dataId));let b=y.id,v=t.dataIdMap.get(m.dataId).id;return B6(b,c,d,h,p,l,u,i?1:0,s?1:0,v),null!=g&&t.disposeData(g.dataId),m}};var j6,G6={kernelName:Qp,backendName:"wasm",setupFunc:function(e){V6=e.wasm.cwrap(Qp,null,["number","number","number","array","array","boolean"])},kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{images:i,dy:s}=n,{alignCorners:o}=r,l=a.makeOutput(i.shape,"float32"),u=a.dataIdMap.get(i.dataId);return"float32"!==u.dtype&&(t=i4({backend:a,inputs:{x:i},attrs:{dtype:"float32"}}),u=a.dataIdMap.get(t.dataId)),V6(a.dataIdMap.get(i.dataId).id,a.dataIdMap.get(s.dataId).id,a.dataIdMap.get(l.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),null!=t&&a.disposeData(t.dataId),l}};var H6,q6={kernelName:ef,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:i}=a,s=um.parseAxisParam(i,r.shape);if(0===r.shape.length)return k3({inputs:{x:r},backend:n});let o=n.makeOutput(r.shape,r.dtype),l=n.dataIdMap.get(r.dataId).id,u=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(s).buffer),d=new Uint8Array(new Int32Array(r.shape).buffer);j6(l,c,s.length,d,r.shape.length,u);let h=X3({inputs:{x:o},attrs:{shape:r.shape},backend:n});return n.disposeData(o.dataId),h},setupFunc:function(e){j6=e.wasm.cwrap(ef,null,["number","array","number","array","number","number"])}};var K6,X6={kernelName:qf,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r}=t,{radians:i,fillValue:s,center:o}=a,l=n.makeOutput(r.shape,r.dtype),u=n.dataIdMap.get(r.dataId).id,c=n.dataIdMap.get(l.dataId).id,[d,h,p,f]=r.shape,[m,g]=MN.getImageCenter(o,h,p),y="number"==typeof s?[s,s,s,0===s?0:255]:[...s,255],b=new Uint8Array(new Int32Array(y).buffer);return H6(u,d,h,p,f,i,m,g,b,y.length,c),l},setupFunc:function(e){H6=e.wasm.cwrap(qf,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Y6=f3(tf),Q6=f3(nf);var J6,Z6={kernelName:af,backendName:"wasm",setupFunc:function(e){K6=e.wasm.cwrap(af,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{indices:r,updates:i}=n,{shape:s}=a,o=t.makeOutput(s,i.dtype);if(0===um.sizeFromShape(s))return o;let{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Tk.calculateShapes(i,r,s),p=t.dataIdMap.get(r.dataId).id,f=t.dataIdMap.get(i.dataId).id,m=new Uint8Array(new Int32Array(d).buffer),g=t.dataIdMap.get(o.dataId).id;return K6(p,f,l3[i.dtype],l,u,c,m,h,g),o}};var $6,e8={kernelName:sf,backendName:"wasm",setupFunc:function(e){J6=e.wasm.cwrap(sf,null,["number","number","number","number","number","number","bool","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:i}=t,{side:s}=a;if(r.dtype!==i.dtype)throw new Error("SearchSorted error: sorted_sequence must have the same dtype as values. Got ".concat(r.dtype," and ").concat(i.dtype));let o=n.makeOutput(i.shape,"int32");function l(e){return n.dataIdMap.get(e.dataId).id}return J6(l(r),l(i),r.shape[0],r.shape[1],i.shape[1],l3[r.dtype],"left"===s,l(o)),o}};var t8,n8={kernelName:of,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:i}=t,s=n.dataIdMap.get(a.dataId).id,o=n.dataIdMap.get(r.dataId).id,l=n.dataIdMap.get(i.dataId).id,u=n.makeOutput(r.shape,r.dtype),c=n.dataIdMap.get(u.dataId).id,d=a.shape.length,h=r.shape.length,p=0===d||d>1||1===h?1:um.sizeFromShape(r.shape.slice(1));return $6(s,o,l,p,c),u},setupFunc:function(e){$6=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}},a8=f3(lf);var r8={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){t8=e.wasm.cwrap(pf,null,["number","number"])},kernelFunc:function(e){let{backend:t,inputs:{x:n}}=e,a=t.dataIdMap.get(n.dataId).id,r=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(r.dataId).id;return 0===um.sizeFromShape(r.shape)||t8(a,i),r}},i8=f3(hf),s8=f3(cf),o8=f3(df),l8=f3(ff);var u8,c8={kernelName:yf,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,paddings:s}=a,o=um.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<r.shape.length;++g)l.push([0,0]);let u=T6.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),c=MN.getReshaped(u.shape,i,o,!1),d=MN.getPermuted(c.length,i.length,!1),h=MN.getReshapedPermuted(u.shape,i,o,!1),p=X3({inputs:{x:u},backend:n,attrs:{shape:c}}),f=N3({inputs:{x:p},backend:n,attrs:{perm:d}}),m=X3({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeData(u.dataId),n.disposeData(p.dataId),n.disposeData(f.dataId),m}};var d8,h8={kernelName:xf,backendName:"wasm",setupFunc:function(e){u8=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=a,l=r.shape[0],u=r.shape[1],c=n.readSync(s.dataId)[0],d=[l+c,u],h=n.dataIdMap.get(r.dataId).id,p=n.dataIdMap.get(i.dataId).id,f=n.dataIdMap.get(o.dataId).id,m=n.makeOutput(d,r.dtype),g=n.dataIdMap.get(m.dataId).id,y=n.makeOutput(d.slice(0,1),i.dtype),b=n.dataIdMap.get(y.dataId).id,v=n.makeOutput([c],"bool"),x=n.dataIdMap.get(v.dataId).id,w=n.makeOutput([l],r.dtype),k=n.dataIdMap.get(w.dataId).id,S=n.makeOutput([4],"int32"),I=n.dataIdMap.get(S.dataId).id,N=u8(h,p,l3[i.dtype],l,c,u,f,g,b,x,k,I),T=n.readSync(S.dataId);switch(T[0]){case 1:t=MN.getSparseFillEmptyRowsIndicesDenseShapeMismatch(T[1]);break;case 2:t=MN.getSparseFillEmptyRowsNegativeIndexErrorMessage(T[1],T[2]);break;case 3:t=MN.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(T[1],T[2],T[3]);break;default:t=""}if(n.disposeData(S.dataId),t)throw n.disposeData(m.dataId),n.disposeData(y.dataId),n.disposeData(v.dataId),n.disposeData(w.dataId),new Error(t);let C=m,E=y;return N!==d[0]&&(C=Z3({inputs:{x:m},attrs:{begin:0,size:[N,u]},backend:n}),E=Z3({inputs:{x:y},attrs:{begin:0,size:N},backend:n}),n.disposeData(m.dataId),n.disposeData(y.dataId)),[C,E,v,w]}};var p8,f8={kernelName:wf,backendName:"wasm",setupFunc:function(e){d8=e.wasm.cwrap(wf,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n}=e,{inputIndices:a,inputShape:r,newShape:i}=n;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==r.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));let s=t.dataIdMap.get(a.dataId).id,o=t.dataIdMap.get(r.dataId).id,l=t.dataIdMap.get(i.dataId).id,u=a.shape[0],c=um.sizeFromShape(i.shape),d=t.makeOutput([u,c],a.dtype),h=t.dataIdMap.get(d.dataId).id,p=t.makeOutput([c],i.dtype),f=t.dataIdMap.get(p.dataId).id,m=t.makeOutput([3],"int32"),g=t.dataIdMap.get(m.dataId).id;d8(s,o,l,u,h,f,g);let y,b=t.readSync(m.dataId);switch(b[0]){case 0:y=MN.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(b[1],b[2]);break;case 1:y=MN.getSparseReshapeNegativeOutputDimErrorMessage(b[1],b[2]);break;case 2:y=MN.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let e=Array.from(t.readSync(r.dataId)),n=Array.from(t.readSync(p.dataId));y=MN.getSparseReshapeInputOutputMultipleErrorMessage(e,n);break}case 4:{let e=Array.from(t.readSync(r.dataId)),n=Array.from(t.readSync(p.dataId));y=MN.getSparseReshapeInputOutputMismatchErrorMessage(e,n);break}default:y=""}if(t.disposeData(m.dataId),y)throw t.disposeData(d.dataId),t.disposeData(p.dataId),new Error(y);return[d,p]}};function m8(e){p8=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function g8(e,t){let{backend:n,inputs:a}=e,{data:r,indices:i,segmentIds:s}=a,o=i.shape[0],l=n.readSync(s.dataId,o-1,o)[0],u=o>0?l+1:0;if(u<0)throw new Error(MN.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=r.shape.slice();c[0]=u;let d=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(i.dataId).id,p=n.dataIdMap.get(s.dataId).id,f=n.makeOutput(c,r.dtype),m=n.dataIdMap.get(f.dataId).id,g=n.makeOutput([4],"int32"),y=n.dataIdMap.get(g.dataId).id;p8(d,l3[r.dtype],r.shape[0],h,p,m,y,t,0);let b,v=n.readSync(g.dataId);switch(v[0]){case 0:b=MN.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break;case 1:b=MN.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break;case 2:b=MN.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v[1],v[2]);break;case 3:b=MN.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v[1],v[2],v[3]);break;default:b=""}if(n.disposeData(g.dataId),b)throw n.disposeData(f.dataId),new Error(b);return f}var y8={kernelName:kf,backendName:"wasm",setupFunc:m8,kernelFunc:function(e){return g8(e,!0)}};var b8,v8={kernelName:Sf,backendName:"wasm",setupFunc:m8,kernelFunc:function(e){return g8(e,!1)}};var x8={kernelName:If,backendName:"wasm",setupFunc:function(e){b8=e.wasm.cwrap(If,null,["number","number","number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{sparseIndices:r,sparseValues:i,defaultValue:s}=n,{outputShape:o}=a,l=t.makeOutput(o,s.dtype);if(0===um.sizeFromShape(o))return l;let{sliceRank:u,numUpdates:c,sliceSize:d,strides:h,outputSize:p}=MN.calculateShapes(i,r,o),f=t.dataIdMap.get(r.dataId).id,m=t.dataIdMap.get(i.dataId).id,g=t.dataIdMap.get(s.dataId).id,y=new Uint8Array(new Int32Array(h).buffer),b=t.dataIdMap.get(l.dataId).id;return b8(f,m,i.shape.length,g,l3[s.dtype],u,c,d,y,p,b),l}};var w8,k8={kernelName:bf,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{numOrSizeSplits:i,axis:s}=n,o=um.parseAxisParam(s,r.shape)[0],l=MN.prepareSplitSize(r,i,o),u=new Array(r.shape.length).fill(0),c=r.shape.slice();return l.map(e=>{let t=[...c];t[o]=e;let n=Z3({inputs:{x:r},attrs:{begin:u,size:t},backend:a});return u[o]+=e,n})}},S8=f3(mf),I8=f3(Tf),N8=b3(Nf);var T8,C8={kernelName:Gf,backendName:"wasm",setupFunc:function(e){w8=e.wasm.cwrap(Gf,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{alpha:r}=a,{x:i}=n,s=t.dataIdMap.get(i.dataId).id,o=t.makeOutput(i.shape,i.dtype),l=t.dataIdMap.get(o.dataId).id;return w8(s,r,l3[i.dtype],l),o}};var E8={kernelName:Ef,backendName:"wasm",setupFunc:function(e){T8=e.wasm.cwrap(Ef,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{x:i}=a,{begin:s,end:o,strides:l,beginMask:u,endMask:c,ellipsisMask:d,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:v,end:x,strides:w}=lN.sliceInfo(i.shape,s,o,l,u,c,d,h,p);if(g)t=X3({inputs:{x:i},backend:n,attrs:{shape:m}});else if(y||b){um.assert(i.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(i.shape.length));let e=lN.computeOutShape(v,x,w),a=Z3({inputs:{x:i},backend:n,attrs:{begin:v,size:e}});t=X3({inputs:{x:a},backend:n,attrs:{shape:m}}),n.disposeData(a.dataId)}else{let e=n.makeOutput(f,"float32"),a=n.dataIdMap.get(i.dataId).id,r=new Uint8Array(new Int32Array(um.computeStrides(i.shape)).buffer),s=new Uint8Array(new Int32Array(v).buffer),o=new Uint8Array(new Int32Array(x).buffer),l=new Uint8Array(new Int32Array(w).buffer),u=new Uint8Array(new Int32Array(f).buffer),c=new Uint8Array(new Int32Array(um.computeStrides(f)).buffer),d=n.dataIdMap.get(e.dataId).id;T8(a,r,i.shape.length,s,o,l,u,c,f.length,d),t=X3({inputs:{x:e},backend:n,attrs:{shape:m}}),n.disposeData(e.dataId)}return t}};var _8={kernelName:_f,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{data:r,dataSplits:i}=n,{separator:s,nGramWidths:o,leftPad:l,rightPad:u,padWidth:c,preserveShortSequences:d}=a,h=t.readSync(r.dataId),p=t.readSync(i.dataId),[f,m]=SU(h,p,s,o,l,u,c,d),g=t.makeOutput([f.length],"string");t.dataIdMap.get(g.dataId).stringBytes=f;let y=t.makeOutput(i.shape,"int32");return t.typedArrayFromHeap(y).set(m),[g,y]}};var A8={kernelName:Af,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{input:r,delimiter:i}=n,{skipEmpty:s}=a,o=t.readSync(r.dataId),l=t.readSync(i.dataId),[u,c,d]=NU(o,l[0],s),h=c.length,p=t.makeOutput([h,2],"int32");t.typedArrayFromHeap(p).set(u);let f=t.makeOutput([h],"string");t.dataIdMap.get(f.dataId).stringBytes=c;let m=t.makeOutput([2],"int32");return t.typedArrayFromHeap(m).set(d),[p,f,m]}};var F8,R8={kernelName:Ff,backendName:"wasm",kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{input:r}=n,{numBuckets:i}=a,s=TU(t.readSync(r.dataId),i),o=t.makeOutput(r.shape,"int32");return t.typedArrayFromHeap(o).set(s),o}},D8=b3(Rf);var M8,O8={kernelName:gf,backendName:"wasm",setupFunc:function(e){F8=e.wasm.cwrap(gf,null,["number","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{axis:r,keepDims:i}=a,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:h,inputWasTransposed:p}=E3(s,r,t),f=d;if(p){let e=t.dataIdMap.get(c.dataId).id;e!==o&&(u=c,l=e,f=MN.getInnerMostAxes(f.length,u.shape.length))}MN.assertAxesAreInnerMostDims("sum",f,u.shape.length);let[m,g]=MN.computeOutAndReduceShapes(u.shape,f),y=um.sizeFromShape(g),b=t.makeOutput(m,u.dtype);if(0!==um.sizeFromShape(u.shape)){let e=t.dataIdMap.get(b.dataId).id;F8(l,y,l3[b.dtype],e)}if(p&&t.disposeData(c.dataId),i){let e=MN.expandShapeToKeepDim(b.shape,h);b.shape=e}return b}},P8=f3(Df),L8=f3(Mf);var z8,B8={kernelName:rf,backendName:"wasm",setupFunc:function(e){M8=e.wasm.cwrap(rf,null,["number","number","number","number","number","number","array","number","number","number"])},kernelFunc:function(e){let{backend:t,inputs:n,attrs:a}=e,{tensor:r,indices:i,updates:s}=n,{}=a,o=t.makeOutput(r.shape,r.dtype);if(0===um.sizeFromShape(r.shape))return o;let{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Tk.calculateShapes(s,i,r.shape),p=t.dataIdMap.get(i.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=t.dataIdMap.get(r.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),y=t.dataIdMap.get(o.dataId).id;return M8(p,f,l3[s.dtype],l,u,c,g,h,y,m),o}};var W8,V8={kernelName:Of,backendName:"wasm",setupFunc:function(e){z8=e.wasm.cwrap(Of,null,["number","array","number","array","number","number"])},kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,i=n.dataIdMap.get(r.dataId).id,{reps:s}=a,o=new Array(r.shape.length);for(let h=0;h<o.length;h++)o[h]=r.shape[h]*s[h];let l=new Uint8Array(new Int32Array(r.shape).buffer),u=new Uint8Array(new Int32Array(o).buffer),c=n.makeOutput(o,r.dtype),d=n.dataIdMap.get(c.dataId).id;return z8(i,l,r.shape.length,u,o.length,l3[c.dtype],d),c}};var U8,j8={kernelName:Pf,backendName:"wasm",setupFunc:function(e){W8=e.wasm.cwrap(Pf,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:i,sorted:s}=a,o=n.dataIdMap.get(r.dataId).id,l=new Uint8Array(new Int32Array(r.shape).buffer),u=r.shape.slice();u[u.length-1]=i;let c=n.makeOutput(u,r.dtype),d=n.dataIdMap.get(c.dataId).id,h=n.makeOutput(u,"int32"),p=n.dataIdMap.get(h.dataId).id;return W8(o,l,r.shape.length,l3[r.dtype],i,s,d,p),[c,h]}};var G8={kernelName:Lf,backendName:"wasm",setupFunc:function(e){U8=e.wasm.cwrap(Lf,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])},kernelFunc:function(e){let t,{backend:n,inputs:a,attrs:r}=e,{image:i,transforms:s}=a,{interpolation:o,fillMode:l,fillValue:u,outputShape:c}=r,[d,h,p,f]=i.shape,[m,g]=null!=c?c:[h,p],y=[d,m,g,f],b=new Uint8Array(new Int32Array(um.computeStrides(i.shape)).buffer),v=new Uint8Array(new Int32Array(um.computeStrides(y)).buffer),x=n.makeOutput(y,i.dtype),w=n.dataIdMap.get(x.dataId).id,k=n.dataIdMap.get(i.dataId).id,S=n.dataIdMap.get(s.dataId).id,I="nearest"===o?1:2;switch(l){case"constant":default:t=1;break;case"reflect":t=2;break;case"wrap":t=3;break;case"nearest":t=4}return U8(k,S,s.shape[0]>1,d,m,g,f,p,h,b,i.shape.length-1,v,y.length-1,I,t,u,w),x}};var H8={kernelName:Bf,backendName:"wasm",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:i}=t,{outputValues:s,outputShape:o,indices:l}=OU(a.readSync(i.dataId),r,i.shape,i.dtype);return[a.makeOutput(o,i.dtype,void 0,s),a.makeOutput([l.length],"int32",void 0,l)]}};var q8={kernelName:Wf,backendName:"wasm",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:i}=a;i<0&&(i+=r.shape.length);let s=r.shape[i],o=r.shape.length,l=new Array(o-1),u=0;for(let p=0;p<o;p++)p!==i&&(l[u++]=r.shape[p]);let c=new Array(s),d=new Array(o).fill(0),h=r.shape.slice();h[i]=1;for(let p=0;p<c.length;p++)d[i]=p,c[p]=Z3({inputs:{x:r},attrs:{begin:d,size:h},backend:n});return c.map(e=>{let{dataId:t,dtype:n}=e;return{dataId:t,dtype:n,shape:l}})}};var K8={kernelName:jf,backendName:"wasm",kernelFunc:function(e){let{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(0),a}},X8=[p3,m3,g3,y3,x3,w3,A3,F3,M3,O3,P3,L3,z3,B3,W3,U3,K3,G3,q3,J3,t4,n4,a4,r4,o4,l4,u4,h4,f4,g4,b4,x4,S4,I4,N4,C4,_4,F4,D4,O4,L4,B4,V4,j4,H4,q4,K4,X4,Y4,Q4,Z4,$4,n5,r5,i5,s5,l5,c5,h5,f5,g5,y5,b5,I3,v5,x5,w5,S5,I5,N5,C5,_5,E5,A5,F5,R5,D5,O5,L5,B5,W5,U5,G5,q5,X5,Q5,Z5,t6,n6,r6,u6,c6,d6,h6,m6,y6,v6,x6,w6,k6,I6,T6,C6,_6,F6,R6,D6,M6,O6,P6,Q3,z6,W6,U6,G6,q6,X6,Y6,Q6,Z6,e8,n8,a8,r8,i8,s8,o8,$3,o6,l8,c8,h8,f8,y8,v8,x8,k8,S8,I8,N8,C8,E8,_8,A8,R8,D8,O8,P8,L8,B8,V8,j8,G8,C3,H8,q8,K8];for(let n of X8)am(n);var Y8=Td();Y8.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch(Xm){return!1}}),Y8.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(Y8.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(Xm){return!1}});var Q8=rc(Sc()),J8=rc(Ic()),Z8=rc(Nc()),$8=Q8.default||Q8,e7=Z8.default||Z8,t7=class extends Cc{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(h7),p7=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new Tc(this,Bg())}write(e,t,n){let a={id:this.dataIdNextNumber++};return this.move(a,e,t,n,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=um.now();return e(),{kernelMs:um.now()-t}}move(e,t,n,a,r){let i=this.dataIdNextNumber++;if("string"===a){let s=t;return void this.dataIdMap.set(e,{id:i,stringBytes:s,shape:n,dtype:a,memoryOffset:null,refCount:r})}let s=um.sizeFromShape(n),o=s*um.bytesPerElement(a),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:i,memoryOffset:l,shape:n,dtype:a,refCount:r}),this.wasm.tfjs.registerTensor(i,s,l),null!=t&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:a,dtype:r,shape:i,stringBytes:s}=this.dataIdMap.get(e);if("string"===r)return null!=t&&0!==t||!(null==n||n>=s.length)?s.slice(t,n):s;t=t||0,n=n||um.sizeFromShape(i);let o=um.bytesPerElement(r);return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error("Unknown dtype ".concat(t))}}(this.wasm.HEAPU8.slice(a+t*o,a+n*o).buffer,r)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,a){let r;if(null==n)r=this.write(null!=a?a:null,e,t);else{let a=this.dataIdNextNumber++;r={id:a},this.dataIdMap.set(r,{id:a,memoryOffset:n,shape:e,dtype:t,refCount:1});let i=um.sizeFromShape(e);this.wasm.tfjs.registerTensor(a,i,n)}return{dataId:r,shape:e,dtype:t}}typedArrayFromHeap(e){let{shape:t,dtype:n,dataId:a}=e,r=this.wasm.HEAPU8.buffer,{memoryOffset:i}=this.dataIdMap.get(a),s=um.sizeFromShape(t);switch(n){case"float32":return new Float32Array(r,i,s);case"int32":return new Int32Array(r,i,s);case"bool":return new Uint8Array(r,i,s);default:throw new Error("Unknown dtype ".concat(n))}}};function n7(e,t,n){if(null!=i7)return i7;let a="tfjs-backend-wasm.wasm";return e&&t?a="tfjs-backend-wasm-threaded-simd.wasm":e&&(a="tfjs-backend-wasm-simd.wasm"),null!=o7&&null!=o7[a]?o7[a]:n+a}async function a7(){let[e,t]=await Promise.all([Td().getAsync("WASM_HAS_SIMD_SUPPORT"),Td().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,a)=>{let r={locateFile:(n,a)=>{if(n.endsWith(".worker.js")){let e=J8.wasmWorkerContents.replace(/\n/g,"\\n"),t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}return n.endsWith(".wasm")?n7(e,t,null!=s7?s7:a):a+n}};u7&&(r.instantiateWasm=function(e){return(t,n)=>(um.fetch(e,{credentials:"same-origin"}).then(a=>{a.ok||t.env.a("failed to load wasm binary file at '".concat(e,"'")),a.arrayBuffer().then(e=>{WebAssembly.instantiate(e,t).then(e=>{n(e.instance,e.module)})})}),{})}(n7(e,t,null!=s7?s7:"")));let i,s=!1;r.onAbort=()=>{s||l7||(l7=!0,a({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))},t&&e&&null==i7?(r.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+$8.toString()],{type:"text/javascript"}),i=$8(r)):i=e7(r),i.then(e=>{s=!0,l7=!1;e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},n({wasm:e})}).catch(a)})}var r7=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],i7=null,s7=null,o7={},l7=!1,u7=!1;function c7(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Lg("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),l7)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");i7=e,u7=t}function d7(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(l7)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)s7=e;else{o7=e;let t=r7.filter(e=>null==o7[e]);if(t.length>0)throw new Error("There were no entries found for the following binaries: ".concat(t.join(","),". Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found."))}u7=t}var h7=-1,p7=-1;function f7(e){h7=e}function m7(){if(-1===p7)throw new Error("WASM backend not initialized.");return p7}var g7="4.22.0";Zg("wasm",async()=>{let{wasm:e}=await a7();return new t7(e)},2);var y7="4.22.0",b7={tfjs:y7,"tfjs-core":y7,"tfjs-converter":"4.22.0","tfjs-backend-cpu":"4.22.0","tfjs-backend-webgl":"4.22.0","tfjs-backend-wasm":"4.22.0"};function v7(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.beginPath(),t.slice(1).forEach((n,a)=>{let{x:r,y:i}=n,s=t[a];e.moveTo(s.x,s.y),e.lineTo(r,i)}),n){let n=t[t.length-1],a=t[0];if(!n||!a)return;e.moveTo(n.x,n.y),e.lineTo(a.x,a.y)}e.stroke()}Yu({},{AnchorPosition:()=>s9,DrawBox:()=>c9,DrawBoxOptions:()=>u9,DrawFaceLandmarks:()=>J9,DrawFaceLandmarksOptions:()=>Q9,DrawTextField:()=>l9,DrawTextFieldOptions:()=>o9,drawContour:()=>v7,drawDetections:()=>d9,drawFaceExpressions:()=>K9,drawFaceLandmarks:()=>Z9});Yu({},{computeReshapedDimensions:()=>A7,getCenterPoint:()=>F7,isDimensions:()=>_7,isEven:()=>C7,isFloat:()=>T7,isTensor:()=>w7,isTensor1D:()=>k7,isTensor2D:()=>S7,isTensor3D:()=>I7,isTensor4D:()=>N7,isValidNumber:()=>D7,isValidProbablitiy:()=>M7,range:()=>R7,round:()=>E7});var x7=class e{constructor(e,t){if(!D7(e)||!D7(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have ".concat(JSON.stringify({width:e,height:t})));this._width=e,this._height=t}get width(){return this._width}get height(){return this._height}reverse(){return new e(1/this.width,1/this.height)}};function w7(e,t){return e instanceof Gm&&e.shape.length===t}function k7(e){return w7(e,1)}function S7(e){return w7(e,2)}function I7(e){return w7(e,3)}function N7(e){return w7(e,4)}function T7(e){return e%1!==0}function C7(e){return e%2===0}function E7(e){let t=10**(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2);return Math.floor(e*t)/t}function _7(e){return e&&e.width&&e.height}function A7(e,t){let{width:n,height:a}=e,r=t/Math.max(a,n);return new x7(Math.round(n*r),Math.round(a*r))}function F7(e){return e.reduce((e,t)=>e.add(t),new O7(0,0)).div(new O7(e.length,e.length))}function R7(e,t,n){return Array(e).fill(0).map((e,a)=>t+a*n)}function D7(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||0===e}function M7(e){return D7(e)&&e>=0&&e<=1}var O7=class e{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}add(t){return new e(this.x+t.x,this.y+t.y)}sub(t){return new e(this.x-t.x,this.y-t.y)}mul(t){return new e(this.x*t.x,this.y*t.y)}div(t){return new e(this.x/t.x,this.y/t.y)}abs(){return new e(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new e(Math.floor(this.x),Math.floor(this.y))}},P7=class e{static isRect(e){return!!e&&[e.x,e.y,e.width,e.height].every(D7)}static assertIsValidBox(t,n){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e.isRect(t))throw new Error("".concat(n," - invalid box: ").concat(JSON.stringify(t),", expected object with properties x, y, width, height"));if(!a&&(t.width<0||t.height<0))throw new Error("".concat(n," - width (").concat(t.width,") and height (").concat(t.height,") must be positive numbers"))}constructor(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t||{},r=[a.left,a.top,a.right,a.bottom].every(D7),i=[a.x,a.y,a.width,a.height].every(D7);if(!i&&!r)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have ".concat(JSON.stringify(a)));let[s,o,l,u]=i?[a.x,a.y,a.width,a.height]:[a.left,a.top,a.right-a.left,a.bottom-a.top];e.assertIsValidBox({x:s,y:o,width:l,height:u},"Box.constructor",n),this._x=s,this._y=o,this._width=l,this._height=u}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new O7(this.left,this.top)}get topRight(){return new O7(this.right,this.top)}get bottomLeft(){return new O7(this.left,this.bottom)}get bottomRight(){return new O7(this.right,this.bottom)}round(){let[t,n,a,r]=[this.x,this.y,this.width,this.height].map(e=>Math.round(e));return new e({x:t,y:n,width:a,height:r})}floor(){let[t,n,a,r]=[this.x,this.y,this.width,this.height].map(e=>Math.floor(e));return new e({x:t,y:n,width:a,height:r})}toSquare(){let{x:t,y:n,width:a,height:r}=this,i=Math.abs(a-r);return a<r&&(t-=i/2,a+=i),r<a&&(n-=i/2,r+=i),new e({x:t,y:n,width:a,height:r})}rescale(t){let n=_7(t)?t.width:t,a=_7(t)?t.height:t;return new e({x:this.x*n,y:this.y*a,width:this.width*n,height:this.height*a})}pad(t,n){let[a,r,i,s]=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:a,y:r,width:i,height:s})}clipAtImageBorders(t,n){let{x:a,y:r,right:i,bottom:s}=this,o=Math.max(a,0),l=Math.max(r,0),u=i-o,c=s-l,d=Math.min(u,t-o),h=Math.min(c,n-l);return new e({x:o,y:l,width:d,height:h}).floor()}shift(t,n){let{width:a,height:r}=this,i=this.x+t,s=this.y+n;return new e({x:i,y:s,width:a,height:r})}padAtBorders(e,t){let n=this.width+1,a=this.height+1,r=n,i=a,s=this.left,o=this.top,l=this.right,u=this.bottom;return l>t&&(r=-l+t+n,l=t),u>e&&(i=-u+e+a,u=e),s<1&&(i=2-s,s=1),o<1&&(i=2-o,o=1),{dy:1,edy:i,dx:1,edx:r,y:o,ey:u,x:s,ex:l,w:n,h:a}}calibrate(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()}},L7=class extends P7{constructor(e,t,n,a){super({left:e,top:t,right:n,bottom:a},arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},z7=class e{constructor(e,t,n,a,r){this._imageDims=new x7(r.width,r.height),this._score=e,this._classScore=t,this._className=n,this._box=new P7(a).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new P7(this._box).rescale(this.imageDims.reverse())}forSize(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})}},B7=class e extends z7{constructor(e,t,n){super(e,e,"",t,n)}forSize(t,n){let{score:a,relativeBox:r,imageDims:i}=super.forSize(t,n);return new e(a,r,i)}};function W7(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?a/(e.area+t.area-a):a/Math.min(e.area,t.area)}function V7(e,t){return Ug(()=>{let[n,a,r]=t,i=ev([...e.shape.slice(0,3),1],n,"float32"),s=ev([...e.shape.slice(0,3),1],a,"float32"),o=ev([...e.shape.slice(0,3),1],r,"float32"),l=Lb([i,s,o],3);return _x(e,l)})}function U7(e){return 1/(1+Math.exp(-e))}var j7,G7=class extends P7{constructor(e,t,n,a){super({x:e,y:t,width:n,height:a},arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},H7=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new O7(0,0),{width:a,height:r}=t;this._imgDims=new x7(a,r),this._shift=n,this._positions=e.map(e=>e.mul(new O7(a,r)).add(n))}get shift(){return new O7(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new O7(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new O7(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){let n=e instanceof B7?e.box.floor():new P7(e);return this.shiftBy(n.x,n.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:a}=l({useDlibAlignment:!1,minBoxPadding:.2},t);return n?this.alignDlib():this.alignMinBbox(a)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,a]=e,r=e=>a.sub(e).magnitude(),i=(r(t)+r(n))/2,s=Math.floor(i/.45),o=F7(e),l=Math.floor(Math.max(0,o.x-.5*s)),u=Math.floor(Math.max(0,o.y-.43*s));return new G7(l,u,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+u))}alignMinBbox(e){let t=function(e){let t=e.map(e=>e.x),n=e.map(e=>e.y),a=t.reduce((e,t)=>t<e?t:e,1/0),r=n.reduce((e,t)=>t<e?t:e,1/0),i=t.reduce((e,t)=>e<t?t:e,0),s=n.reduce((e,t)=>e<t?t:e,0);return new L7(a,r,i,s)}(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},q7=class extends H7{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(F7)}};function K7(e){return e.detection instanceof B7}function X7(e,t){return l(l({},e),{detection:t})}function Y7(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function Q7(){return"object"==typeof n.g&&"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}function J7(e){let t="";if(!e&&Q7())try{e=Xu("fs")}catch(n){t=n.toString()}return{readFile:e?t=>new Promise((n,a)=>{e.readFile(t,(e,t)=>e?a(e):n(t))}):()=>{throw new Error("readFile - failed to require fs in nodejs environment with error: ".concat(t))}}}function Z7(){let e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,a=n.g.Video||n.g.HTMLVideoElement,r=n.g.fetch,i=J7();return l({Canvas:e||class{},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:n.g.ImageData||class{},Video:n.g.HTMLVideoElement||class{},createCanvasElement:()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},createVideoElement:()=>{if(a)return new a;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},fetch:r},i)}function $7(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}function e9(e){j7=e}function t9(){return $7()?e9(Y7()):Q7()?e9(Z7()):null}var n9={getEnv:function(){if(!j7)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return j7},setEnv:e9,initialize:t9,createBrowserEnv:Y7,createFileSystem:J7,createNodejsEnv:Z7,monkeyPatch:function(e){if(j7||t9(),!j7)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=j7.Canvas,Image:n=j7.Image}=e;j7.Canvas=t,j7.Image=n,j7.createCanvasElement=e.createCanvasElement||(()=>new t),j7.createImageElement=e.createImageElement||(()=>new n),j7.ImageData=e.ImageData||j7.ImageData,j7.Video=e.Video||j7.Video,j7.fetch=e.fetch||j7.fetch,j7.readFile=e.readFile||j7.readFile},isBrowser:$7,isNodejs:Q7};function a9(e){return n9.isNodejs()||"string"!=typeof e?e:document.getElementById(e)}function r9(e){let{Canvas:t,CanvasRenderingContext2D:n}=n9.getEnv();if(e instanceof n)return e;let a=a9(e);if(!(a instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let r=a.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("resolveContext2d - canvas 2d context is null");return r}t9();var i9,s9=((i9=s9||{}).TOP_LEFT="TOP_LEFT",i9.TOP_RIGHT="TOP_RIGHT",i9.BOTTOM_LEFT="BOTTOM_LEFT",i9.BOTTOM_RIGHT="BOTTOM_RIGHT",i9),o9=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{anchorPosition:t,backgroundColor:n,fontColor:a,fontSize:r,fontStyle:i,padding:s}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=r||14,this.fontStyle=i||"Georgia",this.padding=s||4}},l9=class e{constructor(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.text="string"==typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new o9(a)}measureWidth(e){let{padding:t}=this.options;return this.text.map(t=>e.measureText(t).width).reduce((e,t)=>e<t?t:e,0)+2*t}measureHeight(){let{fontSize:e,padding:t}=this.options;return this.text.length*e+2*t}getUpperLeft(e,t){let{anchorPosition:n}=this.options,a="BOTTOM_RIGHT"===n||"TOP_RIGHT"===n,r="BOTTOM_LEFT"===n||"BOTTOM_RIGHT"===n,i=this.measureWidth(e),s=this.measureHeight(),o=a?this.anchor.x-i:this.anchor.x,l=r?this.anchor.y-s:this.anchor.y;if(t){let{width:e,height:n}=t;return{x:Math.max(Math.min(o,e-i),0),y:Math.max(Math.min(l,n-s),0)}}return{x:o,y:l}}draw(e){let t=a9(e),n=r9(t),{backgroundColor:a,fontColor:r,fontSize:i,fontStyle:s,padding:o}=this.options;n.font="".concat(i,"px ").concat(s);let l=this.measureWidth(n),u=this.measureHeight();n.fillStyle=a;let c=this.getUpperLeft(n,t);n.fillRect(c.x,c.y,l,u),n.fillStyle=r,this.text.forEach((e,t)=>{let a=o+c.x,r=o+c.y+(t+1)*i;n.fillText(e,a,r)})}},u9=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{boxColor:t,lineWidth:n,label:a,drawLabelOptions:r}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=a;let i={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new o9(l(l({},i),r))}},c9=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.box=new P7(e),this.options=new u9(t)}draw(e){let t=r9(e),{boxColor:n,lineWidth:a}=this.options,{x:r,y:i,width:s,height:o}=this.box;t.strokeStyle=n,t.lineWidth=a,t.strokeRect(r,i,s,o);let{label:l}=this.options;l&&new l9([l],{x:r-a/2,y:i},this.options.drawLabelOptions).draw(e)}};function d9(e,t){(Array.isArray(t)?t:[t]).forEach(t=>{let n=t instanceof B7?t.score:K7(t)?t.detection.score:void 0,a=t instanceof B7?t.box:K7(t)?t.detection.box:new P7(t),r=n?"".concat(E7(n)):void 0;new c9(a,{label:r}).draw(e)})}function h9(e){let{Image:t,Video:n}=n9.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function p9(e){let{Image:t,Video:n}=n9.getEnv();return e instanceof t?new x7(e.naturalWidth,e.naturalHeight):e instanceof n?new x7(e.videoWidth,e.videoHeight):new x7(e.width,e.height)}function f9(e){let{width:t,height:n}=e,{createCanvasElement:a}=n9.getEnv(),r=a();return r.width=t,r.height=n,r}function m9(e,t){let{ImageData:n}=n9.getEnv();if(!(e instanceof n)&&!h9(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:a,height:r}=t||p9(e),i=f9({width:a,height:r});return e instanceof n?r9(i).putImageData(e,0,0):r9(i).drawImage(e,0,0,a,r),i}function g9(e){let{Image:t,Canvas:n,Video:a}=n9.getEnv();return e instanceof t||e instanceof n||e instanceof a}var y9=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ".concat(e));this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((e,t)=>{if(I7(e))return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape);if(N7(e)){let n=e.shape[0];if(1!==n)throw new Error("NetInput - tf.Tensor4D with batchSize ".concat(n," passed, but not supported in input array"));return this._imageTensors[t]=e,void(this._inputDimensions[t]=e.shape.slice(1))}let n=e instanceof n9.getEnv().Canvas?e:m9(e);this._canvases[t]=n,this._inputDimensions[t]=[n.height,n.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return R7(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return A7({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)}toBatchTensor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._inputSize=e,Ug(()=>{let n=R7(this.batchSize,0,1).map(n=>{let a=this.getInput(n);if(a instanceof Gm){let n=N7(a)?a:ex(a);return n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ug(()=>{let[n,a]=e.shape.slice(1);if(n===a)return e;let r=Math.abs(n-a),i=Math.round(r*(t?.5:1)),s=n>a?2:1,o=t=>{let n=e.shape.slice();return n[s]=t,ev(n,0,"float32")},l=o(i),u=r-l.shape[s],c=[t&&u?o(u):null,e,l].filter(e=>!!e).map(e=>$y(e,"float32"));return Lb(c,s)})}(n,t),(n.shape[1]!==e||n.shape[2]!==e)&&(n=sI.resizeBilinear(n,[e,e],!1,!1)),n.as3D(e,e,3)}if(a instanceof n9.getEnv().Canvas)return QI.fromPixels(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{Image:a,Canvas:r}=n9.getEnv();if(!(e instanceof a||e instanceof r))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return f9({width:1,height:1});let i=p9(e),s=t/Math.max(i.height,i.width),o=s*i.width,l=s*i.height,u=f9({width:t,height:t}),c=e instanceof r?e:m9(e),d=Math.abs(o-l)/2,h=n&&o<l?d:0,p=n&&l<o?d:0;return c.width>0&&c.height>0&&r9(u).drawImage(c,h,p,o,l),u}(a,e,t));throw new Error("toBatchTensor - at batchIdx ".concat(n,", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ").concat(a))});return gk(n.map(e=>$y(e,"float32"))).as4D(this.batchSize,e,e,3)})}};async function b9(e){if(e instanceof y9)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=t=>Array.isArray(e)?" at input index ".concat(t,":"):"",a=t.map(a9);return a.forEach((e,a)=>{if(!g9(e)&&!I7(e)&&!N7(e))throw"string"==typeof t[a]?new Error("toNetInput -".concat(n(a)," string passed, but could not resolve HTMLElement for element id ").concat(t[a])):new Error("toNetInput -".concat(n(a)," expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id"));if(N7(e)){let t=e.shape[0];if(1!==t)throw new Error("toNetInput -".concat(n(a)," tf.Tensor4D with batchSize ").concat(t," passed, but not supported in input array"))}}),await Promise.all(a.map(e=>g9(e)&&function(e){return new Promise((t,n)=>{function a(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),n(e))}function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),t(e))}e instanceof n9.getEnv().Canvas||h9(e)?t(null):(e.addEventListener("load",r),e.addEventListener("error",a))})}(e))),new y9(a,Array.isArray(e))}async function v9(e,t){let{Canvas:n}=n9.getEnv(),a=e;if(!(e instanceof n)){let t=await b9(e);if(t.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let r=t.getInput(0);a=r instanceof n?r:await async function(e,t){let n=t||n9.getEnv().createCanvasElement(),[a,r,i]=e.shape.slice(N7(e)?1:0),s=Ug(()=>e.as3D(a,r,i).toInt());return await QI.toPixels(s,n),s.dispose(),n}(r)}let r=r9(a);return t.map(e=>e instanceof B7?e.forSize(a.width,a.height).box.floor():e).map(e=>e.clipAtImageBorders(a.width,a.height)).map(e=>{let{x:t,y:n,width:a,height:i}=e,s=f9({width:a,height:i});return a>0&&i>0&&r9(s).putImageData(r.getImageData(t,n,a,i),0,0),s})}async function x9(e,t){if(!I7(e)&&!N7(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(N7(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return Ug(()=>{let[n,a,r]=e.shape.slice(N7(e)?1:0);return t.map(e=>e instanceof B7?e.forSize(a,n).box:e).map(e=>e.clipAtImageBorders(a,n)).filter(e=>e.width>0&&e.height>0).map(t=>{let{x:i,y:s,width:o,height:l}=t;return sk(e.as3D(n,a,r),[s,i,0],[l,o,r])})})}async function w9(e,t){let{fetch:n}=n9.getEnv(),a=await n(e,t);if(!(a.status<400))throw new Error("failed to fetch: (".concat(a.status,") ").concat(a.statusText,", from url: ").concat(a.url));return a}function k9(e,t){let n="".concat(t,"-weights_manifest.json");if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/".concat(n)};let a=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",r=(e=e.replace(a,"")).split("/").filter(e=>e),i=e.endsWith(".json")?r[r.length-1]:n,s=a+(e.endsWith(".json")?r.slice(0,r.length-1):r).join("/");return s=e.startsWith("/")?"/".concat(s):s,{modelBaseUri:s,manifestUri:"/"===s?"/".concat(i):"".concat(s,"/").concat(i)}}async function S9(e,t){let{manifestUri:n,modelBaseUri:a}=k9(e,t),r=await async function(e){return(await w9(e)).json()}(n);return CI.loadWeights(r,a)}var I9=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:a}=this.traversePropertyPath(e);n[a].dispose(),n[a]=t}getParamList(){return this._paramMappings.map(e=>{let{paramPath:t}=e;return{path:t,tensor:this.getParamFromPath(t)}})}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof qm)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof qm))}variable(){this.getFrozenParams().forEach(e=>{let{path:t,tensor:n}=e;this.reassignParamFromPath(t,n.variable())})}freeze(){this.getTrainableParams().forEach(e=>{let{path:t,tensor:n}=e,a=Fg(n.dataSync());n.dispose(),this.reassignParamFromPath(t,a)})}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path ".concat(t.path));t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(e=>{let{tensor:t}=e;return Array.from(t.dataSync())}).reduce((e,t)=>e.concat(t)))}async load(e){e instanceof Float32Array?this.extractWeights(e):await this.loadFromUri(e)}async loadFromUri(e){if(e&&"string"!=typeof e)throw new Error("".concat(this._name,".loadFromUri - expected model uri"));let t=await S9(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&"string"!=typeof e)throw new Error("".concat(this._name,".loadFromDisk - expected model file path"));let{readFile:t}=n9.getEnv(),{manifestUri:n,modelBaseUri:a}=k9(e,this.getDefaultModelName()),r=CI.weightsLoaderFactory(e=>Promise.all(e.map(e=>t(e).then(e=>"string"==typeof e?Buffer.from(e):e.buffer)))),i=JSON.parse((await t(n)).toString()),s=await r(i,a);this.loadFromWeightMap(s)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((t,n)=>{if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property ".concat(n,", for path ").concat(e));return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}},{nextObj:this.params}),{obj:n,objProp:a}=t;if(!n||!a||!(n[a]instanceof Gm))throw new Error("traversePropertyPath - parameter is not a tensor, for path ".concat(e));return{obj:n,objProp:a}}};function N9(e,t,n){return Ug(()=>{let a=$w(e,t.depthwise_filter,t.pointwise_filter,n,"same");return a=nb(a,t.bias),a})}function T9(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ug(()=>{let a=jw(n?nb(sv(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):N9(e,t.conv0,[2,2])),r=N9(a,t.conv1,[1,1]),i=N9(jw(nb(a,r)),t.conv2,[1,1]);return jw(nb(a,nb(r,i)))})}function C9(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Ug(()=>{let r=jw(n?nb(sv(e,t.conv0.filters,a?[2,2]:[1,1],"same"),t.conv0.bias):N9(e,t.conv0,a?[2,2]:[1,1])),i=N9(r,t.conv1,[1,1]),s=N9(jw(nb(r,i)),t.conv2,[1,1]),o=N9(jw(nb(r,nb(i,s))),t.conv3,[1,1]);return jw(nb(r,nb(i,nb(s,o))))})}function E9(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"same",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Ug(()=>{let r=nb(sv(e,t.filters,[1,1],n),t.bias);return a?jw(r):r})}function _9(e,t){Object.keys(e).forEach(n=>{t.some(e=>e.originalPath===n)||e[n].dispose()})}function A9(e,t){return(n,a,r,i)=>{let s=Sk(e(n*a*r*r),[r,r,n,a]),o=xk(e(a));return t.push({paramPath:"".concat(i,"/filters")},{paramPath:"".concat(i,"/bias")}),{filters:s,bias:o}}}function F9(e,t){return(n,a,r)=>{let i=wk(e(n*a),[n,a]),s=xk(e(a));return t.push({paramPath:"".concat(r,"/weights")},{paramPath:"".concat(r,"/bias")}),{weights:i,bias:s}}}var R9=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function D9(e,t){return(n,a,r)=>{let i=Sk(e(9*n),[3,3,n,1]),s=Sk(e(n*a),[1,1,n,a]),o=xk(e(a));return t.push({paramPath:"".concat(r,"/depthwise_filter")},{paramPath:"".concat(r,"/pointwise_filter")},{paramPath:"".concat(r,"/bias")}),new R9(i,s,o)}}function M9(e){return t=>{let n=e("".concat(t,"/depthwise_filter"),4),a=e("".concat(t,"/pointwise_filter"),4),r=e("".concat(t,"/bias"),1);return new R9(n,a,r)}}function O9(e,t){return(n,a,r)=>{let i=e[n];if(!w7(i,a))throw new Error("expected weightMap[".concat(n,"] to be a Tensor").concat(a,"D, instead have ").concat(i));return t.push({originalPath:n,paramPath:r||n}),i}}function P9(e){let t=e;return{extractWeights:function(e){let n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function L9(e,t){let n=A9(e,t),a=D9(e,t);function r(e,t,r){return{conv0:arguments.length>3&&void 0!==arguments[3]&&arguments[3]?n(e,t,3,"".concat(r,"/conv0")):a(e,t,"".concat(r,"/conv0")),conv1:a(t,t,"".concat(r,"/conv1")),conv2:a(t,t,"".concat(r,"/conv2"))}}return{extractDenseBlock3Params:r,extractDenseBlock4Params:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{conv0:s,conv1:o,conv2:l}=r(e,t,n,i);return{conv0:s,conv1:o,conv2:l,conv3:a(t,t,"".concat(n,"/conv3"))}}}}function z9(e){return t=>({filters:e("".concat(t,"/filters"),4),bias:e("".concat(t,"/bias"),1)})}function B9(e,t){let n=O9(e,t),a=z9(n),r=M9(n);return{extractDenseBlock3Params:function(e){return{conv0:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("".concat(e,"/conv0")):r("".concat(e,"/conv0")),conv1:r("".concat(e,"/conv1")),conv2:r("".concat(e,"/conv2"))}},extractDenseBlock4Params:function(e){return{conv0:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("".concat(e,"/conv0")):r("".concat(e,"/conv0")),conv1:r("".concat(e,"/conv1")),conv2:r("".concat(e,"/conv2")),conv3:r("".concat(e,"/conv3"))}}}}var W9=class extends I9{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return Ug(()=>{let n=C9(V7($y(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=C9(n,t.dense1),n=C9(n,t.dense2),n=C9(n,t.dense3),n=Ob(n,[7,7],[2,2],"valid"),n})}async forward(e){return this.forwardInput(await b9(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock4Params:n}=B9(e,t),a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return _9(e,t),{params:a,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=P9(e),{extractDenseBlock4Params:r}=L9(n,t),i=r(3,32,"dense0",!0),s=r(32,64,"dense1"),o=r(64,128,"dense2"),l=r(128,256,"dense3");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o,dense3:l}}}(e)}};function V9(e,t){return Ug(()=>nb(zb(e,t.weights),t.bias))}function U9(e){let t={},n={};return Object.keys(e).forEach(a=>{(a.startsWith("fc")?n:t)[a]=e[a]}),{featureExtractorMap:t,classifierMap:n}}var j9=class extends I9{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return Ug(()=>{let n=e instanceof y9?this.faceFeatureExtractor.forwardInput(e):e;return V9(n.as2D(n.shape[0],-1),t.fc)})}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e,t,n){let a=[],{extractWeights:r,getRemainingWeights:i}=P9(e),s=F9(r,a)(t,n,"fc");if(0!==i().length)throw new Error("weights remaing after extract: ".concat(i().length));return{paramMappings:a,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=U9(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=O9(e,t),a={fc:(r="fc",{weights:n("".concat(r,"/weights"),2),bias:n("".concat(r,"/bias"),1)})};var r;return _9(e,t),{params:a,paramMappings:t}}(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),a=n*t+n,r=e.slice(0,e.length-a),i=e.slice(e.length-a);return this.faceFeatureExtractor.extractWeights(r),this.extractClassifierParams(i)}},G9=["neutral","happy","sad","angry","fearful","disgusted","surprised"],H9=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: ".concat(e.length));G9.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return G9.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}};function q9(e,t){return l(l({},e),{expressions:t})}function K9(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=arguments.length>3?arguments[3]:void 0;(Array.isArray(t)?t:[t]).forEach(t=>{let r=t instanceof H9?t:function(e){return e.expressions instanceof H9}(t)?t.expressions:void 0;if(!r)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let i=r.asSortedArray().filter(e=>e.probability>n),s=K7(t)?t.detection.box.bottomLeft:a||new O7(0,0);new l9(i.map(e=>"".concat(e.expression," (").concat(E7(e.probability),")")),s).draw(e)})}function X9(e){return K7(e)&&e.landmarks instanceof H7&&e.unshiftedLandmarks instanceof H7&&e.alignedRect instanceof B7}function Y9(e,t){let{box:n}=e.detection,a=t.shiftBy(n.x,n.y),r=a.align(),{imageDims:i}=e.detection,s=new B7(e.detection.score,r.rescale(i.reverse()),i),o=function(e){let t=e=>180*e/Math.PI,n=(e,t)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2),a={roll:void 0,pitch:void 0,yaw:void 0};if(!e||!e.positions||68!==e.positions.length)return a;let r=e.positions;return a.roll=((e,n)=>{let a=Math.hypot(n.x-e.x,n.y-e.y),r=n.y-e.y,i=Math.asin(r/a),s=t(i);return Math.floor(90-s)*(n.x-e.x<0?-1:1)})(r[27],r[66]),a.pitch=((e,a,r)=>{let i=n(e,r),s=new O7((e.x+r.x)/2,(e.y+r.y)/2),o=n(a,s),l=Math.atan(o/i);return Math.floor(t(l))*(s.y-a.y<0?-1:1)})(r[14],r[30],r[2]),a.yaw=(i=r[14],s=r[33],o=r[2],Math.floor(i.x-s.x)-Math.floor(s.x-o.x)),a;var i,s,o}(t);return l(l({},e),{landmarks:a,unshiftedLandmarks:t,alignedRect:s,angle:o})}var Q9=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{drawLines:t=!0,drawPoints:n=!0,lineWidth:a,lineColor:r,pointSize:i,pointColor:s}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=a||1,this.pointSize=i||2,this.lineColor=r||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"}},J9=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.faceLandmarks=e,this.options=new Q9(t)}draw(e){let t=r9(e),{drawLines:n,drawPoints:a,lineWidth:r,lineColor:i,pointSize:s,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof q7&&(t.strokeStyle=i,t.lineWidth=r,v7(t,this.faceLandmarks.getJawOutline()),v7(t,this.faceLandmarks.getLeftEyeBrow()),v7(t,this.faceLandmarks.getRightEyeBrow()),v7(t,this.faceLandmarks.getNose()),v7(t,this.faceLandmarks.getLeftEye(),!0),v7(t,this.faceLandmarks.getRightEye(),!0),v7(t,this.faceLandmarks.getMouth(),!0)),a){t.strokeStyle=o,t.fillStyle=o;let e=e=>{t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(e)}}};function Z9(e,t){(Array.isArray(t)?t:[t]).forEach(t=>{let n=t instanceof H7?t:X9(t)?t.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new J9(n).draw(e)})}function $9(e,t){let n=[],{extractWeights:a,getRemainingWeights:r}=P9(e),{extractConvParams:i,extractSeparableConvParams:s,extractReductionBlockParams:o,extractMainBlockParams:l}=function(e,t){let n=A9(e,t),a=D9(e,t);return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:function(e,t,r){return{separable_conv0:a(e,t,"".concat(r,"/separable_conv0")),separable_conv1:a(t,t,"".concat(r,"/separable_conv1")),expansion_conv:n(e,t,1,"".concat(r,"/expansion_conv"))}},extractMainBlockParams:function(e,t){return{separable_conv0:a(e,e,"".concat(t,"/separable_conv0")),separable_conv1:a(e,e,"".concat(t,"/separable_conv1")),separable_conv2:a(e,e,"".concat(t,"/separable_conv2"))}}}}(a,n),u={conv_in:i(3,32,3,"entry_flow/conv_in"),reduction_block_0:o(32,64,"entry_flow/reduction_block_0"),reduction_block_1:o(64,128,"entry_flow/reduction_block_1")},c={};R7(t,0,1).forEach(e=>{c["main_block_".concat(e)]=l(128,"middle_flow/main_block_".concat(e))});let d={reduction_block:o(128,256,"exit_flow/reduction_block"),separable_conv:s(256,512,"exit_flow/separable_conv")};if(0!==r().length)throw new Error("weights remaing after extract: ".concat(r().length));return{paramMappings:n,params:{entry_flow:u,middle_flow:c,exit_flow:d}}}function eee(e,t){let n=[],{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:s}=function(e,t){let n=O9(e,t),a=z9(n),r=M9(n);return{extractConvParams:a,extractSeparableConvParams:r,extractReductionBlockParams:function(e){return{separable_conv0:r("".concat(e,"/separable_conv0")),separable_conv1:r("".concat(e,"/separable_conv1")),expansion_conv:a("".concat(e,"/expansion_conv"))}},extractMainBlockParams:function(e){return{separable_conv0:r("".concat(e,"/separable_conv0")),separable_conv1:r("".concat(e,"/separable_conv1")),separable_conv2:r("".concat(e,"/separable_conv2"))}}}}(e,n),o={conv_in:a("entry_flow/conv_in"),reduction_block_0:i("entry_flow/reduction_block_0"),reduction_block_1:i("entry_flow/reduction_block_1")},l={};R7(t,0,1).forEach(e=>{l["main_block_".concat(e)]=s("middle_flow/main_block_".concat(e))});let u={reduction_block:i("exit_flow/reduction_block"),separable_conv:r("exit_flow/separable_conv")};return _9(e,n),{params:{entry_flow:o,middle_flow:l,exit_flow:u},paramMappings:n}}function tee(e,t,n){return nb(sv(e,t.filters,n,"same"),t.bias)}function nee(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?jw(e):e;return n=N9(n,t.separable_conv0,[1,1]),n=N9(jw(n),t.separable_conv1,[1,1]),n=Bx(n,[3,3],[2,2],"same"),n=nb(n,tee(e,t.expansion_conv,[2,2])),n}var aee=class extends I9{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return Ug(()=>{let n=V7($y(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),a=jw(tee(n,t.entry_flow.conv_in,[2,2]));return a=nee(a,t.entry_flow.reduction_block_0,!1),a=nee(a,t.entry_flow.reduction_block_1),R7(this._numMainBlocks,0,1).forEach(e=>{a=function(e,t){let n=N9(jw(e),t.separable_conv0,[1,1]);return n=N9(jw(n),t.separable_conv1,[1,1]),n=N9(jw(n),t.separable_conv2,[1,1]),n=nb(n,e),n}(a,t.middle_flow["main_block_".concat(e)])}),a=nee(a,t.exit_flow.reduction_block),a=jw(N9(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await b9(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return eee(e,this._numMainBlocks)}extractParams(e){return $9(e,this._numMainBlocks)}};var ree,iee=((ree=iee||{}).FEMALE="female",ree.MALE="male",ree),see=class extends j9{postProcess(e,t,n){let a=n.map(e=>{let{width:n,height:a}=e,r=t/Math.max(a,n);return{width:n*r,height:a*r}}),r=a.length;return Ug(()=>{let n=(e,t)=>gk([ev([68],e,"float32"),ev([68],t,"float32")],1).as2D(1,136).as1D(),i=(e,t)=>{let{width:n,height:r}=a[e];return t(n,r)?Math.abs(n-r)/2:0};return e.mul(ev([r,136],t,"float32")).sub(gk(Array.from(Array(r),(e,t)=>n((e=>i(e,(e,t)=>e<t))(t),(e=>i(e,(e,t)=>t<e))(t))))).div(gk(Array.from(Array(r),(e,t)=>n(a[t].width,a[t].height))))})}forwardInput(e){return Ug(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(e=>{let[t,n]=e;return{height:t,width:n}}))})}async forward(e){return this.forwardInput(await b9(e))}async detectLandmarks(e){let t=await b9(e),n=Ug(()=>Ok(this.forwardInput(t))),a=await Promise.all(n.map(async(e,n)=>{let a=Array.from(e.dataSync()),r=a.filter((e,t)=>C7(t)),i=a.filter((e,t)=>!C7(t));return new q7(Array(68).fill(0).map((e,t)=>new O7(r[t],i[t])),{height:t.getInputHeight(n),width:t.getInputWidth(n)})}));return n.forEach(e=>e.dispose()),t.isBatchInput?a:a[0]}getClassifierChannelsOut(){return 136}},oee=class extends see{constructor(){super("FaceLandmark68Net",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new W9)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};var lee=class extends I9{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ug(()=>{let n=T9(V7($y(e.toBatchTensor(112,!0),"float32"),[122.782,117.001,104.298]).div(255),t.dense0,!0);return n=T9(n,t.dense1),n=T9(n,t.dense2),n=Ob(n,[14,14],[2,2],"valid"),n})}async forward(e){return this.forwardInput(await b9(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractDenseBlock3Params:n}=B9(e,t),a={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return _9(e,t),{params:a,paramMappings:t}}(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=P9(e),{extractDenseBlock3Params:r}=L9(n,t),i=r(3,32,"dense0",!0),s=r(32,64,"dense1"),o=r(64,128,"dense2");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o}}}(e)}};function uee(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"same",{filters:i,bias:s}=t.conv,o=sv(e,i,n,r);return o=nb(o,s),o=function(e,t){return nb(ib(e,t.weights),t.biases)}(o,t.scale),a?jw(o):o}function cee(e,t){return uee(e,t,[1,1],!1)}function dee(e,t){return uee(e,t,[2,2],!0,"valid")}function hee(e,t){function n(n,a,r,i){let s=function(t,n,a){let r=e(t),i=r.length/(n*a*a);if(T7(i))throw new Error("depth has to be an integer: ".concat(i,", weights.length: ").concat(r.length,", numFilters: ").concat(n,", filterSize: ").concat(a));return Ug(()=>Vk(Sk(r,[n,i,a,a]),[2,3,1,0]))}(n,a,r),o=xk(e(a));return t.push({paramPath:"".concat(i,"/filters")},{paramPath:"".concat(i,"/bias")}),{filters:s,bias:o}}function a(a,r,i,s){let o=n(a,r,i,"".concat(s,"/conv")),l=function(n,a){let r=xk(e(n)),i=xk(e(n));return t.push({paramPath:"".concat(a,"/weights")},{paramPath:"".concat(a,"/biases")}),{weights:r,biases:i}}(r,"".concat(s,"/scale"));return{conv:o,scale:l}}return{extractConvLayerParams:a,extractResidualLayerParams:function(e,t,n,r){return{conv1:a((arguments.length>4&&void 0!==arguments[4]&&arguments[4]?.5:1)*e,t,n,"".concat(r,"/conv1")),conv2:a(e,t,n,"".concat(r,"/conv2"))}}}}function pee(e,t){let n=O9(e,t);function a(e){let t=n("".concat(e,"/conv/filters"),4),a=n("".concat(e,"/conv/bias"),1),r=function(e){return{weights:n("".concat(e,"/scale/weights"),1),biases:n("".concat(e,"/scale/biases"),1)}}(e);return{conv:{filters:t,bias:a},scale:r}}return{extractConvLayerParams:a,extractResidualLayerParams:function(e){return{conv1:a("".concat(e,"/conv1")),conv2:a("".concat(e,"/conv2"))}}}}function fee(e,t){let n=function(e,t){return uee(e,t,[1,1],!0)}(e,t.conv1);return n=cee(n,t.conv2),n=nb(n,e),n=jw(n),n}function mee(e,t){let n=dee(e,t.conv1);n=cee(n,t.conv2);let a=Ob(e,2,2,"valid"),r=Gx(a.shape),i=a.shape[3]!==n.shape[3];if(a.shape[1]!==n.shape[1]||a.shape[2]!==n.shape[2]){let e=[...n.shape];e[1]=1;let t=Gx(e);n=Lb([n,t],1);let a=[...n.shape];a[2]=1;let r=Gx(a);n=Lb([n,r],2)}return a=i?Lb([a,r],3):a,n=nb(a,n),n=jw(n),n}var gee=class extends I9{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return Ug(()=>{let n=dee(V7($y(e.toBatchTensor(150,!0),"float32"),[122.782,117.001,104.298]).div(255),t.conv32_down);n=Bx(n,3,2,"valid"),n=fee(n,t.conv32_1),n=fee(n,t.conv32_2),n=fee(n,t.conv32_3),n=mee(n,t.conv64_down),n=fee(n,t.conv64_1),n=fee(n,t.conv64_2),n=fee(n,t.conv64_3),n=mee(n,t.conv128_down),n=fee(n,t.conv128_1),n=fee(n,t.conv128_2),n=mee(n,t.conv256_down),n=fee(n,t.conv256_1),n=fee(n,t.conv256_2),n=mee(n,t.conv256_down_out);let a=n.mean([1,2]);return zb(a,t.fc)})}async forward(e){return this.forwardInput(await b9(e))}async computeFaceDescriptor(e){var t;if(null!=(t=null==e?void 0:e.shape)&&t.some(e=>e<=0))return new Float32Array(128);let n=await b9(e),a=Ug(()=>Ok(this.forwardInput(n))),r=await Promise.all(a.map(e=>e.data()));return a.forEach(e=>e.dispose()),n.isBatchInput?r:r[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return function(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:a}=pee(e,t),r=n("conv32_down"),i=a("conv32_1"),s=a("conv32_2"),o=a("conv32_3"),l=a("conv64_down"),u=a("conv64_1"),c=a("conv64_2"),d=a("conv64_3"),h=a("conv128_down"),p=a("conv128_1"),f=a("conv128_2"),m=a("conv256_down"),g=a("conv256_1"),y=a("conv256_2"),b=a("conv256_down_out"),{fc:v}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!S7(v))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have ".concat(v));let x={conv32_down:r,conv32_1:i,conv32_2:s,conv32_3:o,conv64_down:l,conv64_1:u,conv64_2:c,conv64_3:d,conv128_down:h,conv128_1:p,conv128_2:f,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:v};return _9(e,t),{params:x,paramMappings:t}}(e)}extractParams(e){return function(e){let{extractWeights:t,getRemainingWeights:n}=P9(e),a=[],{extractConvLayerParams:r,extractResidualLayerParams:i}=hee(t,a),s=r(4704,32,7,"conv32_down"),o=i(9216,32,3,"conv32_1"),l=i(9216,32,3,"conv32_2"),u=i(9216,32,3,"conv32_3"),c=i(36864,64,3,"conv64_down",!0),d=i(36864,64,3,"conv64_1"),h=i(36864,64,3,"conv64_2"),p=i(36864,64,3,"conv64_3"),f=i(147456,128,3,"conv128_down",!0),m=i(147456,128,3,"conv128_1"),g=i(147456,128,3,"conv128_2"),y=i(589824,256,3,"conv256_down",!0),b=i(589824,256,3,"conv256_1"),v=i(589824,256,3,"conv256_2"),x=i(589824,256,3,"conv256_down_out"),w=Ug(()=>Vk(wk(t(32768),[128,256]),[1,0]));if(a.push({paramPath:"fc"}),0!==n().length)throw new Error("weights remaing after extract: ".concat(n().length));return{params:{conv32_down:s,conv32_1:o,conv32_2:l,conv32_3:u,conv64_down:c,conv64_1:d,conv64_2:h,conv64_3:p,conv128_down:f,conv128_1:m,conv128_2:g,conv256_down:y,conv256_1:b,conv256_2:v,conv256_down_out:x,fc:w},paramMappings:a}}(e)}};function yee(e,t){return l(l({},e),{descriptor:t})}function bee(e,t){return l(l({},e),{age:t})}function vee(e,t,n){return l(l({},e),{gender:t,genderProbability:n})}function xee(e,t){function n(n,a,r,i,s){let o=Sk(e(n*a*r*r),[r,r,n,a]),l=xk(e(a));return t.push({paramPath:"".concat(i,"/filters")},{paramPath:"".concat(i,"/").concat(s?"batch_norm_offset":"bias")}),{filters:o,bias:l}}function a(e,t,a,r){let{filters:i,bias:s}=n(e,t,a,r,!0);return{filters:i,batch_norm_offset:s}}function r(n,r,i){let s=function(n,a){let r=Sk(e(9*n),[3,3,n,1]),i=xk(e(n)),s=xk(e(n)),o=xk(e(n)),l=xk(e(n));return t.push({paramPath:"".concat(a,"/filters")},{paramPath:"".concat(a,"/batch_norm_scale")},{paramPath:"".concat(a,"/batch_norm_offset")},{paramPath:"".concat(a,"/batch_norm_mean")},{paramPath:"".concat(a,"/batch_norm_variance")}),{filters:r,batch_norm_scale:i,batch_norm_offset:s,batch_norm_mean:o,batch_norm_variance:l}}(n,"".concat(i,"/depthwise_conv"));return{depthwise_conv:s,pointwise_conv:a(n,r,1,"".concat(i,"/pointwise_conv"))}}return{extractMobilenetV1Params:function(){return{conv_0:a(3,32,3,"mobilenetv1/conv_0"),conv_1:r(32,64,"mobilenetv1/conv_1"),conv_2:r(64,128,"mobilenetv1/conv_2"),conv_3:r(128,128,"mobilenetv1/conv_3"),conv_4:r(128,256,"mobilenetv1/conv_4"),conv_5:r(256,256,"mobilenetv1/conv_5"),conv_6:r(256,512,"mobilenetv1/conv_6"),conv_7:r(512,512,"mobilenetv1/conv_7"),conv_8:r(512,512,"mobilenetv1/conv_8"),conv_9:r(512,512,"mobilenetv1/conv_9"),conv_10:r(512,512,"mobilenetv1/conv_10"),conv_11:r(512,512,"mobilenetv1/conv_11"),conv_12:r(512,1024,"mobilenetv1/conv_12"),conv_13:r(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:a(1024,256,1,"prediction_layer/conv_0"),conv_1:a(256,512,3,"prediction_layer/conv_1"),conv_2:a(512,128,1,"prediction_layer/conv_2"),conv_3:a(128,256,3,"prediction_layer/conv_3"),conv_4:a(256,128,1,"prediction_layer/conv_4"),conv_5:a(128,256,3,"prediction_layer/conv_5"),conv_6:a(256,64,1,"prediction_layer/conv_6"),conv_7:a(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function wee(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:a}=function(e,t){let n=O9(e,t);function a(e,t,a){return{filters:n("".concat(e,"/Conv2d_").concat(t,"_pointwise/weights"),4,"".concat(a,"/filters")),batch_norm_offset:n("".concat(e,"/Conv2d_").concat(t,"_pointwise/convolution_bn_offset"),1,"".concat(a,"/batch_norm_offset"))}}function r(e){let t="mobilenetv1/conv_".concat(e),r="MobilenetV1/Conv2d_".concat(e,"_depthwise"),i="".concat(t,"/depthwise_conv"),s="".concat(t,"/pointwise_conv");return{depthwise_conv:{filters:n("".concat(r,"/depthwise_weights"),4,"".concat(i,"/filters")),batch_norm_scale:n("".concat(r,"/BatchNorm/gamma"),1,"".concat(i,"/batch_norm_scale")),batch_norm_offset:n("".concat(r,"/BatchNorm/beta"),1,"".concat(i,"/batch_norm_offset")),batch_norm_mean:n("".concat(r,"/BatchNorm/moving_mean"),1,"".concat(i,"/batch_norm_mean")),batch_norm_variance:n("".concat(r,"/BatchNorm/moving_variance"),1,"".concat(i,"/batch_norm_variance"))},pointwise_conv:a("MobilenetV1",e,s)}}function i(e,t){return{filters:n("".concat(e,"/weights"),4,"".concat(t,"/filters")),bias:n("".concat(e,"/biases"),1,"".concat(t,"/bias"))}}function s(e){return{box_encoding_predictor:i("Prediction/BoxPredictor_".concat(e,"/BoxEncodingPredictor"),"prediction_layer/box_predictor_".concat(e,"/box_encoding_predictor")),class_predictor:i("Prediction/BoxPredictor_".concat(e,"/ClassPredictor"),"prediction_layer/box_predictor_".concat(e,"/class_predictor"))}}return{extractMobilenetV1Params:function(){return{conv_0:a("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:r(1),conv_2:r(2),conv_3:r(3),conv_4:r(4),conv_5:r(5),conv_6:r(6),conv_7:r(7),conv_8:r(8),conv_9:r(9),conv_10:r(10),conv_11:r(11),conv_12:r(12),conv_13:r(13)}},extractPredictionLayerParams:function(){return{conv_0:a("Prediction",0,"prediction_layer/conv_0"),conv_1:a("Prediction",1,"prediction_layer/conv_1"),conv_2:a("Prediction",2,"prediction_layer/conv_2"),conv_3:a("Prediction",3,"prediction_layer/conv_3"),conv_4:a("Prediction",4,"prediction_layer/conv_4"),conv_5:a("Prediction",5,"prediction_layer/conv_5"),conv_6:a("Prediction",6,"prediction_layer/conv_6"),conv_7:a("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}}}(e,t),r=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!I7(r))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ".concat(r));let i={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:r}};return _9(e,t),{params:i,paramMappings:t}}function kee(e,t,n){return Ug(()=>{let a=sv(e,t.filters,n,"same");return a=nb(a,t.batch_norm_offset),tv(a,0,6)})}function See(e,t){return Ug(()=>{let n,a=kee(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((e,t)=>{let r=t+1,i=function(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}(r);a=function(e,t,n){return Ug(()=>{let a=vv(e,t.filters,n,"same");return a=Hb(a,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),tv(a,0,6)})}(a,e.depthwise_conv,i),a=kee(a,e.pointwise_conv,[1,1]),11===r&&(n=a)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:a,conv11:n}})}function Iee(e,t,n){let a=e.arraySync(),r=Math.min(a[t][0],a[t][2]),i=Math.min(a[t][1],a[t][3]),s=Math.max(a[t][0],a[t][2]),o=Math.max(a[t][1],a[t][3]),l=Math.min(a[n][0],a[n][2]),u=Math.min(a[n][1],a[n][3]),c=Math.max(a[n][0],a[n][2]),d=Math.max(a[n][1],a[n][3]),h=(s-r)*(o-i),p=(c-l)*(d-u);if(h<=0||p<=0)return 0;let f=Math.max(r,l),m=Math.max(i,u),g=Math.min(s,c),y=Math.min(o,d),b=Math.max(g-f,0)*Math.max(y-m,0);return b/(h+p-b)}function Nee(e,t){let{sizes:n,centers:a}=function(e){let t=Ok(Vk(e,[1,0])),n=[_x(t[2],t[0]),_x(t[3],t[1])];return{sizes:n,centers:[nb(t[0],rb(n[0],2)),nb(t[1],rb(n[1],2))]}}(e),r=Ok(Vk(t,[1,0])),i=rb(ib($v(rb(r[2],5)),n[0]),2),s=nb(ib(rb(r[0],10),n[0]),a[0]),o=rb(ib($v(rb(r[3],5)),n[1]),2),l=nb(ib(rb(r[1],10),n[1]),a[1]);return Vk(gk([_x(s,i),_x(l,o),nb(s,i),nb(l,o)]),[1,0])}function Tee(e,t){return Ug(()=>{let n=e.shape[0];return{boxPredictionEncoding:Mb(E9(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:Mb(E9(e,t.class_predictor),[n,-1,3])}})}var Cee=class{constructor(){let{minConfidence:e,maxResults:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error("".concat(this._name," - expected minConfidence to be a number between 0 and 1"));if("number"!=typeof this._maxResults)throw new Error("".concat(this._name," - expected maxResults to be a number"))}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},Eee=class extends I9{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return Ug(()=>{let n=$y(e.toBatchTensor(512,!1),"float32"),a=See(_x(rb(n,127.5),1),t.mobilenetv1),{boxPredictions:r,classPredictions:i}=function(e,t,n){return Ug(()=>{let a=kee(e,n.conv_0,[1,1]),r=kee(a,n.conv_1,[2,2]),i=kee(r,n.conv_2,[1,1]),s=kee(i,n.conv_3,[2,2]),o=kee(s,n.conv_4,[1,1]),l=kee(o,n.conv_5,[2,2]),u=kee(l,n.conv_6,[1,1]),c=kee(u,n.conv_7,[2,2]),d=Tee(t,n.box_predictor_0),h=Tee(e,n.box_predictor_1),p=Tee(r,n.box_predictor_2),f=Tee(s,n.box_predictor_3),m=Tee(l,n.box_predictor_4),g=Tee(c,n.box_predictor_5);return{boxPredictions:Lb([d.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:Lb([d.classPrediction,h.classPrediction,p.classPrediction,f.classPrediction,m.classPrediction,g.classPrediction],1)}})}(a.out,a.conv11,t.prediction_layer);return function(e,t,n){return Ug(()=>{let a=e.shape[0],r=Nee(Mb(nx(n.extra_dim,[a,1,1]),[-1,4]),Mb(e,[-1,4]));r=Mb(r,[a,r.shape[0]/a,4]);let i=Bb(Wb(t,[0,0,1],[-1,-1,-1])),s=Wb(i,[0,0,0],[-1,-1,1]);return s=Mb(s,[a,s.shape[1]]),{boxes:Ok(r),scores:Ok(s)}})}(r,i,t.output_layer)})}async forward(e){return this.forwardInput(await b9(e))}async locateFaces(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxResults:n,minConfidence:a}=new Cee(t),r=await b9(e),{boxes:i,scores:s}=this.forwardInput(r),o=i[0],l=s[0];for(let y=1;y<i.length;y++)i[y].dispose(),s[y].dispose();let u=Array.from(l.dataSync()),c=function(e,t,n,a,r){let i=e.shape[0],s=Math.min(n,i),o=t.map((e,t)=>({score:e,boxIndex:t})).filter(e=>e.score>r).sort((e,t)=>t.score-e.score),l=e=>e<=a?1:0,u=[];return o.forEach(t=>{if(u.length>=s)return;let n=t.score;for(let a=u.length-1;a>=0;--a){let n=Iee(e,t.boxIndex,u[a]);if(0!==n&&(t.score*=l(n),t.score<=r))break}n===t.score&&u.push(t.boxIndex)}),u}(o,u,n,.5,a),d=r.getReshapedInputDimensions(0),h=r.inputSize,p=h/d.width,f=h/d.height,m=o.arraySync(),g=c.map(e=>{let[t,n]=[Math.max(0,m[e][0]),Math.min(1,m[e][2])].map(e=>e*f),[a,i]=[Math.max(0,m[e][1]),Math.min(1,m[e][3])].map(e=>e*p);return new B7(u[e],new G7(a,t,i-a,n-t),{height:r.getInputHeight(0),width:r.getInputWidth(0)})});return o.dispose(),l.dispose(),g}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return wee(e)}extractParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=P9(e),{extractMobilenetV1Params:r,extractPredictionLayerParams:i}=xee(n,t),s=r(),o=i(),l={extra_dim:kk(n(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{params:{mobilenetv1:s,prediction_layer:o,output_layer:l},paramMappings:t}}(e)}};var _ee=[new O7(.738768,.874946),new O7(2.42204,2.65704),new O7(4.30971,7.04493),new O7(10.246,4.59428),new O7(12.6868,11.8741)],Aee=[new O7(1.603231,2.094468),new O7(6.041143,7.080126),new O7(2.882459,3.518061),new O7(4.266906,5.178857),new O7(9.041765,10.66308)],Fee=[117.001,114.697,97.404],Ree=e=>"number"==typeof e;function Dee(e){return Ug(()=>{let t=ib(e,qv(.10000000149011612));return nb(jw(_x(e,t)),t)})}function Mee(e,t){return Ug(()=>{let n=aw(e,[[0,0],[1,1],[1,1],[0,0]]);return n=sv(n,t.conv.filters,[1,1],"valid"),n=_x(n,t.bn.sub),n=ib(n,t.bn.truediv),n=nb(n,t.conv.bias),Dee(n)})}function Oee(e,t){return Ug(()=>{let n=aw(e,[[0,0],[1,1],[1,1],[0,0]]);return n=$w(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=nb(n,t.bias),Dee(n)})}function Pee(e,t){let n=A9(e,t);let a=D9(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(a,r,i){let s=n(a,r,3,"".concat(i,"/conv")),o=function(n,a){let r=xk(e(n)),i=xk(e(n));return t.push({paramPath:"".concat(a,"/sub")},{paramPath:"".concat(a,"/truediv")}),{sub:r,truediv:i}}(r,"".concat(i,"/bn"));return{conv:s,bn:o}},extractSeparableConvParams:a}}function Lee(e,t){let n=O9(e,t);function a(e){return{filters:n("".concat(e,"/filters"),4),bias:n("".concat(e,"/bias"),1)}}return{extractConvParams:a,extractConvWithBatchNormParams:function(e){let t=a("".concat(e,"/conv")),r=function(e){return{sub:n("".concat(e,"/sub"),1),truediv:n("".concat(e,"/truediv"),1)}}("".concat(e,"/bn"));return{conv:t,bn:r}},extractSeparableConvParams:M9(n)}}var zee=class{constructor(){let{inputSize:e,scoreThreshold:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,"number"!=typeof this._inputSize||this._inputSize%32!==0)throw new Error("".concat(this._name," - expected inputSize to be a number divisible by 32"));if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error("".concat(this._name," - expected scoreThreshold to be a number between 0 and 1"))}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},Bee=class e extends I9{constructor(e){super("TinyYolov2"),function(e){if(!e)throw new Error("invalid config: ".concat(e));if("boolean"!=typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: ".concat(e.withSeparableConvs));if(!Ree(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: ".concat(e.iouThreshold));if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(e=>"string"==typeof e))throw new Error("config.classes has to be an array class names: string[], have: ".concat(JSON.stringify(e.classes)));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(e=>e||{}).every(e=>Ree(e.x)&&Ree(e.y)))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: ".concat(JSON.stringify(e.anchors)));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(Ree)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: ".concat(JSON.stringify(e.meanRgb)))}(e),this._config=e}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(e,t){let n=Mee(e,t.conv0);return n=Bx(n,[2,2],[2,2],"same"),n=Mee(n,t.conv1),n=Bx(n,[2,2],[2,2],"same"),n=Mee(n,t.conv2),n=Bx(n,[2,2],[2,2],"same"),n=Mee(n,t.conv3),n=Bx(n,[2,2],[2,2],"same"),n=Mee(n,t.conv4),n=Bx(n,[2,2],[2,2],"same"),n=Mee(n,t.conv5),n=Bx(n,[2,2],[1,1],"same"),n=Mee(n,t.conv6),n=Mee(n,t.conv7),E9(n,t.conv8,"valid",!1)}runMobilenet(e,t){let n=this.config.isFirstLayerConv2d?Dee(E9(e,t.conv0,"valid",!1)):Oee(e,t.conv0);return n=Bx(n,[2,2],[2,2],"same"),n=Oee(n,t.conv1),n=Bx(n,[2,2],[2,2],"same"),n=Oee(n,t.conv2),n=Bx(n,[2,2],[2,2],"same"),n=Oee(n,t.conv3),n=Bx(n,[2,2],[2,2],"same"),n=Oee(n,t.conv4),n=Bx(n,[2,2],[2,2],"same"),n=Oee(n,t.conv5),n=Bx(n,[2,2],[1,1],"same"),n=t.conv6?Oee(n,t.conv6):n,n=t.conv7?Oee(n,t.conv7):n,E9(n,t.conv8,"valid",!1)}forwardInput(e,t){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return Ug(()=>{let a=$y(e.toBatchTensor(t,!1),"float32");return a=this.config.meanRgb?V7(a,this.config.meanRgb):a,a=a.div(255),this.config.withSeparableConvs?this.runMobilenet(a,n):this.runTinyYolov2(a,n)})}async forward(e,t){return this.forwardInput(await b9(e),t)}async detect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{inputSize:n,scoreThreshold:a}=new zee(t),r=await b9(e),i=await this.forwardInput(r,n),s=Ug(()=>Ok(i)[0].expandDims()),o={width:r.getInputWidth(0),height:r.getInputHeight(0)},l=await this.extractBoxes(s,r.getReshapedInputDimensions(0),a);i.dispose(),s.dispose();let u=l.map(e=>e.box),c=l.map(e=>e.score),d=l.map(e=>e.classScore),h=l.map(e=>this.config.classes[e.label]);return function(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=t.map((e,t)=>({score:e,boxIndex:t})).sort((e,t)=>e.score-t.score).map(e=>e.boxIndex),i=[];for(;r.length>0;){let t=r.pop();i.push(t);let s=r,o=[];for(let n=0;n<s.length;n++){let r=s[n],i=e[t],l=e[r];o.push(W7(i,l,a))}r=r.filter((e,t)=>o[t]<=n)}return i}(u.map(e=>e.rescale(n)),c,this.config.iouThreshold,!0).map(e=>new z7(c[e],d[e],h[e],u[e],o))}getDefaultModelName(){return""}extractParamsFromWeightMap(e){return function(e,t){let n,a=[],{extractConvParams:r,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}=Lee(e,a);if(t.withSeparableConvs){let e=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?r("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:e>7?s("conv6"):void 0,conv7:e>8?s("conv7"):void 0,conv8:r("conv8")}}else n={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:r("conv8")};return _9(e,a),{params:n,paramMappings:a}}(e,this.config)}extractParams(t){let n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(7!==a&&8!==a&&9!==a)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ".concat(a," filterSizes in config"));return function(e,t,n,a){let r,{extractWeights:i,getRemainingWeights:s}=P9(e),o=[],{extractConvParams:l,extractConvWithBatchNormParams:u,extractSeparableConvParams:c}=Pee(i,o);if(t.withSeparableConvs){let[e,i,s,o,u,d,h,p,f]=a;r={conv0:t.isFirstLayerConv2d?l(e,i,3,"conv0"):c(e,i,"conv0"),conv1:c(i,s,"conv1"),conv2:c(s,o,"conv2"),conv3:c(o,u,"conv3"),conv4:c(u,d,"conv4"),conv5:c(d,h,"conv5"),conv6:p?c(h,p,"conv6"):void 0,conv7:f?c(p,f,"conv7"):void 0,conv8:l(f||p||h,5*n,1,"conv8")}}else{let[e,t,i,s,o,c,d,h,p]=a;r={conv0:u(e,t,"conv0"),conv1:u(t,i,"conv1"),conv2:u(i,s,"conv2"),conv3:u(s,o,"conv3"),conv4:u(o,c,"conv4"),conv5:u(c,d,"conv5"),conv6:u(d,h,"conv6"),conv7:u(h,p,"conv7"),conv8:l(p,5*n,1,"conv8")}}if(0!==s().length)throw new Error("weights remaing after extract: ".concat(s().length));return{params:r,paramMappings:o}}(t,this.config,this.boxEncodingSize,n)}async extractBoxes(e,t,n){let{width:a,height:r}=t,i=Math.max(a,r),s=i/a,o=i/r,u=e.shape[1],c=this.config.anchors.length,[d,h,p]=Ug(()=>{let t=e.reshape([u,u,c,this.boxEncodingSize]);return[t.slice([0,0,0,0],[u,u,c,4]),t.slice([0,0,0,4],[u,u,c,1]),this.withClassScores?lk(t.slice([0,0,0,5],[u,u,c,this.config.classes.length]),3):qv(0)]}),f=[],m=await h.array(),g=await d.array();for(let y=0;y<u;y++)for(let e=0;e<u;e++)for(let t=0;t<c;t++){let a=U7(m[y][e][t][0]);if(!n||a>n){let n=(e+U7(g[y][e][t][0]))/u*s,r=(y+U7(g[y][e][t][1]))/u*o,i=Math.exp(g[y][e][t][2])*this.config.anchors[t].x/u*s,c=Math.exp(g[y][e][t][3])*this.config.anchors[t].y/u*o,d=n-i/2,h=r-c/2,m={row:y,col:e,anchor:t},{classScore:b,label:v}=this.withClassScores?await this.extractPredictedClass(p,m):{classScore:1,label:0};f.push(l({box:new L7(d,h,d+i,h+c),score:a,classScore:a*b,label:v},m))}}return d.dispose(),h.dispose(),p.dispose(),f}async extractPredictedClass(e,t){let{row:n,col:a,anchor:r}=t,i=await e.array();return Array(this.config.classes.length).fill(0).map((e,t)=>i[n][a][r][t]).map((e,t)=>({classScore:e,label:t})).reduce((e,t)=>e.classScore>t.classScore?e:t)}};Bee.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var Wee=Bee,Vee=class extends Wee{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super(l({withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:Aee,meanRgb:Fee}:{anchors:_ee,withClassScores:!0}))}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(e=>new B7(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}};var Uee=class extends zee{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},jee=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function Gee(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>{let{alignedRect:t}=e;return t},i=e.map(e=>X9(e)?r(e):e.detection),s=a||(t instanceof Gm?await x9(t,i):await v9(t,i)),o=await n(s);return s.forEach(e=>e instanceof Gm&&e.dispose()),o}async function Hee(e,t,n,a,r){return Gee([e],t,async e=>n(e[0]),a,r)}var qee=[new O7(1.603231,2.094468),new O7(6.041143,7.080126),new O7(2.882459,3.518061),new O7(4.266906,5.178857),new O7(9.041765,10.66308)],Kee=[117.001,114.697,97.404],Xee=class extends Wee{constructor(){super({withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:qee,meanRgb:Kee,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(e=>new B7(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},Yee={ssdMobilenetv1:new Eee,tinyFaceDetector:new Xee,tinyYolov2:new Vee,faceLandmark68Net:new oee,faceLandmark68TinyNet:new class extends see{constructor(){super("FaceLandmark68TinyNet",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lee)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}},faceRecognitionNet:new gee,faceExpressionNet:new class extends j9{constructor(){super("FaceExpressionNet",arguments.length>0&&void 0!==arguments[0]?arguments[0]:new W9)}forwardInput(e){return Ug(()=>lk(this.runNet(e)))}async forward(e){return this.forwardInput(await b9(e))}async predictExpressions(e){let t=await b9(e),n=await this.forwardInput(t),a=await Promise.all(Ok(n).map(async e=>{let t=e.dataSync();return e.dispose(),t}));n.dispose();let r=a.map(e=>new H9(e));return t.isBatchInput?r:r[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}},ageGenderNet:new class extends I9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new aee(2);super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error("".concat(this._name," - load model before inference"));return Ug(()=>{let n=e instanceof y9?this.faceFeatureExtractor.forwardInput(e):e,a=Ob(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1);return{age:V9(a,t.fc.age).as1D(),gender:V9(a,t.fc.gender)}})}forwardInput(e){return Ug(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:lk(n)}})}async forward(e){return this.forwardInput(await b9(e))}async predictAgeAndGender(e){let t=await b9(e),n=await this.forwardInput(t),a=Ok(n.age),r=Ok(n.gender),i=a.map((e,t)=>({ageTensor:e,genderTensor:r[t]})),s=await Promise.all(i.map(async e=>{let{ageTensor:t,genderTensor:n}=e,a=t.dataSync()[0],r=n.dataSync()[0],i=r>.5,s=i?"male":"female",o=i?r:1-r;return t.dispose(),n.dispose(),{age:a,gender:s,genderProbability:o}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?s:s[0]}getDefaultModelName(){return"age_gender_model"}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return function(e){let t=[],{extractWeights:n,getRemainingWeights:a}=P9(e),r=F9(n,t),i=r(512,1,"fc/age"),s=r(512,2,"fc/gender");if(0!==a().length)throw new Error("weights remaing after extract: ".concat(a().length));return{paramMappings:t,params:{fc:{age:i,gender:s}}}}(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=U9(e);return this.faceFeatureExtractor.loadFromWeightMap(t),function(e){let t=[],n=O9(e,t);function a(e){return{weights:n("".concat(e,"/weights"),2),bias:n("".concat(e,"/bias"),1)}}let r={fc:{age:a("fc/age"),gender:a("fc/gender")}};return _9(e,t),{params:r,paramMappings:t}}(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}}},Qee=class extends jee{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},Jee=class extends Qee{async run(){let e=await this.parentTask,t=await Gee(e,this.input,async e=>Promise.all(e.map(e=>Yee.faceExpressionNet.predictExpressions(e))),this.extractedFaces);return e.map((e,n)=>q9(e,t[n]))}withAgeAndGender(){return new nte(this,this.input)}},Zee=class extends Qee{async run(){let e=await this.parentTask;if(e)return q9(e,await Hee(e,this.input,e=>Yee.faceExpressionNet.predictExpressions(e),this.extractedFaces))}withAgeAndGender(){return new ate(this,this.input)}},$ee=class extends Jee{withAgeAndGender(){return new rte(this,this.input)}withFaceDescriptors(){return new ote(this,this.input)}},ete=class extends Zee{withAgeAndGender(){return new ite(this,this.input)}withFaceDescriptor(){return new lte(this,this.input)}},tte=class extends jee{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},nte=class extends tte{async run(){let e=await this.parentTask,t=await Gee(e,this.input,async e=>Promise.all(e.map(e=>Yee.ageGenderNet.predictAgeAndGender(e))),this.extractedFaces);return e.map((e,n)=>{let{age:a,gender:r,genderProbability:i}=t[n];return bee(vee(e,r,i),a)})}withFaceExpressions(){return new Jee(this,this.input)}},ate=class extends tte{async run(){let e=await this.parentTask;if(!e)return;let{age:t,gender:n,genderProbability:a}=await Hee(e,this.input,e=>Yee.ageGenderNet.predictAgeAndGender(e),this.extractedFaces);return bee(vee(e,n,a),t)}withFaceExpressions(){return new Zee(this,this.input)}},rte=class extends nte{withFaceExpressions(){return new $ee(this,this.input)}withFaceDescriptors(){return new ote(this,this.input)}},ite=class extends ate{withFaceExpressions(){return new ete(this,this.input)}withFaceDescriptor(){return new lte(this,this.input)}},ste=class extends jee{constructor(e,t){super(),this.parentTask=e,this.input=t}},ote=class extends ste{async run(){let e=await this.parentTask;return(await Gee(e,this.input,e=>Promise.all(e.map(e=>Yee.faceRecognitionNet.computeFaceDescriptor(e))),null,e=>e.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>yee(e[n],t))}withFaceExpressions(){return new $ee(this,this.input)}withAgeAndGender(){return new rte(this,this.input)}},lte=class extends ste{async run(){let e=await this.parentTask;if(e)return yee(e,await Hee(e,this.input,e=>Yee.faceRecognitionNet.computeFaceDescriptor(e),null,e=>e.landmarks.align(null,{useDlibAlignment:!0})))}withFaceExpressions(){return new ete(this,this.input)}withAgeAndGender(){return new ite(this,this.input)}},ute=class extends jee{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?Yee.faceLandmark68TinyNet:Yee.faceLandmark68Net}},cte=class extends ute{async run(){let e=await this.parentTask,t=e.map(e=>e.detection),n=this.input instanceof Gm?await x9(this.input,t):await v9(this.input,t),a=await Promise.all(n.map(e=>this.landmarkNet.detectLandmarks(e)));return n.forEach(e=>e instanceof Gm&&e.dispose()),e.filter((e,t)=>a[t]).map((e,t)=>Y9(e,a[t]))}withFaceExpressions(){return new $ee(this,this.input)}withAgeAndGender(){return new rte(this,this.input)}withFaceDescriptors(){return new ote(this,this.input)}},dte=class extends ute{async run(){let e=await this.parentTask;if(!e)return;let{detection:t}=e,n=this.input instanceof Gm?await x9(this.input,[t]):await v9(this.input,[t]),a=await this.landmarkNet.detectLandmarks(n[0]);return n.forEach(e=>e instanceof Gm&&e.dispose()),Y9(e,a)}withFaceExpressions(){return new ete(this,this.input)}withAgeAndGender(){return new ite(this,this.input)}withFaceDescriptor(){return new lte(this,this.input)}},hte=class extends jee{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Cee;super(),this.input=e,this.options=t}},pte=class extends hte{async run(){let e,{input:t,options:n}=this;if(n instanceof Uee)e=Yee.tinyFaceDetector.locateFaces(t,n);else if(n instanceof Cee)e=Yee.ssdMobilenetv1.locateFaces(t,n);else{if(!(n instanceof zee))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");e=Yee.tinyYolov2.locateFaces(t,n)}return e}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(t=>e(t.map(e=>X7({},e)))).catch(e=>t(e))})}withFaceLandmarks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new cte(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new Jee(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new nte(this.runAndExtendWithFaceDetections(),this.input)}},fte=class extends hte{async run(){let e=await new pte(this.input,this.options),t=e[0];return e.forEach(e=>{e.score>t.score&&(t=e)}),t}runAndExtendWithFaceDetection(){return new Promise(async e=>{let t=await this.run();e(t?X7({},t):void 0)})}withFaceLandmarks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new dte(this.runAndExtendWithFaceDetection(),this.input,e)}withFaceExpressions(){return new Zee(this.runAndExtendWithFaceDetection(),this.input)}withAgeAndGender(){return new ate(this.runAndExtendWithFaceDetection(),this.input)}};function mte(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Cee;return new pte(e,t)}function gte(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");let n=Array.from(e),a=Array.from(t);return Math.sqrt(n.map((e,t)=>e-a[t]).reduce((e,t)=>e+t*t,0))}var yte,bte,vte;!function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"}(yte||(yte={})),function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"}(bte||(bte={})),function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"}(vte||(vte={}));const xte=["user","model","function","system"];var wte,kte,Ste,Ite,Nte,Tte,Cte,Ete;!function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"}(wte||(wte={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(kte||(kte={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(Ste||(Ste={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"}(Ite||(Ite={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"}(Nte||(Nte={})),function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"}(Tte||(Tte={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"}(Cte||(Cte={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(Ete||(Ete={}));class _te extends Error{constructor(e){super("[GoogleGenerativeAI Error]: ".concat(e))}}class Ate extends _te{constructor(e,t){super(e),this.response=t}}class Fte extends _te{constructor(e,t,n,a){super(e),this.status=t,this.statusText=n,this.errorDetails=a}}class Rte extends _te{}class Dte extends _te{}var Mte;!function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"}(Mte||(Mte={}));class Ote{constructor(e,t,n,a,r){this.model=e,this.task=t,this.apiKey=n,this.stream=a,this.requestOptions=r}toString(){var e,t;const n=(null===(e=this.requestOptions)||void 0===e?void 0:e.apiVersion)||"v1beta",a=(null===(t=this.requestOptions)||void 0===t?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com";let r="".concat(a,"/").concat(n,"/").concat(this.model,":").concat(this.task);return this.stream&&(r+="?alt=sse"),r}}async function Pte(e){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",function(e){const t=[];return(null===e||void 0===e?void 0:e.apiClient)&&t.push(e.apiClient),t.push("".concat("genai-js","/").concat("0.24.1")),t.join(" ")}(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let a=null===(t=e.requestOptions)||void 0===t?void 0:t.customHeaders;if(a){if(!(a instanceof Headers))try{a=new Headers(a)}catch(Xm){throw new Rte("unable to convert customHeaders value ".concat(JSON.stringify(a)," to Headers: ").concat(Xm.message))}for(const[e,t]of a.entries()){if("x-goog-api-key"===e)throw new Rte("Cannot set reserved header name ".concat(e));if("x-goog-api-client"===e)throw new Rte("Header name ".concat(e," can only be set using the apiClient field"));n.append(e,t)}}return n}async function Lte(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fetch;const{url:o,fetchOptions:l}=await async function(e,t,n,a,r,i){const s=new Ote(e,t,n,a,i);return{url:s.toString(),fetchOptions:Object.assign(Object.assign({},zte(i)),{method:"POST",headers:await Pte(s),body:r})}}(e,t,n,a,r,i);return async function(e,t){let n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fetch;try{n=await a(e,t)}catch(Xm){!function(e,t){let n=e;"AbortError"===n.name?(n=new Dte("Request aborted when fetching ".concat(t.toString(),": ").concat(e.message)),n.stack=e.stack):e instanceof Fte||e instanceof Rte||(n=new _te("Error fetching from ".concat(t.toString(),": ").concat(e.message)),n.stack=e.stack);throw n}(Xm,e)}n.ok||await async function(e,t){let n,a="";try{const t=await e.json();a=t.error.message,t.error.details&&(a+=" ".concat(JSON.stringify(t.error.details)),n=t.error.details)}catch(Xm){}throw new Fte("Error fetching from ".concat(t.toString(),": [").concat(e.status," ").concat(e.statusText,"] ").concat(a),e.status,e.statusText,n)}(n,e);return n}(o,l,s)}function zte(e){const t={};if(void 0!==(null===e||void 0===e?void 0:e.signal)||(null===e||void 0===e?void 0:e.timeout)>=0){const n=new AbortController;(null===e||void 0===e?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),(null===e||void 0===e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}function Bte(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn("This response had ".concat(e.candidates.length," ")+"candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates."),Ute(e.candidates[0]))throw new Ate("".concat(jte(e)),e);return function(e){var t,n,a,r;const i=[];if(null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)for(const s of null===(r=null===(a=e.candidates)||void 0===a?void 0:a[0].content)||void 0===r?void 0:r.parts)s.text&&i.push(s.text),s.executableCode&&i.push("\n```"+s.executableCode.language+"\n"+s.executableCode.code+"\n```\n"),s.codeExecutionResult&&i.push("\n```\n"+s.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}(e)}if(e.promptFeedback)throw new Ate("Text not available. ".concat(jte(e)),e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn("This response had ".concat(e.candidates.length," ")+"candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates."),Ute(e.candidates[0]))throw new Ate("".concat(jte(e)),e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Wte(e)[0]}if(e.promptFeedback)throw new Ate("Function call not available. ".concat(jte(e)),e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn("This response had ".concat(e.candidates.length," ")+"candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates."),Ute(e.candidates[0]))throw new Ate("".concat(jte(e)),e);return Wte(e)}if(e.promptFeedback)throw new Ate("Function call not available. ".concat(jte(e)),e)},e}function Wte(e){var t,n,a,r;const i=[];if(null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)for(const s of null===(r=null===(a=e.candidates)||void 0===a?void 0:a[0].content)||void 0===r?void 0:r.parts)s.functionCall&&i.push(s.functionCall);return i.length>0?i:void 0}const Vte=[Nte.RECITATION,Nte.SAFETY,Nte.LANGUAGE];function Ute(e){return!!e.finishReason&&Vte.includes(e.finishReason)}function jte(e){var t,n,a;let r="";if(e.candidates&&0!==e.candidates.length||!e.promptFeedback){if(null===(a=e.candidates)||void 0===a?void 0:a[0]){const t=e.candidates[0];Ute(t)&&(r+="Candidate was blocked due to ".concat(t.finishReason),t.finishMessage&&(r+=": ".concat(t.finishMessage)))}}else r+="Response was blocked",(null===(t=e.promptFeedback)||void 0===t?void 0:t.blockReason)&&(r+=" due to ".concat(e.promptFeedback.blockReason)),(null===(n=e.promptFeedback)||void 0===n?void 0:n.blockReasonMessage)&&(r+=": ".concat(e.promptFeedback.blockReasonMessage));return r}function Gte(e){return this instanceof Gte?(this.v=e,this):new Gte(e)}function Hte(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,r=n.apply(e,t||[]),i=[];return a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a;function s(e){r[e]&&(a[e]=function(t){return new Promise(function(n,a){i.push([e,t,n,a])>1||o(e,t)})})}function o(e,t){try{!function(e){e.value instanceof Gte?Promise.resolve(e.value.v).then(l,u):c(i[0][2],e)}(r[e](t))}catch(Xm){c(i[0][3],Xm)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}}"function"===typeof SuppressedError&&SuppressedError;const qte=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Kte(e){const t=function(e){const t=e.getReader(),n=new ReadableStream({start(e){let n="";return a();function a(){return t.read().then(t=>{let{value:r,done:i}=t;if(i)return n.trim()?void e.error(new _te("Failed to parse stream")):void e.close();n+=r;let s,o=n.match(qte);for(;o;){try{s=JSON.parse(o[1])}catch(Xm){return void e.error(new _te('Error parsing JSON response: "'.concat(o[1],'"')))}e.enqueue(s),n=n.substring(o[0].length),o=n.match(qte)}return a()}).catch(e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new Dte("Request aborted when reading from the stream"):new _te("Error reading from the stream"),t})}}});return n}(e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0}))),[n,a]=t.tee();return{stream:Yte(n),response:Xte(a)}}async function Xte(e){const t=[],n=e.getReader();for(;;){const{done:e,value:a}=await n.read();if(e)return Bte(Qte(t));t.push(a)}}function Yte(e){return Hte(this,arguments,function*(){const t=e.getReader();for(;;){const{value:e,done:n}=yield Gte(t.read());if(n)break;yield yield Gte(Bte(e))}})}function Qte(e){const t=e[e.length-1],n={promptFeedback:null===t||void 0===t?void 0:t.promptFeedback};for(const a of e){if(a.candidates){let e=0;for(const t of a.candidates)if(n.candidates||(n.candidates=[]),n.candidates[e]||(n.candidates[e]={index:e}),n.candidates[e].citationMetadata=t.citationMetadata,n.candidates[e].groundingMetadata=t.groundingMetadata,n.candidates[e].finishReason=t.finishReason,n.candidates[e].finishMessage=t.finishMessage,n.candidates[e].safetyRatings=t.safetyRatings,t.content&&t.content.parts){n.candidates[e].content||(n.candidates[e].content={role:t.content.role||"user",parts:[]});const a={};for(const r of t.content.parts)r.text&&(a.text=r.text),r.functionCall&&(a.functionCall=r.functionCall),r.executableCode&&(a.executableCode=r.executableCode),r.codeExecutionResult&&(a.codeExecutionResult=r.codeExecutionResult),0===Object.keys(a).length&&(a.text=""),n.candidates[e].content.parts.push(a)}e++}a.usageMetadata&&(n.usageMetadata=a.usageMetadata)}return n}async function Jte(e,t,n,a){return Kte(await Lte(t,Mte.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),a))}async function Zte(e,t,n,a){const r=await Lte(t,Mte.GENERATE_CONTENT,e,!1,JSON.stringify(n),a);return{response:Bte(await r.json())}}function $te(e){if(null!=e)return"string"===typeof e?{role:"system",parts:[{text:e}]}:e.text?{role:"system",parts:[e]}:e.parts?e.role?e:{role:"system",parts:e.parts}:void 0}function ene(e){let t=[];if("string"===typeof e)t=[{text:e}];else for(const n of e)"string"===typeof n?t.push({text:n}):t.push(n);return function(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let a=!1,r=!1;for(const i of e)"functionResponse"in i?(n.parts.push(i),r=!0):(t.parts.push(i),a=!0);if(a&&r)throw new _te("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!a&&!r)throw new _te("No content is provided for sending chat message.");if(a)return t;return n}(t)}function tne(e){let t;if(e.contents)t=e;else{t={contents:[ene(e)]}}return e.systemInstruction&&(t.systemInstruction=$te(e.systemInstruction)),t}const nne=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],ane={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function rne(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;if(void 0===n)return!1;if(void 0===n.parts||0===n.parts.length)return!1;for(const a of n.parts){if(void 0===a||0===Object.keys(a).length)return!1;if(void 0!==a.text&&""===a.text)return!1}return!0}const ine="SILENT_ERROR";class sne{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.model=t,this.params=n,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null===n||void 0===n?void 0:n.history)&&(!function(e){let t=!1;for(const n of e){const{role:e,parts:a}=n;if(!t&&"user"!==e)throw new _te("First content should be with role 'user', got ".concat(e));if(!xte.includes(e))throw new _te("Each item should include role field. Got ".concat(e," but valid roles are: ").concat(JSON.stringify(xte)));if(!Array.isArray(a))throw new _te("Content should have 'parts' property with an array of Parts");if(0===a.length)throw new _te("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const t of a)for(const e of nne)e in t&&(r[e]+=1);const i=ane[e];for(const t of nne)if(!i.includes(t)&&r[t]>0)throw new _te("Content with role '".concat(e,"' can't contain '").concat(t,"' part"));t=!0}}(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,a,r,i,s,o;await this._sendPromise;const l=ene(e),u={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(a=this.params)||void 0===a?void 0:a.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(i=this.params)||void 0===i?void 0:i.toolConfig,systemInstruction:null===(s=this.params)||void 0===s?void 0:s.systemInstruction,cachedContent:null===(o=this.params)||void 0===o?void 0:o.cachedContent,contents:[...this._history,l]},c=Object.assign(Object.assign({},this._requestOptions),t);let d;return this._sendPromise=this._sendPromise.then(()=>Zte(this._apiKey,this.model,u,c)).then(e=>{var t;if(rne(e.response)){this._history.push(l);const n=Object.assign({parts:[],role:"model"},null===(t=e.response.candidates)||void 0===t?void 0:t[0].content);this._history.push(n)}else{const t=jte(e.response);t&&console.warn("sendMessage() was unsuccessful. ".concat(t,". Inspect response object for details."))}d=e}).catch(e=>{throw this._sendPromise=Promise.resolve(),e}),await this._sendPromise,d}async sendMessageStream(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,a,r,i,s,o;await this._sendPromise;const l=ene(e),u={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(a=this.params)||void 0===a?void 0:a.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(i=this.params)||void 0===i?void 0:i.toolConfig,systemInstruction:null===(s=this.params)||void 0===s?void 0:s.systemInstruction,cachedContent:null===(o=this.params)||void 0===o?void 0:o.cachedContent,contents:[...this._history,l]},c=Object.assign(Object.assign({},this._requestOptions),t),d=Jte(this._apiKey,this.model,u,c);return this._sendPromise=this._sendPromise.then(()=>d).catch(e=>{throw new Error(ine)}).then(e=>e.response).then(e=>{if(rne(e)){this._history.push(l);const t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{const t=jte(e);t&&console.warn("sendMessageStream() was unsuccessful. ".concat(t,". Inspect response object for details."))}}).catch(e=>{e.message!==ine&&console.error(e)}),d}}class one{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model="models/".concat(t.model),this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=$te(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const a=tne(e),r=Object.assign(Object.assign({},this._requestOptions),t);return Zte(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},a),r)}async generateContentStream(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const a=tne(e),r=Object.assign(Object.assign({},this._requestOptions),t);return Jte(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},a),r)}startChat(e){var t;return new sne(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(t=this.cachedContent)||void 0===t?void 0:t.name},e),this._requestOptions)}async countTokens(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e,t){var n;let a={model:null===t||void 0===t?void 0:t.model,generationConfig:null===t||void 0===t?void 0:t.generationConfig,safetySettings:null===t||void 0===t?void 0:t.safetySettings,tools:null===t||void 0===t?void 0:t.tools,toolConfig:null===t||void 0===t?void 0:t.toolConfig,systemInstruction:null===t||void 0===t?void 0:t.systemInstruction,cachedContent:null===(n=null===t||void 0===t?void 0:t.cachedContent)||void 0===n?void 0:n.name,contents:[]};const r=null!=e.generateContentRequest;if(e.contents){if(r)throw new Rte("CountTokensRequest must have one of contents or generateContentRequest, not both.");a.contents=e.contents}else if(r)a=Object.assign(Object.assign({},a),e.generateContentRequest);else{const t=ene(e);a.contents=[t]}return{generateContentRequest:a}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,n,a){return(await Lte(t,Mte.COUNT_TOKENS,e,!1,JSON.stringify(n),a)).json()}(this.apiKey,this.model,n,a)}async embedContent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){if("string"===typeof e||Array.isArray(e))return{content:ene(e)};return e}(e),a=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,n,a){return(await Lte(t,Mte.EMBED_CONTENT,e,!1,JSON.stringify(n),a)).json()}(this.apiKey,this.model,n,a)}async batchEmbedContents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,n,a){const r=n.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await Lte(t,Mte.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:r}),a)).json()}(this.apiKey,this.model,e,n)}}class lne{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new _te("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new one(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new Rte("Cached content must contain a `name` field.");if(!e.model)throw new Rte("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const i of a)if((null===t||void 0===t?void 0:t[i])&&e[i]&&(null===t||void 0===t?void 0:t[i])!==e[i]){if("model"===i){if((t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue}throw new Rte('Different value for "'.concat(i,'" specified in modelParams')+" (".concat(t[i],") and cachedContent (").concat(e[i],")"))}const r=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new one(this.apiKey,r,n)}}const une=function(){const t=(0,e.useRef)(null),n=(0,e.useRef)(null),[a,r]=(0,e.useState)(!1),[i,s]=(0,e.useState)(null),[o,u]=(0,e.useState)("none"),c=(0,e.useRef)(null),d=(0,e.useRef)(null),h=(0,e.useRef)(!1),[p,f]=(0,e.useState)(null),[m,g]=(0,e.useState)(!1),[y,b]=(0,e.useState)(100),[v,x]=(0,e.useState)(!1),[w,k]=(0,e.useState)(!1),S=(0,e.useRef)(null),[I,N]=(0,e.useState)([]),[T,C]=(0,e.useState)(null),E=(0,e.useRef)({x:0,y:0}),[_,A]=(0,e.useState)(""),[F,R]=(0,e.useState)(""),[D,M]=(0,e.useState)(!1),[O,P]=(0,e.useState)(""),[L,z]=(0,e.useState)(!1),[B,W]=(0,e.useState)(""),[V,U]=(0,e.useState)(""),[j,G]=(0,e.useState)(!1),[H,q]=(0,e.useState)(""),[K,X]=(0,e.useState)("filters"),Y=(0,e.useRef)([]),Q=(0,e.useRef)(null),J=(0,e.useRef)(!1),[Z,$]=(0,e.useState)(!1),[ee,te]=(0,e.useState)(!1),[ne,ae]=(0,e.useState)("none"),[re,ie]=(0,e.useState)(null),[se,oe]=(0,e.useState)(!1),le=[{id:"none",name:"Original",icon:"\u2728"},{id:"grayscale",name:"Grayscale",icon:"\u26ab"},{id:"sepia",name:"Sepia",icon:"\ud83d\udfe4"},{id:"invert",name:"Invert",icon:"\ud83d\udd04"},{id:"brightness",name:"Bright",icon:"\u2600\ufe0f"},{id:"contrast",name:"Contrast",icon:"\u26a1"},{id:"saturate",name:"Vibrant",icon:"\ud83c\udf08"},{id:"blur",name:"Blur",icon:"\ud83d\udcab"},{id:"vintage",name:"Vintage",icon:"\ud83d\udcf7"},{id:"cool",name:"Cool",icon:"\u2744\ufe0f"},{id:"warm",name:"Warm",icon:"\ud83d\udd25"},{id:"dramatic",name:"Dramatic",icon:"\ud83c\udfad"},{id:"moonlight",name:"Moonlight",icon:"\ud83c\udf19"},{id:"sunset",name:"Sunset",icon:"\ud83c\udf05"},{id:"ocean",name:"Ocean",icon:"\ud83c\udf0a"},{id:"rose",name:"Rose",icon:"\ud83c\udf39"},{id:"noir",name:"Noir",icon:"\ud83c\udfac"},{id:"cyberpunk",name:"Cyberpunk",icon:"\ud83e\udd16"},{id:"pastel",name:"Pastel",icon:"\ud83c\udfa8"},{id:"neon",name:"Neon",icon:"\ud83d\udca1"}],ue=[{id:"dog",name:"Dog",icon:"\ud83d\udc36",category:"animals"},{id:"cat",name:"Cat",icon:"\ud83d\udc31",category:"animals"},{id:"bunny",name:"Bunny",icon:"\ud83d\udc30",category:"animals"},{id:"bear",name:"Bear",icon:"\ud83d\udc3b",category:"animals"},{id:"panda",name:"Panda",icon:"\ud83d\udc3c",category:"animals"},{id:"glasses",name:"Glasses",icon:"\ud83d\udd76\ufe0f",category:"accessories"},{id:"crown",name:"Crown",icon:"\ud83d\udc51",category:"accessories"},{id:"hat",name:"Hat",icon:"\ud83c\udfa9",category:"accessories"},{id:"party-hat",name:"Party Hat",icon:"\ud83c\udf89",category:"accessories"},{id:"hearts",name:"Hearts",icon:"\ud83d\udc95",category:"fun"},{id:"stars",name:"Stars",icon:"\u2b50",category:"fun"},{id:"sparkles",name:"Sparkles",icon:"\u2728",category:"fun"},{id:"flowers",name:"Flowers",icon:"\ud83c\udf38",category:"fun"},{id:"laugh",name:"LOL",icon:"\ud83d\ude02",category:"expressions"},{id:"cool",name:"Cool",icon:"\ud83d\ude0e",category:"expressions"},{id:"fire",name:"Fire",icon:"\ud83d\udd25",category:"expressions"},{id:"santa",name:"Santa",icon:"\ud83c\udf85",category:"seasonal"},{id:"snowflake",name:"Snowflake",icon:"\u2744\ufe0f",category:"seasonal"},{id:"pumpkin",name:"Pumpkin",icon:"\ud83c\udf83",category:"seasonal"}],ce=(e,t)=>{e.preventDefault(),C(t.id);const n=e.currentTarget.parentElement.getBoundingClientRect(),a=e.type.includes("touch")?e.touches[0].clientX:e.clientX,r=e.type.includes("touch")?e.touches[0].clientY:e.clientY;E.current={x:a-n.left-t.x*n.width/100,y:r-n.top-t.y*n.height/100}},de=e=>{if(!T)return;const t=document.querySelector(".video-container");if(!t)return;const n=t.getBoundingClientRect(),a=e.type.includes("touch")?e.touches[0].clientX:e.clientX,r=e.type.includes("touch")?e.touches[0].clientY:e.clientY,i=(a-n.left-E.current.x)/n.width*100,s=(r-n.top-E.current.y)/n.height*100;N(I.map(e=>e.id===T?l(l({},e),{},{x:Math.max(0,Math.min(100,i)),y:Math.max(0,Math.min(100,s))}):e))},he=()=>{C(null)},pe=(e,t)=>{const n=y/100;let a="";switch(t){case"grayscale":a="grayscale(".concat(100*n,"%)");break;case"sepia":a="sepia(".concat(100*n,"%)");break;case"invert":a="invert(".concat(100*n,"%)");break;case"brightness":a="brightness(".concat(1+.3*n,")");break;case"contrast":a="contrast(".concat(1+.5*n,")");break;case"saturate":a="saturate(".concat(1+1*n,")");break;case"blur":a="blur(".concat(3*n,"px)");break;case"vintage":a="sepia(".concat(50*n,"%) contrast(").concat(1+.2*n,") brightness(").concat(1-.1*n,")");break;case"cool":a="hue-rotate(".concat(180*n,"deg) saturate(").concat(1+.3*n,")");break;case"warm":a="sepia(".concat(30*n,"%) saturate(").concat(1+.4*n,") brightness(").concat(1+.1*n,")");break;case"dramatic":a="contrast(".concat(1+.5*n,") brightness(").concat(1-.1*n,") saturate(").concat(1+.3*n,")");break;case"moonlight":a="brightness(".concat(1-.2*n,") contrast(").concat(1+.2*n,") saturate(").concat(1-.3*n,") hue-rotate(").concat(200*n,"deg)");break;case"sunset":a="sepia(".concat(40*n,"%) saturate(").concat(1+.5*n,") brightness(").concat(1+.1*n,") hue-rotate(").concat(-10*n,"deg)");break;case"ocean":a="hue-rotate(".concat(180*n,"deg) saturate(").concat(1+.4*n,") brightness(").concat(1+.1*n,")");break;case"rose":a="hue-rotate(".concat(320*n,"deg) saturate(").concat(1+.3*n,") brightness(").concat(1+.05*n,")");break;case"noir":a="grayscale(".concat(100*n,"%) contrast(").concat(1+.8*n,") brightness(").concat(1-.1*n,")");break;case"cyberpunk":a="hue-rotate(".concat(270*n,"deg) saturate(").concat(1+1*n,") contrast(").concat(1+.3*n,")");break;case"pastel":a="saturate(".concat(1-.4*n,") brightness(").concat(1+.2*n,") contrast(").concat(1-.1*n,")");break;case"neon":a="saturate(".concat(1+1.5*n,") contrast(").concat(1+.4*n,") brightness(").concat(1+.2*n,")");break;default:a="none"}v&&("none"===a?a="blur(0.5px) brightness(1.05)":a+=" blur(0.5px) brightness(1.05)"),e.filter=a},fe=()=>{f(null)},me=async()=>{if(!J.current)return;if(!t.current||!w||!a)return void(Q.current=setTimeout(me,33));const e=t.current;if(e.readyState===e.HAVE_ENOUGH_DATA)try{const e=await(async()=>{if(!S.current)return[];if(!t.current)return[];if(!w)return[];try{const e=t.current;if(e.readyState!==e.HAVE_ENOUGH_DATA)return[];let n=mte(e,new Uee({inputSize:416,scoreThreshold:.5})).withFaceLandmarks();return ee&&(n=n.withFaceExpressions()),re&&(n=n.withFaceDescriptors()),await n}catch(e){return console.error("Error detecting faces:",e),[]}})(),n=e||[];Y.current=n}catch(n){console.error("Face detection error:",n)}J.current&&(Q.current=setTimeout(me,33))},ge=()=>{if(h.current&&t.current&&n.current&&a){const e=t.current,a=n.current,r=a.getContext("2d",{willReadFrequently:!0});if(e.readyState===e.HAVE_ENOUGH_DATA){a.width===e.videoWidth&&a.height===e.videoHeight||(a.width=e.videoWidth,a.height=e.videoHeight),r.clearRect(0,0,a.width,a.height),r.save(),r.scale(-1,1),r.translate(-a.width,0),pe(r,o),r.drawImage(e,0,0,a.width,a.height),r.filter="none";const t=Y.current;w&&t.length>0&&(((e,t)=>{if(!Z||0===t.length)return;n.current&&t.forEach(t=>{const n=t.detection.box,a=t.detection.score;e.strokeStyle="#00FF00",e.lineWidth=5,e.strokeRect(n.x,n.y,n.width,n.height);const r=Math.round(100*a);e.save(),e.scale(-1,1),e.fillStyle="#00FF00",e.font="bold 20px Arial",e.fillText("".concat(r,"%"),-(n.x+n.width),n.y-10),e.restore()})})(r,t),((e,t)=>{"none"!==ne&&0!==t.length&&t.forEach(t=>{const n=t.landmarks.positions;if("all"===ne)n.forEach(t=>{e.beginPath(),e.arc(t.x,t.y,2,0,2*Math.PI),e.fillStyle="#00FF00",e.fill()});else if("groups"===ne){const t=(t,a,r)=>{for(let i=t;i<=a;i++)e.beginPath(),e.arc(n[i].x,n[i].y,3,0,2*Math.PI),e.fillStyle=r,e.fill()};t(0,16,"#FF6B6B"),t(17,21,"#4ECDC4"),t(22,26,"#45B7D1"),t(27,35,"#FFA07A"),t(36,41,"#98D8C8"),t(42,47,"#6BCF7F"),t(48,67,"#F7DC6F")}})})(r,t),((e,t)=>{ee&&0!==t.length&&t.forEach(t=>{if(!t.expressions)return;const n=t.detection.box,a=t.expressions,r=Object.keys(a).reduce((e,t)=>a[e]>a[t]?e:t);e.save(),e.scale(-1,1);const i=n.y-60,s=n.y-10,o=n.x+n.width/2,l={neutral:"\ud83d\ude10",happy:"\ud83d\ude0a",sad:"\ud83d\ude22",angry:"\ud83d\ude20",fearful:"\ud83d\ude28",disgusted:"\ud83e\udd22",surprised:"\ud83d\ude32"}[r]||"\ud83d\ude10";e.font="48px Arial",e.fillText(l,-o,i);const u=Math.round(100*a[r]);e.font="bold 18px Arial",e.fillStyle="#FFFFFF",e.strokeStyle="#000000",e.lineWidth=4;const c="".concat(r," ").concat(u,"%");e.strokeText(c,-(o+30),s),e.fillText(c,-(o+30),s),e.restore()})})(r,t),((e,t)=>{re&&0!==t.length&&t.forEach(t=>{if(!t.descriptor)return;const n=t.detection.box,a=gte(re,t.descriptor),r=Math.max(0,Math.min(100,100*(1-a))),i=r>60?"#00FF00":r>40?"#FFA500":"#FF0000";e.save(),e.scale(-1,1),e.fillStyle=i,e.font="bold 18px Arial",e.strokeStyle="#000000",e.lineWidth=3;const s="Match: ".concat(Math.round(r),"%");e.strokeText(s,-(n.x+n.width),n.y+n.height+25),e.fillText(s,-(n.x+n.width),n.y+n.height+25),e.restore()})})(r,t)),r.restore()}h.current&&(d.current=requestAnimationFrame(ge))}},ye=()=>{B.trim()&&(localStorage.setItem("gemini_api_key",B.trim()),A(B.trim()),z(!1),W(""))};(0,e.useEffect)(()=>{(async()=>{try{const e="".concat("/LearnLens","/models");return await Promise.all([Yee.tinyFaceDetector.loadFromUri(e),Yee.faceLandmark68Net.loadFromUri(e),Yee.faceExpressionNet.loadFromUri(e),Yee.faceRecognitionNet.loadFromUri(e)]),S.current=!0,!0}catch(e){return console.error("Error loading face-api models:",e),s("Failed to load face detection models: "+e.message),!1}})();const e=localStorage.getItem("gemini_api_key"),t="your_gemini_api_key_here";e?A(e):t&&A(t)},[]),(0,e.useEffect)(()=>(h.current=!1,d.current&&(cancelAnimationFrame(d.current),d.current=null),a&&(h.current=!0,ge()),()=>{h.current=!1,d.current&&(cancelAnimationFrame(d.current),d.current=null)}),[a,o,v,y,ne,Z,ee,re]),(0,e.useEffect)(()=>(J.current=!1,Q.current&&(clearTimeout(Q.current),Q.current=null),a&&w?(J.current=!0,me()):Y.current=[],()=>{J.current=!1,Q.current&&(clearTimeout(Q.current),Q.current=null)}),[a,w,Z,ee,ne,re]);const be=(0,e.useRef)(null),ve=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{const e=be.current;if(!e||!a)return;setTimeout(()=>{if(0===e.scrollLeft){const t=(e.scrollWidth-e.clientWidth)/2;e.scrollLeft=t}},100);const t=()=>{if(ve.current)return;const t=e.scrollLeft,n=e.scrollWidth-e.clientWidth,a=n/2;(t<=5||t>=n-5)&&(ve.current=!0,requestAnimationFrame(()=>{e.scrollLeft=a,requestAnimationFrame(()=>{ve.current=!1})}))};return e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t)}},[a]),(0,vr.jsx)("div",{className:"App",children:(0,vr.jsx)("section",{className:"app-section",children:(0,vr.jsxs)("div",{className:"container",children:[(0,vr.jsxs)("div",{className:"section-header",children:[(0,vr.jsx)("span",{className:"section-badge",children:"\ud83c\udfa8 Interactive Demo"}),(0,vr.jsx)("h2",{className:"section-title",children:"Try the App or Learn to Build It"}),(0,vr.jsxs)("p",{className:"section-subtitle",children:["Start your webcam and explore 20+ real-time filters, AI recommendations, and face detection.",(0,vr.jsx)("br",{}),"This is what you'll build through the 8 learning levels!"]})]}),(0,vr.jsxs)("div",{className:"app-layout",children:[(0,vr.jsxs)("div",{className:"camera-section",children:[(0,vr.jsxs)("div",{className:"video-container",children:[!a&&(0,vr.jsx)("div",{className:"placeholder",children:(0,vr.jsxs)("div",{className:"placeholder-content",children:[(0,vr.jsx)("svg",{className:"camera-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,vr.jsx)("p",{children:"Click the button below to start your webcam"})]})}),(0,vr.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"webcam hidden"}),(0,vr.jsx)("canvas",{ref:n,className:"webcam-canvas ".concat(a?"":"hidden")}),a&&(0,vr.jsx)("div",{className:"sticker-overlay",onMouseMove:de,onMouseUp:he,onTouchMove:de,onTouchEnd:he,children:I.map(e=>(0,vr.jsxs)("div",{className:"placed-sticker",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%"),fontSize:"".concat(e.size,"px"),transform:"translate(-50%, -50%) rotate(".concat(e.rotation,"deg) scaleX(-1)"),cursor:T===e.id?"grabbing":"grab"},children:[(0,vr.jsx)("span",{className:"sticker-emoji",onMouseDown:t=>ce(t,e),onTouchStart:t=>ce(t,e),children:e.icon}),(0,vr.jsx)("button",{className:"sticker-delete",onClick:()=>{return t=e.id,void N(I.filter(e=>e.id!==t));var t},title:"Remove sticker",children:"\xd7"})]},e.id))}),m&&(0,vr.jsx)("div",{className:"capture-flash"}),a&&(0,vr.jsx)("button",{className:"capture-button",onClick:()=>{if(n.current){g(!0);const e=n.current,t=document.createElement("canvas");t.width=e.width,t.height=e.height;const a=t.getContext("2d");a.drawImage(e,0,0),I.length>0&&I.forEach(e=>{const n=e.x/100*t.width,r=e.y/100*t.height;a.save(),a.translate(n,r),a.rotate(e.rotation*Math.PI/180),a.font="".concat(e.size,'px "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", Arial'),a.textAlign="center",a.textBaseline="middle",a.fillText(e.icon,0,0),a.restore()});const r=t.toDataURL("image/png");f(r),setTimeout(()=>g(!1),200)}},title:"Capture Photo",children:(0,vr.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),a&&(0,vr.jsx)("div",{className:"filters-container",children:(0,vr.jsx)("div",{className:"filters-scroll-track",ref:be,children:(0,vr.jsxs)("div",{className:"filters-scroll-wrapper",children:[(0,vr.jsx)("div",{className:"filters-scroll-content",children:le.map(e=>(0,vr.jsxs)("button",{className:"filter-button ".concat(o===e.id?"active":""),onClick:()=>{u(o===e.id?"none":e.id)},children:[(0,vr.jsx)("span",{className:"filter-icon",children:e.icon}),(0,vr.jsx)("span",{className:"filter-name",children:e.name})]},"".concat(e.id,"-first")))}),(0,vr.jsx)("div",{className:"filters-scroll-content","aria-hidden":"true",children:le.map(e=>(0,vr.jsxs)("button",{className:"filter-button ".concat(o===e.id?"active":""),onClick:()=>{u(o===e.id?"none":e.id)},children:[(0,vr.jsx)("span",{className:"filter-icon",children:e.icon}),(0,vr.jsx)("span",{className:"filter-name",children:e.name})]},"".concat(e.id,"-second")))})]})})})]}),a&&(0,vr.jsxs)("div",{className:"controls-sidebar",children:[(0,vr.jsxs)("div",{className:"tab-navigation",children:[(0,vr.jsx)("button",{className:"tab-button ".concat("filters"===K?"active":""),onClick:()=>X("filters"),children:"\u2728 Effects"}),(0,vr.jsx)("button",{className:"tab-button ".concat("face"===K?"active":""),onClick:()=>X("face"),children:"\ud83e\udd16 Face"}),(0,vr.jsx)("button",{className:"tab-button ".concat("ai"===K?"active":""),onClick:()=>X("ai"),children:"\ud83e\udde0 AI"}),(0,vr.jsx)("button",{className:"tab-button ".concat("stickers"===K?"active":""),onClick:()=>X("stickers"),children:"\ud83d\ude0a Stickers"})]}),(0,vr.jsxs)("div",{className:"tab-content",children:["filters"===K&&(0,vr.jsxs)("div",{className:"tab-panel",children:[(0,vr.jsx)("h3",{className:"panel-title",children:"Filter Effects"}),(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsx)("input",{type:"checkbox",checked:v,onChange:e=>x(e.target.checked),className:"toggle-checkbox"}),(0,vr.jsx)("span",{className:"toggle-label",children:"\u2728 Beauty Mode"})]})}),(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsxs)("span",{className:"slider-label",children:["Filter Intensity: ",y,"%"]}),(0,vr.jsx)("input",{type:"range",min:"0",max:"100",value:y,onChange:e=>b(Number(e.target.value)),className:"intensity-slider"})]})}),(0,vr.jsx)("div",{className:"feature-info",children:(0,vr.jsx)("p",{className:"feature-description",children:"\ud83d\udca1 Choose a filter from the horizontal scroll below the camera"})})]}),"face"===K&&(0,vr.jsxs)("div",{className:"tab-panel",children:[(0,vr.jsx)("h3",{className:"panel-title",children:"AI-Powered Face Detection"}),(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsx)("input",{type:"checkbox",checked:w,onChange:e=>k(e.target.checked),className:"toggle-checkbox"}),(0,vr.jsxs)("span",{className:"toggle-label",children:["Enable Face Detection ",w?"\u2713":""]})]})}),w&&(0,vr.jsxs)(vr.Fragment,{children:[(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsx)("input",{type:"checkbox",checked:Z,onChange:e=>$(e.target.checked),className:"toggle-checkbox"}),(0,vr.jsx)("span",{className:"toggle-label",children:"\ud83d\udce6 Bounding Box & Confidence"})]})}),(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>te(e.target.checked),className:"toggle-checkbox"}),(0,vr.jsx)("span",{className:"toggle-label",children:"\ud83d\ude0a Expression Recognition"})]})}),(0,vr.jsx)("div",{className:"control-group",children:(0,vr.jsxs)("label",{className:"control-label",children:[(0,vr.jsx)("span",{className:"slider-label",children:"\ud83d\udc41\ufe0f Landmarks:"}),(0,vr.jsxs)("select",{value:ne,onChange:e=>ae(e.target.value),className:"landmarks-select",children:[(0,vr.jsx)("option",{value:"none",children:"Hide Landmarks"}),(0,vr.jsx)("option",{value:"all",children:"Show All (Green)"}),(0,vr.jsx)("option",{value:"groups",children:"Color Groups (Educational)"})]})]})}),(0,vr.jsxs)("div",{className:"control-group face-recognition-section",children:[(0,vr.jsx)("label",{className:"section-label",children:"\ud83c\udfaf Face Recognition"}),re?(0,vr.jsxs)("div",{children:[(0,vr.jsx)("p",{className:"success-message",children:"\u2713 Reference captured! Matching enabled."}),(0,vr.jsx)("button",{className:"ai-button danger",onClick:()=>{ie(null),oe(!1)},children:"\u2715 Clear Reference"})]}):(0,vr.jsx)("button",{className:"ai-button",onClick:async()=>{if(t.current&&S.current)try{const e=t.current,n=new Uee({inputSize:416,scoreThreshold:.5}),a=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Cee;return new fte(e,t)}(e,n).withFaceLandmarks().withFaceDescriptor();a&&a.descriptor?(ie(a.descriptor),oe(!0)):s("No face detected. Please ensure your face is visible.")}catch(e){console.error("Error capturing reference face:",e),s("Failed to capture reference face")}else s("Face detection not ready")},children:"\ud83d\udcf8 Capture Reference Face"})]})]})]}),"ai"===K&&(0,vr.jsxs)("div",{className:"tab-panel",children:[(0,vr.jsx)("h3",{className:"panel-title",children:"AI-Powered Features"}),(0,vr.jsxs)("div",{className:"ai-feature-section",children:[(0,vr.jsx)("label",{className:"section-label",children:"\ud83d\udd11 API Key Settings"}),(0,vr.jsx)("p",{className:"feature-description",children:_?"\u2713 API key configured":"Add your Gemini API key to enable AI features"}),_?(0,vr.jsxs)("div",{children:[(0,vr.jsx)("p",{className:"success-message",style:{fontSize:"0.85rem"},children:"\ud83d\udd12 Stored securely in your browser only"}),(0,vr.jsx)("button",{className:"ai-button danger",onClick:()=>{localStorage.removeItem("gemini_api_key"),A(""),W(""),z(!1)},style:{marginTop:"10px"},children:"\ud83d\uddd1\ufe0f Remove API Key"})]}):(0,vr.jsxs)("div",{children:[(0,vr.jsx)("button",{className:"ai-button",onClick:()=>z(!0),children:"\u2795 Add API Key"}),(0,vr.jsxs)("p",{className:"feature-description",style:{marginTop:"10px",fontSize:"0.75rem",fontStyle:"italic"},children:["Get a free API key at"," ",(0,vr.jsx)("a",{href:"https://aistudio.google.com/app/api-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#a855f7",textDecoration:"underline"},children:"Google AI Studio"})]})]})]}),(0,vr.jsxs)("div",{className:"ai-feature-section",children:[(0,vr.jsx)("label",{className:"section-label",children:"\u2728 Filter Suggestion"}),(0,vr.jsx)("button",{className:"ai-button",onClick:async()=>{if(_){M(!0),R(""),P("");try{const e=new lne(_).getGenerativeModel({model:"gemini-2.5-flash"}),t=(new Date).getHours(),n="You are a photography and filter expert. Suggest ONE of the best filters from this list for a webcam photo during the ".concat(t<12?"morning":t<18?"afternoon":"evening",":\n\n      Available filters: ").concat(le.map(e=>e.name).join(", "),".\n\n      Respond with ONLY the filter name and one brief sentence explaining why it's good for this time of day. Keep it under 30 words."),a=await e.generateContent(n),r=(await a.response).text();R(r),M(!1)}catch(e){console.error("Error getting AI recommendation:",e),e.message&&e.message.includes("API key")?P("API key invalid"):P("Failed to get recommendation"),R(""),M(!1)}}},disabled:D||!_,children:D?"\ud83e\udd14 Thinking...":"Get Filter Suggestion"}),!_&&(0,vr.jsx)("p",{className:"inline-error",children:"\u26a0\ufe0f Add your API key"}),O&&(0,vr.jsxs)("p",{className:"inline-error",children:["\u274c ",O]}),F&&(0,vr.jsx)("div",{className:"ai-recommendation",children:(0,vr.jsxs)("p",{children:[(0,vr.jsx)("strong",{children:"AI:"})," ",F]})})]}),(0,vr.jsxs)("div",{className:"ai-feature-section",children:[(0,vr.jsx)("label",{className:"section-label",children:"\ud83d\udd2c Skin Analysis"}),(0,vr.jsx)("p",{className:"feature-description",children:"Get personalized filter recommendations based on your appearance"}),(0,vr.jsx)("button",{className:"ai-button",onClick:async()=>{if(_&&a&&t.current&&n.current){G(!0),U(""),q("");try{const e=t.current,a=n.current,r=document.createElement("canvas");r.width=a.width,r.height=a.height;const i=r.getContext("2d");i.save(),i.scale(-1,1),i.translate(-r.width,0),pe(i,o),i.drawImage(e,0,0,r.width,r.height),i.restore();const s=r.toDataURL("image/jpeg",.8).split(",")[1],l=new lne(_).getGenerativeModel({model:"gemini-2.5-flash"}),u="You are an expert in photography, skin tones, and visual aesthetics. Analyze this person's appearance in the webcam photo and provide personalized filter recommendations.\n\nAvailable filters: ".concat(le.map(e=>e.name).join(", "),".\n\nPlease analyze:\n1. Skin tone and undertones (warm/cool/neutral)\n2. Current lighting conditions\n3. Which 3 filters would look BEST on this person\n\nRespond in this format:\n**Skin Analysis:** [Brief 1-sentence analysis of skin tone and lighting]\n**Top 3 Recommended Filters:**\n1. [Filter Name] - [Why it suits them]\n2. [Filter Name] - [Why it suits them]\n3. [Filter Name] - [Why it suits them]\n\nKeep recommendations under 80 words total. Be specific and helpful."),c=await l.generateContent([u,{inlineData:{mimeType:"image/jpeg",data:s}}]),d=(await c.response).text();U(d),G(!1)}catch(e){console.error("Error analyzing with Gemini Vision:",e),e.message&&e.message.includes("API key")?q("API key invalid"):q("Analysis failed"),U(""),G(!1)}}},disabled:j||!_,children:j?"\ud83d\udd0d Analyzing...":"\ud83d\udcf8 Analyze My Appearance"}),!_&&(0,vr.jsx)("p",{className:"inline-error",children:"\u26a0\ufe0f Add your API key"}),H&&(0,vr.jsxs)("p",{className:"inline-error",children:["\u274c ",H]}),V&&(0,vr.jsx)("div",{className:"ai-recommendation",children:(0,vr.jsx)("div",{style:{whiteSpace:"pre-wrap",lineHeight:"1.6"},children:V})})]})]}),"stickers"===K&&(0,vr.jsxs)("div",{className:"tab-panel",children:[(0,vr.jsx)("h3",{className:"panel-title",children:"Add Stickers"}),(0,vr.jsx)("p",{className:"feature-description",children:"Click to add stickers, then drag to position"}),["animals","accessories","fun","expressions","seasonal"].map(e=>(0,vr.jsxs)("div",{className:"sticker-category",children:[(0,vr.jsx)("h4",{className:"category-title",children:e.charAt(0).toUpperCase()+e.slice(1)}),(0,vr.jsx)("div",{className:"stickers-grid",children:ue.filter(t=>t.category===e).map(e=>(0,vr.jsx)("button",{className:"sticker-button",onClick:()=>(e=>{const t={id:"".concat(e.id,"-").concat(Date.now()),icon:e.icon,name:e.name,x:50,y:50,size:60,rotation:0};N([...I,t])})(e),title:e.name,children:(0,vr.jsx)("span",{className:"sticker-icon",children:e.icon})},e.id))})]},e))]})]})]})]}),p&&(0,vr.jsx)("div",{className:"photo-preview-modal",onClick:fe,children:(0,vr.jsxs)("div",{className:"photo-preview-content",onClick:e=>e.stopPropagation(),children:[(0,vr.jsx)("button",{className:"close-preview",onClick:fe,children:(0,vr.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,vr.jsx)("img",{src:p,alt:"Captured",className:"preview-image"}),(0,vr.jsxs)("button",{className:"download-button",onClick:()=>{if(p){const e=document.createElement("a");e.download="beautify-me-".concat(Date.now(),".png"),e.href=p,e.click()}},children:[(0,vr.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download Photo"]})]})}),L&&(0,vr.jsx)("div",{className:"photo-preview-modal",onClick:()=>z(!1),children:(0,vr.jsxs)("div",{className:"api-key-modal-content",onClick:e=>e.stopPropagation(),children:[(0,vr.jsx)("button",{className:"close-preview",onClick:()=>z(!1),children:(0,vr.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,vr.jsx)("h2",{style:{color:"white",marginBottom:"20px",fontSize:"1.5rem"},children:"\ud83d\udd11 Add Gemini API Key"}),(0,vr.jsx)("p",{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:"15px",lineHeight:"1.6"},children:"Your API key is stored locally in your browser's localStorage and never sent to any server except Google's Gemini API."}),(0,vr.jsxs)("p",{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:"20px",fontSize:"0.9rem"},children:["Get a free API key at"," ",(0,vr.jsx)("a",{href:"https://aistudio.google.com/app/api-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#a855f7",textDecoration:"underline"},children:"Google AI Studio"})]}),(0,vr.jsx)("input",{type:"password",placeholder:"Paste your API key here...",value:B,onChange:e=>W(e.target.value),onKeyPress:e=>"Enter"===e.key&&ye(),className:"api-key-input",autoFocus:!0}),(0,vr.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[(0,vr.jsx)("button",{className:"download-button",onClick:ye,disabled:!B.trim(),children:"\ud83d\udcbe Save Key"}),(0,vr.jsx)("button",{className:"ai-button danger",onClick:()=>z(!1),style:{flex:1},children:"Cancel"})]})]})}),i&&(0,vr.jsx)("div",{className:"error",children:i}),(0,vr.jsx)("div",{className:"controls",children:a?(0,vr.jsxs)("button",{className:"stop-button",onClick:()=>{if(d.current&&cancelAnimationFrame(d.current),c.current){c.current.getTracks().forEach(e=>e.stop()),t.current&&(t.current.srcObject=null),c.current=null,r(!1),u("none")}},children:[(0,vr.jsx)("span",{className:"button-icon",children:(0,vr.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,vr.jsx)("rect",{x:"6",y:"6",width:"12",height:"12",rx:"1"})})}),"Stop Webcam"]}):(0,vr.jsxs)("button",{className:"start-button",onClick:async()=>{try{s(null);const e=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720},audio:!1});c.current=e,t.current&&(t.current.srcObject=e,await new Promise(e=>{t.current.onloadedmetadata=()=>{t.current.play(),e()}}),r(!0))}catch(e){console.error("Error accessing webcam:",e),s("Unable to access webcam. Please ensure you have granted camera permissions."),r(!1)}},children:[(0,vr.jsx)("span",{className:"button-icon",children:(0,vr.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,vr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),"Start Webcam"]})})]})})})};const cne=function(){return(0,vr.jsx)(ht,{children:(0,vr.jsxs)(De,{children:[(0,vr.jsx)(Fe,{path:"/",element:(0,vr.jsx)(Hu,{})}),(0,vr.jsx)(Fe,{path:"/demo",element:(0,vr.jsx)(une,{})}),(0,vr.jsx)(Fe,{path:"*",element:(0,vr.jsx)(Ae,{to:"/",replace:!0})})]})})},dne=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:a,getFCP:r,getLCP:i,getTTFB:s}=t;n(e),a(e),r(e),i(e),s(e)})};t.createRoot(document.getElementById("root")).render((0,vr.jsx)(e.StrictMode,{children:(0,vr.jsx)(cne,{})})),dne()})()})();
//# sourceMappingURL=main.3dd02a24.js.map